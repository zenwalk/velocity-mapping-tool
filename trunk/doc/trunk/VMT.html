<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of VMT</title>
  <meta name="keywords" content="VMT">
  <meta name="description" content="--- THE VELOCITY MAPPING TOOLBOX ---">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html trunk -->
<h1>VMT
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>--- THE VELOCITY MAPPING TOOLBOX ---</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function varargout = VMT(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> --- THE VELOCITY MAPPING TOOLBOX ---
 
 VMT is a Matlab-based software for processing and visualizing ADCP data
 collected along transects in rivers or other bodies of water. VMT allows
 rapid processing, visualization, and analysis of a range of ADCP datasets
 and includes utilities to export ADCP data to files compatible with
 ArcGIS, Tecplot, and Google Earth. The software can be used to explore
 patterns of three-dimensional fluid motion through several methods for
 calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et
 al., 2000). The software also includes capabilities for analyzing the
 acoustic backscatter and bathymetric data from the ADCP. A user-friendly
 graphical user interface (GUI) enhances program functionality and
 provides ready access to two- and three- dimensional plotting functions,
 allowing rapid display and interrogation of velocity, backscatter, and
 bathymetry data.
 
 CITATION: 
 Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.
 L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,
 J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and
 visualization suite for moving-vessel ADCP measurements. Earth Surf.
 Process. Landforms. doi: 10.1002/esp.3367

__________________________________________________________________________
 P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center
 (pjackson@usgs.gov)

 Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.
__________________________________________________________________________</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>	Takes the processed data structure and writes a TecPlot ASCII data file.</li><li><a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>	Takes the processed data structure and writes a TecPlot ASCII data file</li><li><a href="VMT_LoadMap.html" class="code" title="function Map = VMT_LoadMap(filetype,coord);">VMT_LoadMap</a>	This routine loads a map file from either a text file or a .mat file.</li><li><a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>	Computes the multibeam bathymetry from the four beams of the ADCP</li><li><a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>	Outputs the mean cross section (3-D) from VMT to Google Earth (saved as a</li><li><a href="VMT_OverlayDOQQ.html" class="code" title="function log_text = VMT_OverlayDOQQ(pathname)">VMT_OverlayDOQQ</a>	Prompts the user for a geotiff DOQQ (USGS) and overlays the aerial image</li><li><a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>	This function plots a plan view of the measurement region with a vector</li><li><a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>	Plots the shiptracks, and interpolated grid in the VMT GUI axes. Also</li><li><a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>	Plots a shoreline map given the shoreline data structure 'Map' (see</li><li><a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english)">VMT_PlotXSCont</a>	Plots contours for the variable 'var' within the mean cross section given</li><li><a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english)">VMT_PlotXSContQuiver</a>	This function plots the the contour plot (mean XS) for the variable 'var'</li><li><a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>	This function is a driver to preprocess the transects data.  Several</li><li><a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>	Driver program to process multiple transects at a single cross-section</li><li><a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>	Read in multiple ASCII output files from WinRiver or WinRiverII.</li><li><a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>	Saves the figures (specified by fignums) from VMT as .PNG or EPS files</li><li><a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>	This routine smooths all processed variables in V struct. By default is</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a></li><li><a href="#_sub2" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub3" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub4" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub5" class="code">function menuFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub6" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub7" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub8" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub9" class="code">function menuSave_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub10" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub11" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub12" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub13" class="code">function menuExport_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub14" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub15" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub16" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub17" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub18" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub19" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub20" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub21" class="code">function menuParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub22" class="code">function menuProcessingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub23" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub24" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub25" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub26" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub27" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub28" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub29" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub30" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub31" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub32" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub33" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub34" class="code">function menuKMZExport_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub35" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub36" class="code">function menuTools_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub37" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub38" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub39" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub40" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub41" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub42" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub43" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub44" class="code">function loadDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub45" class="code">function saveDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub46" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub47" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub48" class="code">function processingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub49" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub50" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub51" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub52" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub53" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub54" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub55" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub56" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub57" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub58" class="code">function WSE_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub59" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub60" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub61" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub62" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub63" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub64" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub65" class="code">function MapDepthAveragedVelocities_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub66" class="code">function DisplayShoreline_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub67" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub68" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub69" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub70" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub71" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub72" class="code">function Contour_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub73" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub74" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub75" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub76" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub77" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub78" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub79" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub80" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub81" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub82" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub83" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub84" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub85" class="code">function handles = buildToolbar(handles)</a></li><li><a href="#_sub86" class="code">function load_prefs(hfigure)</a></li><li><a href="#_sub87" class="code">function store_prefs(hfigure,pref)</a></li><li><a href="#_sub88" class="code">function initGUI(handles)</a></li><li><a href="#_sub89" class="code">function set_enable(handles,enable_state)</a></li><li><a href="#_sub90" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] =</a></li><li><a href="#_sub91" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a></li><li><a href="#_sub92" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a></li><li><a href="#_sub93" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a></li><li><a href="#_sub94" class="code">function dialogOK(hObject,eventdata,h_OK)</a></li><li><a href="#_sub95" class="code">function dialogCancel(hObject,eventdata,handles)</a></li><li><a href="#_sub96" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a></li><li><a href="#_sub97" class="code">function [beam_angle,magnetic_variation,wse,output_auxilliary_data] = exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxilliary_data,hf)</a></li><li><a href="#_sub98" class="code">function dialogExportSettings(hObject,eventdata,handles)</a></li><li><a href="#_sub99" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a></li><li><a href="#_sub100" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a></li><li><a href="#_sub101" class="code">function icons = getIcons</a></li><li><a href="#_sub102" class="code">function guiparams = createGUIparams</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function varargout = VMT(varargin)</a>
0002 <span class="comment">% --- THE VELOCITY MAPPING TOOLBOX ---</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% VMT is a Matlab-based software for processing and visualizing ADCP data</span>
0005 <span class="comment">% collected along transects in rivers or other bodies of water. VMT allows</span>
0006 <span class="comment">% rapid processing, visualization, and analysis of a range of ADCP datasets</span>
0007 <span class="comment">% and includes utilities to export ADCP data to files compatible with</span>
0008 <span class="comment">% ArcGIS, Tecplot, and Google Earth. The software can be used to explore</span>
0009 <span class="comment">% patterns of three-dimensional fluid motion through several methods for</span>
0010 <span class="comment">% calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et</span>
0011 <span class="comment">% al., 2000). The software also includes capabilities for analyzing the</span>
0012 <span class="comment">% acoustic backscatter and bathymetric data from the ADCP. A user-friendly</span>
0013 <span class="comment">% graphical user interface (GUI) enhances program functionality and</span>
0014 <span class="comment">% provides ready access to two- and three- dimensional plotting functions,</span>
0015 <span class="comment">% allowing rapid display and interrogation of velocity, backscatter, and</span>
0016 <span class="comment">% bathymetry data.</span>
0017 <span class="comment">%</span>
0018 <span class="comment">% CITATION:</span>
0019 <span class="comment">% Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.</span>
0020 <span class="comment">% L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,</span>
0021 <span class="comment">% J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and</span>
0022 <span class="comment">% visualization suite for moving-vessel ADCP measurements. Earth Surf.</span>
0023 <span class="comment">% Process. Landforms. doi: 10.1002/esp.3367</span>
0024 <span class="comment">%</span>
0025 <span class="comment">%__________________________________________________________________________</span>
0026 <span class="comment">% P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center</span>
0027 <span class="comment">% (pjackson@usgs.gov)</span>
0028 <span class="comment">%</span>
0029 <span class="comment">% Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.</span>
0030 <span class="comment">%__________________________________________________________________________</span>
0031 
0032 <span class="comment">% Begin initialization code - DO NOT EDIT</span>
0033 gui_Singleton = 1;
0034 gui_State = struct(<span class="string">'gui_Name'</span>,       mfilename, <span class="keyword">...</span>
0035     <span class="string">'gui_Singleton'</span>,  gui_Singleton, <span class="keyword">...</span>
0036     <span class="string">'gui_OpeningFcn'</span>, @<a href="#_sub1" class="code" title="subfunction VMT_OpeningFcn(hObject, eventdata, handles, varargin)">VMT_OpeningFcn</a>, <span class="keyword">...</span>
0037     <span class="string">'gui_OutputFcn'</span>,  @<a href="#_sub2" class="code" title="subfunction varargout = VMT_OutputFcn(hObject, eventdata, handles)">VMT_OutputFcn</a>, <span class="keyword">...</span>
0038     <span class="string">'gui_LayoutFcn'</span>,  [] , <span class="keyword">...</span>
0039     <span class="string">'gui_Callback'</span>,   []);
0040 <span class="keyword">if</span> nargin &amp;&amp; ischar(varargin{1})
0041     gui_State.gui_Callback = str2func(varargin{1});
0042 <span class="keyword">end</span>
0043 
0044 <span class="keyword">if</span> nargout
0045     [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
0046 <span class="keyword">else</span>
0047     gui_mainfcn(gui_State, varargin{:});
0048 <span class="keyword">end</span>
0049 <span class="comment">% End initialization code - DO NOT EDIT</span>
0050 
0051 <span class="comment">%#ok&lt;*DEFNU,*INUSL,*INUSD&gt;</span>
0052 
0053 <span class="comment">% --- Executes just before VMT is made visible.</span>
0054 <a name="_sub1" href="#_subfunctions" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a>
0055 <span class="comment">% This function has no output args, see OutputFcn.</span>
0056 <span class="comment">% hObject    handle to figure</span>
0057 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0058 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0059 <span class="comment">% varargin   command line arguments to VMT (see VARARGIN)</span>
0060 
0061 <span class="comment">% Choose default command line output for VMT</span>
0062 handles.output = hObject;
0063 
0064 <span class="comment">% Build the GUI toolbar:</span>
0065 <span class="comment">% ----------------------</span>
0066 handles = <a href="#_sub85" class="code" title="subfunction handles = buildToolbar(handles)">buildToolbar</a>(handles);
0067 
0068 <span class="comment">% Ensure path to utils &amp; docs is available</span>
0069 <span class="comment">% ----------------------------------------</span>
0070 <span class="keyword">if</span> ~isdeployed
0071     filesep = <span class="string">'\'</span>; <span class="comment">% windows</span>
0072     utilspath = [pwd filesep <span class="string">'utils'</span>];
0073     docspath  = [pwd filesep <span class="string">'doc'</span>];
0074     toolspath = [pwd filesep <span class="string">'tools'</span>];
0075     addpath(utilspath,docspath,toolspath)
0076 <span class="keyword">end</span>
0077 
0078 <span class="comment">% Update handles structure</span>
0079 <span class="comment">% ------------------------</span>
0080 guidata(hObject, handles);
0081 
0082 <span class="comment">% Load the GUI preferences:</span>
0083 <span class="comment">% -------------------------</span>
0084 <a href="#_sub86" class="code" title="subfunction load_prefs(hfigure)">load_prefs</a>(handles.figure1)
0085 
0086 <span class="comment">% Initialize the GUI parameters:</span>
0087 <span class="comment">% ------------------------------</span>
0088 guiparams = <a href="#_sub102" class="code" title="subfunction guiparams = createGUIparams">createGUIparams</a>;
0089 guiparams.vmt_version = <span class="string">'v4.0'</span>;
0090 
0091 <span class="comment">% Draw the VMT Background</span>
0092 <span class="comment">% -----------------</span>
0093 pos = get(handles.figure1,<span class="string">'position'</span>);
0094 axes(handles.VMTBackground);
0095 <span class="keyword">if</span> ~isdeployed <span class="comment">%isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0096     X = imread(<span class="string">'VMT_Background.png'</span>);
0097     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0098 <span class="keyword">else</span>
0099     X = imread(<span class="string">'VMT_Background.png'</span>);
0100     X = imresize(X, [pos(4) pos(3)]);
0101     X = uint8(X);
0102     imshow(X,<span class="string">'Border'</span>,<span class="string">'tight'</span>)
0103 <span class="keyword">end</span>
0104 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0105 
0106 <span class="comment">% Store the application data:</span>
0107 <span class="comment">% ---------------------------</span>
0108 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0109 
0110 <span class="comment">% Initialize the GUI:</span>
0111 <span class="comment">% -------------------</span>
0112 <a href="#_sub88" class="code" title="subfunction initGUI(handles)">initGUI</a>(handles)
0113 <a href="#_sub89" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'init'</span>)
0114 <span class="comment">% set(handles.GraphicsExportPanel,'Visible','off')</span>
0115 <span class="comment">% set(handles.ProcessingPanel,'Visible','off')</span>
0116 pos = get(handles.figure1,<span class="string">'Position'</span>);
0117 <span class="comment">% pos(3) = 545;</span>
0118 set(handles.figure1,<span class="string">'Position'</span>,pos)
0119 set(handles.figure1,<span class="string">'Resize'</span>,<span class="string">'on'</span>)
0120 
0121 <span class="comment">% UIWAIT makes VMT wait for user response (see UIRESUME)</span>
0122 <span class="comment">% uiwait(handles.figure1);</span>
0123 <span class="comment">% [EOF] VMT_OpeningFcn</span>
0124 
0125 
0126 <span class="comment">% --- Outputs from this function are returned to the command line.</span>
0127 <a name="_sub2" href="#_subfunctions" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a>
0128 <span class="comment">% varargout  cell array for returning output args (see VARARGOUT);</span>
0129 <span class="comment">% hObject    handle to figure</span>
0130 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0131 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0132 
0133 <span class="comment">% Get default command line output from handles structure</span>
0134 varargout{1} = handles.output;
0135 <span class="comment">% [EOF] VMT_OutputFcn</span>
0136 
0137 <span class="comment">% --- Executes when figure1 is resized.</span>
0138 <a name="_sub3" href="#_subfunctions" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a>
0139 
0140 <span class="comment">% Draw the VMT Background</span>
0141 <span class="comment">% -----------------</span>
0142 pos = get(handles.figure1,<span class="string">'position'</span>);
0143 axes(handles.VMTBackground);
0144 <span class="keyword">if</span> ~isdeployed <span class="comment">%isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0145     X = imread(<span class="string">'VMT_Background.png'</span>);
0146     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0147 <span class="keyword">else</span>
0148     X = imread(<span class="string">'VMT_Background.png'</span>);
0149     X = imresize(X, [pos(4) pos(3)]);
0150     X = uint8(X);
0151     imshow(X,<span class="string">'Border'</span>,<span class="string">'tight'</span>)
0152 <span class="keyword">end</span>
0153 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0154 
0155 <span class="comment">% --- Executes when user attempts to close figure1.</span>
0156 <a name="_sub4" href="#_subfunctions" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a>
0157 <span class="comment">% hObject    handle to figure1 (see GCBO)</span>
0158 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0159 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0160 
0161 <span class="comment">% Hint: delete(hObject) closes the figure</span>
0162 close_button = questdlg(<span class="keyword">...</span>
0163     <span class="string">'You are about to exit VMT. Any unsaved work will be lost. Are you sure?'</span>,<span class="keyword">...</span>
0164     <span class="string">'Exit VMT?'</span>,<span class="string">'No'</span>);
0165 <span class="keyword">switch</span> close_button
0166     <span class="keyword">case</span> <span class="string">'Yes'</span>
0167         delete(hObject)
0168         close all hidden
0169     <span class="keyword">otherwise</span>
0170         <span class="keyword">return</span>
0171 <span class="keyword">end</span>
0172 <span class="comment">% [EOF] figure1_CloseRequestFcn</span>
0173 
0174 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0175 <span class="comment">% MENU BAR CALLBACKS %</span>
0176 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0177 
0178 <span class="comment">% --------------------------------------------------------------------</span>
0179 <a name="_sub5" href="#_subfunctions" class="code">function menuFile_Callback(hObject, eventdata, handles)</a>
0180 <span class="comment">% Empty</span>
0181 
0182 <span class="comment">% --------------------------------------------------------------------</span>
0183 <a name="_sub6" href="#_subfunctions" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a>
0184 <span class="comment">% Empty</span>
0185 
0186 <span class="comment">% --------------------------------------------------------------------</span>
0187 <a name="_sub7" href="#_subfunctions" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a>
0188 <a href="#_sub44" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>(hObject, eventdata, handles)
0189 <span class="comment">% [EOF] menuOpenASCII_Callback</span>
0190 
0191 <span class="comment">% --------------------------------------------------------------------</span>
0192 <a name="_sub8" href="#_subfunctions" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a>
0193 
0194 <span class="comment">% Get the Application data:</span>
0195 <span class="comment">% -------------------------</span>
0196 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0197 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0198 
0199 <span class="comment">% Ask the user to select files:</span>
0200 <span class="comment">% -----------------------------</span>
0201 <span class="comment">% current_file = fullfile(guiparams.data_folder,guiparams.data_files{1});</span>
0202 <span class="comment">% current_file = fullfile(guiprefs.mat_path,guiprefs.mat_file);</span>
0203 <span class="keyword">if</span> iscell(guiprefs.mat_file)
0204     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file{1});
0205 <span class="keyword">else</span>
0206     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file);
0207 <span class="keyword">end</span>
0208 [filename,pathname] = <span class="keyword">...</span>
0209     uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-files (*.mat)'</span>}, <span class="keyword">...</span>
0210     <span class="string">'Select MAT File'</span>, <span class="keyword">...</span>
0211     uifile, <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
0212 
0213 <span class="keyword">if</span> ischar(filename) <span class="comment">% Single MAT file loaded</span>
0214     <span class="comment">% Load the data:</span>
0215     <span class="comment">% --------------</span>
0216     vars = load(fullfile(pathname,filename));
0217     
0218     <span class="comment">% Make sure the selected file is a valid file:</span>
0219     <span class="comment">% --------------------------------------------</span>
0220     varnames = fieldnames(vars);
0221     <span class="keyword">if</span> isequal(sort(varnames),{<span class="string">'A'</span> <span class="string">'Map'</span> <span class="string">'V'</span> <span class="string">'z'</span>}')
0222         guiparams.mat_path = pathname;
0223         guiparams.mat_file = filename;
0224         guiparams.z = vars.z;
0225         guiparams.A = vars.A;
0226         guiparams.V = vars.V;
0227         
0228         <span class="comment">% Update the preferences:</span>
0229         <span class="comment">% -----------------------</span>
0230         guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0231         guiprefs.mat_path = pathname;
0232         guiprefs.mat_file = filename;
0233         setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0234         <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0235                      
0236         <span class="comment">% Re-store the Application Data:</span>
0237         <span class="comment">% ------------------------------</span>
0238         setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0239         
0240         <span class="comment">% Update the GUI:</span>
0241         <span class="comment">% ---------------</span>
0242         <a href="#_sub89" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
0243     <span class="keyword">else</span> <span class="comment">% Not a valid file</span>
0244         errordlg(<span class="string">'The selected file is not a valid ADCP data MAT file.'</span>, <span class="keyword">...</span>
0245             <span class="string">'Invalid File...'</span>)
0246     <span class="keyword">end</span>
0247     
0248 <span class="keyword">elseif</span> iscell(filename) <span class="comment">% Multiple MAT files loaded</span>
0249     <span class="comment">% Set the filenames</span>
0250     <span class="comment">% -----------------</span>
0251     guiparams.mat_path = pathname;
0252     guiparams.mat_file = filename;
0253     
0254     <span class="comment">% Push status to log window</span>
0255     <span class="comment">% -------------------------</span>
0256     log_text = {<span class="keyword">...</span>
0257         <span class="string">'Loading previously processed MAT files.'</span>;<span class="keyword">...</span>
0258         <span class="string">'Directory:'</span>};
0259     log_text = vertcat(log_text, pathname, {<span class="string">'Files:'</span>}, filename');
0260     statusLogging(handles.LogWindow,log_text)
0261     
0262     <span class="comment">% Update the Application Data:</span>
0263     <span class="comment">% ------------------------------</span>
0264     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0265     
0266     <span class="comment">% Update the persistent preferences:</span>
0267     <span class="comment">% ----------------------------------</span>
0268     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0269     guiprefs.mat_path = pathname;
0270     guiprefs.mat_file = filename;
0271     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0272     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0273         
0274     <span class="comment">% Update the GUI:</span>
0275     <span class="comment">% ---------------</span>
0276     <a href="#_sub89" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'multiplematfiles'</span>)
0277 <span class="keyword">end</span>
0278 
0279 <span class="comment">% [EOF] menuOpenMAT_Callback</span>
0280 
0281 <span class="comment">% --------------------------------------------------------------------</span>
0282 <a name="_sub9" href="#_subfunctions" class="code">function menuSave_Callback(hObject, eventdata, handles)</a>
0283 <span class="comment">% Empty</span>
0284 
0285 <span class="comment">% --------------------------------------------------------------------</span>
0286 <a name="_sub10" href="#_subfunctions" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a>
0287 <a href="#_sub45" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>(hObject, eventdata, handles)
0288 <span class="comment">% [EOF] menuSaveMAT_Callback</span>
0289 
0290 <span class="comment">% --------------------------------------------------------------------</span>
0291 <a name="_sub11" href="#_subfunctions" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a>
0292 <a href="#_sub53" class="code" title="subfunction SaveTecplotFile_Callback(hObject, eventdata, handles)">SaveTecplotFile_Callback</a>(handles,eventdata,handles)
0293 <span class="comment">% [EOF] menuSaveTecplot_Callback</span>
0294 
0295 <span class="comment">% --------------------------------------------------------------------</span>
0296 <a name="_sub12" href="#_subfunctions" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a>
0297 <a href="#_sub54" class="code" title="subfunction SaveGoogleEarthFile_Callback(hObject, eventdata, handles)">SaveGoogleEarthFile_Callback</a>(handles,eventdata,handles)
0298 <span class="comment">% [EOF] menuSaveKMZFile_Callback</span>
0299 
0300 <span class="comment">% --------------------------------------------------------------------</span>
0301 <a name="_sub13" href="#_subfunctions" class="code">function menuExport_Callback(hObject, eventdata, handles)</a>
0302 <span class="comment">% Empty</span>
0303 
0304 <span class="comment">% --------------------------------------------------------------------</span>
0305 <a name="_sub14" href="#_subfunctions" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a>
0306 <span class="comment">% Empty</span>
0307 
0308 <span class="comment">% --------------------------------------------------------------------</span>
0309 <a name="_sub15" href="#_subfunctions" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a>
0310 
0311 <span class="comment">% Get the Application Data:</span>
0312 <span class="comment">% -------------------------</span>
0313 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0314 
0315 <span class="comment">% Update the Application Data:</span>
0316 <span class="comment">% ----------------------------</span>
0317 guiparams.print        = true;
0318 guiparams.presentation = false;
0319 
0320 <span class="comment">% Re-store the Application data:</span>
0321 <span class="comment">% ------------------------------</span>
0322 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0323 
0324 <span class="comment">% Update the GUI:</span>
0325 <span class="comment">% ---------------</span>
0326 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0327 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
0328 
0329 <span class="comment">% [EOF] menuPrintFormat_Callback</span>
0330 
0331 
0332 <span class="comment">% --------------------------------------------------------------------</span>
0333 <a name="_sub16" href="#_subfunctions" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a>
0334 
0335 <span class="comment">% Get the Application Data:</span>
0336 <span class="comment">% -------------------------</span>
0337 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0338 
0339 <span class="comment">% Update the Application Data:</span>
0340 <span class="comment">% ----------------------------</span>
0341 guiparams.print        = false;
0342 guiparams.presentation = true;
0343 
0344 <span class="comment">% Re-store the Application data:</span>
0345 <span class="comment">% ------------------------------</span>
0346 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0347 
0348 <span class="comment">% Update the GUI:</span>
0349 <span class="comment">% ---------------</span>
0350 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0351 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
0352 
0353 <span class="comment">% [EOF] menuPresentationFormat_Callback</span>
0354 
0355 <span class="comment">% --------------------------------------------------------------------</span>
0356 <a name="_sub17" href="#_subfunctions" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a>
0357 <span class="comment">% Get the Application data:</span>
0358 <span class="comment">% -------------------------</span>
0359 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0360 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0361 
0362 <span class="comment">% Find what plots exist already</span>
0363 fig_handles = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0364 fig_names   = get(fig_handles,<span class="string">'name'</span>);
0365 
0366 <span class="comment">% Remove the VMT GUI as a valid figure in the list</span>
0367 [~, idx] = ismember(get(handles.figure1,<span class="string">'Name'</span>), fig_names);
0368 <span class="keyword">if</span> ~isempty(idx)
0369     fig_names(idx) = [];
0370 <span class="keyword">end</span>
0371 
0372 <span class="keyword">if</span> guiparams.presentation
0373     figure_style = <span class="string">'presentation'</span>;
0374 <span class="keyword">else</span>
0375     figure_style = <span class="string">'print'</span>;
0376 <span class="keyword">end</span>
0377 
0378 [selected_figures] = <a href="#_sub99" class="code" title="subfunction [selected_figures] = openFiguresDialog(figure_names,hf)">openFiguresDialog</a>(fig_names,handles.figure1);
0379 
0380 <span class="keyword">if</span> isempty(selected_figures) <span class="comment">% User pressed cancel</span>
0381     <span class="keyword">return</span>
0382 <span class="keyword">else</span>
0383     <span class="keyword">for</span> i = 1:length(selected_figures)
0384         <a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>(guiprefs.mat_path,selected_figures(i),figure_style)
0385     <span class="keyword">end</span>
0386 <span class="keyword">end</span>
0387 
0388 
0389 <span class="comment">% [EOF] menuExportFigures_Callback</span>
0390 
0391 <span class="comment">% --------------------------------------------------------------------</span>
0392 <a name="_sub18" href="#_subfunctions" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a>
0393 <span class="comment">% Get the Application data:</span>
0394 <span class="comment">% -------------------------</span>
0395 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0396 beam_angle = guiparams.beam_angle; 
0397 magnetic_variation = guiparams.magnetic_variation; 
0398 wse = guiparams.wse;
0399 output_auxilliary_data = guiparams.output_auxiliary_data; 
0400 
0401 <span class="comment">% Open dialog and allow user to select settings</span>
0402 <span class="comment">% ---------------------------------------------</span>
0403 [guiparams.beam_angle,<span class="keyword">...</span>
0404     guiparams.magnetic_variation,<span class="keyword">...</span>
0405     guiparams.wse,<span class="keyword">...</span>
0406     guiparams.output_auxilliary_data] = <span class="keyword">...</span>
0407     <a href="#_sub97" class="code" title="subfunction [beam_angle,magnetic_variation,wse,output_auxilliary_data] = exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxilliary_data,hf)">exportSettingsDialog</a>(beam_angle,magnetic_variation,wse,output_auxilliary_data,handles.figure1);
0408 
0409 <span class="comment">% Re-store the Application data:</span>
0410 <span class="comment">% ------------------------------</span>
0411 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0412 
0413 <span class="comment">% [EOF] menuExportSettings_Callback</span>
0414 
0415 <span class="comment">% --------------------------------------------------------------------</span>
0416 <a name="_sub19" href="#_subfunctions" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
0417 <a href="#_sub55" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>(hObject, eventdata, handles);
0418 <span class="comment">% [EOF] menuExportMultibeamBathymetry_Callback</span>
0419 
0420 
0421 <span class="comment">% --------------------------------------------------------------------</span>
0422 <a name="_sub20" href="#_subfunctions" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a>
0423 
0424 <span class="comment">% Get the Application Data:</span>
0425 <span class="comment">% -------------------------</span>
0426 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0427 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0428 PVdata    = guiparams.iric_anv_planview_data;
0429 iric_path = guiprefs.iric_path;
0430 iric_file = guiprefs.iric_file;
0431 
0432 <span class="comment">% Is there any planview data?</span>
0433 <span class="keyword">if</span> isempty(PVdata)
0434     <span class="comment">% Nothing to do, warn user</span>
0435     log_text = {<span class="string">'No planview plot data to export. User must Plot Plan View first.'</span>};
0436     warndlg(log_text{:},<span class="string">'Nothing to export'</span>)
0437 <span class="keyword">else</span>
0438     <span class="comment">% Save the planview data as output and to an *.anv file with spacing</span>
0439     <span class="comment">% and smoothing (for iRiC)</span>
0440     log_text = {<span class="string">'Exporting iRic formated ANV vector file...'</span>};
0441     [iric_file,iric_path] = uiputfile(<span class="string">'*.anv'</span>,<span class="string">'Save *.anv file'</span>,<span class="keyword">...</span>
0442         fullfile(iric_path,iric_file));
0443     
0444     <span class="keyword">if</span> ischar(iric_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0445         outfile = fullfile(iric_path,iric_file);
0446         log_text = vertcat(log_text,{outfile});
0447         ofid   = fopen(outfile, <span class="string">'wt'</span>);
0448         outcount = fprintf(ofid,<span class="keyword">...</span>
0449             <span class="string">'%8.2f  %8.2f  %5.2f  %3.3f  %3.3f\n'</span>,PVdata.outmat);
0450         fclose(ofid);
0451     <span class="keyword">else</span>
0452         <span class="comment">% Return default iric_path and iric_file</span>
0453         iric_path = guiprefs.iric_path;
0454         iric_file = guiprefs.iric_file;
0455     <span class="keyword">end</span>
0456 <span class="keyword">end</span>
0457 
0458 <span class="comment">% Push messages to Log Window:</span>
0459 <span class="comment">% ----------------------------</span>
0460 statusLogging(handles.LogWindow, log_text)
0461 
0462 <span class="comment">% Store the persistent preferences:</span>
0463 <span class="comment">% ---------------------------------</span>
0464 guiprefs.iric_file = iric_file;
0465 guiprefs.iric_path = iric_path;
0466 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0467 <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'iric'</span>)
0468 
0469 <span class="comment">% [EOF] menuSaveANVFile_Callback</span>
0470 
0471 <span class="comment">% --------------------------------------------------------------------</span>
0472 <a name="_sub21" href="#_subfunctions" class="code">function menuParameters_Callback(hObject, eventdata, handles)</a>
0473 <span class="comment">% Empty</span>
0474 
0475 <span class="comment">% --------------------------------------------------------------------</span>
0476 <a name="_sub22" href="#_subfunctions" class="code">function menuProcessingParameters_Callback(hObject, eventdata, handles)</a>
0477 <span class="comment">% Empty</span>
0478 
0479 <span class="comment">% --------------------------------------------------------------------</span>
0480 <a name="_sub23" href="#_subfunctions" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a>
0481 <span class="comment">% Turn ON or OFF Unit Discharge Correction</span>
0482 
0483 <span class="comment">% Get the Application Data:</span>
0484 <span class="comment">% -------------------------</span>
0485 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0486 
0487 <span class="comment">% Update the GUI &amp; Application Data:</span>
0488 <span class="comment">% ----------------------------------</span>
0489 status = get(handles.menuUnitDischargeCorrection,<span class="string">'Checked'</span>);
0490 <span class="keyword">switch</span> status
0491     <span class="keyword">case</span> <span class="string">'on'</span> <span class="comment">% Turn it off</span>
0492         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0493         guiparams.unit_discharge_correction = false;
0494     <span class="keyword">case</span> <span class="string">'off'</span> <span class="comment">% Turn it on</span>
0495         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0496         guiparams.unit_discharge_correction = true;
0497 <span class="keyword">end</span>
0498 
0499 <span class="comment">% Re-store the Application data:</span>
0500 <span class="comment">% ------------------------------</span>
0501 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0502 
0503 
0504 <span class="comment">%  [EOF] menuUnitDischargeCorrection_Callback</span>
0505 
0506 <span class="comment">% --------------------------------------------------------------------</span>
0507 <a name="_sub24" href="#_subfunctions" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a>
0508 <span class="comment">% Empty</span>
0509 
0510 <span class="comment">% --------------------------------------------------------------------</span>
0511 <a name="_sub25" href="#_subfunctions" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a>
0512 <span class="comment">% Empty</span>
0513 
0514 <span class="comment">% --------------------------------------------------------------------</span>
0515 <a name="_sub26" href="#_subfunctions" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a>
0516 <span class="comment">% Set the Plotting Parameter Units to &quot;metric&quot;</span>
0517 
0518 <span class="comment">% Get the Application Data:</span>
0519 <span class="comment">% -------------------------</span>
0520 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0521 
0522 <span class="comment">% Update the Application Data:</span>
0523 <span class="comment">% ----------------------------</span>
0524 guiparams.english_units = false;
0525 
0526 <span class="comment">% Re-store the Application data:</span>
0527 <span class="comment">% ------------------------------</span>
0528 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0529 
0530 <span class="comment">% Update the GUI:</span>
0531 <span class="comment">% ---------------</span>
0532 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0533 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
0534 
0535 <span class="comment">% [EOF] menuMetric_Callback</span>
0536 
0537 
0538 <span class="comment">% --------------------------------------------------------------------</span>
0539 <a name="_sub27" href="#_subfunctions" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a>
0540 <span class="comment">% Set the Plotting Parameter Units to &quot;english&quot;</span>
0541 
0542 <span class="comment">% Get the Application Data:</span>
0543 <span class="comment">% -------------------------</span>
0544 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0545 
0546 <span class="comment">% Update the Application Data:</span>
0547 <span class="comment">% ----------------------------</span>
0548 guiparams.english_units = true;
0549 
0550 <span class="comment">% Re-store the Application data:</span>
0551 <span class="comment">% ------------------------------</span>
0552 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0553 
0554 <span class="comment">% Update the GUI:</span>
0555 <span class="comment">% ---------------</span>
0556 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0557 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
0558 
0559 <span class="comment">% [EOF] menuEnglish_Callback</span>
0560 
0561 
0562 <span class="comment">% --------------------------------------------------------------------</span>
0563 <a name="_sub28" href="#_subfunctions" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
0564 <span class="comment">% Empty</span>
0565 
0566 <span class="comment">% --------------------------------------------------------------------</span>
0567 <a name="_sub29" href="#_subfunctions" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a>
0568 <span class="comment">% Set cross-section endpoints automatically</span>
0569 
0570 <span class="comment">% Get the Application Data:</span>
0571 <span class="comment">% -------------------------</span>
0572 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0573 
0574 <span class="comment">% Update the Application Data:</span>
0575 <span class="comment">% ----------------------------</span>
0576 guiparams.set_cross_section_endpoints = false;
0577 
0578 <span class="comment">% Re-store the Application data:</span>
0579 <span class="comment">% ------------------------------</span>
0580 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0581 
0582 <span class="comment">% Update the GUI:</span>
0583 <span class="comment">% ---------------</span>
0584 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0585 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0586 
0587 <span class="comment">% [EOF] menuCrossSectionEndpointAutomatic_Callback</span>
0588 
0589 
0590 <span class="comment">% --------------------------------------------------------------------</span>
0591 <a name="_sub30" href="#_subfunctions" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a>
0592 <span class="comment">% Set cross-section endpoints manually</span>
0593 
0594 <span class="comment">% Get the Application Data:</span>
0595 <span class="comment">% -------------------------</span>
0596 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0597 
0598 <span class="comment">% Update the Application Data:</span>
0599 <span class="comment">% ----------------------------</span>
0600 guiparams.set_cross_section_endpoints = true;
0601 
0602 <span class="comment">% Re-store the Application data:</span>
0603 <span class="comment">% ------------------------------</span>
0604 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0605 
0606 <span class="comment">% Update the GUI:</span>
0607 <span class="comment">% ---------------</span>
0608 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0609 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0610 
0611 <span class="comment">% [EOF] menuCrossSectionEndpointManual_Callback</span>
0612 
0613 
0614 
0615 
0616 <span class="comment">% --------------------------------------------------------------------</span>
0617 <a name="_sub31" href="#_subfunctions" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a>
0618 <span class="comment">% Empty</span>
0619 
0620 <span class="comment">% --------------------------------------------------------------------</span>
0621 <a name="_sub32" href="#_subfunctions" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a>
0622 
0623 <span class="comment">% Get the Application Data:</span>
0624 <span class="comment">% -------------------------</span>
0625 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0626 
0627 <span class="comment">% Update the Application Data:</span>
0628 <span class="comment">% ----------------------------</span>
0629 guiparams.print        = true;
0630 guiparams.presentation = false;
0631 
0632 <span class="comment">% Re-store the Application data:</span>
0633 <span class="comment">% ------------------------------</span>
0634 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0635 
0636 <span class="comment">% Update the GUI:</span>
0637 <span class="comment">% ---------------</span>
0638 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0639 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0640 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0641 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
0642 
0643 <span class="comment">% Modify the existing figures</span>
0644 <span class="comment">% ---------------------------</span>
0645 <span class="comment">% Find what plots exist already</span>
0646 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0647 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0648 
0649 <span class="comment">% Defaults for Print Stlye Figure</span>
0650 BkgdColor   = <span class="string">'white'</span>;
0651 AxColor     = <span class="string">'black'</span>;
0652 FigColor    = <span class="string">'white'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
0653 FntSize     = 14;
0654 
0655 <span class="comment">% Loop through valid figures and adjust</span>
0656 <span class="comment">% -------------------------------------</span>
0657 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0658     
0659     <span class="keyword">for</span> i = 1:length(valid_names)
0660         <span class="keyword">switch</span> valid_names{i}
0661             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
0662                 <span class="comment">% Focus the figure</span>
0663                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0664                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0665                     figure(hff)
0666                     
0667                     <span class="comment">% Make the changes to figure</span>
0668                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
0669                     set(gca,<span class="string">'FontSize'</span>,FntSize)
0670                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
0671                     set(gca,<span class="string">'Color'</span>,FigColor)
0672                     set(gca,<span class="string">'XColor'</span>,AxColor)
0673                     set(gca,<span class="string">'YColor'</span>,AxColor)
0674                     set(gca,<span class="string">'ZColor'</span>,AxColor)
0675                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
0676                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0677                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0678                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0679                 <span class="keyword">end</span>
0680             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
0681                 <span class="comment">% Focus the figure</span>
0682                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0683                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0684                     figure(hff)
0685                     
0686                     <span class="comment">% Make the changes to figure</span>
0687                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
0688                     set(gca,<span class="string">'FontSize'</span>,FntSize)
0689                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
0690                     set(gca,<span class="string">'Color'</span>,FigColor)
0691                     set(gca,<span class="string">'XColor'</span>,AxColor)
0692                     set(gca,<span class="string">'YColor'</span>,AxColor)
0693                     set(gca,<span class="string">'ZColor'</span>,AxColor)
0694                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
0695                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0696                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0697                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0698                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
0699                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
0700                 <span class="keyword">end</span>
0701             <span class="keyword">otherwise</span>
0702         <span class="keyword">end</span>
0703     <span class="keyword">end</span>
0704     
0705     
0706 <span class="keyword">end</span>
0707 
0708 
0709 <span class="comment">%[EOF] menuStylePrint_Callback</span>
0710 
0711 
0712 <span class="comment">% --------------------------------------------------------------------</span>
0713 <a name="_sub33" href="#_subfunctions" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a>
0714 <span class="comment">% Get the Application Data:</span>
0715 <span class="comment">% -------------------------</span>
0716 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0717 
0718 <span class="comment">% Update the Application Data:</span>
0719 <span class="comment">% ----------------------------</span>
0720 guiparams.print        = false;
0721 guiparams.presentation = true;
0722 
0723 <span class="comment">% Re-store the Application data:</span>
0724 <span class="comment">% ------------------------------</span>
0725 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0726 
0727 <span class="comment">% Update the GUI:</span>
0728 <span class="comment">% ---------------</span>
0729 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0730 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0731 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0732 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
0733 
0734 <span class="comment">% Modify the existing figures</span>
0735 <span class="comment">% ---------------------------</span>
0736 <span class="comment">% Find what plots exist already</span>
0737 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0738 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0739 
0740 <span class="comment">% Defaults for Presentation Stlye Figure</span>
0741 <span class="comment">% --------------------------------------</span>
0742 BkgdColor   = <span class="string">'black'</span>;
0743 AxColor     = <span class="string">'white'</span>;
0744 FigColor    = <span class="string">'black'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
0745 FntSize     = 14;
0746 
0747 <span class="comment">% Loop through valid figures and adjust</span>
0748 <span class="comment">% -------------------------------------</span>
0749 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0750     
0751     <span class="keyword">for</span> i = 1:length(valid_names)
0752         <span class="keyword">switch</span> valid_names{i}
0753             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
0754                 <span class="comment">% Focus the figure</span>
0755                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0756                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0757                     figure(hff)
0758                     
0759                     <span class="comment">% Make the changes to figure</span>
0760                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
0761                     set(gca,<span class="string">'FontSize'</span>,FntSize)
0762                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
0763                     set(gca,<span class="string">'Color'</span>,FigColor)
0764                     set(gca,<span class="string">'XColor'</span>,AxColor)
0765                     set(gca,<span class="string">'YColor'</span>,AxColor)
0766                     set(gca,<span class="string">'ZColor'</span>,AxColor)
0767                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
0768                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0769                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0770                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0771                 <span class="keyword">end</span>
0772             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
0773                 <span class="comment">% Focus the figure</span>
0774                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0775                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0776                     figure(hff)
0777                     
0778                     <span class="comment">% Make the changes to figure</span>
0779                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
0780                     set(gca,<span class="string">'FontSize'</span>,FntSize)
0781                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
0782                     set(gca,<span class="string">'Color'</span>,[0.3 0.3 0.3]) <span class="comment">%FigColor)</span>
0783                     set(gca,<span class="string">'XColor'</span>,AxColor)
0784                     set(gca,<span class="string">'YColor'</span>,AxColor)
0785                     set(gca,<span class="string">'ZColor'</span>,AxColor)
0786                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
0787                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0788                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0789                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0790                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
0791                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
0792                 <span class="keyword">end</span>
0793             <span class="keyword">otherwise</span>
0794         <span class="keyword">end</span>
0795     <span class="keyword">end</span>
0796     
0797     
0798 <span class="keyword">end</span>
0799 
0800 <span class="comment">% [EOF] menuStylePresentation_Callback</span>
0801 
0802 <span class="comment">% --------------------------------------------------------------------</span>
0803 <a name="_sub34" href="#_subfunctions" class="code">function menuKMZExport_Callback(hObject, eventdata, handles)</a>
0804 
0805 <span class="comment">% Get the Application data:</span>
0806 <span class="comment">% -------------------------</span>
0807 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0808 
0809 <span class="comment">% Initialize the answer:</span>
0810 <span class="comment">% ----------------------</span>
0811 numstr = {num2str(guiparams.vertical_offset)};
0812 answer = NaN;
0813 <span class="keyword">while</span> isnan(answer)
0814     answer = inputdlg(<span class="string">'Vertical Offset (m)'</span>,<span class="string">'KMZ Export'</span>,1,numstr);
0815     
0816     <span class="keyword">if</span> isempty(answer) <span class="comment">% User hits &quot;Cancel&quot;</span>
0817         <span class="keyword">return</span>
0818     <span class="keyword">end</span>
0819     
0820     answer = str2double(answer); <span class="comment">% A non-numeric char will be NaN</span>
0821     <span class="comment">% A numeric char will be a double</span>
0822 <span class="keyword">end</span>
0823 
0824 <span class="comment">% Re-store the Application data:</span>
0825 <span class="comment">% ------------------------------</span>
0826 guiparams.vertical_offset = answer;
0827 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0828 
0829 <span class="comment">% [EOF] menuKMZExport_Callback</span>
0830 
0831 <span class="comment">% --------------------------------------------------------------------</span>
0832 <a name="_sub35" href="#_subfunctions" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a>
0833 <span class="comment">% Not implemented</span>
0834 
0835 <span class="comment">% --------------------------------------------------------------------</span>
0836 <a name="_sub36" href="#_subfunctions" class="code">function menuTools_Callback(hObject, eventdata, handles)</a>
0837 <span class="comment">% Empty</span>
0838 
0839 <span class="comment">% --------------------------------------------------------------------</span>
0840 <a name="_sub37" href="#_subfunctions" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a>
0841 ASCII2GIS_GUI
0842 <span class="comment">% [EOF] menuASCII2GIS_Callback</span>
0843 
0844 <span class="comment">% --------------------------------------------------------------------</span>
0845 <a name="_sub38" href="#_subfunctions" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a>
0846 
0847 <span class="comment">% Get the Application preferences:</span>
0848 <span class="comment">% --------------------------------</span>
0849 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0850 
0851 inpath = guiprefs.kmz_path;
0852 <span class="keyword">if</span> iscell(guiprefs.kmz_file)
0853     infile = guiprefs.kmz_file{1};
0854 <span class="keyword">else</span>
0855     infile = guiprefs.kmz_file;
0856 <span class="keyword">end</span>
0857 [log_text,outpath,outfile] = ASCII2KML(inpath,infile);
0858 
0859 guiprefs.kmz_path = outpath;
0860 guiprefs.kmz_file = outfile;
0861 
0862 <span class="comment">% Update persistent preferences</span>
0863 <span class="comment">% -----------------------------</span>
0864 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0865 
0866 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
0867 
0868 <span class="comment">% --------------------------------------------------------------------</span>
0869 <a name="_sub39" href="#_subfunctions" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a>
0870 <span class="comment">% Empty</span>
0871 
0872 <span class="comment">% --------------------------------------------------------------------</span>
0873 <a name="_sub40" href="#_subfunctions" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a>
0874 <span class="keyword">try</span>
0875     web(<span class="string">'http://code.google.com/p/velocity-mapping-tool/wiki/UserGuide?tm=6'</span>)
0876 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
0877     h = errordlg(<span class="string">'No internet connectivity. Try again later.'</span>,<span class="keyword">...</span>
0878         <span class="string">'Online User Guide unavailable'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
0879 <span class="keyword">end</span>
0880 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
0881 
0882 <span class="comment">% --------------------------------------------------------------------</span>
0883 <a name="_sub41" href="#_subfunctions" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a>
0884 <span class="comment">% Get the Application data:</span>
0885 <span class="comment">% -------------------------</span>
0886 <span class="comment">% guiparams = getappdata(handles.figure1,'guiparams'); %#ok&lt;NASGU&gt;</span>
0887 
0888 <span class="keyword">try</span>
0889     <span class="comment">% Construct a URL to a local file which can be interpreted by any</span>
0890     <span class="comment">% web-browser</span>
0891     rootpath = strrep(pwd,filesep,<span class="string">'/'</span>);
0892     webaddress = [<span class="string">'file:///'</span> rootpath <span class="string">'/doc/index.html'</span>];
0893     system([<span class="string">'start '</span> webaddress]);
0894 <span class="comment">%     [stat,h,url] = web(webaddress) % Produced with m2html (FEX)</span>
0895 <span class="keyword">catch</span> err 
0896     error(<span class="string">'VMT:guiInterface'</span>,<span class="keyword">...</span>
0897         horzcat(<span class="string">'Unable to open function library. \n'</span>,<span class="keyword">...</span>
0898         <span class="string">'Attempted to find function library at the URL:\n'</span>,<span class="keyword">...</span>
0899         <span class="string">'   %s'</span>), webaddress)
0900     <span class="keyword">return</span>
0901 <span class="keyword">end</span>
0902 
0903 <span class="comment">% [EOF] menuFunctionLibrary_Callback</span>
0904 
0905 <span class="comment">% --------------------------------------------------------------------</span>
0906 <a name="_sub42" href="#_subfunctions" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a>
0907 
0908 <span class="comment">% Get the Application data:</span>
0909 <span class="comment">% -------------------------</span>
0910 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0911 
0912 <span class="comment">% Check version tag against the web, and display a message</span>
0913 <span class="keyword">try</span>
0914     current_vmt_version = urlread(<span class="string">'http://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt'</span>);
0915     <span class="comment">%     current_vmt_version = urlread('http://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt');</span>
0916 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
0917     h = msgbox(<span class="string">'No internet connection. Try again later.'</span>,<span class="string">'Check for updates'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
0918     <span class="keyword">return</span>
0919 <span class="keyword">end</span>
0920 
0921 <span class="keyword">if</span> strcmpi(guiparams.vmt_version,current_vmt_version)
0922     h = msgbox(<span class="string">'VMT is currently up to date, no updates available.'</span>,<span class="string">'Check for updates'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
0923 <span class="keyword">else</span>
0924     h = msgbox(<span class="string">'VMT is out of date. Please visit the VMT homepage.'</span>,<span class="string">'Check for updates'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
0925 <span class="keyword">end</span>
0926 <span class="comment">% [EOF] menuCheckForUpdates_Callback</span>
0927 
0928 <span class="comment">% --------------------------------------------------------------------</span>
0929 <a name="_sub43" href="#_subfunctions" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a>
0930 
0931 <span class="comment">% Get the Application data:</span>
0932 <span class="comment">% -------------------------</span>
0933 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0934 messagestr = <span class="keyword">...</span>
0935     {<span class="string">'The Velocity Mapping Toolbox'</span>;<span class="keyword">...</span>
0936     [<span class="string">'   Version: '</span> guiparams.vmt_version];<span class="keyword">...</span>
0937     <span class="string">''</span>;<span class="keyword">...</span>
0938     <span class="string">''</span>;<span class="keyword">...</span>
0939     <span class="string">'With collaborations from:'</span>;<span class="keyword">...</span>
0940     <span class="string">'   U.S. Geological Survey'</span>;<span class="keyword">...</span>
0941     <span class="string">'   University of Illinois'</span>;<span class="keyword">...</span>
0942     <span class="string">'   University of Hull'</span>;<span class="keyword">...</span>
0943     <span class="string">''</span>;<span class="keyword">...</span>
0944     <span class="string">''</span>;<span class="keyword">...</span>
0945     <span class="string">'Citation: '</span>;<span class="keyword">...</span>
0946     <span class="string">'   Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L.,'</span>;<span class="keyword">...</span>
0947     <span class="string">'   Rhoads, B. L., Oberg, K. A., Best, J. L., Mueller, D. S.,'</span>;<span class="keyword">...</span>
0948     <span class="string">'   Johnson, K. K. and Riley, J. D. (2013), Velocity Mapping'</span>;<span class="keyword">...</span>
0949     <span class="string">'   Toolbox (VMT): a processing and visualization suite for'</span>;<span class="keyword">...</span>
0950     <span class="string">'   moving-vessel ADCP measurements. Earth Surf. Process.'</span>;<span class="keyword">...</span>
0951     <span class="string">'   Landforms.doi: 10.1002/esp.3367'</span>};
0952 h = msgbox(messagestr,<span class="string">'About VMT'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
0953 <span class="comment">% [EOF] menuAbout_Callback</span>
0954 
0955 
0956 
0957 
0958 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
0959 <span class="comment">% TOOLBAR CALLBACKS %</span>
0960 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
0961 
0962 <span class="comment">% --------------------------------------------------------------------</span>
0963 <a name="_sub44" href="#_subfunctions" class="code">function loadDataCallback(hObject, eventdata, handles)</a>
0964 <span class="comment">% Read Files into Data Structure using tfile.</span>
0965 
0966 <span class="comment">% Get the Application data:</span>
0967 <span class="comment">% -------------------------</span>
0968 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0969 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0970 
0971 <span class="comment">% Ask the user to select files:</span>
0972 <span class="comment">% -----------------------------</span>
0973 current_file = fullfile(guiprefs.ascii_path,guiprefs.ascii_file{1});
0974 [filename,pathname] = uigetfile({<span class="string">'*_ASC.TXT'</span>,<span class="string">'ASCII (*_ASC.TXT)'</span>}, <span class="keyword">...</span>
0975     <span class="string">'Select the ASCII Output Files'</span>, <span class="keyword">...</span>
0976     current_file, <span class="keyword">...</span>
0977     <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
0978 
0979 <span class="keyword">if</span> ischar(pathname) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0980     guiparams.data_folder = pathname;
0981     <span class="keyword">if</span> ischar(filename)
0982         filename = {filename};
0983     <span class="keyword">end</span>
0984     guiparams.data_files = filename;
0985     guiparams.mat_file = <span class="string">''</span>;
0986     
0987     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0988     
0989    
0990     
0991     <span class="comment">% Update the preferences:</span>
0992     <span class="comment">% -----------------------</span>
0993     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0994     guiprefs.ascii_path = pathname;
0995     guiprefs.ascii_file = filename;
0996     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0997     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'ascii'</span>)
0998     
0999     <span class="comment">% Push messages to Log Window:</span>
1000     <span class="comment">% ----------------------------</span>
1001     log_text = {<span class="keyword">...</span>
1002         <span class="string">''</span>;<span class="keyword">...</span>
1003         [<span class="string">'%--- '</span> datestr(now) <span class="string">' ---%'</span>];<span class="keyword">...</span>
1004         <span class="string">'Current Project Directory:'</span>;<span class="keyword">...</span>
1005         guiparams.data_folder;
1006         <span class="string">'Loading the following files into memory:'</span>;<span class="keyword">...</span>
1007         char(filename)};
1008     statusLogging(handles.LogWindow, log_text)
1009     
1010     <span class="comment">% Read the file(s)</span>
1011     <span class="comment">% ----------------</span>
1012     [~,~,savefile,A,z] = <span class="keyword">...</span>
1013         <a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>(guiparams.data_folder,guiparams.data_files);
1014     guiparams.savefile = savefile;
1015     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1016     
1017     <span class="comment">% Preprocess the data:</span>
1018     <span class="comment">% --------------------</span>
1019     A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
1020     
1021     <span class="comment">% Push messages to Log Window:</span>
1022     <span class="comment">% ----------------------------</span>
1023     log_text = {<span class="keyword">...</span>
1024         <span class="string">'   Preprocessing complete.'</span>;<span class="keyword">...</span>
1025         <span class="string">'   Begin Data Processing...'</span>};
1026     statusLogging(handles.LogWindow, log_text)
1027     
1028     A(1).hgns = guiparams.horizontal_grid_node_spacing;
1029     A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
1030     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
1031         guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
1032         guiparams.unit_discharge_correction);
1033     
1034     <span class="comment">% Push messages to Log Window:</span>
1035     <span class="comment">% ----------------------------</span>
1036     statusLogging(handles.LogWindow, processing_log_text)
1037     
1038     <span class="comment">% Store the data:</span>
1039     <span class="comment">% ---------------</span>
1040     guiparams.z = z;
1041     guiparams.A = A;
1042     guiparams.V = V;
1043     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1044     
1045       
1046     <span class="comment">% Update the GUI:</span>
1047     <span class="comment">% ---------------</span>
1048     <a href="#_sub89" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
1049 <span class="keyword">end</span>
1050 <span class="comment">% [EOF] loadDataCallback</span>
1051 
1052 
1053 
1054 <span class="comment">% --------------------------------------------------------------------</span>
1055 <a name="_sub45" href="#_subfunctions" class="code">function saveDataCallback(hObject, eventdata, handles)</a>
1056 <span class="comment">% SaveMATFile_Callback(handles.SaveMATFile,eventdata,handles)</span>
1057 
1058 <span class="comment">% Get the Application data:</span>
1059 <span class="comment">% -------------------------</span>
1060 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1061 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1062 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1063 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1064 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
1065 
1066 [the_file,the_path] = <span class="keyword">...</span>
1067     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
1068     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
1069     fullfile(guiparams.mat_path,guiparams.savefile));
1070 
1071 <span class="comment">% Save the processed data to a MAT file:</span>
1072 <span class="comment">% --------------------------------------</span>
1073 <span class="keyword">if</span> ischar(the_file)
1074     guiparams.mat_path = the_path;
1075     guiparams.mat_file = the_file;
1076     guiparams.savefile = the_file;
1077     
1078     <span class="comment">% Re-store the Application data:</span>
1079     <span class="comment">% ------------------------------</span>
1080     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1081     
1082     <span class="comment">% Update the preferences:</span>
1083     <span class="comment">% -----------------------</span>
1084     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1085     guiprefs.mat_path = the_path;
1086     guiprefs.mat_file = the_file;
1087     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1088     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
1089     
1090     [pathstr,filename,extension] = fileparts([guiparams.mat_path guiparams.savefile]);
1091     savefile = fullfile(pathstr,[filename extension]);
1092     <span class="comment">%h = msgbox(['Saving processed data in MAT File ''' filename extension ''''], ...</span>
1093     <span class="comment">%    'Saving Processed Data File...'); %#ok&lt;NASGU&gt;</span>
1094     log_text = {<span class="keyword">...</span>
1095         <span class="string">'Saving Processed Data File...'</span>;<span class="keyword">...</span>
1096         savefile};
1097     statusLogging(handles.LogWindow,log_text)
1098     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
1099 <span class="keyword">end</span>
1100 
1101 <span class="comment">% [EOF] saveDataCallback</span>
1102 
1103 
1104 <span class="comment">% --------------------------------------------------------------------</span>
1105 <a name="_sub46" href="#_subfunctions" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a>
1106 
1107 <span class="comment">% Get the Application data:</span>
1108 <span class="comment">% -------------------------</span>
1109 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1110 z   = guiparams.z;
1111 A   = guiparams.A;
1112 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
1113 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
1114 
1115 <span class="comment">% Compute multibeam bathymetry:</span>
1116 <span class="comment">% -----------------------------</span>
1117 msgbox(<span class="string">'Processing Bathymetry...Please Be Patient'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
1118 <span class="comment">%A = VMT_MBBathy(z,A,savefile,handles.beam_angle,handles.MagneticVariation,handles.WSE);</span>
1119 <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>(z,A,savefile, <span class="keyword">...</span>
1120     guiparams.beam_angle, <span class="keyword">...</span>
1121     guiparams.magnetic_variation, <span class="keyword">...</span>
1122     guiparams.wse, <span class="keyword">...</span>
1123     guiparams.output_auxiliary_data);
1124 
1125 msgbox(<span class="string">'Bathymetry Output Complete'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
1126 
1127 <span class="comment">% [EOF] saveBathymetryCallback</span>
1128 
1129 <span class="comment">% --------------------------------------------------------------------</span>
1130 <a name="_sub47" href="#_subfunctions" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a>
1131 
1132 <span class="comment">% Get the Application data:</span>
1133 <span class="comment">% -------------------------</span>
1134 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1135 
1136 [guiparams.english_units,guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
1137     guiparams.presentation,guiparams.print] = <span class="keyword">...</span>
1138     plotParametersDialog(guiparams.english_units, <span class="keyword">...</span>
1139     guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
1140     guiparams.presentation,guiparams.print,<span class="keyword">...</span>
1141     handles.figure1);
1142 
1143 <span class="comment">% Update the GUI:</span>
1144 <span class="comment">% ---------------</span>
1145 <span class="keyword">if</span> guiparams.english_units
1146     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1147     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1148 <span class="keyword">else</span>
1149     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1150     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1151 <span class="keyword">end</span>
1152 
1153 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
1154     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1155     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1156 <span class="keyword">else</span>
1157     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1158     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1159 <span class="keyword">end</span>
1160 
1161 <span class="keyword">if</span> guiparams.presentation
1162     <a href="#_sub33" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
1163 <span class="comment">%     set(handles.menuStylePrint,           'Checked','off')</span>
1164 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','on')</span>
1165 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','off')</span>
1166 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','on')</span>
1167 <span class="keyword">else</span>
1168     <a href="#_sub32" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
1169 <span class="comment">%     set(handles.menuStylePrint,           'Checked','on')</span>
1170 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','off')</span>
1171 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','on')</span>
1172 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','off')</span>
1173 <span class="keyword">end</span>
1174 
1175 <span class="comment">% Re-store the Application data:</span>
1176 <span class="comment">% ------------------------------</span>
1177 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1178 
1179 <span class="comment">% [EOF] plottingParametersCallback</span>
1180 
1181 
1182 <span class="comment">% --------------------------------------------------------------------</span>
1183 <a name="_sub48" href="#_subfunctions" class="code">function processingParametersCallback(hObject, eventdata, handles)</a>
1184 
1185 <span class="comment">% Get the Application data:</span>
1186 <span class="comment">% -------------------------</span>
1187 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1188 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1189 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1190 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1191 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
1192 
1193 <span class="comment">% [EOF] processingParametersCallback</span>
1194 
1195 
1196 <span class="comment">% --------------------------------------------------------------------</span>
1197 <a name="_sub49" href="#_subfunctions" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a>
1198 <span class="comment">% Plot 1</span>
1199 
1200 <span class="comment">% Get the Application data:</span>
1201 <span class="comment">% -------------------------</span>
1202 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1203 z = guiparams.z;
1204 A = guiparams.A;
1205 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
1206 <span class="comment">% Map = guiparams.Map;</span>
1207 setends = guiparams.set_cross_section_endpoints;
1208 
1209 <span class="comment">% Process the transects:</span>
1210 <span class="comment">% ----------------------</span>
1211 A(1).hgns = guiparams.horizontal_grid_node_spacing;
1212 A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
1213 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
1214     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction);
1215 
1216 <span class="comment">% Push messages to Log Window:</span>
1217 <span class="comment">% ----------------------------</span>
1218 log_text = {<span class="string">'Plotting Shiptracks (reprocessing)'</span>};
1219 statusLogging(handles.LogWindow, vertcat(log_text,processing_log_text))
1220 
1221 <span class="comment">% Create or replot the Shiptracks</span>
1222 <span class="comment">% -------------------------------</span>
1223 <span class="comment">% Grab the axes to the plot</span>
1224 <span class="comment">% axes(handles.Plot1Shiptracks);</span>
1225 <a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>(A,V,z,setends,handles.Plot1Shiptracks); <span class="comment">% PLOT 1</span>
1226 
1227 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
1228 <span class="comment">% New plot display window</span>
1229 <span class="comment">% h = VMT_CreatePlotDisplay('shiptracks');</span>
1230 <span class="comment">% h = figure(1); clf</span>
1231 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
1232 
1233 <span class="comment">% [EOF] shiptracksPlotCallback</span>
1234 
1235 
1236 <span class="comment">% --------------------------------------------------------------------</span>
1237 <a name="_sub50" href="#_subfunctions" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a>
1238 <span class="comment">% Plot 2</span>
1239 
1240 <span class="comment">% Get the Application data:</span>
1241 <span class="comment">% -------------------------</span>
1242 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1243 
1244 <span class="keyword">if</span> iscell(guiparams.mat_file) <span class="comment">% Multiple MAT files loaded</span>
1245     <span class="comment">% Push messages to Log Window:</span>
1246     <span class="comment">% ----------------------------</span>
1247     log_text = {<span class="string">'Plotting Multiple Transects (Planview)'</span>};
1248     statusLogging(handles.LogWindow, log_text)
1249     
1250        
1251     <span class="comment">% Push plotting parameters to log window:</span>
1252     <span class="comment">% ---------------------------------------</span>
1253     log_text = {<span class="keyword">...</span>
1254         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
1255         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
1256         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
1257         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
1258         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
1259         };
1260     statusLogging(handles.LogWindow, log_text)
1261     
1262     <span class="comment">% Plot the data:</span>
1263     <span class="comment">% --------------</span>
1264     z = [];
1265     A = [];
1266     V = [];
1267     Map = [];
1268     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
1269     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
1270         depth_range, <span class="keyword">...</span>
1271         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
1272         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
1273         guiparams.smoothing_window_size, <span class="keyword">...</span>
1274         guiparams.display_shoreline, <span class="keyword">...</span>
1275         guiparams.english_units, <span class="keyword">...</span>
1276         guiparams.mat_file, <span class="keyword">...</span>
1277         guiparams.mat_path); <span class="comment">% PLOT2</span>
1278     statusLogging(handles.LogWindow, log_text)
1279     
1280     <span class="comment">% Plot a Shoreline Map:</span>
1281     <span class="comment">% ---------------------</span>
1282     <span class="keyword">if</span> guiparams.display_shoreline
1283         Map = <a href="VMT_LoadMap.html" class="code" title="function Map = VMT_LoadMap(filetype,coord);">VMT_LoadMap</a>(<span class="string">'txt'</span>,<span class="string">'UTM'</span>);
1284         <span class="comment">%figure(2); clf</span>
1285         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
1286         log_text = {<span class="keyword">...</span>
1287             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
1288             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
1289             };
1290         statusLogging(handles.LogWindow, log_text)
1291     <span class="keyword">else</span>
1292         Map = [];
1293     <span class="keyword">end</span>
1294     
1295 <span class="keyword">else</span>
1296     z = guiparams.z;
1297     A = guiparams.A;
1298     <span class="comment">% V = guiparams.V;</span>
1299     Map = guiparams.Map;
1300     
1301     <span class="comment">% Push messages to Log Window:</span>
1302     <span class="comment">% ----------------------------</span>
1303     log_text = {<span class="string">'Plotting Depth Averaged Vectors (reprocessing)'</span>};
1304     statusLogging(handles.LogWindow, log_text)
1305     
1306         
1307     <span class="comment">% Preprocess the data:</span>
1308     <span class="comment">% --------------------</span>
1309     A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
1310     
1311     <span class="comment">% Process the transects:</span>
1312     <span class="comment">% ----------------------</span>
1313     A(1).hgns = guiparams.horizontal_grid_node_spacing;
1314     A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
1315     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
1316         guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction);
1317     
1318     <span class="comment">% Push messages to Log Window:</span>
1319     <span class="comment">% ----------------------------</span>
1320     statusLogging(handles.LogWindow, processing_log_text)
1321     
1322     <span class="comment">% Plot the cross section:</span>
1323     <span class="comment">% -----------------------</span>
1324     log_text = {<span class="keyword">...</span>
1325         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
1326         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
1327         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
1328         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
1329         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
1330         };
1331     statusLogging(handles.LogWindow, log_text)
1332     
1333     <span class="comment">% Plot the data:</span>
1334     <span class="comment">% --------------</span>
1335     <span class="comment">%msgbox('Plotting Plan View','VMT Status','help','replace');</span>
1336     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
1337     <span class="comment">% if ~guiparams.map_depth_averaged_velocities</span>
1338     
1339     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
1340         depth_range, <span class="keyword">...</span>
1341         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
1342         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
1343         guiparams.smoothing_window_size, <span class="keyword">...</span>
1344         guiparams.display_shoreline, <span class="keyword">...</span>
1345         guiparams.english_units); <span class="comment">% PLOT2</span>
1346     statusLogging(handles.LogWindow, log_text)
1347     
1348     <span class="comment">% Plot a Shoreline Map:</span>
1349     <span class="comment">% ---------------------</span>
1350     <span class="keyword">if</span> guiparams.display_shoreline
1351         Map = <a href="VMT_LoadMap.html" class="code" title="function Map = VMT_LoadMap(filetype,coord);">VMT_LoadMap</a>(<span class="string">'txt'</span>,<span class="string">'UTM'</span>);
1352         <span class="comment">%figure(2); clf</span>
1353         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
1354         log_text = {<span class="keyword">...</span>
1355             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
1356             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
1357             };
1358         statusLogging(handles.LogWindow, log_text)
1359     <span class="keyword">else</span>
1360         Map = [];
1361     <span class="keyword">end</span>
1362     
1363 <span class="keyword">end</span>
1364 
1365 <span class="keyword">if</span> guiparams.add_background
1366     log_text = <a href="VMT_OverlayDOQQ.html" class="code" title="function log_text = VMT_OverlayDOQQ(pathname)">VMT_OverlayDOQQ</a>(guiparams.data_folder);
1367     statusLogging(handles.LogWindow, log_text)
1368 <span class="keyword">end</span>
1369 
1370 <span class="comment">% Save the PVdata to persistent guiparams</span>
1371 <span class="comment">% ---------------------------------------</span>
1372 guiparams.iric_anv_planview_data = PVdata;
1373 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams);
1374 
1375 <span class="comment">% Force plot to be formated properly</span>
1376 <span class="comment">% ----------------------------------</span>
1377 <span class="keyword">if</span> guiparams.presentation
1378     <a href="#_sub33" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
1379 <span class="keyword">else</span>
1380     <a href="#_sub32" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
1381 <span class="keyword">end</span>
1382 
1383 <span class="comment">% [EOF] planviewPlotCallback</span>
1384 
1385 
1386 <span class="comment">% --------------------------------------------------------------------</span>
1387 <a name="_sub51" href="#_subfunctions" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a>
1388 <span class="comment">% Plot 3</span>
1389 
1390 <span class="comment">% Get the Application data:</span>
1391 <span class="comment">% -------------------------</span>
1392 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1393 z = guiparams.z;
1394 A = guiparams.A;
1395 <span class="comment">% V = guiparams.V;</span>
1396 <span class="comment">% Map = guiparams.Map;</span>
1397 
1398 <span class="comment">% Preprocess the data:</span>
1399 <span class="comment">% --------------------</span>
1400 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
1401 
1402 <span class="comment">% Push messages to Log Window:</span>
1403 <span class="comment">% ----------------------------</span>
1404 log_text = {<span class="string">'Plotting Cross Section (reprocessing)'</span>};
1405 statusLogging(handles.LogWindow, log_text)
1406 
1407 <span class="comment">% Process the transects:</span>
1408 <span class="comment">% ----------------------</span>
1409 A(1).hgns = guiparams.horizontal_grid_node_spacing;
1410 A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
1411 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
1412     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction);
1413 
1414 <span class="comment">% Push messages to Log Window:</span>
1415 <span class="comment">% ----------------------------</span>
1416 statusLogging(handles.LogWindow, processing_log_text)
1417 
1418 <span class="comment">% Plot the cross section:</span>
1419 <span class="comment">% -----------------------</span>
1420 log_text = {<span class="keyword">...</span>
1421     <span class="string">'Cross Section Plotting Parameters'</span>;<span class="keyword">...</span>
1422     sprintf(<span class="string">'   Contour variable: %s'</span>          ,guiparams.contours(guiparams.idx_contour).string);<span class="keyword">...</span>
1423     sprintf(<span class="string">'   Vertical exaggeration: %d'</span>     ,guiparams.vertical_exaggeration);<span class="keyword">...</span>
1424     sprintf(<span class="string">'   Vector scale: %3.1f'</span>           ,guiparams.vector_scale_cross_section);<span class="keyword">...</span>
1425     sprintf(<span class="string">'   Horizontal vector spacing: %d'</span> ,guiparams.horizontal_vector_spacing);<span class="keyword">...</span>
1426     sprintf(<span class="string">'   Vertical vector spacing: %d'</span>   ,guiparams.vertical_vector_spacing);<span class="keyword">...</span>
1427     sprintf(<span class="string">'   Horizontal smooting window: %d'</span>,guiparams.horizontal_smoothing_window);<span class="keyword">...</span>
1428     sprintf(<span class="string">'   Vertical smoothing window: %d'</span> ,guiparams.vertical_smoothing_window);<span class="keyword">...</span>
1429     };
1430 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
1431     log_text = vertcat(log_text, {<span class="keyword">...</span>
1432         sprintf(<span class="string">'   Vector variable: %s'</span>,guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).string);<span class="keyword">...</span>
1433         sprintf(<span class="string">'   Inc. vertical component?: %d'</span>,guiparams.include_vertical_velocity)<span class="keyword">...</span>
1434         });
1435 <span class="keyword">end</span>
1436 <span class="comment">% Push messages to Log Window:</span>
1437 <span class="comment">% ----------------------------</span>
1438 statusLogging(handles.LogWindow, log_text)
1439 
1440 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
1441     <span class="comment">%msgbox('Plotting Cross Section','VMT Status','help','replace')</span>
1442     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
1443         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
1444         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
1445         guiparams.vertical_smoothing_window);
1446     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
1447         <span class="keyword">...</span><span class="comment">guiparams.secondary_flow_vector_variable, ...</span>
1448         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
1449         guiparams.vertical_smoothing_window);
1450     [~,A,V,plot_cont_log_text] = <a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english)">VMT_PlotXSContQuiver</a>(z,A,V, <span class="keyword">...</span>
1451         guiparams.contour, <span class="keyword">...</span>
1452         guiparams.vector_scale_cross_section, <span class="keyword">...</span>
1453         guiparams.vertical_exaggeration, <span class="keyword">...</span>
1454         guiparams.horizontal_vector_spacing, <span class="keyword">...</span>
1455         guiparams.vertical_vector_spacing, <span class="keyword">...</span>
1456         guiparams.secondary_flow_vector_variable, <span class="keyword">...</span>
1457         guiparams.include_vertical_velocity, <span class="keyword">...</span>
1458         guiparams.english_units); <span class="comment">%#ok&lt;ASGLU&gt; % PLOT3</span>
1459     
1460 <span class="keyword">elseif</span> ~guiparams.plot_secondary_flow_vectors
1461     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
1462         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
1463         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
1464         guiparams.vertical_smoothing_window);
1465     
1466     [~,A,V,zmin,zmax,plot_cont_log_text] = <a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english)">VMT_PlotXSCont</a>(z,A,V, <span class="keyword">...</span>
1467         guiparams.contour, <span class="keyword">...</span>
1468         guiparams.vertical_exaggeration, <span class="keyword">...</span>
1469         guiparams.english_units);  <span class="comment">%#ok&lt;ASGLU&gt;</span>
1470     
1471     guiparams.zmin = zmin;
1472     guiparams.zmax = zmax;
1473     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1474 <span class="keyword">end</span>
1475 
1476 <span class="comment">% Force plot to be formated properly</span>
1477 <span class="comment">% ----------------------------------</span>
1478 <span class="keyword">if</span> guiparams.presentation
1479     <a href="#_sub33" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
1480 <span class="keyword">else</span>
1481     <a href="#_sub32" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
1482 <span class="keyword">end</span>
1483 
1484 <span class="comment">% Push messages to Log Window:</span>
1485 <span class="comment">% ----------------------------</span>
1486 statusLogging(handles.LogWindow, plot_cont_log_text)
1487 <span class="comment">% msgbox('Plotting Complete','VMT Status','help','replace')</span>
1488 
1489 <span class="comment">% [EOF] crosssectionPlotCallback</span>
1490 
1491 
1492 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
1493 <span class="comment">% DATA EXPORT CALLBACKS %</span>
1494 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
1495 
1496 <span class="comment">% --------------------------------------------------------------------</span>
1497 <a name="_sub52" href="#_subfunctions" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a>
1498 <span class="comment">% saveDataCallback(hObject, eventdata, handles)</span>
1499 
1500 <span class="comment">% Get the Application data:</span>
1501 <span class="comment">% -------------------------</span>
1502 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1503 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1504 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1505 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1506 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
1507 
1508 [the_file,the_path] = <span class="keyword">...</span>
1509     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
1510     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
1511     fullfile(guiparams.mat_path,guiparams.savefile));
1512 
1513 <span class="comment">% Save the processed data to a MAT file:</span>
1514 <span class="comment">% --------------------------------------</span>
1515 <span class="keyword">if</span> ischar(the_file)
1516     guiparams.mat_path = the_path;
1517     guiparams.mat_file = the_file;
1518     guiparams.savefile = the_file;
1519     
1520     <span class="comment">% Re-store the Application data:</span>
1521     <span class="comment">% ------------------------------</span>
1522     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1523     
1524     <span class="comment">% Update the preferences:</span>
1525     <span class="comment">% -----------------------</span>
1526     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1527     guiprefs.mat_path = the_path;
1528     guiprefs.mat_file = the_file;
1529     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1530     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
1531     
1532     [~,filename,extension] = fileparts(guiparams.savefile);
1533     savefile = [filename extension];
1534     h = msgbox([<span class="string">'Saving processed data in MAT File '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
1535         <span class="string">'Saving Processed Data File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1536     disp(<span class="string">'Saving Processed Data File...'</span>)
1537     disp(savefile)
1538     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
1539 <span class="keyword">end</span>
1540 
1541 <span class="comment">% [EOF] SaveMATFile_Callback</span>
1542 
1543 
1544 <span class="comment">% --------------------------------------------------------------------</span>
1545 <a name="_sub53" href="#_subfunctions" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a>
1546 
1547 <span class="comment">% Get the Application data:</span>
1548 <span class="comment">% -------------------------</span>
1549 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1550 <span class="comment">% z   = guiparams.z;</span>
1551 <span class="comment">% A   = guiparams.A;</span>
1552 V   = guiparams.V;
1553 <span class="comment">% Map = guiparams.Map;</span>
1554 
1555 [the_file,the_path] = <span class="keyword">...</span>
1556     uiputfile({<span class="string">'*.dat'</span>,<span class="string">'Tecplot Files (*.dat)'</span>}, <span class="keyword">...</span>
1557     <span class="string">'Save Tecplot File'</span>, <span class="keyword">...</span>
1558     fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
1559 
1560 <span class="comment">% Output the data (no smoothing) to Tecplot:</span>
1561 <span class="comment">% ------------------------------------------</span>
1562 <span class="keyword">if</span> ischar(the_file)
1563     guiparams.tecplot_path = the_path;
1564     guiparams.tecplot_file = the_file;
1565     
1566     <span class="comment">% Re-store the Application data:</span>
1567     <span class="comment">% ------------------------------</span>
1568     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1569     
1570     <span class="comment">% Update the preferences:</span>
1571     <span class="comment">% -----------------------</span>
1572     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1573     guiprefs.tecplot_path = the_path;
1574     guiprefs.tecplot_file = the_file;
1575     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1576     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'tecplot'</span>)
1577     
1578     <span class="comment">% Push to log window</span>
1579     <span class="comment">% ------------------</span>
1580     log_text = {<span class="keyword">...</span>
1581         <span class="string">'Exporting Data to Tecplot (*.dat) File...'</span>;<span class="keyword">...</span>
1582         <span class="string">'Directory:'</span>;<span class="keyword">...</span>
1583         the_path;<span class="keyword">...</span>
1584         [<span class="string">'Filename: '</span> the_file]};
1585     statusLogging(handles.LogWindow,log_text)
1586         
1587     <span class="keyword">if</span> isempty(V)
1588         A = guiparams.A;
1589         A(1).hgns = guiparams.horizontal_grid_node_spacing;
1590         A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
1591         [~,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
1592             guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
1593             guiparams.unit_discharge_correction);
1594     <span class="keyword">end</span>
1595     <a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
1596     
1597     <span class="comment">% Push to log window</span>
1598     <span class="comment">% ------------------</span>
1599     log_text = {<span class="string">'Exporting XS Bathy Data to Tecplot (*.dat) File...'</span>};
1600     statusLogging(handles.LogWindow,log_text)
1601     
1602     <a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
1603     
1604     <span class="comment">% Push to log window</span>
1605     <span class="comment">% ------------------</span>
1606     log_text = {<span class="string">'Tecplot Export Complete'</span>};
1607     statusLogging(handles.LogWindow,log_text)
1608    
1609 <span class="keyword">end</span>
1610 
1611 <span class="comment">% [EOF] SaveTechplotFile_Callback</span>
1612 
1613 
1614 <span class="comment">% --------------------------------------------------------------------</span>
1615 <a name="_sub54" href="#_subfunctions" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a>
1616 
1617 <span class="comment">% Get the Application data:</span>
1618 <span class="comment">% -------------------------</span>
1619 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1620 <span class="comment">% z   = guiparams.z;</span>
1621 A   = guiparams.A;
1622 V   = guiparams.V;
1623 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
1624 
1625 [the_file,the_path] = <span class="keyword">...</span>
1626     uiputfile({<span class="string">'*.kmz'</span>,<span class="string">'Google Earth Files (*.kmz)'</span>}, <span class="keyword">...</span>
1627     <span class="string">'Save Google Earth File'</span>, <span class="keyword">...</span>
1628     fullfile(guiparams.kmz_path,guiparams.kmz_file));
1629 
1630 <span class="comment">% Save the processed data to a Google Earth (KMZ) file:</span>
1631 <span class="comment">% -----------------------------------------------------</span>
1632 <span class="keyword">if</span> ischar(the_file)
1633     guiparams.kmz_path = the_path;
1634     guiparams.kmz_file = the_file;
1635     
1636     <span class="comment">% Re-store the Application data:</span>
1637     <span class="comment">% ------------------------------</span>
1638     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1639     
1640     <span class="comment">% Update the preferences:</span>
1641     <span class="comment">% -----------------------</span>
1642     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1643     guiprefs.kmz_path = the_path;
1644     guiprefs.kmz_file = the_file;
1645     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1646     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'kmz'</span>)
1647     
1648     <span class="comment">%     if guiparams.display_shoreline</span>
1649     <span class="comment">%         VMT_Shoreline2GE_3D(A,Map, ...</span>
1650     <span class="comment">%                             guiparams.vertical_exaggeration, ...</span>
1651     <span class="comment">%                             guiparams.vertical_offset);</span>
1652     <span class="comment">%     end</span>
1653     <span class="keyword">if</span> isempty(V)
1654         A = guiparams.A;
1655         A(1).hgns = guiparams.horizontal_grid_node_spacing;
1656         A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
1657         [~,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
1658             guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
1659             guiparams.unit_discharge_correction);
1660     <span class="keyword">end</span>
1661     <a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>(A,V,[], <span class="keyword">...</span>
1662         fullfile(guiparams.kmz_path,guiparams.kmz_file), <span class="keyword">...</span>
1663         guiparams.vertical_exaggeration, <span class="keyword">...</span>
1664         guiparams.vertical_offset);
1665 <span class="keyword">end</span>
1666 
1667 <span class="comment">% [EOF] SaveGoogleEarthFile_Callback</span>
1668 
1669 
1670 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
1671 <span class="comment">% DATA EXPORT/BATHYMETRY CALLBACKS %</span>
1672 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
1673 
1674 <span class="comment">% --------------------------------------------------------------------</span>
1675 <a name="_sub55" href="#_subfunctions" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
1676 
1677 <span class="comment">% Get the Application data:</span>
1678 <span class="comment">% -------------------------</span>
1679 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1680 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1681 
1682 [the_file,the_path] = <span class="keyword">...</span>
1683     uiputfile({<span class="string">'*.csv'</span>,<span class="string">'Multibeam Bathymetry Files (*.csv)'</span>}, <span class="keyword">...</span>
1684     <span class="string">'Export Multibeam Bathymetry'</span>, <span class="keyword">...</span>
1685     fullfile(guiprefs.multibeambathymetry_path, <span class="keyword">...</span>
1686     guiprefs.multibeambathymetry_file));
1687 
1688 <span class="keyword">if</span> ischar(the_file)
1689     guiparams.multibeambathymetry_path = the_path;
1690     guiparams.multibeambathymetry_file = the_file;
1691     
1692     <span class="comment">% Re-store the Application data:</span>
1693     <span class="comment">% ------------------------------</span>
1694     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1695     
1696     <span class="comment">% Update the preferences:</span>
1697     <span class="comment">% -----------------------</span>
1698     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1699     guiprefs.multibeambathymetry_path = the_path;
1700     guiprefs.multibeambathymetry_file = the_file;
1701     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1702     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'multibeambathymetry'</span>)
1703     
1704     <span class="keyword">if</span> guiparams.output_auxiliary_data
1705     <span class="keyword">end</span>
1706     
1707     <span class="comment">%msgbox('Processing Bathymetry...Please Be Patient','VMT Status','help','replace')</span>
1708     
1709     savefile = fullfile(guiparams.multibeambathymetry_path, <span class="keyword">...</span>
1710         guiparams.multibeambathymetry_file);
1711     
1712     log_text = {<span class="string">'Multibeam bathymetry file saved to:'</span>;<span class="keyword">...</span>
1713         [<span class="string">'   '</span> savefile]};
1714     statusLogging(handles.LogWindow,log_text)
1715     
1716     <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>(guiparams.z, <span class="keyword">...</span>
1717         guiparams.A, <span class="keyword">...</span>
1718         savefile, <span class="keyword">...</span>
1719         guiparams.beam_angle, <span class="keyword">...</span>
1720         guiparams.magnetic_variation, <span class="keyword">...</span>
1721         guiparams.wse, <span class="keyword">...</span>
1722         guiparams.output_auxiliary_data);
1723     
1724     <span class="comment">%msgbox('Bathymetry Output Complete','VMT Status','help','replace')</span>
1725     
1726 <span class="keyword">end</span>
1727 
1728 <span class="comment">% [EOF] ExportMultibeamBathymetry_Callback</span>
1729 
1730 
1731 <span class="comment">% --------------------------------------------------------------------</span>
1732 <a name="_sub56" href="#_subfunctions" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a>
1733 <span class="comment">% Get the beam angle</span>
1734 
1735 <span class="comment">% Get the Application data:</span>
1736 <span class="comment">% -------------------------</span>
1737 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1738 
1739 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
1740 <span class="comment">% ----------------------------------------------------------------</span>
1741 new_beam_angle = str2double(get(hObject,<span class="string">'String'</span>));
1742 is_a_number = ~isnan(new_beam_angle);
1743 is_positive = new_beam_angle&gt;=0;
1744 
1745 <span class="comment">% Modify the Application data:</span>
1746 <span class="comment">% ----------------------------</span>
1747 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
1748     guiparams.beam_angle = new_beam_angle;
1749     
1750     <span class="comment">% Re-store the Application data:</span>
1751     <span class="comment">% ------------------------------</span>
1752     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1753     
1754 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
1755     set(hObject,<span class="string">'String'</span>,guiparams.beam_angle)
1756 <span class="keyword">end</span>
1757 
1758 <span class="comment">% [EOF] BeamAngle_Callback</span>
1759 
1760 
1761 <span class="comment">% --------------------------------------------------------------------</span>
1762 <a name="_sub57" href="#_subfunctions" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a>
1763 <span class="comment">% Get the Magnetic Variation</span>
1764 
1765 <span class="comment">% Get the Application data:</span>
1766 <span class="comment">% -------------------------</span>
1767 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1768 
1769 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
1770 <span class="comment">% ----------------------------------------------------------------</span>
1771 new_magnetic_variation = str2double(get(hObject,<span class="string">'String'</span>));
1772 is_a_number = ~isnan(new_magnetic_variation);
1773 is_positive = new_magnetic_variation&gt;=0;
1774 
1775 <span class="comment">% Modify the Application data:</span>
1776 <span class="comment">% ----------------------------</span>
1777 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
1778     guiparams.magnetic_variation = new_magnetic_variation;
1779     
1780     <span class="comment">% Re-store the Application data:</span>
1781     <span class="comment">% ------------------------------</span>
1782     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1783     
1784 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
1785     set(hObject,<span class="string">'String'</span>,guiparams.magnetic_variation)
1786 <span class="keyword">end</span>
1787 
1788 <span class="comment">% [EOF] MagneticVariation_Callback</span>
1789 
1790 
1791 <span class="comment">% --------------------------------------------------------------------</span>
1792 <a name="_sub58" href="#_subfunctions" class="code">function WSE_Callback(hObject, eventdata, handles)</a>
1793 
1794 <span class="comment">% Get the Application data:</span>
1795 <span class="comment">% -------------------------</span>
1796 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1797 
1798 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
1799 <span class="comment">% ----------------------------------------------------------------</span>
1800 new_wse = str2double(get(hObject,<span class="string">'String'</span>));
1801 is_a_number = ~isnan(new_wse);
1802 is_positive = new_wse&gt;=0;
1803 
1804 <span class="comment">% Modify the Application data:</span>
1805 <span class="comment">% ----------------------------</span>
1806 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
1807     guiparams.wse = new_wse;
1808     
1809     <span class="comment">% Re-store the Application data:</span>
1810     <span class="comment">% ------------------------------</span>
1811     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1812     
1813 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
1814     set(hObject,<span class="string">'String'</span>,guiparams.wse)
1815 <span class="keyword">end</span>
1816 
1817 <span class="comment">% [EOF] WSE_Callback</span>
1818 
1819 
1820 <span class="comment">% --------------------------------------------------------------------</span>
1821 <a name="_sub59" href="#_subfunctions" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a>
1822 <span class="comment">% Bathymetry Auxillary Data</span>
1823 
1824 <span class="comment">% Get the Application data:</span>
1825 <span class="comment">% -------------------------</span>
1826 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1827 
1828 <span class="comment">% Modify the Application data:</span>
1829 <span class="comment">% ----------------------------</span>
1830 guiparams.output_auxiliary_data = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
1831 
1832 <span class="comment">% Re-store the Application data:</span>
1833 <span class="comment">% ------------------------------</span>
1834 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1835 
1836 <span class="comment">% [EOF] OutputAuxiliaryData_Callback</span>
1837 
1838 
1839 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
1840 <span class="comment">% PLOTTING/PLAN VIEW PLOT CALLBACKS %</span>
1841 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
1842 
1843 <span class="comment">% --------------------------------------------------------------------</span>
1844 <a name="_sub60" href="#_subfunctions" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a>
1845 
1846 <span class="comment">% Get the Application data:</span>
1847 <span class="comment">% -------------------------</span>
1848 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1849 
1850 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
1851 <span class="comment">% ----------------------------------------------------------------</span>
1852 new_depth_range_min = str2double(get(hObject,<span class="string">'String'</span>));
1853 is_a_number = ~isnan(new_depth_range_min);
1854 is_positive = new_depth_range_min&gt;=0;
1855 
1856 <span class="comment">% Modify the Application data:</span>
1857 <span class="comment">% ----------------------------</span>
1858 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
1859     guiparams.depth_range_min = new_depth_range_min;
1860     
1861     <span class="comment">% Re-store the Application data:</span>
1862     <span class="comment">% ------------------------------</span>
1863     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1864     
1865 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
1866     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_min)
1867 <span class="keyword">end</span>
1868 
1869 <span class="comment">% [EOF] DepthRangeMin_Callback</span>
1870 
1871 
1872 <span class="comment">% --------------------------------------------------------------------</span>
1873 <a name="_sub61" href="#_subfunctions" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a>
1874 
1875 <span class="comment">% Get the Application data:</span>
1876 <span class="comment">% -------------------------</span>
1877 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1878 
1879 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
1880 <span class="comment">% ----------------------------------------------------------------</span>
1881 new_depth_range_max = str2double(get(hObject,<span class="string">'String'</span>));
1882 is_a_number = ~isnan(new_depth_range_max);
1883 is_positive = new_depth_range_max&gt;=0;
1884 
1885 <span class="comment">% Modify the Application data:</span>
1886 <span class="comment">% ----------------------------</span>
1887 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
1888     guiparams.depth_range_max = new_depth_range_max;
1889     
1890     <span class="comment">% Re-store the Application data:</span>
1891     <span class="comment">% ------------------------------</span>
1892     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1893     
1894 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
1895     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_max)
1896 <span class="keyword">end</span>
1897 
1898 <span class="comment">% [EOF] DepthMax_Callback</span>
1899 
1900 
1901 <span class="comment">% --------------------------------------------------------------------</span>
1902 <a name="_sub62" href="#_subfunctions" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a>
1903 <span class="comment">% Set quiver scale (contour)</span>
1904 
1905 <span class="comment">% Get the Application data:</span>
1906 <span class="comment">% -------------------------</span>
1907 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1908 
1909 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
1910 <span class="comment">% ----------------------------------------------------------------</span>
1911 new_vector_scale_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
1912 is_a_number = ~isnan(new_vector_scale_plan_view);
1913 is_positive = new_vector_scale_plan_view&gt;=0;
1914 
1915 <span class="comment">% Modify the Application data:</span>
1916 <span class="comment">% ----------------------------</span>
1917 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
1918     guiparams.vector_scale_plan_view = round(new_vector_scale_plan_view);
1919     
1920     <span class="comment">% Re-store the Application data:</span>
1921     <span class="comment">% ------------------------------</span>
1922     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1923     
1924 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
1925     set(hObject,<span class="string">'String'</span>,guiparams.vector_scale_plan_view)
1926 <span class="keyword">end</span>
1927 
1928 <span class="comment">% [EOF] VectorScalePlanView_Callback</span>
1929 
1930 
1931 <span class="comment">% --------------------------------------------------------------------</span>
1932 <a name="_sub63" href="#_subfunctions" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a>
1933 <span class="comment">% Set quiver spacing (contour, horizontal)</span>
1934 
1935 <span class="comment">% Get the Application data:</span>
1936 <span class="comment">% -------------------------</span>
1937 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1938 
1939 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
1940 <span class="comment">% ----------------------------------------------------------------</span>
1941 new_vector_spacing_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
1942 is_a_number = ~isnan(new_vector_spacing_plan_view);
1943 is_positive = new_vector_spacing_plan_view&gt;=0;
1944 
1945 <span class="comment">% Modify the Application data:</span>
1946 <span class="comment">% ----------------------------</span>
1947 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
1948     guiparams.vector_spacing_plan_view = round(new_vector_spacing_plan_view);
1949     
1950     <span class="comment">% Re-store the Application data:</span>
1951     <span class="comment">% ------------------------------</span>
1952     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1953     
1954 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
1955     set(hObject,<span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
1956 <span class="keyword">end</span>
1957 
1958 <span class="comment">% [EOF] VectorSpacingPlanview_Callback</span>
1959 
1960 
1961 <span class="comment">% --------------------------------------------------------------------</span>
1962 <a name="_sub64" href="#_subfunctions" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a>
1963 <span class="comment">% Plan View smoothing window size</span>
1964 
1965 <span class="comment">% Get the Application data:</span>
1966 <span class="comment">% -------------------------</span>
1967 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1968 
1969 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
1970 <span class="comment">% ----------------------------------------------------------------</span>
1971 new_smoothing_window_size = str2double(get(hObject,<span class="string">'String'</span>));
1972 is_a_number = ~isnan(new_smoothing_window_size);
1973 is_positive = new_smoothing_window_size&gt;=0;
1974 
1975 <span class="comment">% Modify the Application data:</span>
1976 <span class="comment">% ----------------------------</span>
1977 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
1978     guiparams.smoothing_window_size = round(new_smoothing_window_size);
1979     
1980     <span class="comment">% Re-store the Application data:</span>
1981     <span class="comment">% ------------------------------</span>
1982     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1983     
1984 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
1985     set(hObject,<span class="string">'String'</span>,guiparams.smoothing_window_size)
1986 <span class="keyword">end</span>
1987 
1988 <span class="comment">% [EOF] SmoothingWindowSize_Callback</span>
1989 
1990 
1991 <span class="comment">% --------------------------------------------------------------------</span>
1992 <a name="_sub65" href="#_subfunctions" class="code">function MapDepthAveragedVelocities_Callback(hObject, eventdata, handles)</a>
1993 
1994 <span class="comment">% Get the Application data:</span>
1995 <span class="comment">% -------------------------</span>
1996 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1997 
1998 <span class="comment">% Modify the Application data:</span>
1999 <span class="comment">% ----------------------------</span>
2000 guiparams.map_depth_averaged_velocities = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2001 
2002 <span class="comment">% Re-store the Application data:</span>
2003 <span class="comment">% ------------------------------</span>
2004 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2005 
2006 <span class="comment">% [EOF] MapDepthAveragedVelocities_Callback</span>
2007 
2008 
2009 <span class="comment">% --------------------------------------------------------------------</span>
2010 <a name="_sub66" href="#_subfunctions" class="code">function DisplayShoreline_Callback(hObject, eventdata, handles)</a>
2011 
2012 <span class="comment">% Get the Application data:</span>
2013 <span class="comment">% -------------------------</span>
2014 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2015 
2016 <span class="comment">% Modify the Application data:</span>
2017 <span class="comment">% ----------------------------</span>
2018 guiparams.display_shoreline = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2019 
2020 <span class="comment">% Re-store the Application data:</span>
2021 <span class="comment">% ------------------------------</span>
2022 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2023 
2024 <span class="comment">% [EOF] DisplayShoreline_Callback</span>
2025 
2026 
2027 <span class="comment">% --------------------------------------------------------------------</span>
2028 <a name="_sub67" href="#_subfunctions" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a>
2029 
2030 <span class="comment">% Get the Application data:</span>
2031 <span class="comment">% -------------------------</span>
2032 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2033 
2034 <span class="comment">% Modify the Application data:</span>
2035 <span class="comment">% ----------------------------</span>
2036 guiparams.add_background = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2037 
2038 <span class="comment">% Re-store the Application data:</span>
2039 <span class="comment">% ------------------------------</span>
2040 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2041 
2042 <span class="comment">% [EOF] AddBackground_Callback</span>
2043 
2044 
2045 <span class="comment">% --------------------------------------------------------------------</span>
2046 <a name="_sub68" href="#_subfunctions" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a>
2047 <a href="#_sub50" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
2048 <span class="comment">% [EOF] PlotPlanView_Callback</span>
2049 
2050 
2051 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2052 <span class="comment">% PLOTTING/SHIP TRACKS PLOT CALLBACKS %</span>
2053 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2054 
2055 <span class="comment">% --------------------------------------------------------------------</span>
2056 <a name="_sub69" href="#_subfunctions" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a>
2057 <span class="comment">% Set the horizontal grid node spacing</span>
2058 
2059 <span class="comment">% Get the Application data:</span>
2060 <span class="comment">% -------------------------</span>
2061 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2062 
2063 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2064 <span class="comment">% ----------------------------------------------------------------</span>
2065 new_horizontal_grid_node_spacing = str2double(get(hObject,<span class="string">'String'</span>));
2066 is_a_number = ~isnan(new_horizontal_grid_node_spacing);
2067 is_positive = new_horizontal_grid_node_spacing&gt;=0;
2068 
2069 <span class="comment">% Modify the Application data:</span>
2070 <span class="comment">% ----------------------------</span>
2071 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2072     guiparams.horizontal_grid_node_spacing = round(new_horizontal_grid_node_spacing);
2073     
2074     <span class="comment">% Re-store the Application data:</span>
2075     <span class="comment">% ------------------------------</span>
2076     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2077     
2078 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2079     set(hObject,<span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
2080 <span class="keyword">end</span>
2081 
2082 <span class="comment">% [EOF] HorizontalGridNodeSpacing_Callback</span>
2083 
2084 
2085 <span class="comment">% --------------------------------------------------------------------</span>
2086 <a name="_sub70" href="#_subfunctions" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
2087 <span class="comment">% Set the cross section endpoints manually</span>
2088 
2089 <span class="comment">% Get the Application data:</span>
2090 <span class="comment">% -------------------------</span>
2091 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2092 
2093 <span class="comment">% Modify the Application data:</span>
2094 <span class="comment">% ----------------------------</span>
2095 guiparams.set_cross_section_endpoints = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2096 
2097 <span class="comment">% Re-store the Application data:</span>
2098 <span class="comment">% ------------------------------</span>
2099 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2100 
2101 <span class="comment">% [EOF] SetCrossSectionEndpoints_Callback</span>
2102 
2103 
2104 <span class="comment">% --------------------------------------------------------------------</span>
2105 <a name="_sub71" href="#_subfunctions" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a>
2106 <a href="#_sub49" class="code" title="subfunction shiptracksPlotCallback(hObject, eventdata, handles)">shiptracksPlotCallback</a>(hObject, eventdata, handles)
2107 <span class="comment">% [EOF] PlotShiptracks_Callback</span>
2108 
2109 
2110 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2111 <span class="comment">% PLOTTING/CROSS SECTION PLOT CALLBACKS %</span>
2112 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2113 
2114 <span class="comment">% --------------------------------------------------------------------</span>
2115 <a name="_sub72" href="#_subfunctions" class="code">function Contour_Callback(hObject, eventdata, handles)</a>
2116 
2117 <span class="comment">% Get the Application data:</span>
2118 <span class="comment">% -------------------------</span>
2119 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2120 
2121 <span class="comment">% Modify the Application data:</span>
2122 <span class="comment">% ----------------------------</span>
2123 idx_variable = get(hObject,<span class="string">'Value'</span>);
2124 guiparams.idx_contour = idx_variable;
2125 guiparams.contour = guiparams.contours(idx_variable).variable;
2126 
2127 <span class="comment">% Re-store the Application data:</span>
2128 <span class="comment">% ------------------------------</span>
2129 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2130 
2131 <span class="comment">% [EOF] Contour_Callback</span>
2132 
2133 
2134 <span class="comment">% --------------------------------------------------------------------</span>
2135 <a name="_sub73" href="#_subfunctions" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a>
2136 <span class="comment">% Set vertical exaggeration</span>
2137 
2138 <span class="comment">% Get the Application data:</span>
2139 <span class="comment">% -------------------------</span>
2140 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2141 
2142 <span class="comment">% Modify the Application data:</span>
2143 <span class="comment">% ----------------------------</span>
2144 guiparams.vertical_exaggeration = str2double(get(hObject,<span class="string">'String'</span>));
2145 
2146 <span class="comment">% Re-store the Application data:</span>
2147 <span class="comment">% ------------------------------</span>
2148 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2149 
2150 <span class="comment">% Update the GUI:</span>
2151 <span class="comment">% ---------------</span>
2152 <span class="comment">% updateGUI(handles,guiparams)</span>
2153 
2154 <span class="comment">% [EOF] VerticalExaggeration_Callback</span>
2155 
2156 
2157 <span class="comment">% --------------------------------------------------------------------</span>
2158 <a name="_sub74" href="#_subfunctions" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a>
2159 
2160 <span class="comment">% Get the Application data:</span>
2161 <span class="comment">% -------------------------</span>
2162 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2163 
2164 <span class="comment">% Modify the Application data:</span>
2165 <span class="comment">% ----------------------------</span>
2166 guiparams.vector_scale_cross_section = str2double(get(hObject,<span class="string">'String'</span>));
2167 
2168 <span class="comment">% Re-store the Application data:</span>
2169 <span class="comment">% ------------------------------</span>
2170 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2171 
2172 <span class="comment">% Update the GUI:</span>
2173 <span class="comment">% ---------------</span>
2174 <span class="comment">% updateGUI(handles,guiparams)</span>
2175 
2176 <span class="comment">% [EOF] VectorScaleCrossSection_Callback</span>
2177 
2178 
2179 <span class="comment">% --------------------------------------------------------------------</span>
2180 <a name="_sub75" href="#_subfunctions" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a>
2181 
2182 <span class="comment">% Get the Application data:</span>
2183 <span class="comment">% -------------------------</span>
2184 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2185 
2186 <span class="comment">% Modify the Application data:</span>
2187 <span class="comment">% ----------------------------</span>
2188 guiparams.horizontal_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
2189 
2190 <span class="comment">% Re-store the Application data:</span>
2191 <span class="comment">% ------------------------------</span>
2192 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2193 
2194 <span class="comment">% Update the GUI:</span>
2195 <span class="comment">% ---------------</span>
2196 <span class="comment">% updateGUI(handles,guiparams)</span>
2197 
2198 <span class="comment">% [EOF] HorizontalVectorSpacing_Callback</span>
2199 
2200 
2201 <span class="comment">% --------------------------------------------------------------------</span>
2202 <a name="_sub76" href="#_subfunctions" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a>
2203 <span class="comment">% Get the vertical quiver spacing for contour plots</span>
2204 
2205 <span class="comment">% Get the Application data:</span>
2206 <span class="comment">% -------------------------</span>
2207 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2208 
2209 <span class="comment">% Modify the Application data:</span>
2210 <span class="comment">% ----------------------------</span>
2211 guiparams.vertical_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
2212 
2213 <span class="comment">% Re-store the Application data:</span>
2214 <span class="comment">% ------------------------------</span>
2215 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2216 
2217 <span class="comment">% Update the GUI:</span>
2218 <span class="comment">% ---------------</span>
2219 <span class="comment">% updateGUI(handles,guiparams)</span>
2220 
2221 <span class="comment">% [EOF] VerticalVectorSpacing_Callback</span>
2222 
2223 
2224 <span class="comment">% --------------------------------------------------------------------</span>
2225 <a name="_sub77" href="#_subfunctions" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
2226 <span class="comment">% Horizontal Smoothing</span>
2227 
2228 <span class="comment">% Get the Application data:</span>
2229 <span class="comment">% -------------------------</span>
2230 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2231 
2232 <span class="comment">% Modify the Application data:</span>
2233 <span class="comment">% ----------------------------</span>
2234 guiparams.horizontal_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
2235 
2236 <span class="comment">% Re-store the Application data:</span>
2237 <span class="comment">% ------------------------------</span>
2238 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2239 
2240 <span class="comment">% Update the GUI:</span>
2241 <span class="comment">% ---------------</span>
2242 <span class="comment">% updateGUI(handles,guiparams)</span>
2243 
2244 <span class="comment">% [EOF] HorizontalSmoothingWindow_Callback</span>
2245 
2246 
2247 <span class="comment">% --------------------------------------------------------------------</span>
2248 <a name="_sub78" href="#_subfunctions" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
2249 <span class="comment">% Vertical Smoothing</span>
2250 
2251 <span class="comment">% Get the Application data:</span>
2252 <span class="comment">% -------------------------</span>
2253 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2254 
2255 <span class="comment">% Modify the Application data:</span>
2256 <span class="comment">% ----------------------------</span>
2257 guiparams.vertical_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
2258 
2259 <span class="comment">% Re-store the Application data:</span>
2260 <span class="comment">% ------------------------------</span>
2261 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2262 
2263 <span class="comment">% Update the GUI:</span>
2264 <span class="comment">% ---------------</span>
2265 <span class="comment">% updateGUI(handles,guiparams)</span>
2266 
2267 <span class="comment">% [EOF] VerticalSmoothingWindow_Callback</span>
2268 
2269 
2270 <span class="comment">% --------------------------------------------------------------------</span>
2271 <a name="_sub79" href="#_subfunctions" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a>
2272 
2273 <span class="comment">% Get the Application data:</span>
2274 <span class="comment">% -------------------------</span>
2275 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2276 
2277 <span class="comment">% Modify the Application data:</span>
2278 <span class="comment">% ----------------------------</span>
2279 guiparams.plot_secondary_flow_vectors = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2280 
2281 <span class="comment">% Re-store the Application data:</span>
2282 <span class="comment">% ------------------------------</span>
2283 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2284 
2285 <span class="comment">% [EOF] PlotSecondaryFlowVectors_Callback</span>
2286 
2287 
2288 <span class="comment">% --------------------------------------------------------------------</span>
2289 <a name="_sub80" href="#_subfunctions" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a>
2290 
2291 <span class="comment">% Get the Application data:</span>
2292 <span class="comment">% -------------------------</span>
2293 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2294 
2295 <span class="comment">% Modify the Application data:</span>
2296 <span class="comment">% ----------------------------</span>
2297 idx_variable = get(hObject,<span class="string">'Value'</span>);
2298 guiparams.idx_secondary_flow_vector_variable = idx_variable;
2299 guiparams.secondary_flow_vector_variable = guiparams.secondary_flows(idx_variable).variable;
2300 
2301 <span class="comment">% Re-store the Application data:</span>
2302 <span class="comment">% ------------------------------</span>
2303 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2304 
2305 <span class="comment">% [EOF] SecondaryFlowVectorVariable_Callback</span>
2306 
2307 
2308 <span class="comment">% --------------------------------------------------------------------</span>
2309 <a name="_sub81" href="#_subfunctions" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a>
2310 
2311 <span class="comment">% Get the Application data:</span>
2312 <span class="comment">% -------------------------</span>
2313 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2314 
2315 <span class="comment">% Modify the Application data:</span>
2316 <span class="comment">% ----------------------------</span>
2317 guiparams.include_vertical_velocity = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2318 
2319 <span class="comment">% Re-store the Application data:</span>
2320 <span class="comment">% ------------------------------</span>
2321 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2322 
2323 <span class="comment">% [EOF] IncludeVerticalVelocity_Callback</span>
2324 
2325 
2326 <span class="comment">% --------------------------------------------------------------------</span>
2327 <a name="_sub82" href="#_subfunctions" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a>
2328 <a href="#_sub51" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
2329 <span class="comment">% [EOF] PlotCrossSection_Callback</span>
2330 
2331 
2332 <span class="comment">% --------------------------------------------------------------------</span>
2333 <a name="_sub83" href="#_subfunctions" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a>
2334 set(handles.LogWindow,<span class="string">'string'</span>,<span class="string">''</span>)
2335 <span class="comment">% [EOF] ClearLog_Callback</span>
2336 
2337 <span class="comment">% --------------------------------------------------------------------</span>
2338 <a name="_sub84" href="#_subfunctions" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a>
2339 
2340 <span class="comment">% Get the Application data:</span>
2341 <span class="comment">% -------------------------</span>
2342 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2343 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2344 <span class="comment">% z   = guiparams.z;   %#ok&lt;NASGU&gt;</span>
2345 <span class="comment">% A   = guiparams.A;   %#ok&lt;NASGU&gt;</span>
2346 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
2347 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
2348 
2349 [the_file,the_path] = <span class="keyword">...</span>
2350     uiputfile({<span class="string">'*.txt'</span>,<span class="string">'TXT-Files (*.txt)'</span>}, <span class="keyword">...</span>
2351     <span class="string">'Choose where to save the log file'</span>, <span class="keyword">...</span>
2352     fullfile(guiprefs.log_path,guiprefs.log_file));
2353 
2354 <span class="comment">% Save the log to a TXT file:</span>
2355 <span class="comment">% ---------------------------</span>
2356 <span class="keyword">if</span> ischar(the_file)
2357     guiparams.log_path = the_path;
2358     guiparams.log_file = the_file;
2359     <span class="comment">%guiparams.savefile = the_file;</span>
2360     
2361     <span class="comment">% Re-store the Application data:</span>
2362     <span class="comment">% ------------------------------</span>
2363     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2364     
2365     <span class="comment">% Update the preferences:</span>
2366     <span class="comment">% -----------------------</span>
2367     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2368     guiprefs.log_path = the_path;
2369     guiprefs.log_file = the_file;
2370     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2371     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'log'</span>)
2372     
2373     [~,filename,extension] = fileparts(the_file);
2374     savefile = [the_path filename extension];
2375     h = msgbox([<span class="string">'Saving log to: '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
2376         <span class="string">'Saving Log File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2377     
2378     logfile = get(handles.LogWindow,<span class="string">'string'</span>);
2379     [nrows,~]= size(logfile);
2380     fid = fopen(savefile, <span class="string">'w'</span>);
2381     <span class="keyword">for</span> row=1:nrows
2382         fprintf(fid, <span class="string">'%s \n'</span>, logfile{row,:});
2383     <span class="keyword">end</span>
2384     fclose(fid);
2385 <span class="keyword">end</span>
2386 <span class="comment">% [EOF] SaveLog_Callback</span>
2387 
2388 <span class="comment">%%%%%%%%%%%%%%%%</span>
2389 <span class="comment">% SUBFUNCTIONS %</span>
2390 <span class="comment">%%%%%%%%%%%%%%%%</span>
2391 
2392 <span class="comment">% --------------------------------------------------------------------</span>
2393 <a name="_sub85" href="#_subfunctions" class="code">function handles = buildToolbar(handles)</a>
2394 
2395 icons = <a href="#_sub101" class="code" title="subfunction icons = getIcons">getIcons</a>;
2396 ht = uitoolbar(<span class="string">'Parent'</span>,handles.figure1);
2397 
2398 <span class="comment">% Load data</span>
2399 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_open.png');</span>
2400 <span class="comment">% icon = double(icon)/(2^16-1);</span>
2401 <span class="comment">% icon(icon==0) = NaN;</span>
2402 handles.toolbarLoadData = <span class="keyword">...</span>
2403     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
2404     <span class="string">'CData'</span>,        icons(1).data, <span class="keyword">...</span>
2405     <span class="string">'TooltipString'</span>,<span class="string">'Open ASCII File'</span>);
2406 
2407 <span class="comment">% Save data</span>
2408 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_save.png');</span>
2409 <span class="comment">% icon = double(icon)/(2^16-1);</span>
2410 <span class="comment">% icon(icon==0) = NaN;</span>
2411 handles.toolbarSaveMatFile = <span class="keyword">...</span>
2412     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
2413     <span class="string">'CData'</span>,        icons(2).data, <span class="keyword">...</span>
2414     <span class="string">'TooltipString'</span>,<span class="string">'Save MAT File'</span>, <span class="keyword">...</span>
2415     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
2416 
2417 
2418 <span class="comment">% Save bathymetry</span>
2419 <span class="comment">%icon = ones(16,16,3);</span>
2420 handles.toolbarSaveBathymetry = <span class="keyword">...</span>
2421     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
2422     <span class="string">'CData'</span>,        icons(5).data, <span class="keyword">...</span>
2423     <span class="string">'TooltipString'</span>,<span class="string">'Export Bathymetry'</span>);
2424 
2425 <span class="comment">% Save figures</span>
2426 <span class="comment">% icon = ones(16,16,3);</span>
2427 handles.toolbarSaveFigures = <span class="keyword">...</span>
2428     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
2429     <span class="string">'CData'</span>,        icons(6).data, <span class="keyword">...</span>
2430     <span class="string">'TooltipString'</span>,<span class="string">'Export Figures'</span>);
2431 
2432 
2433 <span class="comment">% Plotting parameters</span>
2434 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\PlotGeneralElement.gif');</span>
2435 <span class="comment">% icon = ind2rgb(icon,map);</span>
2436 handles.toolbarPlottingParameters = <span class="keyword">...</span>
2437     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
2438     <span class="string">'CData'</span>,        icons(3).data, <span class="keyword">...</span>
2439     <span class="string">'TooltipString'</span>,<span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
2440     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
2441 
2442 <span class="comment">% Processing parameters</span>
2443 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
2444 <span class="comment">% icon = ind2rgb(icon,map);</span>
2445 handles.toolbarProcessingParameters = <span class="keyword">...</span>
2446     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
2447     <span class="string">'CData'</span>,        icons(4).data, <span class="keyword">...</span>
2448     <span class="string">'TooltipString'</span>,<span class="string">'Processing Parameters'</span>);
2449 
2450 <span class="comment">% % Plot 1: Shiptracks</span>
2451 <span class="comment">% handles.shiptracksPlot = ...</span>
2452 <span class="comment">%     uipushtool('Parent',       ht, ...</span>
2453 <span class="comment">%                'CData',        icon, ...</span>
2454 <span class="comment">%                'TooltipString','Shiptracks plot', ...</span>
2455 <span class="comment">%                'Separator',    'on');</span>
2456 <span class="comment">%</span>
2457 <span class="comment">% % Plot 2: Plan view</span>
2458 <span class="comment">% handles.planviewPlot = ...</span>
2459 <span class="comment">%     uipushtool('Parent',       ht, ...</span>
2460 <span class="comment">%                'CData',        icon, ...</span>
2461 <span class="comment">%                'TooltipString','Plan view plot');</span>
2462 <span class="comment">%</span>
2463 <span class="comment">% % Plot 3: Cross section</span>
2464 <span class="comment">% handles.crosssectionPlot = ...</span>
2465 <span class="comment">%     uipushtool('Parent',       ht, ...</span>
2466 <span class="comment">%                'CData',        icon, ...</span>
2467 <span class="comment">%                'TooltipString','Cross section plot');</span>
2468 
2469 set(handles.toolbarLoadData,            <span class="string">'ClickedCallback'</span>,{@<a href="#_sub44" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>,handles})
2470 set(handles.toolbarSaveMatFile,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub45" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>,handles})
2471 set(handles.toolbarSaveBathymetry,      <span class="string">'ClickedCallback'</span>,{@<a href="#_sub55" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>,handles})
2472 set(handles.toolbarSaveFigures,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub17" class="code" title="subfunction menuExportFigures_Callback(hObject, eventdata, handles)">menuExportFigures_Callback</a>,handles})
2473 set(handles.toolbarPlottingParameters,  <span class="string">'ClickedCallback'</span>,{@<a href="#_sub47" class="code" title="subfunction plottingParametersCallback(hObject, eventdata, handles)">plottingParametersCallback</a>,handles})
2474 set(handles.toolbarProcessingParameters,<span class="string">'ClickedCallback'</span>,{@<a href="#_sub48" class="code" title="subfunction processingParametersCallback(hObject, eventdata, handles)">processingParametersCallback</a>,handles})
2475 <span class="comment">% set(handles.shiptracksPlot,      'ClickedCallback',{@shiptracksPlotCallback,handles})</span>
2476 <span class="comment">% set(handles.planviewPlot,        'ClickedCallback',{@planviewPlotCallback,handles})</span>
2477 <span class="comment">% set(handles.crosssectionPlot,    'ClickedCallback',{@crosssectionPlotCallback,handles})</span>
2478 
2479 <span class="comment">% [EOF] buildtoolbar</span>
2480 
2481 
2482 <span class="comment">% --------------------------------------------------------------------</span>
2483 <a name="_sub86" href="#_subfunctions" class="code">function load_prefs(hfigure)</a>
2484 <span class="comment">% Load the GUI preferences.  Also, initialize preferences if they don't</span>
2485 <span class="comment">% already exist.</span>
2486 
2487 <span class="comment">% Preferences:</span>
2488 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
2489 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
2490 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
2491 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
2492 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
2493 <span class="comment">% 'log'                  Path and filename of last Log file</span>
2494 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
2495 
2496 <span class="comment">% Originals</span>
2497 <span class="comment">% prefs = {'ascii2gispath' 'ascii2kmlpath' 'asciipath'   'doqqpath' ...</span>
2498 <span class="comment">%          'endspath'      'logpath'       'matpath'     'savedpath' ...</span>
2499 <span class="comment">%          'shorepath'     'stapath'       'ysidatapath' 'ysidatapath'};</span>
2500 
2501 <span class="comment">% ASCII</span>
2502 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>)
2503     ascii = getpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>);
2504     <span class="keyword">if</span> exist(ascii.path,<span class="string">'dir'</span>)
2505         guiprefs.ascii_path = ascii.path;
2506     <span class="keyword">else</span>
2507         guiprefs.ascii_path = pwd;
2508     <span class="keyword">end</span>
2509     does_exist = false(1,length(ascii.file));
2510     <span class="keyword">for</span> k = 1:length(ascii.file) <span class="comment">% Check each file one-by-one</span>
2511         does_exist(k) = exist(fullfile(ascii.path,ascii.file{k}),<span class="string">'file'</span>);
2512     <span class="keyword">end</span>
2513     <span class="keyword">if</span> any(does_exist)
2514         guiprefs.ascii_file = ascii.file(does_exist);
2515     <span class="keyword">else</span>
2516         guiprefs.ascii_file = {<span class="string">''</span>};
2517     <span class="keyword">end</span>
2518 <span class="keyword">else</span> <span class="comment">% Initialize ASCII</span>
2519     guiprefs.ascii_path = pwd;
2520     guiprefs.ascii_file = {<span class="string">''</span>};
2521     
2522     ascii.path = pwd;
2523     ascii.file = {<span class="string">''</span>};
2524     setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
2525 <span class="keyword">end</span>
2526 
2527 <span class="comment">% MAT</span>
2528 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>)
2529     mat = getpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>);
2530     <span class="keyword">if</span> exist(mat.path,<span class="string">'dir'</span>)
2531         guiprefs.mat_path = mat.path;
2532     <span class="keyword">else</span>
2533         guiprefs.mat_path = pwd;
2534     <span class="keyword">end</span>
2535     
2536     <span class="keyword">if</span> iscell(mat.file)
2537         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file{1}),<span class="string">'file'</span>)
2538             guiprefs.mat_file = mat.file;
2539         <span class="keyword">else</span>
2540             guiprefs.mat_file = <span class="string">''</span>;
2541         <span class="keyword">end</span>
2542     <span class="keyword">else</span>
2543         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file),<span class="string">'file'</span>)
2544             guiprefs.mat_file = mat.file;
2545         <span class="keyword">else</span>
2546             guiprefs.mat_file = <span class="string">''</span>;
2547         <span class="keyword">end</span>
2548     <span class="keyword">end</span>
2549 <span class="keyword">else</span> <span class="comment">% Initialize MAT</span>
2550     guiprefs.mat_path = pwd;
2551     guiprefs.mat_file = <span class="string">''</span>;
2552     
2553     mat.path = pwd;
2554     mat.file = <span class="string">''</span>;
2555     setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
2556 <span class="keyword">end</span>
2557 
2558 <span class="comment">% TECPLOT</span>
2559 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>)
2560     tecplot = getpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>);
2561     <span class="keyword">if</span> exist(tecplot.path,<span class="string">'dir'</span>)
2562         guiprefs.tecplot_path = tecplot.path;
2563     <span class="keyword">else</span>
2564         guiprefs.tecplot_path = pwd;
2565     <span class="keyword">end</span>
2566     <span class="keyword">if</span> exist(fullfile(tecplot.path,tecplot.file),<span class="string">'file'</span>)
2567         guiprefs.tecplot_file = tecplot.file;
2568     <span class="keyword">else</span>
2569         guiprefs.tecplot_file = <span class="string">''</span>;
2570     <span class="keyword">end</span>
2571 <span class="keyword">else</span> <span class="comment">% Initialize TECPLOT</span>
2572     guiprefs.tecplot_path = pwd;
2573     guiprefs.tecplot_file = <span class="string">''</span>;
2574     
2575     tecplot.path = pwd;
2576     tecplot.file = <span class="string">''</span>;
2577     setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
2578 <span class="keyword">end</span>
2579 
2580 <span class="comment">% KMZ</span>
2581 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>)
2582     kmz = getpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>);
2583     <span class="keyword">if</span> exist(kmz.path,<span class="string">'dir'</span>)
2584         guiprefs.kmz_path = kmz.path;
2585     <span class="keyword">else</span>
2586         guiprefs.kmz_path = pwd;
2587     <span class="keyword">end</span>
2588     <span class="keyword">if</span> exist(fullfile(kmz.path,kmz.file),<span class="string">'file'</span>)
2589         guiprefs.kmz_file = kmz.file;
2590     <span class="keyword">else</span>
2591         guiprefs.kmz_file = <span class="string">''</span>;
2592     <span class="keyword">end</span>
2593 <span class="keyword">else</span> <span class="comment">% Initialize KMZ</span>
2594     guiprefs.kmz_path = pwd;
2595     guiprefs.kmz_file = <span class="string">''</span>;
2596     
2597     kmz.path = pwd;
2598     kmz.file = <span class="string">''</span>;
2599     setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
2600 <span class="keyword">end</span>
2601 
2602 <span class="comment">% MULTIBEAM BATHYMETRY</span>
2603 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>)
2604     multibeambathymetry = getpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>);
2605     <span class="keyword">if</span> exist(multibeambathymetry.path,<span class="string">'dir'</span>)
2606         guiprefs.multibeambathymetry_path = multibeambathymetry.path;
2607     <span class="keyword">else</span>
2608         guiprefs.multibeambathymetry_path = pwd;
2609     <span class="keyword">end</span>
2610     <span class="keyword">if</span> exist(fullfile(multibeambathymetry.path,multibeambathymetry.file),<span class="string">'file'</span>)
2611         guiprefs.multibeambathymetry_file = multibeambathymetry.file;
2612     <span class="keyword">else</span>
2613         guiprefs.multibeambathymetry_file = <span class="string">''</span>;
2614     <span class="keyword">end</span>
2615 <span class="keyword">else</span> <span class="comment">% Initialize MULTIBEAM BATHYMETRY</span>
2616     guiprefs.multibeambathymetry_path = pwd;
2617     guiprefs.multibeambathymetry_file = <span class="string">''</span>;
2618     
2619     multibeambathymetry.path = pwd;
2620     multibeambathymetry.file = <span class="string">''</span>;
2621     setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
2622 <span class="keyword">end</span>
2623 
2624 <span class="comment">% Log</span>
2625 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'log'</span>)
2626     log = getpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>);
2627     <span class="keyword">if</span> exist(log.path,<span class="string">'dir'</span>)
2628         guiprefs.log_path = log.path;
2629     <span class="keyword">else</span>
2630         guiprefs.log_path = pwd;
2631     <span class="keyword">end</span>
2632     <span class="keyword">if</span> exist(fullfile(log.path,log.file),<span class="string">'file'</span>)
2633         guiprefs.log_file = log.file;
2634     <span class="keyword">else</span>
2635         guiprefs.log_file = <span class="string">''</span>;
2636     <span class="keyword">end</span>
2637 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
2638     guiprefs.log_path = pwd;
2639     guiprefs.log_file = <span class="string">''</span>;
2640     
2641     log.path = pwd;
2642     log.file = <span class="string">''</span>;
2643     setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
2644 <span class="keyword">end</span>
2645 
2646 <span class="comment">% iRic</span>
2647 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>)
2648     iric = getpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>);
2649     <span class="keyword">if</span> exist(iric.path,<span class="string">'dir'</span>)
2650         guiprefs.iric_path = iric.path;
2651     <span class="keyword">else</span>
2652         guiprefs.iric_path = pwd;
2653     <span class="keyword">end</span>
2654     <span class="keyword">if</span> exist(fullfile(iric.path,iric.file),<span class="string">'file'</span>)
2655         guiprefs.iric_file = iric.file;
2656     <span class="keyword">else</span>
2657         guiprefs.iric_file = <span class="string">''</span>;
2658     <span class="keyword">end</span>
2659 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
2660     guiprefs.iric_path = pwd;
2661     guiprefs.iric_file = <span class="string">''</span>;
2662     
2663     iric.path = pwd;
2664     iric.file = <span class="string">''</span>;
2665     setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
2666 <span class="keyword">end</span>
2667 
2668 <span class="comment">% guiprefs.presentation = true;</span>
2669 <span class="comment">% guiprefs.print        = false;</span>
2670 
2671 <span class="comment">% for k = 1:length(prefs)</span>
2672 <span class="comment">%     newpref = '';</span>
2673 <span class="comment">%     if ispref('VMT',prefs{k})</span>
2674 <span class="comment">%         stored_newpref = getpref('VMT',prefs{k});</span>
2675 <span class="comment">%         if exist(stored_newpref,'dir')</span>
2676 <span class="comment">%             newpref = stored_newpref;</span>
2677 <span class="comment">%         else</span>
2678 <span class="comment">%             setpref('VMT',prefs{k},newpref)</span>
2679 <span class="comment">%         end</span>
2680 <span class="comment">%     end</span>
2681 <span class="comment">%     guiprefs.(prefs{k}) = newpref;</span>
2682 <span class="comment">% end</span>
2683 
2684 setappdata(hfigure,<span class="string">'guiprefs'</span>,guiprefs)
2685 
2686 <span class="comment">% [EOF] load_prefs</span>
2687 
2688 
2689 <span class="comment">% --------------------------------------------------------------------</span>
2690 <a name="_sub87" href="#_subfunctions" class="code">function store_prefs(hfigure,pref)</a>
2691 <span class="comment">% Store preferences in the Application data and in the persistent</span>
2692 <span class="comment">% preferences data.</span>
2693 
2694 <span class="comment">% Preferences:</span>
2695 <span class="comment">% 'ascii'               Path and filenames of current ASCII files</span>
2696 <span class="comment">% 'mat'                 Path and filename of current MAT file</span>
2697 <span class="comment">% 'tecplot'             Path and filename of last Tecplot file</span>
2698 <span class="comment">% 'kmz'                 Path and filename of last KMZ file</span>
2699 <span class="comment">% 'multibeambathymetry' Path and filename of last Multibeam Bathymetry file</span>
2700 <span class="comment">% 'log'                 Path and filename of last Log file</span>
2701 
2702 guiprefs = getappdata(hfigure,<span class="string">'guiprefs'</span>);
2703 
2704 <span class="keyword">switch</span> pref
2705     <span class="keyword">case</span> <span class="string">'ascii'</span>
2706         ascii.path = guiprefs.ascii_path;
2707         ascii.file = guiprefs.ascii_file;
2708         setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
2709     <span class="keyword">case</span> <span class="string">'mat'</span>
2710         mat.path = guiprefs.mat_path;
2711         mat.file = guiprefs.mat_file;
2712         setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
2713     <span class="keyword">case</span> <span class="string">'tecplot'</span>
2714         tecplot.path = guiprefs.tecplot_path;
2715         tecplot.file = guiprefs.tecplot_file;
2716         setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
2717     <span class="keyword">case</span> <span class="string">'kmz'</span>
2718         kmz.path = guiprefs.kmz_path;
2719         kmz.file = guiprefs.kmz_file;
2720         setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
2721     <span class="keyword">case</span> <span class="string">'multibeambathymetry'</span>
2722         multibeambathymetry.path = guiprefs.multibeambathymetry_path;
2723         multibeambathymetry.file = guiprefs.multibeambathymetry_file;
2724         setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
2725     <span class="keyword">case</span> <span class="string">'log'</span>
2726         log.path = guiprefs.log_path;
2727         log.file = guiprefs.log_file;
2728         setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
2729     <span class="keyword">otherwise</span>
2730 <span class="keyword">end</span>
2731 
2732 <span class="comment">% if ismember(pref,prefs)</span>
2733 <span class="comment">%     setpref('VMT',pref,value)</span>
2734 <span class="comment">%</span>
2735 <span class="comment">%     guiprefs = getappdata(hfigure,'guiprefs');</span>
2736 <span class="comment">%     guiprefs.(pref) = value;</span>
2737 <span class="comment">%     setappdata(hfigure,'guiprefs',guiprefs)</span>
2738 <span class="comment">% end</span>
2739 
2740 <span class="comment">% [EOF] store_prefs</span>
2741 
2742 
2743 <span class="comment">% --------------------------------------------------------------------</span>
2744 <a name="_sub88" href="#_subfunctions" class="code">function initGUI(handles)</a>
2745 <span class="comment">% Initialize the UI controls in the GUI.</span>
2746 
2747 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2748 
2749 <span class="comment">% Set the name and version</span>
2750 set(handles.figure1,<span class="string">'Name'</span>,[<span class="string">'Velocity Mapping Toolbox (VMT) '</span> guiparams.vmt_version], <span class="keyword">...</span>
2751     <span class="string">'DockControls'</span>,<span class="string">'off'</span>)
2752 <span class="comment">%set(handles.VMTversion,             'String',guiparams.vmt_version)</span>
2753 
2754 <span class="comment">% Set the PLOT 1 axis labels</span>
2755 axes(handles.Plot1Shiptracks);
2756 set(handles.Plot1Shiptracks,<span class="string">'DataAspectRatio'</span>,[1 1 1],<span class="string">'PlotBoxAspectRatio'</span>,[1 1 1])
2757 xlabel(<span class="string">'UTM Easting (m)'</span>)
2758 ylabel(<span class="string">'UTM Northing (m)'</span>)
2759 box on
2760 grid on
2761 <span class="comment">% ticks_format('%6.0f','%8.0f'); %formats the ticks for UTM</span>
2762 
2763 <span class="comment">%%%%%%%%%%%%</span>
2764 <span class="comment">% MENU BAR %</span>
2765 <span class="comment">%%%%%%%%%%%%</span>
2766 <span class="keyword">if</span> guiparams.english_units
2767     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
2768     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
2769 <span class="keyword">else</span>
2770     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
2771     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
2772 <span class="keyword">end</span>
2773 
2774 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
2775     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
2776     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
2777 <span class="keyword">else</span>
2778     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
2779     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
2780 <span class="keyword">end</span>
2781 
2782 
2783 <span class="keyword">if</span> guiparams.print
2784     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
2785     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
2786     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
2787     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
2788 <span class="keyword">elseif</span> guiparams.presentation
2789     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
2790     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
2791     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
2792     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
2793 <span class="keyword">else</span>
2794 <span class="keyword">end</span>
2795 
2796 
2797 <span class="comment">%%%%%%%%%%%%%%%</span>
2798 <span class="comment">% DATA EXPORT %</span>
2799 <span class="comment">%%%%%%%%%%%%%%%</span>
2800 <span class="comment">% BathymetryPanel</span>
2801 <span class="comment">% set(handles.BeamAngle,                  'String',guiparams.beam_angle)</span>
2802 <span class="comment">% set(handles.MagneticVariation,          'String',guiparams.magnetic_variation)</span>
2803 <span class="comment">% set(handles.WSE,                        'String',guiparams.wse)</span>
2804 <span class="comment">% set(handles.OutputAuxiliaryData,        'Value', guiparams.output_auxiliary_data)</span>
2805 
2806 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
2807 <span class="comment">% PLOTTING/PLAN VIEW %</span>
2808 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
2809 <span class="comment">% PlanViewPanel</span>
2810 set(handles.DepthRangeMin,              <span class="string">'String'</span>,guiparams.depth_range_min)
2811 set(handles.DepthRangeMax,              <span class="string">'String'</span>,guiparams.depth_range_max)
2812 set(handles.VectorScalePlanView,        <span class="string">'String'</span>,guiparams.vector_scale_plan_view)
2813 set(handles.VectorSpacingPlanview,      <span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
2814 set(handles.SmoothingWindowSize,        <span class="string">'String'</span>,guiparams.smoothing_window_size)
2815 set(handles.MapDepthAveragedVelocities, <span class="string">'Value'</span>, guiparams.map_depth_averaged_velocities)
2816 set(handles.DisplayShoreline,           <span class="string">'Value'</span>, guiparams.display_shoreline)
2817 set(handles.AddBackground,              <span class="string">'Value'</span>, guiparams.add_background)
2818 
2819 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
2820 <span class="comment">% PLOTTING/SHIP TRACKS %</span>
2821 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
2822 <span class="comment">% ShiptracksPanel</span>
2823 set(handles.HorizontalGridNodeSpacing,  <span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
2824 <span class="comment">%set(handles.SetCrossSectionEndpoints,   'Value', guiparams.set_cross_section_endpoints)</span>
2825 
2826 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2827 <span class="comment">% PLOTTING/CROSS SECTIONS %</span>
2828 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2829 <span class="comment">% CrossSectionsPanel</span>
2830 set(handles.Contour,                    <span class="string">'String'</span>,{guiparams.contours.string}, <span class="keyword">...</span>
2831     <span class="string">'Value'</span>, guiparams.idx_contour)
2832 set(handles.VerticalExaggeration,       <span class="string">'String'</span>,guiparams.vertical_exaggeration)
2833 set(handles.VectorScaleCrossSection,    <span class="string">'String'</span>,guiparams.vector_scale_cross_section)
2834 set(handles.HorizontalVectorSpacing,    <span class="string">'String'</span>,guiparams.horizontal_vector_spacing)
2835 set(handles.VerticalVectorSpacing,      <span class="string">'String'</span>,guiparams.vertical_vector_spacing)
2836 set(handles.HorizontalSmoothingWindow,  <span class="string">'String'</span>,guiparams.horizontal_smoothing_window)
2837 set(handles.VerticalSmoothingWindow,    <span class="string">'String'</span>,guiparams.vertical_smoothing_window)
2838 set(handles.PlotSecondaryFlowVectors,   <span class="string">'Value'</span>, guiparams.plot_secondary_flow_vectors)
2839 set(handles.SecondaryFlowVectorVariable,<span class="string">'String'</span>,{guiparams.secondary_flows.string}, <span class="keyword">...</span>
2840     <span class="string">'Value'</span>, guiparams.idx_secondary_flow_vector_variable)
2841 set(handles.IncludeVerticalVelocity,    <span class="string">'Value'</span>, guiparams.include_vertical_velocity)
2842 
2843 <span class="comment">% set(handles.EnglishUnits,               'Value',guiparams.english_units)</span>
2844 
2845 <span class="comment">% [EOF] initGUI</span>
2846 
2847 
2848 <span class="comment">% --------------------------------------------------------------------</span>
2849 <a name="_sub89" href="#_subfunctions" class="code">function set_enable(handles,enable_state)</a>
2850 
2851 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2852 
2853 <span class="keyword">switch</span> enable_state
2854     <span class="keyword">case</span> <span class="string">'init'</span>
2855         set([handles.menuFile
2856             handles.menuOpen
2857             handles.menuOpenASCII
2858             handles.menuOpenMAT
2859             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
2860         
2861         set([handles.toolbarLoadData
2862             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
2863         set([handles.toolbarSaveMatFile
2864             handles.toolbarSaveBathymetry
2865             handles.toolbarSaveFigures
2866             handles.toolbarPlottingParameters
2867             handles.toolbarProcessingParameters
2868             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
2869         
2870         set([handles.DepthRangeMin
2871             handles.DepthRangeMax
2872             handles.VectorScalePlanView
2873             handles.VectorSpacingPlanview
2874             handles.SmoothingWindowSize
2875             handles.MapDepthAveragedVelocities
2876             handles.DisplayShoreline
2877             handles.AddBackground
2878             handles.PlotPlanView
2879             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
2880         
2881         set([handles.HorizontalGridNodeSpacing
2882             handles.PlotShiptracks
2883             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
2884         
2885         set([handles.Contour
2886             handles.VerticalExaggeration
2887             handles.VectorScaleCrossSection
2888             handles.HorizontalVectorSpacing
2889             handles.VerticalVectorSpacing
2890             handles.HorizontalSmoothingWindow
2891             handles.VerticalSmoothingWindow
2892             handles.PlotSecondaryFlowVectors
2893             handles.SecondaryFlowVectorVariable
2894             handles.IncludeVerticalVelocity
2895             handles.PlotCrossSection
2896             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
2897         
2898     <span class="keyword">case</span> <span class="string">'fileloaded'</span>
2899         set([handles.menuFile
2900             handles.menuOpen
2901             handles.menuOpenASCII
2902             handles.menuOpenMAT
2903             handles.menuSaveMAT
2904             handles.menuSaveTecplot
2905             handles.menuSaveKMZFile
2906             handles.menuParameters
2907             handles.menuPlottingParameters
2908             handles.menuMetric
2909             handles.menuEnglish
2910             handles.menuBathymetryExportSettings
2911             handles.menuExportMultibeamBathymetry
2912             handles.menuKMZExport
2913             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
2914         
2915         set([handles.toolbarLoadData
2916             handles.toolbarSaveMatFile
2917             handles.toolbarSaveBathymetry
2918             handles.toolbarSaveFigures
2919             handles.toolbarPlottingParameters
2920             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
2921         set([handles.toolbarProcessingParameters
2922             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
2923         
2924            
2925         set([handles.DepthRangeMin
2926             handles.DepthRangeMax
2927             handles.VectorScalePlanView
2928             handles.VectorSpacingPlanview
2929             handles.SmoothingWindowSize
2930             handles.MapDepthAveragedVelocities
2931             handles.DisplayShoreline
2932             handles.PlotPlanView
2933             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
2934         <span class="keyword">if</span> guiparams.has_mapping_toolbox
2935             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
2936         <span class="keyword">else</span>
2937             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
2938         <span class="keyword">end</span>
2939         
2940         set([handles.HorizontalGridNodeSpacing
2941             handles.PlotShiptracks
2942             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
2943         
2944         set([handles.Contour
2945             handles.VerticalExaggeration
2946             handles.VectorScaleCrossSection
2947             handles.HorizontalVectorSpacing
2948             handles.VerticalVectorSpacing
2949             handles.HorizontalSmoothingWindow
2950             handles.VerticalSmoothingWindow
2951             handles.PlotSecondaryFlowVectors
2952             handles.SecondaryFlowVectorVariable
2953             handles.IncludeVerticalVelocity
2954             handles.PlotCrossSection
2955             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
2956     <span class="keyword">case</span> <span class="string">'multiplematfiles'</span>
2957         set([handles.menuFile
2958             handles.menuOpen
2959             handles.menuOpenASCII
2960             handles.menuOpenMAT
2961             handles.menuParameters
2962             handles.menuPlottingParameters
2963             handles.menuMetric
2964             handles.menuEnglish
2965             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
2966         set([handles.menuSaveMAT
2967             handles.menuBathymetryExportSettings
2968             handles.menuExportMultibeamBathymetry
2969             handles.menuKMZExport
2970             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
2971         
2972         set([handles.toolbarLoadData
2973             handles.toolbarSaveFigures
2974             handles.toolbarPlottingParameters
2975             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
2976         set([handles.toolbarProcessingParameters
2977             handles.toolbarSaveMatFile
2978             handles.toolbarSaveBathymetry
2979             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
2980         
2981         set([handles.DepthRangeMin
2982             handles.DepthRangeMax
2983             handles.VectorScalePlanView
2984             handles.VectorSpacingPlanview
2985             handles.SmoothingWindowSize
2986             handles.MapDepthAveragedVelocities
2987             handles.DisplayShoreline
2988             handles.PlotPlanView
2989             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
2990         <span class="keyword">if</span> guiparams.has_mapping_toolbox
2991             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
2992         <span class="keyword">else</span>
2993             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
2994         <span class="keyword">end</span>
2995         
2996         set([handles.HorizontalGridNodeSpacing
2997             handles.PlotShiptracks
2998             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
2999         
3000         set([handles.Contour
3001             handles.VerticalExaggeration
3002             handles.VectorScaleCrossSection
3003             handles.HorizontalVectorSpacing
3004             handles.VerticalVectorSpacing
3005             handles.HorizontalSmoothingWindow
3006             handles.VerticalSmoothingWindow
3007             handles.PlotSecondaryFlowVectors
3008             handles.SecondaryFlowVectorVariable
3009             handles.IncludeVerticalVelocity
3010             handles.PlotCrossSection
3011             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3012     <span class="keyword">otherwise</span>
3013 <span class="keyword">end</span>
3014 
3015 <span class="comment">% Temporary</span>
3016 set(handles.MapDepthAveragedVelocities,<span class="string">'Value'</span>,0,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3017 
3018 <span class="comment">% [EOF] set_enable</span>
3019 
3020 <span class="comment">%% Compute the longitudinal dispersion coefficient</span>
3021 
3022 <span class="comment">%% --- Executes on button press in zerosecq_chkbox.</span>
3023 <span class="comment">%function zerosecq_chkbox_Callback(hObject, eventdata, handles)</span>
3024 <span class="comment">% hObject    handle to zerosecq_chkbox (see GCBO)</span>
3025 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
3026 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
3027 
3028 <span class="comment">% Hint: get(hObject,'Value') returns toggle state of zerosecq_chkbox</span>
3029 
3030 
3031 <span class="comment">% --------------------------------------------------------------------</span>
3032 <a name="_sub90" href="#_subfunctions" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] = </a><span class="keyword">...</span>
3033     plotParametersDialog(english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style,hf)
3034 
3035 w = 500;
3036 h = 110;
3037 dx = 10;
3038 dy = 35;
3039 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
3040 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
3041     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
3042     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
3043     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
3044     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
3045     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
3046     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
3047     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3048     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
3049     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
3050     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
3051 dialog_params.english_units               = english_units;
3052 dialog_params.set_cross_section_endpoints = set_cross_section_endpoints;
3053 dialog_params.presentation                = plot_presentation_style; <span class="comment">%presentation;</span>
3054 dialog_params.print                       = plot_print_style; <span class="comment">%print;</span>
3055 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3056 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
3057 
3058 <span class="comment">% Build the graphics:</span>
3059 <span class="comment">% -------------------</span>
3060 handles.UnitsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
3061     <span class="string">'Title'</span>, <span class="string">'Units'</span>, <span class="keyword">...</span>
3062     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3063     <span class="string">'Position'</span>,[dx dy (w-3*dx)/3 h-dx-dy+10]);
3064 handles.UnitsMetric = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3065     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
3066     <span class="string">'String'</span>,<span class="string">'Metric'</span>, <span class="keyword">...</span>
3067     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3068     <span class="string">'Position'</span>,[15 35 100 22]);
3069 handles.UnitsEnglish = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3070     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
3071     <span class="string">'String'</span>,<span class="string">'English'</span>, <span class="keyword">...</span>
3072     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3073     <span class="string">'Position'</span>,[15 10 100 22]);
3074 
3075 handles.EndpointsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
3076     <span class="string">'Title'</span>, <span class="string">'Cross-Section Endpoints'</span>, <span class="keyword">...</span>
3077     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3078     <span class="string">'Position'</span>,[(w+dx)/3 dy (w-3*dx)/3 h-dx-dy+10]);
3079 handles.EndpointsAutomatic = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3080     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
3081     <span class="string">'String'</span>,<span class="string">'Automatic'</span>, <span class="keyword">...</span>
3082     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3083     <span class="string">'Position'</span>,[15 35 100 22]);
3084 handles.EndpointsManual = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3085     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
3086     <span class="string">'String'</span>,<span class="string">'Set Manually'</span>, <span class="keyword">...</span>
3087     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3088     <span class="string">'Position'</span>,[15 10 100 22]);
3089 
3090 handles.StylePanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
3091     <span class="string">'Title'</span>, <span class="string">'Plot Style'</span>, <span class="keyword">...</span>
3092     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3093     <span class="string">'Position'</span>,[w-w/3 dy (w-3*dx)/3 h-dx-dy+10]);
3094 handles.StylePresentation = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3095     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
3096     <span class="string">'String'</span>,<span class="string">'Presentation'</span>, <span class="keyword">...</span>
3097     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3098     <span class="string">'Position'</span>,[15 35 100 22]);
3099 handles.StylePrint = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3100     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
3101     <span class="string">'String'</span>,<span class="string">'Print'</span>, <span class="keyword">...</span>
3102     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3103     <span class="string">'Position'</span>,[15 10 100 22]);
3104 
3105 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
3106     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
3107     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
3108     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
3109     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
3110 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
3111     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
3112     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
3113     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
3114     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
3115 
3116 <span class="comment">% Update the UI controls:</span>
3117 <span class="comment">% -----------------------</span>
3118 <span class="keyword">if</span> dialog_params.english_units
3119     set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
3120     set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
3121 <span class="keyword">else</span>
3122     set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
3123     set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
3124 <span class="keyword">end</span>
3125 <span class="keyword">if</span> dialog_params.set_cross_section_endpoints
3126     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
3127     set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
3128 <span class="keyword">else</span>
3129     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
3130     set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
3131 <span class="keyword">end</span>
3132 <span class="keyword">if</span> dialog_params.presentation
3133     set(handles.StylePresentation, <span class="string">'Value'</span>,1)
3134     set(handles.StylePrint,        <span class="string">'Value'</span>,0)
3135 <span class="keyword">else</span>
3136     set(handles.StylePresentation, <span class="string">'Value'</span>,0)
3137     set(handles.StylePrint,        <span class="string">'Value'</span>,1)
3138 <span class="keyword">end</span>
3139 
3140 <span class="comment">% Set the callbacks:</span>
3141 <span class="comment">% ------------------</span>
3142 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub96" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
3143 set(handles.UnitsMetric,       <span class="string">'Callback'</span>,       {@<a href="#_sub91" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'metric'</span>})
3144 set(handles.UnitsEnglish,      <span class="string">'Callback'</span>,       {@<a href="#_sub91" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'english'</span>})
3145 set(handles.EndpointsAutomatic,<span class="string">'Callback'</span>,       {@<a href="#_sub92" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'auto'</span>})
3146 set(handles.EndpointsManual,   <span class="string">'Callback'</span>,       {@<a href="#_sub92" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'manual'</span>})
3147 set(handles.StylePresentation, <span class="string">'Callback'</span>,       {@<a href="#_sub93" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'presentation'</span>})
3148 set(handles.StylePrint,        <span class="string">'Callback'</span>,       {@<a href="#_sub93" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'print'</span>})
3149 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub94" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
3150 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub95" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
3151 
3152 <span class="comment">% Position the dialog and make it visible:</span>
3153 <span class="comment">% ----------------------------------------</span>
3154 fpos = get(hf,<span class="string">'Position'</span>);
3155 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
3156 movegui(handles.Figure,dpos)
3157 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
3158 
3159 <span class="comment">% Hold the dialog open:</span>
3160 <span class="comment">% ---------------------</span>
3161 waitfor(handles.OK)
3162 
3163 <span class="comment">% Return the outputs and close the dialog:</span>
3164 <span class="comment">% ----------------------------------------</span>
3165 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3166 english_units = dialog_params.english_units;
3167 set_cross_section_endpoints = dialog_params.set_cross_section_endpoints;
3168 plot_presentation_style =  dialog_params.presentation;
3169 plot_print_style =  dialog_params.print;
3170 
3171 delete(handles.Figure)
3172 
3173 <span class="comment">% [EOF] plotParametersDialog</span>
3174 
3175 
3176 <span class="comment">% --------------------------------------------------------------------</span>
3177 <a name="_sub91" href="#_subfunctions" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a>
3178 
3179 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3180 <span class="keyword">switch</span> the_units
3181     <span class="keyword">case</span> <span class="string">'metric'</span>
3182         dialog_params.english_units = false;
3183         
3184         set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
3185         set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
3186     <span class="keyword">case</span> <span class="string">'english'</span>
3187         dialog_params.english_units = true;
3188         
3189         set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
3190         set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
3191     <span class="keyword">otherwise</span>
3192 <span class="keyword">end</span>
3193 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3194 
3195 <span class="comment">% [EOF] dialogUnits</span>
3196 
3197 <span class="comment">% --------------------------------------------------------------------</span>
3198 <a name="_sub92" href="#_subfunctions" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a>
3199 
3200 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3201 <span class="keyword">switch</span> the_endpoints
3202     <span class="keyword">case</span> <span class="string">'auto'</span>
3203         dialog_params.set_cross_section_endpoints = false;
3204         
3205         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
3206         set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
3207     <span class="keyword">case</span> <span class="string">'manual'</span>
3208         dialog_params.set_cross_section_endpoints = true;
3209         
3210         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
3211         set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
3212     <span class="keyword">otherwise</span>
3213 <span class="keyword">end</span>
3214 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3215 
3216 <span class="comment">% [EOF] dialogEnpoints</span>
3217 
3218 <a name="_sub93" href="#_subfunctions" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a>
3219 
3220 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3221 <span class="keyword">switch</span> the_style
3222     <span class="keyword">case</span> <span class="string">'presentation'</span>
3223         dialog_params.presentation  = true;
3224         dialog_params.print         = false;
3225         
3226         set(handles.StylePresentation,<span class="string">'Value'</span>,1)
3227         set(handles.StylePrint,       <span class="string">'Value'</span>,0)
3228     <span class="keyword">case</span> <span class="string">'print'</span>
3229         dialog_params.presentation  = false;
3230         dialog_params.print         = true;
3231         
3232         set(handles.StylePresentation,<span class="string">'Value'</span>,0)
3233         set(handles.StylePrint,       <span class="string">'Value'</span>,1)
3234     <span class="keyword">otherwise</span>
3235 <span class="keyword">end</span>
3236 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3237 
3238 <span class="comment">% [EOF] dialogEnpoints</span>
3239 
3240 <span class="comment">% --------------------------------------------------------------------</span>
3241 <a name="_sub94" href="#_subfunctions" class="code">function dialogOK(hObject,eventdata,h_OK)</a>
3242 
3243 delete(h_OK)
3244 
3245 <span class="comment">% [EOF] dialogOK</span>
3246 
3247 <span class="comment">% --------------------------------------------------------------------</span>
3248 <a name="_sub95" href="#_subfunctions" class="code">function dialogCancel(hObject,eventdata,handles)</a>
3249 <span class="comment">% Return the original inputs</span>
3250 dialog_params = getappdata(handles.Figure,<span class="string">'original_dialog_params'</span>);
3251 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3252 delete(handles.OK)
3253 
3254 <span class="comment">% [EOF] dialogCancel</span>
3255 
3256 <span class="comment">% --------------------------------------------------------------------</span>
3257 <a name="_sub96" href="#_subfunctions" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a>
3258 
3259 delete(h_OK)
3260 
3261 <span class="comment">% [EOF] dialogCloseReq</span>
3262 
3263 <a name="_sub97" href="#_subfunctions" class="code">function [beam_angle,magnetic_variation,wse,output_auxilliary_data] = exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxilliary_data,hf)</a>
3264 w = 230;
3265 h = 200;
3266 dx = 10;
3267 dy = 35;
3268 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
3269 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Export Settings'</span>, <span class="keyword">...</span>
3270     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
3271     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
3272     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
3273     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
3274     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
3275     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
3276     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3277     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
3278     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
3279     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
3280 dialog_params.beam_angle             = beam_angle;
3281 dialog_params.magnetic_variation     = magnetic_variation;
3282 dialog_params.wse                    = wse;
3283 dialog_params.output_auxilliary_data = output_auxilliary_data;
3284 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3285 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
3286 
3287 <span class="comment">% Build the graphics:</span>
3288 <span class="comment">% -------------------</span>
3289 ph = 150;
3290 handles.BathymetryPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
3291     <span class="string">'Title'</span>, <span class="string">'Bathymetry'</span>, <span class="keyword">...</span>
3292     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3293     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
3294 handles.BeamAngleText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
3295     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
3296     <span class="string">'String'</span>,<span class="string">'Beam Angle (deg)'</span>, <span class="keyword">...</span>
3297     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
3298     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
3299     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3300     <span class="string">'Position'</span>,[dx+5 h-ph+60-4 100 22]);
3301 handles.BeamAngle = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
3302     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
3303     <span class="keyword">...</span><span class="comment">'String','Beam Angle (deg)', ...</span>
3304     <span class="string">'String'</span>,beam_angle,<span class="keyword">...</span>
3305     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
3306     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3307     <span class="string">'Position'</span>,[w-dx-80 h-ph+60 50 22]);
3308 handles.MagneticVariationText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
3309     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
3310     <span class="string">'String'</span>,<span class="string">'Magnetic Variation'</span>, <span class="keyword">...</span>
3311     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
3312     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
3313     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3314     <span class="string">'Position'</span>,[dx+5 h-ph+30-4 100 22]);
3315 handles.MagneticVariation = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
3316     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
3317     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
3318     <span class="string">'String'</span>,magnetic_variation,<span class="keyword">...</span>
3319     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
3320     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3321     <span class="string">'Position'</span>,[w-dx-80 h-ph+30 50 22]);
3322 handles.WSEText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
3323     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
3324     <span class="string">'String'</span>,<span class="string">'WSE (m)'</span>, <span class="keyword">...</span>
3325     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
3326     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
3327     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3328     <span class="string">'Position'</span>,[dx+5 h-ph-4 100 22]);
3329 handles.WSE = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
3330     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
3331     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
3332     <span class="string">'String'</span>,wse,<span class="keyword">...</span>
3333     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
3334     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3335     <span class="string">'Position'</span>,[w-dx-80 h-ph 50 22]);
3336 handles.OutputAuxilliaryData = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3337     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
3338     <span class="string">'String'</span>,<span class="string">'Output Auxilliary Data'</span>, <span class="keyword">...</span>
3339     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3340     <span class="string">'Position'</span>,[dx+5 20 w-2*dx-30 22]);
3341 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
3342     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
3343     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
3344     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
3345     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
3346 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
3347     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
3348     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
3349     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
3350     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
3351 
3352 <span class="comment">% Update the UI controls:</span>
3353 <span class="comment">% -----------------------</span>
3354 set(handles.BeamAngle,                <span class="string">'String'</span>,dialog_params.beam_angle)
3355 set(handles.MagneticVariation,        <span class="string">'String'</span>,dialog_params.magnetic_variation)
3356 set(handles.WSE,                      <span class="string">'String'</span>,dialog_params.wse)
3357 set(handles.OutputAuxilliaryData,     <span class="string">'Value'</span>,dialog_params.output_auxilliary_data)
3358 
3359 <span class="comment">% Set the callbacks:</span>
3360 <span class="comment">% ------------------</span>
3361 set(handles.Figure,                      <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub96" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
3362 set(handles.BeamAngle,                   <span class="string">'Callback'</span>,       {@<a href="#_sub98" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
3363 set(handles.MagneticVariation,           <span class="string">'Callback'</span>,       {@<a href="#_sub98" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
3364 set(handles.WSE,                         <span class="string">'Callback'</span>,       {@<a href="#_sub98" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
3365 set(handles.OutputAuxilliaryData,        <span class="string">'Callback'</span>,       {@<a href="#_sub98" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
3366 set(handles.OK,                          <span class="string">'Callback'</span>,       {@<a href="#_sub94" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,      handles.OK})
3367 set(handles.Cancel,                      <span class="string">'Callback'</span>,       {@<a href="#_sub95" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,  handles})
3368 
3369 <span class="comment">% Position the dialog and make it visible:</span>
3370 <span class="comment">% ----------------------------------------</span>
3371 fpos = get(hf,<span class="string">'Position'</span>);
3372 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
3373 movegui(handles.Figure,dpos)
3374 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
3375 
3376 <span class="comment">% Hold the dialog open:</span>
3377 <span class="comment">% ---------------------</span>
3378 waitfor(handles.OK)
3379 
3380 <span class="comment">% Return the outputs and close the dialog:</span>
3381 <span class="comment">% ----------------------------------------</span>
3382 dialog_params           = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3383 beam_angle              = dialog_params.beam_angle;
3384 magnetic_variation      = dialog_params.magnetic_variation;
3385 wse                     = dialog_params.wse;
3386 output_auxilliary_data  = dialog_params.output_auxilliary_data;
3387 
3388 delete(handles.Figure)
3389 
3390 <span class="comment">% [EOF] exportSettingsDialog</span>
3391 
3392 <span class="comment">% --------------------------------------------------------------------</span>
3393 <a name="_sub98" href="#_subfunctions" class="code">function dialogExportSettings(hObject,eventdata,handles)</a>
3394 
3395 <span class="comment">% Grab the current data</span>
3396 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3397 
3398 <span class="comment">% Set it according to the dialog box values</span>
3399 dialog_params.beam_angle                = get(handles.BeamAngle,<span class="string">'String'</span>);
3400 dialog_params.magnetic_variation        = get(handles.MagneticVariation,<span class="string">'String'</span>);
3401 dialog_params.wse                       = get(handles.WSE,<span class="string">'String'</span>);
3402 dialog_params.output_auxilliary_data    = get(handles.OutputAuxilliaryData,<span class="string">'Value'</span>);
3403 
3404 <span class="comment">% Re-store the application data</span>
3405 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3406 
3407 <span class="comment">% [EOF] dialogExportSettings</span>
3408 
3409 <a name="_sub99" href="#_subfunctions" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a>
3410 
3411 w = 230;
3412 h = 200;
3413 dx = 10;
3414 dy = 35;
3415 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
3416 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Select open figures to export'</span>, <span class="keyword">...</span>
3417     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
3418     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
3419     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
3420     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
3421     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
3422     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
3423     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3424     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
3425     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
3426     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
3427 dialog_params.figure_names               = figure_names;
3428 dialog_params.selected_figures           = <span class="string">''</span>;
3429 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3430 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
3431 
3432 <span class="comment">% Build the graphics:</span>
3433 <span class="comment">% -------------------</span>
3434 handles.ListboxPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
3435     <span class="string">'Title'</span>, <span class="string">'Figures'</span>, <span class="keyword">...</span>
3436     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3437     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
3438 handles.Figures = uicontrol(<span class="string">'Style'</span>,<span class="string">'listbox'</span>, <span class="keyword">...</span>
3439     <span class="string">'Parent'</span>,handles.ListboxPanel, <span class="keyword">...</span>
3440     <span class="string">'BackGroundColor'</span>,<span class="string">'white'</span>,<span class="keyword">...</span>
3441     <span class="string">'String'</span>,figure_names, <span class="keyword">...</span>
3442     <span class="string">'Min'</span>, 0,<span class="keyword">...</span>
3443     <span class="string">'Max'</span>, 2,<span class="keyword">...</span>
3444     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3445     <span class="string">'Position'</span>,[15 35 (w-5*dx) 100]);
3446 
3447 
3448 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
3449     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
3450     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
3451     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
3452     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
3453 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
3454     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
3455     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
3456     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
3457     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
3458 
3459 <span class="comment">% Update the UI controls:</span>
3460 <span class="comment">% -----------------------</span>
3461 
3462 
3463 <span class="comment">% Set the callbacks:</span>
3464 <span class="comment">% ------------------</span>
3465 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub96" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
3466 set(handles.Figures,           <span class="string">'Callback'</span>,       {@<a href="#_sub100" class="code" title="subfunction dialogSelectFigures(hObject,eventdata,handles)">dialogSelectFigures</a>    handles})
3467 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub94" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
3468 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub95" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
3469 
3470 <span class="comment">% Position the dialog and make it visible:</span>
3471 <span class="comment">% ----------------------------------------</span>
3472 fpos = get(hf,<span class="string">'Position'</span>);
3473 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
3474 movegui(handles.Figure,dpos)
3475 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
3476 
3477 <span class="comment">% Hold the dialog open:</span>
3478 <span class="comment">% ---------------------</span>
3479 waitfor(handles.OK)
3480 
3481 <span class="comment">% Return the outputs and close the dialog:</span>
3482 <span class="comment">% ----------------------------------------</span>
3483 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3484 selected_figures = dialog_params.selected_figures;
3485 
3486 delete(handles.Figure)
3487 
3488 <span class="comment">% [EOF] openFiguresDialog</span>
3489 
3490 <span class="comment">% --------------------------------------------------------------------</span>
3491 <a name="_sub100" href="#_subfunctions" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a>
3492 
3493 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3494 
3495 idx_selected = get(handles.Figures,<span class="string">'Value'</span>);
3496 fig_names    = get(handles.Figures,<span class="string">'String'</span>);
3497 selected     = fig_names(idx_selected);
3498 dialog_params.selected_figures = selected;
3499 
3500 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3501 
3502 
3503 
3504 <span class="comment">% --------------------------------------------------------------------</span>
3505 <a name="_sub101" href="#_subfunctions" class="code">function icons = getIcons</a>
3506 
3507 <span class="comment">% Load data</span>
3508 idx = 1;
3509 icons(idx).data(:,:,1) = <span class="keyword">...</span>
3510     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
3511     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   129   120   135   188   NaN   NaN   NaN
3512     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN    96   189   NaN   NaN   130   NaN    95   NaN
3513     NaN   NaN   206   206   206   206   NaN   NaN   NaN   NaN   NaN   NaN   NaN    84    79   NaN
3514     NaN   206   255   255   255   255   198   197   NaN   NaN   NaN   NaN    83    79    76   NaN
3515     198   255   255   255   255   255   255   198   198   198   198   198   198   212   212   NaN
3516     198   255   255   255   255   255   255   255   255   255   255   255   198   157   197   NaN
3517     198   255   226   198   198   198   198   198   198   198   198   198   198   198   177   NaN
3518     198   255   198   218   255   255   255   255   255   255   255   255   255   255   161   NaN
3519     198   253   198   247   255   255   255   255   255   255   255   255   255   251   155   NaN
3520     198   226   201   255   255   255   255   255   255   255   255   255   231   206   165   NaN
3521     198   207   215   255   255   255   255   255   255   255   255   255   239   198   159   NaN
3522     198   198   240   255   255   255   255   255   255   255   255   255   222   157   159   NaN
3523     198   199   255   255   255   255   255   255   255   255   255   255   191   165   159   NaN
3524     NaN   165   165   165   165   165   165   165   165   165   165   165   165   159   159   NaN
3525     NaN   NaN   159   159   159   159   159   159   159   159   159   159   159   159   NaN   NaN]/255;
3526 
3527 icons(idx).data(:,:,2) = <span class="keyword">...</span>
3528     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
3529     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   145   137   149   195   NaN   NaN   NaN
3530     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   116   196   NaN   NaN   145   NaN   116   NaN
3531     NaN   NaN   162   162   162   162   NaN   NaN   NaN   NaN   NaN   NaN   NaN   107   105   NaN
3532     NaN   162   255   255   255   255   154   197   NaN   NaN   NaN   NaN   106   104   103   NaN
3533     154   255   255   255   255   255   255   154   154   154   154   154   154   208   208   NaN
3534     154   243   243   243   243   243   243   255   255   255   255   255   154   123   197   NaN
3535     154   235   193   154   154   154   154   154   154   154   154   154   154   154   137   NaN
3536     154   215   154   191   255   255   251   255   255   255   255   255   231   255   126   NaN
3537     154   213   154   240   255   255   255   255   255   255   255   255   199   249   123   NaN
3538     154   179   160   255   247   247   247   247   247   247   247   247   190   188   115   NaN
3539     154   162   184   255   235   235   235   235   235   235   235   231   186   154   169   NaN
3540     154   154   228   255   227   227   227   227   227   227   227   223   178   123   169   NaN
3541     154   156   255   215   215   215   215   215   215   215   215   215   153   115   169   NaN
3542     NaN   115   115   115   115   115   115   115   115   115   115   115   115   169   169   NaN
3543     NaN   NaN   169   169   169   169   169   169   169   169   169   169   169   169   NaN   NaN]/255;
3544 
3545 icons(idx).data(:,:,3) = <span class="keyword">...</span>
3546     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
3547     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   166   161   170   202   NaN   NaN   NaN
3548     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   149   205   NaN   NaN   166   NaN   148   NaN
3549     NaN   NaN    34    34    34    34   NaN   NaN   NaN   NaN   NaN   NaN   NaN   141   144   NaN
3550     NaN    34   255   255   255   255    25   197   NaN   NaN   NaN   NaN   142   145   147   NaN
3551     25   255   156   156   156   156   255    25    25    25    25    25    25   200   200   NaN
3552     25   156   140   140   140   140   140   255   255   255   255   255    25    26   197   NaN
3553     25   132    80    25    25    25    25    25    25    25    25    25    25    25    25   NaN
3554     25   132    25   108   255   255   247   255   255   255   255   255   132   255    25   NaN
3555     25   112    25   137   156   156   156   156   156   156   156   156    91   150    25   NaN
3556     25    67    33   165   148   148   148   148   148   148   148   148    83    92    13   NaN
3557     25    38    64   156   132   132   132   132   132   132   132   132    67    25   176   NaN
3558     25    26   122   156   124   124   124   124   124   124   124   124    67    26   176   NaN
3559     25    28   156   108   108   108   108   108   108   108   108   108    41    13   176   NaN
3560     NaN    13    13    13    13    13    13    13    13    13    13    13    13   176   176   NaN
3561     NaN   NaN   176   176   176   176   176   176   176   176   176   176   176   176   NaN   NaN]/255;
3562 
3563 <span class="comment">% Save data</span>
3564 idx = idx+1;
3565 icons(idx).data(:,:,1) = <span class="keyword">...</span>
3566     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
3567     NaN    0.6902    0.6902    0.6902    0.6902    0.6902    0.6274    0.6274    0.5647    0.5647    0.5647    0.5019    0.5019    0.4392    0.2510       NaN
3568     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.3137    0.3765    0.2510    0.4670
3569     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.2510    0.1882    0.2510    0.4670
3570     NaN    0.6274    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.1882    0.5019    0.2510    0.4670
3571     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.1882    0.4392    0.2510    0.4670
3572     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.1255    0.3765    0.2510    0.4670
3573     NaN    0.5647    0.7529    0.3765    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.7529    0.0627    0.3765    0.2510    0.4670
3574     NaN    0.5647    0.7529    0.6902    0.3765    0.3137    0.3137    0.2510    0.1882    0.1882    0.1255    0.0627    0.3765    0.3137    0.2510    0.4670
3575     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5019    0.5019    0.5019    0.4392    0.4392    0.3765    0.3137    0.3137    0.2510    0.4670
3576     NaN    0.5019    0.6902    0.6274    0.5647    0.3137    0.3137    0.3137    0.3137    0.3137    0.3765    0.3137    0.3137    0.2510    0.2510    0.4670
3577     NaN    0.4392    0.6274    0.5647    0.5019    0.3137       NaN    0.1882    0.8157    0.8157    0.3765    0.2510    0.2510    0.2510    0.2510    0.4670
3578     NaN    0.4392    0.6274    0.5019    0.5019    0.3137    0.1882    0.4392    0.8784    0.8784    0.4392    0.1882    0.2510    0.1882    0.2510    0.4670
3579     NaN    0.4392    0.5647    0.5019    0.1255    0.1255    0.6902    0.6902    0.7529    0.7529    0.3137    0.1882    0.1882    0.1882    0.2510    0.4670
3580     NaN    0.7333    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.4670
3581     NaN       NaN    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670];
3582 
3583 icons(idx).data(:,:,2) = <span class="keyword">...</span>
3584     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
3585     NaN    0.7216    0.7216    0.6902    0.6902    0.6588    0.6274    0.5961    0.5647    0.5647    0.5333    0.5019    0.4706    0.4706    0.2196       NaN
3586     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.3451    0.3451    0.2196    0.5378
3587     NaN    0.6902    0.7529    0.5333    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.3137    0.1882    0.2196    0.5378
3588     NaN    0.6588    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.3137    0.4706    0.2196    0.5378
3589     NaN    0.6274    0.7529    0.4706    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.2824    0.4392    0.2196    0.5378
3590     NaN    0.5961    0.7529    0.4392    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.2510    0.4078    0.2196    0.5378
3591     NaN    0.5647    0.7529    0.4078    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.7843    0.2196    0.3765    0.2196    0.5378
3592     NaN    0.5333    0.7216    0.7216    0.3765    0.3765    0.3451    0.3137    0.3137    0.2824    0.2510    0.2196    0.3765    0.3451    0.2196    0.5378
3593     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5333    0.5019    0.4706    0.4392    0.4078    0.3765    0.3451    0.3137    0.2196    0.5378
3594     NaN    0.4706    0.6588    0.6274    0.5647    0.3451    0.3451    0.3451    0.3451    0.3765    0.4078    0.3451    0.3137    0.2824    0.2196    0.5378
3595     NaN    0.4706    0.6274    0.5647    0.5333    0.3451       NaN    0.2510    0.8470    0.8784    0.4706    0.2824    0.2824    0.2510    0.2196    0.5378
3596     NaN    0.4392    0.5961    0.5333    0.5019    0.3451    0.2510    0.4706    0.8784    0.9098    0.5019    0.2510    0.2510    0.2510    0.2196    0.5378
3597     NaN    0.4078    0.5647    0.5019    0.2824    0.1882    0.7216    0.7216    0.7529    0.7843    0.3137    0.2510    0.2510    0.2196    0.2196    0.5378
3598     NaN    0.7176    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.5378
3599     NaN       NaN    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378];
3600 
3601 icons(idx).data(:,:,3) = <span class="keyword">...</span>
3602     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
3603     NaN    0.9412    0.9412    0.9412    0.9412    0.9412    0.9412    0.8784    0.8784    0.8784    0.8784    0.8784    0.8157    0.8157    0.4392       NaN
3604     NaN    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.7529    0.6902    0.4392    0.5997
3605     NaN    0.9412    1.0000    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.7529    0.3765    0.4392    0.5997
3606     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.6902    0.8784    0.4392    0.5997
3607     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.6902    0.8157    0.4392    0.5997
3608     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.6274    0.8157    0.4392    0.5997
3609     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.8784    0.6274    0.7529    0.4392    0.5997
3610     NaN    0.8784    1.0000    1.0000    0.8157    0.7529    0.7529    0.7529    0.6902    0.6902    0.6274    0.6274    0.7529    0.7529    0.4392    0.5997
3611     NaN    0.8784    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8784    0.8157    0.8157    0.7529    0.7529    0.6902    0.4392    0.5997
3612     NaN    0.8157    1.0000    1.0000    0.9412    0.4392    0.4392    0.4392    0.4392    0.4392    0.5019    0.7529    0.6902    0.6902    0.4392    0.5997
3613     NaN    0.8157    1.0000    0.9412    0.9412    0.4392       NaN    0.2510    0.9412    0.9412    0.5019    0.6902    0.6902    0.6274    0.4392    0.5997
3614     NaN    0.8157    1.0000    0.9412    0.8784    0.4392    0.2510    0.5647    0.9412    0.9412    0.5647    0.6274    0.6274    0.6274    0.4392    0.5997
3615     NaN    0.8157    0.9412    0.8784    0.6902    0.2510    0.7529    0.7529    0.8157    0.8157    0.3137    0.6274    0.6274    0.6274    0.4392    0.5997
3616     NaN    0.8275    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.5997
3617     NaN       NaN    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997];
3618 
3619 <span class="comment">% Plotting parameters</span>
3620 idx = idx+1;
3621 icons(idx).data(:,:,1) = <span class="keyword">...</span>
3622     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
3623     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
3624     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
3625     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
3626     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
3627     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
3628     0   101   239   255   224   109   255   255   255   247    79   254   254   123    36   165
3629     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
3630     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
3631     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
3632     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
3633     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
3634     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
3635     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
3636     0     0     0     1     0     0     0     0     0     0     0     0     0     0     0   165
3637     255   165   165   165   172   165   165   165   165   165   165   165   165   165   165   165]/255;
3638 
3639 icons(idx).data(:,:,2) = <span class="keyword">...</span>
3640     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
3641     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0     0
3642     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
3643     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
3644     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
3645     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
3646     0   101   239   255   224   109   255   255   255   247    79   254   254   123     0   165
3647     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
3648     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
3649     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
3650     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
3651     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
3652     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
3653     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
3654     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   165
3655     0   165   165   165   153   165   165   165   165   165   165   165   165   165   165   165]/255;
3656 
3657 icons(idx).data(:,:,3) = <span class="keyword">...</span>
3658     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
3659     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
3660     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
3661     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
3662     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
3663     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
3664     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
3665     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
3666     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
3667     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
3668     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
3669     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
3670     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
3671     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
3672     0    24    39     0     0     0     0     0     0     0     0     0     0     0     0   145
3673     255   145   145   145   134   145   145   145   145   145   145   145   145   145   145   145]/255;
3674 
3675 <span class="comment">% Processing parameters</span>
3676 idx = idx+1;
3677 icons(idx).data(:,:,1) = <span class="keyword">...</span>
3678     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
3679     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
3680     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
3681     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
3682     255     0   255   255   107   255   255   107   255   255   107   255   107   255     0   255
3683     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
3684     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
3685     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
3686     255     0   255   255   107   255   107   255   107   255   255   107   255   255     0   255
3687     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
3688     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
3689     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
3690     255     0   255   107   255   107   255   107   255   255   107   255   107   255     0   255
3691     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
3692     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
3693     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
3694 
3695 icons(idx).data(:,:,2) = <span class="keyword">...</span>
3696     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
3697     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
3698     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
3699     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
3700     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
3701     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
3702     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
3703     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
3704     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
3705     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
3706     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
3707     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
3708     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
3709     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
3710     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
3711     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
3712 
3713 icons(idx).data(:,:,3) = <span class="keyword">...</span>
3714     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
3715     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
3716     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
3717     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
3718     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
3719     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
3720     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
3721     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
3722     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
3723     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
3724     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
3725     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
3726     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
3727     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
3728     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
3729     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
3730 
3731 <span class="comment">% Export bathymetry dialog</span>
3732 idx = idx+1;
3733 icons(idx).data(:,:,1) = <span class="keyword">...</span>
3734     [226    226    226    226    226    226    226    197    220    226    226    226    226    226    226    226
3735     226    226    226    226    226    227    241    144    158    241    228    228    229    228    229    226
3736     226    243    243    243    237    237    246    164    119    242    232    225    226    218    243    206
3737     179    152    153    166    148    148    177    179    63    185    141    146    154    151    179    189
3738     167    4    134    175    151    164    161    198    122    255    212    233    215    199    140    185
3739     134    50    209    241    255    255    133    118    15    20    28    94    4    0    0    89
3740     136    0    0    0    0    0    0    0    0    0    0    0    0    21    56    140
3741     208    255    226    233    255    242    215    232    251    237    226    233    207    222    156    139
3742     172    159    152    153    166    145    178    147    169    164    161    163    154    153    128    135
3743     160    164    148    139    171    150    165    154    165    185    166    173    190    190    148    162
3744     214    233    211    203    217    212    217    238    202    236    213    222    230    224    184    184
3745     219    206    174    190    219    204    201    218    183    224    219    222    217    202    176    182
3746     210    182    183    214    225    220    203    229    175    217    220    220    222    212    184    185
3747     197    175    207    224    223    220    205    231    170    221    220    220    222    217    191    187
3748     186    193    223    224    220    201    203    228    171    224    218    220    222    215    190    187
3749     189    211    220    216    204    201    214    213    187    213    216    220    220    212    193    189
3750     ]/255;
3751 icons(idx).data(:,:,2) = <span class="keyword">...</span>
3752     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
3753     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
3754     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
3755     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
3756     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
3757     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
3758     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
3759     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
3760     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
3761     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
3762     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
3763     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
3764     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
3765     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
3766     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
3767     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
3768     ]/255;
3769 icons(idx).data(:,:,3) = <span class="keyword">...</span>
3770     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
3771     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
3772     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
3773     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
3774     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
3775     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
3776     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
3777     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
3778     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
3779     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
3780     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
3781     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
3782     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
3783     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
3784     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
3785     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
3786     ]/255;
3787 
3788 <span class="comment">% Export Figures Dialog</span>
3789 idx = idx + 1;
3790 icons(idx).data(:,:,1) = <span class="keyword">...</span>
3791     [NaN    NaN    10    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
3792     NaN    NaN    67    255    255    255    255    255    255    255    201    141    NaN    NaN    NaN    NaN
3793     NaN    NaN    43    255    241    240    241    246    252    255    186    220    151    NaN    NaN    NaN
3794     NaN    NaN    42    255    238    237    237    236    238    254    210    178    214    38    NaN    NaN
3795     NaN    NaN    43    255    241    241    241    241    240    244    252    255    255    79    NaN    NaN
3796     NaN    NaN    47    255    232    232    225    224    224    223    220    238    255    69    NaN    NaN
3797     NaN    NaN    55    233    114    225    230    223    221    221    215    237    255    67    NaN    NaN
3798     4    NaN    37    181    168    126    193    214    205    200    203    242    255    67    NaN    NaN
3799     41    164    134    153    144    139    131    209    238    223    242    240    255    67    NaN    NaN
3800     41    118    91    91    122    125    120    106    170    241    245    241    255    67    NaN    NaN
3801     41    113    91    89    97    108    99    89    117    205    190    230    255    67    NaN    NaN
3802     41    124    94    88    78    74    81    179    255    252    244    241    255    67    NaN    NaN
3803     13    34    76    187    88    92    222    255    255    250    250    250    255    73    NaN    NaN
3804     NaN    NaN    69    236    121    227    255    243    238    238    238    238    255    82    NaN    NaN
3805     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
3806 
3807 
3808 icons(idx).data(:,:,2) = <span class="keyword">...</span>
3809     [NaN    NaN    10    24    24    24    24    24    24    24    22    4    NaN    NaN    NaN    NaN
3810     NaN    NaN    69    255    255    255    255    255    255    255    204    144    NaN    NaN    NaN    NaN
3811     NaN    NaN    45    255    241    240    241    246    252    255    189    222    155    NaN    NaN    NaN
3812     NaN    NaN    43    255    238    237    237    236    238    254    210    179    215    39    NaN    NaN
3813     NaN    NaN    44    255    241    241    241    241    240    244    252    255    255    80    NaN    NaN
3814     NaN    NaN    49    255    231    230    225    224    224    223    220    238    255    70    NaN    NaN
3815     NaN    NaN    56    227    136    214    227    223    221    221    215    237    255    68    NaN    NaN
3816     4    NaN    19    157    243    154    181    210    204    200    203    242    255    67    NaN    NaN
3817     51    255    231    225    219    217    172    197    232    222    242    240    255    67    NaN    NaN
3818     52    227    184    183    195    201    204    172    169    239    245    241    255    67    NaN    NaN
3819     51    218    177    177    180    187    187    177    130    202    190    230    255    67    NaN    NaN
3820     51    237    195    183    172    170    152    175    255    251    244    241    255    67    NaN    NaN
3821     15    38    72    173    183    149    211    255    255    250    250    250    255    73    NaN    NaN
3822     NaN    NaN    65    226    174    214    252    242    238    238    238    238    255    84    NaN    NaN
3823     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
3824 
3825 
3826 icons(idx).data(:,:,3) = <span class="keyword">...</span>
3827     [NaN    NaN    9    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
3828     NaN    NaN    66    255    255    255    255    255    255    255    196    139    NaN    NaN    NaN    NaN
3829     NaN    NaN    42    255    239    238    238    244    252    255    186    216    148    NaN    NaN    NaN
3830     NaN    NaN    41    255    236    235    235    234    237    251    210    176    212    36    NaN    NaN
3831     NaN    NaN    42    255    239    239    239    239    238    241    252    255    255    78    NaN    NaN
3832     NaN    NaN    46    255    233    232    224    223    223    223    219    235    255    67    NaN    NaN
3833     NaN    NaN    53    240    101    232    230    221    219    218    213    235    255    65    NaN    NaN
3834     5    NaN    60    212    94    107    205    215    203    198    201    240    255    66    NaN    NaN
3835     34    56    40    80    70    62    94    222    241    221    240    238    255    66    NaN    NaN
3836     35    10    2    0    51    55    36    46    176    240    243    239    255    66    NaN    NaN
3837     35    11    9    7    16    34    12    6    110    204    188    228    255    66    NaN    NaN
3838     35    14    0    0    0    0    14    187    255    251    242    239    255    66    NaN    NaN
3839     12    37    84    206    0    41    234    255    255    248    248    248    255    72    NaN    NaN
3840     NaN    NaN    69    249    79    239    255    240    236    236    236    236    255    80    NaN    NaN
3841     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
3842 
3843 
3844 <span class="comment">% [EOF] getIcons</span>
3845 
3846 <a name="_sub102" href="#_subfunctions" class="code">function guiparams = createGUIparams</a>
3847 <span class="comment">% Creates the guiparams structure with specified defaults.</span>
3848 
3849 <span class="comment">% Organized by GUI panels</span>
3850 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
3851 <span class="comment">% SHIPTRACKS PLOT %</span>
3852 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
3853 guiparams.horizontal_grid_node_spacing       = 1.0;
3854 
3855 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
3856 <span class="comment">% CROSS SECTION PLOT %</span>
3857 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
3858 guiparams.contours                           = <span class="string">''</span>; <span class="comment">% Set below</span>
3859 guiparams.contour                            = <span class="string">''</span>; <span class="comment">% Set below</span>
3860 guiparams.idx_contour                        = 1;
3861 guiparams.vertical_exaggeration              = 10;
3862 guiparams.vector_scale_cross_section         = 0.2;
3863 guiparams.horizontal_vector_spacing          = 1;
3864 guiparams.vertical_vector_spacing            = 1;
3865 guiparams.horizontal_smoothing_window        = 1;
3866 guiparams.vertical_smoothing_window          = 1;
3867 guiparams.plot_secondary_flow_vectors        = true;
3868 guiparams.secondary_flows                    = <span class="string">''</span>; <span class="comment">% Set below</span>
3869 guiparams.secondary_flow_vector_variable     = <span class="string">''</span>; <span class="comment">% Set below</span>
3870 guiparams.idx_secondary_flow_vector_variable = 1;
3871 guiparams.include_vertical_velocity          = true;
3872 
3873 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
3874 <span class="comment">% PLAN VIEW PLOT %</span>
3875 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
3876 guiparams.depth_range_min                    = 0;
3877 guiparams.depth_range_max                    = inf;
3878 guiparams.vector_scale_plan_view             = 1;
3879 guiparams.vector_spacing_plan_view           = 1;
3880 guiparams.smoothing_window_size              = 1;
3881 guiparams.map_depth_averaged_velocities      = true;
3882 guiparams.display_shoreline                  = false;
3883 guiparams.add_background                     = false;
3884 
3885 <span class="comment">%%%%%%%%%%%%%%%</span>
3886 <span class="comment">% DATA EXPORT %</span>
3887 <span class="comment">%%%%%%%%%%%%%%%</span>
3888 guiparams.beam_angle                         = 20.0;
3889 guiparams.magnetic_variation                 = 0.0;
3890 guiparams.wse                                = 0.0;
3891 guiparams.output_auxiliary_data              = false;
3892 
3893 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
3894 <span class="comment">% Contour variables %</span>
3895 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
3896 idx = 1;
3897 guiparams.contours(idx).string   = <span class="string">'Streamwise Velocity (u)'</span>;
3898 guiparams.contours(idx).variable = <span class="string">'streamwise'</span>;
3899 idx = idx + 1;
3900 guiparams.contours(idx).string   = <span class="string">'Transverse Velocity (v)'</span>;
3901 guiparams.contours(idx).variable = <span class="string">'transverse'</span>;
3902 idx = idx + 1;
3903 guiparams.contours(idx).string   = <span class="string">'Vertical Velocity (w)'</span>;
3904 guiparams.contours(idx).variable = <span class="string">'vertical'</span>;
3905 idx = idx + 1;
3906 guiparams.contours(idx).string   = <span class="string">'Velocity Magnitude'</span>;
3907 guiparams.contours(idx).variable = <span class="string">'mag'</span>;
3908 idx = idx + 1;
3909 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (zsd)'</span>;
3910 guiparams.contours(idx).variable = <span class="string">'primary_zsd'</span>;
3911 idx = idx + 1;
3912 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (zsd)'</span>;
3913 guiparams.contours(idx).variable = <span class="string">'secondary_zsd'</span>;
3914 idx = idx + 1;
3915 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (Roz)'</span>;
3916 guiparams.contours(idx).variable = <span class="string">'primary_roz'</span>;
3917 idx = idx + 1;
3918 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (Roz)'</span>;
3919 guiparams.contours(idx).variable = <span class="string">'secondary_roz'</span>;
3920 idx = idx + 1;
3921 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Downstream Comp.)'</span>;
3922 guiparams.contours(idx).variable = <span class="string">'primary_roz_x'</span>;
3923 idx = idx + 1;
3924 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Cross-Stream Comp.)'</span>;
3925 guiparams.contours(idx).variable = <span class="string">'primary_roz_y'</span>;
3926 idx = idx + 1;
3927 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Downstream Comp.)'</span>;
3928 guiparams.contours(idx).variable = <span class="string">'secondary_roz_x'</span>;
3929 idx = idx + 1;
3930 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Cross-Stream Comp.)'</span>;
3931 guiparams.contours(idx).variable = <span class="string">'secondary_roz_y'</span>;
3932 idx = idx + 1;
3933 guiparams.contours(idx).string   = <span class="string">'Backscatter'</span>;
3934 guiparams.contours(idx).variable = <span class="string">'backscatter'</span>;
3935 idx = idx + 1;
3936 guiparams.contours(idx).string   = <span class="string">'Flow Direction (deg.)'</span>;
3937 guiparams.contours(idx).variable = <span class="string">'flowangle'</span>;
3938 
3939 guiparams.contour = guiparams.contours(guiparams.idx_contour).variable;
3940 
3941 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3942 <span class="comment">% Secondary Flow Vector Variables %</span>
3943 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3944 idx = 1;
3945 guiparams.secondary_flows(idx).string   = <span class="string">'Transverse'</span>;
3946 guiparams.secondary_flows(idx).variable = <span class="string">'transverse'</span>;
3947 idx = idx + 1;
3948 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (zsd)'</span>;
3949 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_zsd'</span>;
3950 idx = idx + 1;
3951 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz)'</span>;
3952 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz'</span>;
3953 idx = idx + 1;
3954 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz, Cross-Stream Comp)'</span>;
3955 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz_y'</span>;
3956 idx = idx + 1;
3957 guiparams.secondary_flows(idx).string   = <span class="string">'Primary (Roz, Cross-Stream Comp)'</span>;
3958 guiparams.secondary_flows(idx).variable  = <span class="string">'primary_roz_y'</span>;
3959 
3960 guiparams.secondary_flow_vector_variable = <span class="keyword">...</span>
3961     guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).variable;
3962 
3963 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3964 <span class="comment">% INTERNAL SETTINGS &amp; DEFAULTS %</span>
3965 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3966 <span class="comment">% Menu bar options</span>
3967 guiparams.presentation                       = true;
3968 guiparams.print                              = false;
3969 guiparams.set_cross_section_endpoints        = false;
3970 guiparams.unit_discharge_correction          = false;
3971 guiparams.english_units                      = false;
3972 guiparams.vertical_offset                    = 0;
3973 <span class="comment">% guiparams.plot_ship_tracks                   = false;</span>
3974 <span class="comment">% guiparams.plot_planview                      = false;</span>
3975 <span class="comment">% guiparams.plot_cross_section                 = false;</span>
3976 
3977 <span class="comment">% File location defaults</span>
3978 guiparams.ascii_path                        = pwd;
3979 guiparams.ascii_file                        = <span class="string">''</span>;
3980 guiparams.mat_path                          = pwd;
3981 guiparams.mat_file                          = <span class="string">''</span>;
3982 guiparams.tecplot_path                      = pwd;
3983 guiparams.tecplot_file                      = <span class="string">''</span>;
3984 guiparams.kmz_path                          = pwd;
3985 guiparams.kmz_file                          = <span class="string">''</span>;
3986 guiparams.multibeambathymetry_path          = pwd;
3987 guiparams.multibeambathymetry_file          = <span class="string">''</span>;
3988 guiparams.log_path                          = pwd;
3989 guiparams.log_file                          = <span class="string">''</span>;
3990 <span class="comment">% Avoids problems of not finding the MCR root when running as a standalone</span>
3991 <span class="comment">% application</span>
3992 <span class="keyword">if</span> isdeployed 
3993     guiparams.has_mapping_toolbox           = true;
3994 <span class="keyword">else</span>
3995     guiparams.has_mapping_toolbox               = <span class="keyword">...</span>
3996         ~isempty(dir(fullfile(matlabroot,<span class="string">'toolbox'</span>,<span class="string">'map'</span>)));
3997 <span class="keyword">end</span>
3998 
3999 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4000 <span class="comment">% IN MEMORY DATA STORAGE %</span>
4001 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4002 guiparams.z                      = [];
4003 guiparams.A                      = [];
4004 guiparams.V                      = [];
4005 guiparams.Map                    = [];
4006 guiparams.savefile               = [];
4007 guiparams.iric_anv_planview_data = [];
4008 <span class="comment">% guiparams.zmin = []; % Don't need to store these?</span>
4009 <span class="comment">% guiparams.zmax = [];</span>
4010 <span class="comment">% guiprefs = getappdata(handles.figure1,'guiprefs');</span>
4011 guiparams.data_folder = <span class="string">''</span>;
4012 guiparams.data_files  = {<span class="string">''</span>};
4013 
4014 <span class="comment">% [EOF] createGUIparams</span>
4015 
4016 <span class="comment">% [EOF] VMT</span>
4017 
4018 
4019 
4020 
4021 
4022 
4023</pre></div>
<hr><address>Generated on Wed 29-May-2013 10:50:31 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>