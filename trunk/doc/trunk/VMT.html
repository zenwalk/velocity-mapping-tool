<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of VMT</title>
  <meta name="keywords" content="VMT">
  <meta name="description" content="--- THE VELOCITY MAPPING TOOLBOX ---">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html trunk -->
<h1>VMT
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>--- THE VELOCITY MAPPING TOOLBOX ---</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function varargout = VMT(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> --- THE VELOCITY MAPPING TOOLBOX ---
 
 VMT is a Matlab-based software for processing and visualizing ADCP data
 collected along transects in rivers or other bodies of water. VMT allows
 rapid processing, visualization, and analysis of a range of ADCP datasets
 and includes utilities to export ADCP data to files compatible with
 ArcGIS, Tecplot, and Google Earth. The software can be used to explore
 patterns of three-dimensional fluid motion through several methods for
 calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et
 al., 2000). The software also includes capabilities for analyzing the
 acoustic backscatter and bathymetric data from the ADCP. A user-friendly
 graphical user interface (GUI) enhances program functionality and
 provides ready access to two- and three- dimensional plotting functions,
 allowing rapid display and interrogation of velocity, backscatter, and
 bathymetry data.
 
 CITATION: 
 Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.
 L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,
 J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and
 visualization suite for moving-vessel ADCP measurements. Earth Surf.
 Process. Landforms. doi: 10.1002/esp.3367

__________________________________________________________________________
 P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center
 (pjackson@usgs.gov)

 Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.
__________________________________________________________________________</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>	Takes the processed data structure and writes a TecPlot ASCII data file.</li><li><a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>	Takes the processed data structure and writes a TecPlot ASCII data file</li><li><a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>	Computes the multibeam bathymetry from the four beams of the ADCP</li><li><a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>	Outputs the mean cross section (3-D) from VMT to Google Earth (saved as a</li><li><a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>	Prompts the user for a geotiff DOQQ (USGS) and overlays the aerial image</li><li><a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>	This function plots a plan view of the measurement region with a vector</li><li><a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>	Plots the shiptracks, and interpolated grid in the VMT GUI axes. Also</li><li><a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>	Plots a shoreline map given the shoreline data structure 'Map' (see</li><li><a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english)">VMT_PlotXSCont</a>	Plots contours for the variable 'var' within the mean cross section given</li><li><a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,varargin)">VMT_PlotXSContQuiver</a>	This function plots the the contour plot (mean XS) for the variable 'var'</li><li><a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>	This function is a driver to preprocess the transects data.  Several</li><li><a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>	Driver program to process multiple transects at a single cross-section</li><li><a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>	Read in multiple ASCII output files from WinRiver or WinRiverII.</li><li><a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>	Saves the figures (specified by fignums) from VMT as .PNG or EPS files</li><li><a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>	This routine smooths all processed variables in V struct. By default is</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a></li><li><a href="#_sub2" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub3" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub4" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub5" class="code">function menuFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub6" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub7" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub8" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub9" class="code">function menuSave_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub10" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub11" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub12" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub13" class="code">function menuExport_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub14" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub15" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub16" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub17" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub18" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub19" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub20" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub21" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub22" class="code">function menuParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub23" class="code">function menuProcessingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub24" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub25" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub26" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub27" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub28" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub29" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub30" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub31" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub32" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub33" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub34" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub35" class="code">function menuKMZExport_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub36" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub37" class="code">function menuTools_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub38" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub39" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub40" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub41" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub42" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub43" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub44" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub45" class="code">function loadDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub46" class="code">function saveDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub47" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub48" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub49" class="code">function processingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub50" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub51" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub52" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub53" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub54" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub55" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub56" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub57" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub58" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub59" class="code">function WSE_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub60" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub61" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub62" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub63" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub64" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub65" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub66" class="code">function DisplayShoreline_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub67" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub68" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub69" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub70" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub71" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub72" class="code">function Contour_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub73" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub74" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub75" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub76" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub77" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub78" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub79" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub80" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub81" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub82" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub83" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub84" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub85" class="code">function handles = buildToolbar(handles)</a></li><li><a href="#_sub86" class="code">function load_prefs(hfigure)</a></li><li><a href="#_sub87" class="code">function store_prefs(hfigure,pref)</a></li><li><a href="#_sub88" class="code">function initGUI(handles)</a></li><li><a href="#_sub89" class="code">function set_enable(handles,enable_state)</a></li><li><a href="#_sub90" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] =</a></li><li><a href="#_sub91" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a></li><li><a href="#_sub92" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a></li><li><a href="#_sub93" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a></li><li><a href="#_sub94" class="code">function dialogOK(hObject,eventdata,h_OK)</a></li><li><a href="#_sub95" class="code">function dialogCancel(hObject,eventdata,handles)</a></li><li><a href="#_sub96" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a></li><li><a href="#_sub97" class="code">function [beam_angle,magnetic_variation,wse,output_auxiliary_data] = exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,hf)</a></li><li><a href="#_sub98" class="code">function dialogExportSettings(hObject,eventdata,handles)</a></li><li><a href="#_sub99" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a></li><li><a href="#_sub100" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a></li><li><a href="#_sub101" class="code">function icons = getIcons</a></li><li><a href="#_sub102" class="code">function guiparams = createGUIparams</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function varargout = VMT(varargin)</a>
0002 <span class="comment">% --- THE VELOCITY MAPPING TOOLBOX ---</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% VMT is a Matlab-based software for processing and visualizing ADCP data</span>
0005 <span class="comment">% collected along transects in rivers or other bodies of water. VMT allows</span>
0006 <span class="comment">% rapid processing, visualization, and analysis of a range of ADCP datasets</span>
0007 <span class="comment">% and includes utilities to export ADCP data to files compatible with</span>
0008 <span class="comment">% ArcGIS, Tecplot, and Google Earth. The software can be used to explore</span>
0009 <span class="comment">% patterns of three-dimensional fluid motion through several methods for</span>
0010 <span class="comment">% calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et</span>
0011 <span class="comment">% al., 2000). The software also includes capabilities for analyzing the</span>
0012 <span class="comment">% acoustic backscatter and bathymetric data from the ADCP. A user-friendly</span>
0013 <span class="comment">% graphical user interface (GUI) enhances program functionality and</span>
0014 <span class="comment">% provides ready access to two- and three- dimensional plotting functions,</span>
0015 <span class="comment">% allowing rapid display and interrogation of velocity, backscatter, and</span>
0016 <span class="comment">% bathymetry data.</span>
0017 <span class="comment">%</span>
0018 <span class="comment">% CITATION:</span>
0019 <span class="comment">% Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.</span>
0020 <span class="comment">% L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,</span>
0021 <span class="comment">% J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and</span>
0022 <span class="comment">% visualization suite for moving-vessel ADCP measurements. Earth Surf.</span>
0023 <span class="comment">% Process. Landforms. doi: 10.1002/esp.3367</span>
0024 <span class="comment">%</span>
0025 <span class="comment">%__________________________________________________________________________</span>
0026 <span class="comment">% P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center</span>
0027 <span class="comment">% (pjackson@usgs.gov)</span>
0028 <span class="comment">%</span>
0029 <span class="comment">% Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.</span>
0030 <span class="comment">%__________________________________________________________________________</span>
0031 
0032 <span class="comment">% Begin initialization code - DO NOT EDIT</span>
0033 gui_Singleton = 1;
0034 gui_State = struct(<span class="string">'gui_Name'</span>,       mfilename, <span class="keyword">...</span>
0035     <span class="string">'gui_Singleton'</span>,  gui_Singleton, <span class="keyword">...</span>
0036     <span class="string">'gui_OpeningFcn'</span>, @<a href="#_sub1" class="code" title="subfunction VMT_OpeningFcn(hObject, eventdata, handles, varargin)">VMT_OpeningFcn</a>, <span class="keyword">...</span>
0037     <span class="string">'gui_OutputFcn'</span>,  @<a href="#_sub2" class="code" title="subfunction varargout = VMT_OutputFcn(hObject, eventdata, handles)">VMT_OutputFcn</a>, <span class="keyword">...</span>
0038     <span class="string">'gui_LayoutFcn'</span>,  [] , <span class="keyword">...</span>
0039     <span class="string">'gui_Callback'</span>,   []);
0040 <span class="keyword">if</span> nargin &amp;&amp; ischar(varargin{1})
0041     gui_State.gui_Callback = str2func(varargin{1});
0042 <span class="keyword">end</span>
0043 
0044 <span class="comment">% If ERROR, write a txt file with the error dump info</span>
0045 <span class="keyword">try</span>
0046 <span class="keyword">if</span> nargout
0047     [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
0048 <span class="keyword">else</span>
0049     gui_mainfcn(gui_State, varargin{:});
0050 <span class="keyword">end</span>
0051 
0052 <span class="keyword">catch</span> err
0053     <span class="keyword">if</span> isdeployed
0054         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
0055             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
0056         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
0057             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
0058             errLogFileName},<span class="keyword">...</span>
0059             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0060             <span class="string">'error'</span>);
0061         fid = fopen(errLogFileName,<span class="string">'W'</span>);
0062         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
0063         fclose(fid);
0064         rethrow(err)
0065     <span class="keyword">else</span>
0066         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
0067             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0068             <span class="string">'error'</span>);
0069         rethrow(err);
0070     <span class="keyword">end</span>
0071 <span class="keyword">end</span>
0072 <span class="comment">% End initialization code - DO NOT EDIT</span>
0073 
0074 <span class="comment">%#ok&lt;*DEFNU,*INUSL,*INUSD&gt;</span>
0075 
0076 <span class="comment">% --- Executes just before VMT is made visible.</span>
0077 <a name="_sub1" href="#_subfunctions" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a>
0078 <span class="comment">% This function has no output args, see OutputFcn.</span>
0079 <span class="comment">% hObject    handle to figure</span>
0080 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0081 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0082 <span class="comment">% varargin   command line arguments to VMT (see VARARGIN)</span>
0083 
0084 <span class="comment">% Choose default command line output for VMT</span>
0085 handles.output = hObject;
0086 
0087 <span class="comment">% Build the GUI toolbar:</span>
0088 <span class="comment">% ----------------------</span>
0089 handles = <a href="#_sub85" class="code" title="subfunction handles = buildToolbar(handles)">buildToolbar</a>(handles);
0090 
0091 <span class="comment">% Ensure path to utils &amp; docs is available</span>
0092 <span class="comment">% ----------------------------------------</span>
0093 <span class="keyword">if</span> ~isdeployed
0094     filesep = <span class="string">'\'</span>; <span class="comment">% windows</span>
0095     utilspath = [pwd filesep <span class="string">'utils'</span>];
0096     docspath  = [pwd filesep <span class="string">'doc'</span>];
0097     toolspath = [pwd filesep <span class="string">'tools'</span>];
0098     addpath(utilspath,docspath,toolspath)
0099 <span class="keyword">end</span>
0100 
0101 <span class="comment">% Update handles structure</span>
0102 <span class="comment">% ------------------------</span>
0103 guidata(hObject, handles);
0104 
0105 <span class="comment">% Load the GUI preferences:</span>
0106 <span class="comment">% -------------------------</span>
0107 <a href="#_sub86" class="code" title="subfunction load_prefs(hfigure)">load_prefs</a>(handles.figure1)
0108 
0109 <span class="comment">% Initialize the GUI parameters:</span>
0110 <span class="comment">% ------------------------------</span>
0111 guiparams = <a href="#_sub102" class="code" title="subfunction guiparams = createGUIparams">createGUIparams</a>;
0112 guiparams.vmt_version = <span class="string">'v4.03'</span>;
0113 
0114 <span class="comment">% Draw the VMT Background</span>
0115 <span class="comment">% -----------------</span>
0116 pos = get(handles.figure1,<span class="string">'position'</span>);
0117 axes(handles.VMTBackground);
0118 <span class="keyword">if</span> ~isdeployed <span class="comment">%isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0119     X = imread(<span class="string">'VMT_Background.png'</span>);
0120     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0121 <span class="keyword">else</span>
0122     X = imread(<span class="string">'VMT_Background.png'</span>);
0123     X = imresize(X, [pos(4) pos(3)]);
0124     X = uint8(X);
0125     imshow(X,<span class="string">'Border'</span>,<span class="string">'tight'</span>)
0126 <span class="keyword">end</span>
0127 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0128 
0129 <span class="comment">% Store the application data:</span>
0130 <span class="comment">% ---------------------------</span>
0131 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0132 
0133 <span class="comment">% Initialize the GUI:</span>
0134 <span class="comment">% -------------------</span>
0135 <a href="#_sub88" class="code" title="subfunction initGUI(handles)">initGUI</a>(handles)
0136 <a href="#_sub89" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'init'</span>)
0137 <span class="comment">% set(handles.GraphicsExportPanel,'Visible','off')</span>
0138 <span class="comment">% set(handles.ProcessingPanel,'Visible','off')</span>
0139 pos = get(handles.figure1,<span class="string">'Position'</span>);
0140 <span class="comment">% pos(3) = 545;</span>
0141 set(handles.figure1,<span class="string">'Position'</span>,pos)
0142 set(handles.figure1,<span class="string">'Resize'</span>,<span class="string">'on'</span>)
0143 
0144 <span class="comment">% Allow access to the VMT Main GUI info by other sub-GUIs by pushing it to</span>
0145 <span class="comment">% the root</span>
0146 setappdata(0  , <span class="string">'hVMTgui'</span>    , gcf);
0147 
0148 <span class="comment">% UIWAIT makes VMT wait for user response (see UIRESUME)</span>
0149 <span class="comment">% uiwait(handles.figure1);</span>
0150 <span class="comment">% [EOF] VMT_OpeningFcn</span>
0151 
0152 
0153 <span class="comment">% --- Outputs from this function are returned to the command line.</span>
0154 <a name="_sub2" href="#_subfunctions" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a>
0155 <span class="comment">% varargout  cell array for returning output args (see VARARGOUT);</span>
0156 <span class="comment">% hObject    handle to figure</span>
0157 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0158 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0159 
0160 <span class="comment">% Get default command line output from handles structure</span>
0161 varargout{1} = handles.output;
0162 <span class="comment">% [EOF] VMT_OutputFcn</span>
0163 
0164 <span class="comment">% --- Executes when figure1 is resized.</span>
0165 <a name="_sub3" href="#_subfunctions" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a>
0166 
0167 <span class="comment">% Draw the VMT Background</span>
0168 <span class="comment">% -----------------</span>
0169 pos = get(handles.figure1,<span class="string">'position'</span>);
0170 axes(handles.VMTBackground);
0171 <span class="keyword">if</span> ~isdeployed <span class="comment">%isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0172     X = imread(<span class="string">'VMT_Background.png'</span>);
0173     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0174 <span class="keyword">else</span>
0175     X = imread(<span class="string">'VMT_Background.png'</span>);
0176     X = imresize(X, [pos(4) pos(3)]);
0177     X = uint8(X);
0178     imshow(X,<span class="string">'Border'</span>,<span class="string">'tight'</span>)
0179 <span class="keyword">end</span>
0180 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0181 
0182 <span class="comment">% --- Executes when user attempts to close figure1.</span>
0183 <a name="_sub4" href="#_subfunctions" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a>
0184 <span class="comment">% hObject    handle to figure1 (see GCBO)</span>
0185 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0186 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0187 
0188 <span class="comment">% Hint: delete(hObject) closes the figure</span>
0189 close_button = questdlg(<span class="keyword">...</span>
0190     <span class="string">'You are about to exit VMT. Any unsaved work will be lost. Are you sure?'</span>,<span class="keyword">...</span>
0191     <span class="string">'Exit VMT?'</span>,<span class="string">'No'</span>);
0192 <span class="keyword">switch</span> close_button
0193     <span class="keyword">case</span> <span class="string">'Yes'</span>
0194         delete(hObject)
0195         close all hidden
0196     <span class="keyword">otherwise</span>
0197         <span class="keyword">return</span>
0198 <span class="keyword">end</span>
0199 <span class="comment">% [EOF] figure1_CloseRequestFcn</span>
0200 
0201 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0202 <span class="comment">% MENU BAR CALLBACKS %</span>
0203 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0204 
0205 <span class="comment">% --------------------------------------------------------------------</span>
0206 <a name="_sub5" href="#_subfunctions" class="code">function menuFile_Callback(hObject, eventdata, handles)</a>
0207 <span class="comment">% Empty</span>
0208 
0209 <span class="comment">% --------------------------------------------------------------------</span>
0210 <a name="_sub6" href="#_subfunctions" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a>
0211 <span class="comment">% Empty</span>
0212 
0213 <span class="comment">% --------------------------------------------------------------------</span>
0214 <a name="_sub7" href="#_subfunctions" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a>
0215 <a href="#_sub45" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>(hObject, eventdata, handles)
0216 <span class="comment">% [EOF] menuOpenASCII_Callback</span>
0217 
0218 <span class="comment">% --------------------------------------------------------------------</span>
0219 <a name="_sub8" href="#_subfunctions" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a>
0220 
0221 <span class="comment">% Get the Application data:</span>
0222 <span class="comment">% -------------------------</span>
0223 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0224 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0225 
0226 <span class="comment">% Ask the user to select files:</span>
0227 <span class="comment">% -----------------------------</span>
0228 <span class="comment">% current_file = fullfile(guiparams.data_folder,guiparams.data_files{1});</span>
0229 <span class="comment">% current_file = fullfile(guiprefs.mat_path,guiprefs.mat_file);</span>
0230 <span class="keyword">if</span> iscell(guiprefs.mat_file)
0231     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file{1});
0232 <span class="keyword">else</span>
0233     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file);
0234 <span class="keyword">end</span>
0235 [filename,pathname] = <span class="keyword">...</span>
0236     uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-files (*.mat)'</span>}, <span class="keyword">...</span>
0237     <span class="string">'Select MAT File'</span>, <span class="keyword">...</span>
0238     uifile, <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
0239 
0240 <span class="keyword">if</span> ischar(filename) <span class="comment">% Single MAT file loaded</span>
0241     <span class="comment">% Load the data:</span>
0242     <span class="comment">% --------------</span>
0243     vars = load(fullfile(pathname,filename));
0244     
0245     <span class="comment">% Make sure the selected file is a valid file:</span>
0246     <span class="comment">% --------------------------------------------</span>
0247     varnames = fieldnames(vars);
0248     <span class="keyword">if</span> isequal(sort(varnames),{<span class="string">'A'</span> <span class="string">'Map'</span> <span class="string">'V'</span> <span class="string">'z'</span>}')
0249         guiparams.mat_path = pathname;
0250         guiparams.mat_file = filename;
0251         guiparams.z = vars.z;
0252         guiparams.A = vars.A;
0253         guiparams.V = vars.V;
0254         
0255         <span class="comment">% Update the preferences:</span>
0256         <span class="comment">% -----------------------</span>
0257         guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0258         guiprefs.mat_path = pathname;
0259         guiprefs.mat_file = filename;
0260         setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0261         <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0262                      
0263         <span class="comment">% Re-store the Application Data:</span>
0264         <span class="comment">% ------------------------------</span>
0265         setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0266         
0267         <span class="comment">% Update the GUI:</span>
0268         <span class="comment">% ---------------</span>
0269         <a href="#_sub89" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
0270     <span class="keyword">else</span> <span class="comment">% Not a valid file</span>
0271         errordlg(<span class="string">'The selected file is not a valid ADCP data MAT file.'</span>, <span class="keyword">...</span>
0272             <span class="string">'Invalid File...'</span>)
0273     <span class="keyword">end</span>
0274     
0275 <span class="keyword">elseif</span> iscell(filename) <span class="comment">% Multiple MAT files loaded</span>
0276     <span class="comment">% Set the filenames</span>
0277     <span class="comment">% -----------------</span>
0278     guiparams.mat_path = pathname;
0279     guiparams.mat_file = filename;
0280     
0281     <span class="comment">% Push status to log window</span>
0282     <span class="comment">% -------------------------</span>
0283     log_text = {<span class="keyword">...</span>
0284         <span class="string">'Loading previously processed MAT files.'</span>;<span class="keyword">...</span>
0285         <span class="string">'Directory:'</span>};
0286     log_text = vertcat(log_text, pathname, {<span class="string">'Files:'</span>}, filename');
0287     statusLogging(handles.LogWindow,log_text)
0288     
0289     <span class="comment">% Update the Application Data:</span>
0290     <span class="comment">% ------------------------------</span>
0291     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0292     
0293     <span class="comment">% Update the persistent preferences:</span>
0294     <span class="comment">% ----------------------------------</span>
0295     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0296     guiprefs.mat_path = pathname;
0297     guiprefs.mat_file = filename;
0298     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0299     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0300         
0301     <span class="comment">% Update the GUI:</span>
0302     <span class="comment">% ---------------</span>
0303     <a href="#_sub89" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'multiplematfiles'</span>)
0304 <span class="keyword">end</span>
0305 
0306 <span class="comment">% [EOF] menuOpenMAT_Callback</span>
0307 
0308 <span class="comment">% --------------------------------------------------------------------</span>
0309 <a name="_sub9" href="#_subfunctions" class="code">function menuSave_Callback(hObject, eventdata, handles)</a>
0310 <span class="comment">% Empty</span>
0311 
0312 <span class="comment">% --------------------------------------------------------------------</span>
0313 <a name="_sub10" href="#_subfunctions" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a>
0314 <a href="#_sub46" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>(hObject, eventdata, handles)
0315 <span class="comment">% [EOF] menuSaveMAT_Callback</span>
0316 
0317 <span class="comment">% --------------------------------------------------------------------</span>
0318 <a name="_sub11" href="#_subfunctions" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a>
0319 <a href="#_sub54" class="code" title="subfunction SaveTecplotFile_Callback(hObject, eventdata, handles)">SaveTecplotFile_Callback</a>(handles,eventdata,handles)
0320 <span class="comment">% [EOF] menuSaveTecplot_Callback</span>
0321 
0322 <span class="comment">% --------------------------------------------------------------------</span>
0323 <a name="_sub12" href="#_subfunctions" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a>
0324 <a href="#_sub55" class="code" title="subfunction SaveGoogleEarthFile_Callback(hObject, eventdata, handles)">SaveGoogleEarthFile_Callback</a>(handles,eventdata,handles)
0325 <span class="comment">% [EOF] menuSaveKMZFile_Callback</span>
0326 
0327 <span class="comment">% --------------------------------------------------------------------</span>
0328 <a name="_sub13" href="#_subfunctions" class="code">function menuExport_Callback(hObject, eventdata, handles)</a>
0329 <span class="comment">% Empty</span>
0330 
0331 <span class="comment">% --------------------------------------------------------------------</span>
0332 <a name="_sub14" href="#_subfunctions" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a>
0333 <span class="comment">% Empty</span>
0334 
0335 <span class="comment">% --------------------------------------------------------------------</span>
0336 <a name="_sub15" href="#_subfunctions" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a>
0337 
0338 <span class="comment">% Get the Application Data:</span>
0339 <span class="comment">% -------------------------</span>
0340 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0341 
0342 <span class="comment">% Update the Application Data:</span>
0343 <span class="comment">% ----------------------------</span>
0344 guiparams.print        = true;
0345 guiparams.presentation = false;
0346 
0347 <span class="comment">% Re-store the Application data:</span>
0348 <span class="comment">% ------------------------------</span>
0349 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0350 
0351 <span class="comment">% Update the GUI:</span>
0352 <span class="comment">% ---------------</span>
0353 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0354 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
0355 
0356 <span class="comment">% [EOF] menuPrintFormat_Callback</span>
0357 
0358 
0359 <span class="comment">% --------------------------------------------------------------------</span>
0360 <a name="_sub16" href="#_subfunctions" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a>
0361 
0362 <span class="comment">% Get the Application Data:</span>
0363 <span class="comment">% -------------------------</span>
0364 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0365 
0366 <span class="comment">% Update the Application Data:</span>
0367 <span class="comment">% ----------------------------</span>
0368 guiparams.print        = false;
0369 guiparams.presentation = true;
0370 
0371 <span class="comment">% Re-store the Application data:</span>
0372 <span class="comment">% ------------------------------</span>
0373 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0374 
0375 <span class="comment">% Update the GUI:</span>
0376 <span class="comment">% ---------------</span>
0377 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0378 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
0379 
0380 <span class="comment">% [EOF] menuPresentationFormat_Callback</span>
0381 
0382 <span class="comment">% --------------------------------------------------------------------</span>
0383 <a name="_sub17" href="#_subfunctions" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a>
0384 <span class="comment">% Get the Application data:</span>
0385 <span class="comment">% -------------------------</span>
0386 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0387 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0388 
0389 <span class="comment">% Find what plots exist already</span>
0390 fig_handles = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0391 fig_names   = get(fig_handles,<span class="string">'name'</span>);
0392 
0393 <span class="comment">% Remove the VMT GUI as a valid figure in the list</span>
0394 [~, idx] = ismember({get(handles.figure1,<span class="string">'Name'</span>),<span class="string">'VMT_GraphicsControl'</span>}, fig_names);
0395 <span class="keyword">if</span> ~isempty(idx)
0396     fig_names(idx) = [];
0397 <span class="keyword">end</span>
0398 
0399 <span class="keyword">if</span> guiparams.presentation
0400     figure_style = <span class="string">'presentation'</span>;
0401 <span class="keyword">else</span>
0402     figure_style = <span class="string">'print'</span>;
0403 <span class="keyword">end</span>
0404 
0405 [selected_figures] = <a href="#_sub99" class="code" title="subfunction [selected_figures] = openFiguresDialog(figure_names,hf)">openFiguresDialog</a>(fig_names,handles.figure1);
0406 
0407 <span class="keyword">if</span> isempty(selected_figures) <span class="comment">% User pressed cancel</span>
0408     <span class="keyword">return</span>
0409 <span class="keyword">else</span>
0410     <span class="keyword">for</span> i = 1:length(selected_figures)
0411         <a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>(guiprefs.mat_path,selected_figures(i),figure_style)
0412     <span class="keyword">end</span>
0413 <span class="keyword">end</span>
0414 
0415 
0416 <span class="comment">% [EOF] menuExportFigures_Callback</span>
0417 
0418 <span class="comment">% --------------------------------------------------------------------</span>
0419 <a name="_sub18" href="#_subfunctions" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a>
0420 <span class="comment">% Get the Application data:</span>
0421 <span class="comment">% -------------------------</span>
0422 guiparams              = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0423 beam_angle             = guiparams.beam_angle; 
0424 magnetic_variation     = guiparams.magnetic_variation; 
0425 wse                    = guiparams.wse;
0426 output_auxiliary_data = guiparams.output_auxiliary_data; 
0427 
0428 <span class="comment">% Open dialog and allow user to select settings</span>
0429 <span class="comment">% ---------------------------------------------</span>
0430 [beam_angle,<span class="keyword">...</span>
0431     magnetic_variation,<span class="keyword">...</span>
0432     wse,<span class="keyword">...</span>
0433     output_auxiliary_data] = <span class="keyword">...</span>
0434     <a href="#_sub97" class="code" title="subfunction [beam_angle,magnetic_variation,wse,output_auxiliary_data] = exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,hf)">exportSettingsDialog</a>(beam_angle,magnetic_variation,wse,output_auxiliary_data,handles.figure1);
0435 
0436 <span class="comment">% Re-store the Application data:</span>
0437 <span class="comment">% ------------------------------</span>
0438 guiparams.beam_angle            = beam_angle;
0439 guiparams.magnetic_variation    = magnetic_variation; 
0440 guiparams.wse                   = wse;
0441 guiparams.output_auxiliary_data = output_auxiliary_data;
0442 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0443 
0444 <span class="comment">% [EOF] menuExportSettings_Callback</span>
0445 
0446 <span class="comment">% --------------------------------------------------------------------</span>
0447 <a name="_sub19" href="#_subfunctions" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
0448 <a href="#_sub56" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>(hObject, eventdata, handles);
0449 <span class="comment">% [EOF] menuExportMultibeamBathymetry_Callback</span>
0450 
0451 
0452 <span class="comment">% --------------------------------------------------------------------</span>
0453 <a name="_sub20" href="#_subfunctions" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a>
0454 
0455 <span class="comment">% Get the Application Data:</span>
0456 <span class="comment">% -------------------------</span>
0457 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0458 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0459 PVdata    = guiparams.iric_anv_planview_data;
0460 iric_path = guiprefs.iric_path;
0461 iric_file = guiprefs.iric_file;
0462 
0463 <span class="comment">% Is there any planview data?</span>
0464 <span class="keyword">if</span> isempty(PVdata)
0465     <span class="comment">% Nothing to do, warn user</span>
0466     log_text = {<span class="string">'No planview plot data to export. User must Plot Plan View first.'</span>};
0467     warndlg(log_text{:},<span class="string">'Nothing to export'</span>)
0468 <span class="keyword">else</span>
0469     <span class="comment">% Save the planview data as output and to an *.anv file with spacing</span>
0470     <span class="comment">% and smoothing (for iRiC)</span>
0471     log_text = {<span class="string">'Exporting iRic formated ANV vector file...'</span>};
0472     [iric_file,iric_path] = uiputfile(<span class="string">'*.anv'</span>,<span class="string">'Save *.anv file'</span>,<span class="keyword">...</span>
0473         fullfile(iric_path,iric_file));
0474     
0475     <span class="keyword">if</span> ischar(iric_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0476         outfile = fullfile(iric_path,iric_file);
0477         log_text = vertcat(log_text,{outfile});
0478         ofid   = fopen(outfile, <span class="string">'wt'</span>);
0479         outcount = fprintf(ofid,<span class="keyword">...</span>
0480             <span class="string">'%8.2f  %8.2f  %5.2f  %3.3f  %3.3f\n'</span>,PVdata.outmat);
0481         fclose(ofid);
0482     <span class="keyword">else</span>
0483         <span class="comment">% Return default iric_path and iric_file</span>
0484         iric_path = guiprefs.iric_path;
0485         iric_file = guiprefs.iric_file;
0486     <span class="keyword">end</span>
0487 <span class="keyword">end</span>
0488 
0489 <span class="comment">% Push messages to Log Window:</span>
0490 <span class="comment">% ----------------------------</span>
0491 statusLogging(handles.LogWindow, log_text)
0492 
0493 <span class="comment">% Store the persistent preferences:</span>
0494 <span class="comment">% ---------------------------------</span>
0495 guiprefs.iric_file = iric_file;
0496 guiprefs.iric_path = iric_path;
0497 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0498 <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'iric'</span>)
0499 
0500 <span class="comment">% [EOF] menuSaveANVFile_Callback</span>
0501 
0502 <span class="comment">% --------------------------------------------------------------------</span>
0503 <a name="_sub21" href="#_subfunctions" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a>
0504 <span class="comment">% Get the Application Data:</span>
0505 <span class="comment">% -------------------------</span>
0506 guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0507 guiprefs    = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0508 excel_path  = guiprefs.excel_path;
0509 excel_file  = guiprefs.excel_file;
0510 
0511 <span class="comment">% Push messages to Log Window:</span>
0512 <span class="comment">% ----------------------------</span>
0513 log_text = {<span class="string">'Exporting Excel File (reprocessing dataset; this will create new plots)'</span>};
0514 statusLogging(handles.LogWindow, log_text)
0515 
0516 <span class="comment">% If there are multiple MAT files loaded, go ahead and export just the DAV</span>
0517 <span class="comment">% data.</span>
0518 <span class="keyword">if</span> iscell(guiparams.mat_file)
0519     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0520     <a href="#_sub51" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0521     <span class="comment">% Refresh the Application Data:</span>
0522     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0523     z           = guiparams.z;
0524     A           = guiparams.A;
0525     V           = guiparams.V;
0526     Map         = guiparams.Map;
0527     wse         = guiparams.wse;
0528     PVdata      = guiparams.iric_anv_planview_data;
0529     log_text = {<span class="string">'Writing data to Excel file...'</span>;<span class="keyword">...</span>
0530         <span class="string">'Multiple transected loaded. Will export Planview Data Only!'</span>};
0531     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
0532         fullfile(excel_path,excel_file));
0533     
0534     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0535         outfile = fullfile(excel_path,excel_file);
0536         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0537         
0538     <span class="keyword">else</span>
0539         <span class="comment">% Return default excel_path and excel_file</span>
0540         excel_path = guiprefs.excel_path;
0541         excel_file = guiprefs.excel_file;
0542         outfile = fullfile(excel_path,excel_file);
0543         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0544     <span class="keyword">end</span>
0545     
0546     <span class="comment">% Delete the old file if it exists</span>
0547     <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
0548         log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
0549             [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
0550             <span class="string">'already exists. Overwriting file...'</span>});
0551         delete(outfile)
0552     <span class="keyword">end</span>
0553     
0554     <span class="comment">% Save DAV data to an Excel File</span>
0555     hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
0556     vmin = num2str(guiparams.depth_range_min);
0557     vmax = num2str(guiparams.depth_range_max);
0558     pvheaders = {<span class="keyword">...</span>
0559         <span class="string">'UTM_East'</span> <span class="string">'UTM_North'</span> <span class="string">'Elev_m'</span><span class="keyword">...</span>
0560         [<span class="string">'EastDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0561         [<span class="string">'NorthDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]};
0562     PVdata.outmat(4:5,:) = PVdata.outmat(4:5,:).*100; <span class="comment">% velocities in cm/s</span>
0563     pvdata = num2cell(PVdata.outmat');
0564     pvout = vertcat(pvheaders,pvdata);
0565     xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
0566     waitbar(1,hwait)
0567     delete(hwait)
0568     
0569     <span class="comment">% Push messages to Log Window:</span>
0570     <span class="comment">% ----------------------------</span>
0571     statusLogging(handles.LogWindow, log_text)
0572 <span class="keyword">else</span>
0573     
0574     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0575     <a href="#_sub51" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0576     <a href="#_sub52" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
0577     <span class="comment">% Refresh the Application Data:</span>
0578     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0579     z           = guiparams.z;
0580     A           = guiparams.A;
0581     V           = guiparams.V;
0582     Map         = guiparams.Map;
0583     wse         = guiparams.wse;
0584     PVdata      = guiparams.iric_anv_planview_data;
0585     
0586     
0587     log_text = {<span class="string">'Writing data to Excel file...'</span>};
0588     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
0589         fullfile(excel_path,excel_file));
0590     
0591     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0592         outfile = fullfile(excel_path,excel_file);
0593         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0594         
0595         <span class="comment">% Delete the old file if it exists</span>
0596         <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
0597             log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
0598                 [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
0599                 <span class="string">'already exists. Overwriting file...'</span>});
0600             delete(outfile)
0601         <span class="keyword">end</span>
0602         
0603         <span class="comment">% Push messages to Log Window:</span>
0604         <span class="comment">% ----------------------------</span>
0605         statusLogging(handles.LogWindow, log_text)
0606         
0607         <span class="comment">% Save MCS Summary to an Excel File</span>
0608         hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
0609         xlswrite(outfile,{<span class="string">'Files:'</span>},<span class="string">'VMTSummary'</span>,<span class="string">'H4'</span>); waitbar(1/5,hwait)
0610         sout = guiparams.data_files';
0611         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'I4'</span>); waitbar(2/5,hwait)
0612         sout = {<span class="keyword">...</span>
0613             <span class="string">'VMT: Summary of Mean Cross Section'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0614             <span class="string">'VMT '</span> guiparams.vmt_version <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0615             <span class="string">'Date Processed: '</span> datestr(now) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0616             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0617             <span class="string">'Mean Cross Section (MCS) Properties'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0618             <span class="string">'Horz. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.horizontal_grid_node_spacing;<span class="keyword">...</span>
0619             <span class="string">'Vert. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> single(guiparams.A(1).Sup.binSize_cm)/100;<span class="keyword">...</span>
0620             <span class="string">'Endpoints:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">'UTM_East'</span>    <span class="string">'UTM_North'</span>;<span class="keyword">...</span>
0621             <span class="string">'Left Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xLeftBank V.yLeftBank;<span class="keyword">...</span>
0622             <span class="string">'Right Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xRightBank V.yRightBank;<span class="keyword">...</span>
0623             <span class="string">'Total Length in meters'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.dl;<span class="keyword">...</span>
0624             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0625             <span class="string">'Mean Flow Direction (deg)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.mfd;<span class="keyword">...</span>
0626             <span class="string">'in geographic coordinates'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0627             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0628             <span class="string">'Slope'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.m;<span class="keyword">...</span>
0629             <span class="string">'Intercept'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.b;<span class="keyword">...</span>
0630             <span class="string">'Theta (deg)'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.theta};
0631         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'A1'</span>); waitbar(3/5,hwait)
0632         
0633         <span class="comment">% Save DAV data to an Excel File</span>
0634         vmin = num2str(guiparams.depth_range_min);
0635         vmax = num2str(guiparams.depth_range_max);
0636         pvheaders = {<span class="keyword">...</span>
0637             <span class="string">'UTM_East'</span> <span class="string">'UTM_North'</span> <span class="string">'Elev_m'</span><span class="keyword">...</span>
0638             [<span class="string">'EastDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0639             [<span class="string">'NorthDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]};
0640         PVdata.outmat(4:5,:) = PVdata.outmat(4:5,:).*100; <span class="comment">% velocities in cm/s</span>
0641         pvdata = num2cell(PVdata.outmat');
0642         pvout = vertcat(pvheaders,pvdata);
0643         xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
0644         waitbar(4/5,hwait)
0645         
0646         <span class="comment">% Save MCS data to an Excel File</span>
0647         mcsheaders = {<span class="keyword">...</span>
0648             <span class="string">'UTM_East'</span> <span class="keyword">...</span>
0649             <span class="string">'UTM_North'</span><span class="keyword">...</span>
0650             <span class="string">'Distance from Left Bank, in meters'</span><span class="keyword">...</span>
0651             <span class="string">'Elevation, in meters'</span><span class="keyword">...</span>
0652             <span class="string">'Bed Elevation, in meters'</span><span class="keyword">...</span>
0653             <span class="string">'East Velocity, in cm/s'</span><span class="keyword">...</span>
0654             <span class="string">'North Velocity, in cm/s'</span><span class="keyword">...</span>
0655             <span class="string">'Vertical Velocity, in cm/s'</span><span class="keyword">...</span>
0656             <span class="string">'Velocity Magnitude, in cm/s'</span><span class="keyword">...</span>
0657             <span class="string">'Velocity Direction, in degrees (geographic coordinates)'</span><span class="keyword">...</span>
0658             <span class="string">'Streamwise Velocity, in cm/s'</span><span class="keyword">...</span>
0659             <span class="string">'Transverse Velocity, in cm/s'</span><span class="keyword">...</span>
0660             <span class="string">'Primary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
0661             <span class="string">'Secondary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
0662             <span class="string">'Primary Velocity (roz), in cm/s'</span><span class="keyword">...</span>
0663             <span class="string">'Secondary Velocity (roz), in cm/s'</span>};
0664         
0665         mcsdata = [<span class="keyword">...</span>
0666             V.mcsX(:)<span class="keyword">...</span>
0667             V.mcsY(:)<span class="keyword">...</span>
0668             V.mcsDist(:)<span class="keyword">...</span>
0669             (wse - V.mcsDepth(:))<span class="keyword">...</span>
0670             repmat((wse - V.mcsBed(:)),size(V.mcsX,1),1)<span class="keyword">...</span>
0671             V.mcsEast(:)<span class="keyword">...</span>
0672             V.mcsNorth(:)<span class="keyword">...</span>
0673             V.mcsVert(:)<span class="keyword">...</span>
0674             V.mcsMag(:)<span class="keyword">...</span>
0675             V.mcsDir(:)<span class="keyword">...</span>
0676             V.u(:)<span class="keyword">...</span>
0677             V.v(:)<span class="keyword">...</span>
0678             V.vp(:)<span class="keyword">...</span>
0679             V.vs(:)<span class="keyword">...</span>
0680             V.Roz.up(:)<span class="keyword">...</span>
0681             V.Roz.us(:)];
0682         mcsdata(isnan(mcsdata)) = -9999;
0683         
0684         mcsout = vertcat(mcsheaders,num2cell(mcsdata));
0685         xlswrite(outfile,mcsout,<span class="string">'MeanCrossSection'</span>);
0686         waitbar(1,hwait)
0687         delete(hwait)
0688         
0689     <span class="keyword">else</span>
0690         <span class="comment">% Return default excel_path and excel_file</span>
0691         excel_path = guiprefs.excel_path;
0692         excel_file = guiprefs.excel_file;
0693         outfile = fullfile(excel_path,excel_file);
0694         log_text = {<span class="string">'User aborted Excel export...'</span>};
0695     <span class="keyword">end</span>
0696     
0697     
0698     
0699 <span class="keyword">end</span>
0700 
0701 <span class="comment">% Push messages to Log Window:</span>
0702 <span class="comment">% ----------------------------</span>
0703 statusLogging(handles.LogWindow, log_text)
0704 
0705 <span class="comment">% Store the persistent preferences:</span>
0706 <span class="comment">% ---------------------------------</span>
0707 guiprefs.excel_file = excel_file;
0708 guiprefs.excel_path = excel_path;
0709 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0710 <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'excel'</span>)
0711 
0712 <span class="comment">% [EOF] menuSaveExcel_Callback</span>
0713 
0714 <span class="comment">% --------------------------------------------------------------------</span>
0715 <a name="_sub22" href="#_subfunctions" class="code">function menuParameters_Callback(hObject, eventdata, handles)</a>
0716 <span class="comment">% Empty</span>
0717 
0718 <span class="comment">% --------------------------------------------------------------------</span>
0719 <a name="_sub23" href="#_subfunctions" class="code">function menuProcessingParameters_Callback(hObject, eventdata, handles)</a>
0720 <span class="comment">% Empty</span>
0721 
0722 <span class="comment">% --------------------------------------------------------------------</span>
0723 <a name="_sub24" href="#_subfunctions" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a>
0724 <span class="comment">% Turn ON or OFF Unit Discharge Correction</span>
0725 
0726 <span class="comment">% Get the Application Data:</span>
0727 <span class="comment">% -------------------------</span>
0728 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0729 
0730 <span class="comment">% Update the GUI &amp; Application Data:</span>
0731 <span class="comment">% ----------------------------------</span>
0732 status = get(handles.menuUnitDischargeCorrection,<span class="string">'Checked'</span>);
0733 <span class="keyword">switch</span> status
0734     <span class="keyword">case</span> <span class="string">'on'</span> <span class="comment">% Turn it off</span>
0735         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0736         guiparams.unit_discharge_correction = false;
0737     <span class="keyword">case</span> <span class="string">'off'</span> <span class="comment">% Turn it on</span>
0738         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0739         guiparams.unit_discharge_correction = true;
0740 <span class="keyword">end</span>
0741 
0742 <span class="comment">% Re-store the Application data:</span>
0743 <span class="comment">% ------------------------------</span>
0744 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0745 
0746 
0747 <span class="comment">%  [EOF] menuUnitDischargeCorrection_Callback</span>
0748 
0749 <span class="comment">% --------------------------------------------------------------------</span>
0750 <a name="_sub25" href="#_subfunctions" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a>
0751 <span class="comment">% Empty</span>
0752 
0753 <span class="comment">% --------------------------------------------------------------------</span>
0754 <a name="_sub26" href="#_subfunctions" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a>
0755 <span class="comment">% Empty</span>
0756 
0757 <span class="comment">% --------------------------------------------------------------------</span>
0758 <a name="_sub27" href="#_subfunctions" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a>
0759 <span class="comment">% Set the Plotting Parameter Units to &quot;metric&quot;</span>
0760 
0761 <span class="comment">% Get the Application Data:</span>
0762 <span class="comment">% -------------------------</span>
0763 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0764 
0765 <span class="comment">% Update the Application Data:</span>
0766 <span class="comment">% ----------------------------</span>
0767 guiparams.english_units = false;
0768 
0769 <span class="comment">% Re-store the Application data:</span>
0770 <span class="comment">% ------------------------------</span>
0771 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0772 
0773 <span class="comment">% Update the GUI:</span>
0774 <span class="comment">% ---------------</span>
0775 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0776 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
0777 
0778 <span class="comment">% [EOF] menuMetric_Callback</span>
0779 
0780 
0781 <span class="comment">% --------------------------------------------------------------------</span>
0782 <a name="_sub28" href="#_subfunctions" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a>
0783 <span class="comment">% Set the Plotting Parameter Units to &quot;english&quot;</span>
0784 
0785 <span class="comment">% Get the Application Data:</span>
0786 <span class="comment">% -------------------------</span>
0787 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0788 
0789 <span class="comment">% Update the Application Data:</span>
0790 <span class="comment">% ----------------------------</span>
0791 guiparams.english_units = true;
0792 
0793 <span class="comment">% Re-store the Application data:</span>
0794 <span class="comment">% ------------------------------</span>
0795 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0796 
0797 <span class="comment">% Update the GUI:</span>
0798 <span class="comment">% ---------------</span>
0799 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0800 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
0801 
0802 <span class="comment">% [EOF] menuEnglish_Callback</span>
0803 
0804 
0805 <span class="comment">% --------------------------------------------------------------------</span>
0806 <a name="_sub29" href="#_subfunctions" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
0807 <span class="comment">% Empty</span>
0808 
0809 <span class="comment">% --------------------------------------------------------------------</span>
0810 <a name="_sub30" href="#_subfunctions" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a>
0811 <span class="comment">% Set cross-section endpoints automatically</span>
0812 
0813 <span class="comment">% Get the Application Data:</span>
0814 <span class="comment">% -------------------------</span>
0815 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0816 
0817 <span class="comment">% Update the Application Data:</span>
0818 <span class="comment">% ----------------------------</span>
0819 guiparams.set_cross_section_endpoints = false;
0820 
0821 <span class="comment">% Re-store the Application data:</span>
0822 <span class="comment">% ------------------------------</span>
0823 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0824 
0825 <span class="comment">% Update the GUI:</span>
0826 <span class="comment">% ---------------</span>
0827 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0828 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0829 
0830 <span class="comment">% [EOF] menuCrossSectionEndpointAutomatic_Callback</span>
0831 
0832 
0833 <span class="comment">% --------------------------------------------------------------------</span>
0834 <a name="_sub31" href="#_subfunctions" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a>
0835 <span class="comment">% Set cross-section endpoints manually</span>
0836 
0837 <span class="comment">% Get the Application Data:</span>
0838 <span class="comment">% -------------------------</span>
0839 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0840 
0841 <span class="comment">% Update the Application Data:</span>
0842 <span class="comment">% ----------------------------</span>
0843 guiparams.set_cross_section_endpoints = true;
0844 
0845 <span class="comment">% Re-store the Application data:</span>
0846 <span class="comment">% ------------------------------</span>
0847 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0848 
0849 <span class="comment">% Update the GUI:</span>
0850 <span class="comment">% ---------------</span>
0851 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0852 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0853 
0854 <span class="comment">% [EOF] menuCrossSectionEndpointManual_Callback</span>
0855 
0856 
0857 
0858 
0859 <span class="comment">% --------------------------------------------------------------------</span>
0860 <a name="_sub32" href="#_subfunctions" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a>
0861 <span class="comment">% Empty</span>
0862 
0863 <span class="comment">% --------------------------------------------------------------------</span>
0864 <a name="_sub33" href="#_subfunctions" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a>
0865 
0866 <span class="comment">% Get the Application Data:</span>
0867 <span class="comment">% -------------------------</span>
0868 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0869 
0870 <span class="comment">% Update the Application Data:</span>
0871 <span class="comment">% ----------------------------</span>
0872 guiparams.print        = true;
0873 guiparams.presentation = false;
0874 
0875 <span class="comment">% Re-store the Application data:</span>
0876 <span class="comment">% ------------------------------</span>
0877 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0878 
0879 <span class="comment">% Update the GUI:</span>
0880 <span class="comment">% ---------------</span>
0881 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0882 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0883 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0884 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
0885 
0886 <span class="comment">% Modify the existing figures</span>
0887 <span class="comment">% ---------------------------</span>
0888 <span class="comment">% Find what plots exist already</span>
0889 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0890 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0891 
0892 <span class="comment">% Defaults for Print Stlye Figure</span>
0893 BkgdColor   = <span class="string">'white'</span>;
0894 AxColor     = <span class="string">'black'</span>;
0895 FigColor    = <span class="string">'white'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
0896 FntSize     = 14;
0897 
0898 <span class="comment">% Loop through valid figures and adjust</span>
0899 <span class="comment">% -------------------------------------</span>
0900 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0901     
0902     <span class="keyword">for</span> i = 1:length(valid_names)
0903         <span class="keyword">switch</span> valid_names{i}
0904             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
0905                 <span class="comment">% Focus the figure</span>
0906                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0907                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0908                     figure(hff)
0909                     
0910                     <span class="comment">% Make the changes to figure</span>
0911                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
0912                     set(gca,<span class="string">'FontSize'</span>,FntSize)
0913                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
0914                     set(gca,<span class="string">'Color'</span>,FigColor)
0915                     set(gca,<span class="string">'XColor'</span>,AxColor)
0916                     set(gca,<span class="string">'YColor'</span>,AxColor)
0917                     set(gca,<span class="string">'ZColor'</span>,AxColor)
0918                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
0919                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0920                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0921                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0922                 <span class="keyword">end</span>
0923             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
0924                 <span class="comment">% Focus the figure</span>
0925                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0926                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0927                     figure(hff)
0928                     
0929                     <span class="comment">% Make the changes to figure</span>
0930                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
0931                     set(gca,<span class="string">'FontSize'</span>,FntSize)
0932                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
0933                     set(gca,<span class="string">'Color'</span>,FigColor)
0934                     set(gca,<span class="string">'XColor'</span>,AxColor)
0935                     set(gca,<span class="string">'YColor'</span>,AxColor)
0936                     set(gca,<span class="string">'ZColor'</span>,AxColor)
0937                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
0938                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0939                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0940                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0941                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
0942                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
0943                 <span class="keyword">end</span>
0944             <span class="keyword">otherwise</span>
0945         <span class="keyword">end</span>
0946     <span class="keyword">end</span>
0947     
0948     
0949 <span class="keyword">end</span>
0950 
0951 
0952 <span class="comment">%[EOF] menuStylePrint_Callback</span>
0953 
0954 
0955 <span class="comment">% --------------------------------------------------------------------</span>
0956 <a name="_sub34" href="#_subfunctions" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a>
0957 <span class="comment">% Get the Application Data:</span>
0958 <span class="comment">% -------------------------</span>
0959 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0960 
0961 <span class="comment">% Update the Application Data:</span>
0962 <span class="comment">% ----------------------------</span>
0963 guiparams.print        = false;
0964 guiparams.presentation = true;
0965 
0966 <span class="comment">% Re-store the Application data:</span>
0967 <span class="comment">% ------------------------------</span>
0968 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0969 
0970 <span class="comment">% Update the GUI:</span>
0971 <span class="comment">% ---------------</span>
0972 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0973 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0974 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0975 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
0976 
0977 <span class="comment">% Modify the existing figures</span>
0978 <span class="comment">% ---------------------------</span>
0979 <span class="comment">% Find what plots exist already</span>
0980 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0981 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0982 
0983 <span class="comment">% Defaults for Presentation Stlye Figure</span>
0984 <span class="comment">% --------------------------------------</span>
0985 BkgdColor   = <span class="string">'black'</span>;
0986 AxColor     = <span class="string">'white'</span>;
0987 FigColor    = <span class="string">'black'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
0988 FntSize     = 14;
0989 
0990 <span class="comment">% Loop through valid figures and adjust</span>
0991 <span class="comment">% -------------------------------------</span>
0992 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0993     
0994     <span class="keyword">for</span> i = 1:length(valid_names)
0995         <span class="keyword">switch</span> valid_names{i}
0996             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
0997                 <span class="comment">% Focus the figure</span>
0998                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0999                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1000                     figure(hff)
1001                     
1002                     <span class="comment">% Make the changes to figure</span>
1003                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1004                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1005                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1006                     set(gca,<span class="string">'Color'</span>,FigColor)
1007                     set(gca,<span class="string">'XColor'</span>,AxColor)
1008                     set(gca,<span class="string">'YColor'</span>,AxColor)
1009                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1010                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1011                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1012                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1013                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1014                 <span class="keyword">end</span>
1015             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
1016                 <span class="comment">% Focus the figure</span>
1017                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
1018                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1019                     figure(hff)
1020                     
1021                     <span class="comment">% Make the changes to figure</span>
1022                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1023                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1024                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1025                     set(gca,<span class="string">'Color'</span>,[0.3 0.3 0.3]) <span class="comment">%FigColor)</span>
1026                     set(gca,<span class="string">'XColor'</span>,AxColor)
1027                     set(gca,<span class="string">'YColor'</span>,AxColor)
1028                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1029                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1030                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1031                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1032                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1033                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
1034                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
1035                 <span class="keyword">end</span>
1036             <span class="keyword">otherwise</span>
1037         <span class="keyword">end</span>
1038     <span class="keyword">end</span>
1039     
1040     
1041 <span class="keyword">end</span>
1042 
1043 <span class="comment">% [EOF] menuStylePresentation_Callback</span>
1044 
1045 <span class="comment">% --------------------------------------------------------------------</span>
1046 <a name="_sub35" href="#_subfunctions" class="code">function menuKMZExport_Callback(hObject, eventdata, handles)</a>
1047 
1048 <span class="comment">% Get the Application data:</span>
1049 <span class="comment">% -------------------------</span>
1050 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1051 
1052 <span class="comment">% Initialize the answer:</span>
1053 <span class="comment">% ----------------------</span>
1054 numstr = {num2str(guiparams.vertical_offset)};
1055 answer = NaN;
1056 <span class="keyword">while</span> isnan(answer)
1057     answer = inputdlg(<span class="string">'Vertical Offset (m)'</span>,<span class="string">'KMZ Export'</span>,1,numstr);
1058     
1059     <span class="keyword">if</span> isempty(answer) <span class="comment">% User hits &quot;Cancel&quot;</span>
1060         <span class="keyword">return</span>
1061     <span class="keyword">end</span>
1062     
1063     answer = str2double(answer); <span class="comment">% A non-numeric char will be NaN</span>
1064     <span class="comment">% A numeric char will be a double</span>
1065 <span class="keyword">end</span>
1066 
1067 <span class="comment">% Re-store the Application data:</span>
1068 <span class="comment">% ------------------------------</span>
1069 guiparams.vertical_offset = answer;
1070 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1071 
1072 <span class="comment">% [EOF] menuKMZExport_Callback</span>
1073 
1074 <span class="comment">% --------------------------------------------------------------------</span>
1075 <a name="_sub36" href="#_subfunctions" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a>
1076 <span class="comment">% Not implemented</span>
1077 
1078 <span class="comment">% --------------------------------------------------------------------</span>
1079 <a name="_sub37" href="#_subfunctions" class="code">function menuTools_Callback(hObject, eventdata, handles)</a>
1080 <span class="comment">% Empty</span>
1081 
1082 <span class="comment">% --------------------------------------------------------------------</span>
1083 <a name="_sub38" href="#_subfunctions" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a>
1084 ASCII2GIS_GUI
1085 <span class="comment">% [EOF] menuASCII2GIS_Callback</span>
1086 
1087 <span class="comment">% --------------------------------------------------------------------</span>
1088 <a name="_sub39" href="#_subfunctions" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a>
1089 
1090 <span class="comment">% Get the Application preferences:</span>
1091 <span class="comment">% --------------------------------</span>
1092 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1093 
1094 inpath = guiprefs.kmz_path;
1095 <span class="keyword">if</span> iscell(guiprefs.kmz_file)
1096     infile = guiprefs.kmz_file{1};
1097 <span class="keyword">else</span>
1098     infile = guiprefs.kmz_file;
1099 <span class="keyword">end</span>
1100 [log_text,outpath,outfile] = ASCII2KML(inpath,infile);
1101 
1102 guiprefs.kmz_path = outpath;
1103 guiprefs.kmz_file = outfile;
1104 
1105 <span class="comment">% Update persistent preferences</span>
1106 <span class="comment">% -----------------------------</span>
1107 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1108 
1109 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1110 
1111 <span class="comment">% --------------------------------------------------------------------</span>
1112 <a name="_sub40" href="#_subfunctions" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a>
1113 <span class="comment">% Empty</span>
1114 
1115 <span class="comment">% --------------------------------------------------------------------</span>
1116 <a name="_sub41" href="#_subfunctions" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a>
1117 <span class="keyword">try</span>
1118     web(<span class="string">'http://code.google.com/p/velocity-mapping-tool/wiki/UserGuide?tm=6'</span>)
1119 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
1120     <span class="keyword">if</span> isdeployed
1121         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1122             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1123         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1124             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1125             errLogFileName},<span class="keyword">...</span>
1126             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1127             <span class="string">'error'</span>);
1128         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1129         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1130         fclose(fid);
1131         rethrow(err)
1132     <span class="keyword">else</span>
1133         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1134             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1135             <span class="string">'error'</span>);
1136         rethrow(err);
1137     <span class="keyword">end</span>
1138 <span class="keyword">end</span>
1139 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1140 
1141 <span class="comment">% --------------------------------------------------------------------</span>
1142 <a name="_sub42" href="#_subfunctions" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a>
1143 <span class="comment">% Get the Application data:</span>
1144 <span class="comment">% -------------------------</span>
1145 <span class="comment">% guiparams = getappdata(handles.figure1,'guiparams'); %#ok&lt;NASGU&gt;</span>
1146 
1147 <span class="keyword">try</span>
1148     <span class="comment">% Construct a URL to a local file which can be interpreted by any</span>
1149     <span class="comment">% web-browser</span>
1150     rootpath = strrep(pwd,filesep,<span class="string">'/'</span>);
1151     webaddress = [<span class="string">'file:///'</span> rootpath <span class="string">'/doc/index.html'</span>];
1152     system([<span class="string">'start '</span> webaddress]);
1153 <span class="comment">%     [stat,h,url] = web(webaddress) % Produced with m2html (FEX)</span>
1154 <span class="keyword">catch</span> err 
1155     <span class="keyword">if</span> isdeployed
1156         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1157             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1158         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1159             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1160             errLogFileName},<span class="keyword">...</span>
1161             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1162             <span class="string">'error'</span>);
1163         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1164         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1165         fclose(fid);
1166         rethrow(err)
1167     <span class="keyword">else</span>
1168         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1169             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1170             <span class="string">'error'</span>);
1171         rethrow(err);
1172     <span class="keyword">end</span>
1173 <span class="keyword">end</span>
1174 
1175 <span class="comment">% [EOF] menuFunctionLibrary_Callback</span>
1176 
1177 <span class="comment">% --------------------------------------------------------------------</span>
1178 <a name="_sub43" href="#_subfunctions" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a>
1179 
1180 <span class="comment">% Get the Application data:</span>
1181 <span class="comment">% -------------------------</span>
1182 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1183 
1184 <span class="comment">% Check version tag against the web, and display a message</span>
1185 <span class="keyword">try</span>
1186     current_vmt_version = urlread(<span class="string">'http://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt'</span>);
1187     <span class="comment">%     current_vmt_version = urlread('http://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt');</span>
1188 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
1189     <span class="keyword">if</span> isdeployed
1190         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1191             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1192         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1193             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1194             errLogFileName},<span class="keyword">...</span>
1195             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1196             <span class="string">'error'</span>);
1197         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1198         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1199         fclose(fid);
1200         rethrow(err)
1201     <span class="keyword">else</span>
1202         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1203             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1204             <span class="string">'error'</span>);
1205         rethrow(err);
1206     <span class="keyword">end</span>
1207 <span class="keyword">end</span>
1208 
1209 <span class="keyword">if</span> strcmpi(guiparams.vmt_version,current_vmt_version)
1210     h = msgbox(<span class="string">'VMT is currently up to date, no updates available.'</span>,<span class="string">'Check for updates'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1211 <span class="keyword">else</span>
1212     h = msgbox(<span class="string">'VMT is out of date. Please visit the VMT homepage.'</span>,<span class="string">'Check for updates'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1213 <span class="keyword">end</span>
1214 <span class="comment">% [EOF] menuCheckForUpdates_Callback</span>
1215 
1216 <span class="comment">% --------------------------------------------------------------------</span>
1217 <a name="_sub44" href="#_subfunctions" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a>
1218 
1219 <span class="comment">% Get the Application data:</span>
1220 <span class="comment">% -------------------------</span>
1221 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1222 messagestr = <span class="keyword">...</span>
1223     {<span class="string">'The Velocity Mapping Toolbox'</span>;<span class="keyword">...</span>
1224     [<span class="string">'   Version: '</span> guiparams.vmt_version];<span class="keyword">...</span>
1225     <span class="string">''</span>;<span class="keyword">...</span>
1226     <span class="string">''</span>;<span class="keyword">...</span>
1227     <span class="string">'With collaborations from:'</span>;<span class="keyword">...</span>
1228     <span class="string">'   U.S. Geological Survey'</span>;<span class="keyword">...</span>
1229     <span class="string">'   University of Illinois'</span>;<span class="keyword">...</span>
1230     <span class="string">'   University of Hull'</span>;<span class="keyword">...</span>
1231     <span class="string">''</span>;<span class="keyword">...</span>
1232     <span class="string">''</span>;<span class="keyword">...</span>
1233     <span class="string">'Citation: '</span>;<span class="keyword">...</span>
1234     <span class="string">'   Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L.,'</span>;<span class="keyword">...</span>
1235     <span class="string">'   Rhoads, B. L., Oberg, K. A., Best, J. L., Mueller, D. S.,'</span>;<span class="keyword">...</span>
1236     <span class="string">'   Johnson, K. K. and Riley, J. D. (2013), Velocity Mapping'</span>;<span class="keyword">...</span>
1237     <span class="string">'   Toolbox (VMT): a processing and visualization suite for'</span>;<span class="keyword">...</span>
1238     <span class="string">'   moving-vessel ADCP measurements. Earth Surf. Process.'</span>;<span class="keyword">...</span>
1239     <span class="string">'   Landforms.doi: 10.1002/esp.3367'</span>};
1240 h = msgbox(messagestr,<span class="string">'About VMT'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1241 <span class="comment">% [EOF] menuAbout_Callback</span>
1242 
1243 
1244 
1245 
1246 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
1247 <span class="comment">% TOOLBAR CALLBACKS %</span>
1248 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
1249 
1250 <span class="comment">% --------------------------------------------------------------------</span>
1251 <a name="_sub45" href="#_subfunctions" class="code">function loadDataCallback(hObject, eventdata, handles)</a>
1252 <span class="comment">% Read Files into Data Structure using tfile.</span>
1253 
1254 <span class="comment">% Get the Application data:</span>
1255 <span class="comment">% -------------------------</span>
1256 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1257 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1258 
1259 <span class="comment">% Ask the user to select files:</span>
1260 <span class="comment">% -----------------------------</span>
1261 current_file = fullfile(guiprefs.ascii_path,guiprefs.ascii_file{1});
1262 [filename,pathname] = uigetfile({<span class="string">'*_ASC.TXT'</span>,<span class="string">'ASCII (*_ASC.TXT)'</span>}, <span class="keyword">...</span>
1263     <span class="string">'Select the ASCII Output Files'</span>, <span class="keyword">...</span>
1264     current_file, <span class="keyword">...</span>
1265     <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
1266 
1267 <span class="keyword">if</span> ischar(pathname) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
1268     guiparams.data_folder = pathname;
1269     <span class="keyword">if</span> ischar(filename)
1270         filename = {filename};
1271     <span class="keyword">end</span>
1272     guiparams.data_files = filename;
1273     guiparams.mat_file = <span class="string">''</span>;
1274     
1275     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1276     
1277    
1278     
1279     <span class="comment">% Update the preferences:</span>
1280     <span class="comment">% -----------------------</span>
1281     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1282     guiprefs.ascii_path = pathname;
1283     guiprefs.ascii_file = filename;
1284     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1285     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'ascii'</span>)
1286     
1287     <span class="comment">% Push messages to Log Window:</span>
1288     <span class="comment">% ----------------------------</span>
1289     log_text = {<span class="keyword">...</span>
1290         <span class="string">''</span>;<span class="keyword">...</span>
1291         [<span class="string">'%--- '</span> datestr(now) <span class="string">' ---%'</span>];<span class="keyword">...</span>
1292         <span class="string">'Current Project Directory:'</span>;<span class="keyword">...</span>
1293         guiparams.data_folder;
1294         <span class="string">'Loading the following files into memory:'</span>;<span class="keyword">...</span>
1295         char(filename)};
1296     statusLogging(handles.LogWindow, log_text)
1297     
1298     <span class="comment">% Read the file(s)</span>
1299     <span class="comment">% ----------------</span>
1300     [~,~,savefile,A,z] = <span class="keyword">...</span>
1301         <a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>(guiparams.data_folder,guiparams.data_files);
1302     guiparams.savefile = savefile;
1303     guiparams.A        = A;
1304     guiparams.z        = z;
1305     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1306 <span class="comment">%</span>
1307 <span class="comment">%     % Preprocess the data:</span>
1308 <span class="comment">%     % --------------------</span>
1309 <span class="comment">%     A = VMT_PreProcess(z,A);</span>
1310 <span class="comment">%</span>
1311 <span class="comment">%     % Push messages to Log Window:</span>
1312 <span class="comment">%     % ----------------------------</span>
1313 <span class="comment">%     log_text = {...</span>
1314 <span class="comment">%         '   Preprocessing complete.';...</span>
1315 <span class="comment">%         '   Begin Data Processing...'};</span>
1316 <span class="comment">%     statusLogging(handles.LogWindow, log_text)</span>
1317 <span class="comment">%</span>
1318 <span class="comment">%     A(1).hgns = guiparams.horizontal_grid_node_spacing;</span>
1319 <span class="comment">%     A(1).wse  = guiparams.wse;  %Set the WSE to entered value</span>
1320 <span class="comment">%     [A,V,processing_log_text] = VMT_ProcessTransects(z,A,...</span>
1321 <span class="comment">%         guiparams.set_cross_section_endpoints,...</span>
1322 <span class="comment">%         guiparams.unit_discharge_correction);</span>
1323 <span class="comment">%</span>
1324 <span class="comment">%     % Push messages to Log Window:</span>
1325 <span class="comment">%     % ----------------------------</span>
1326 <span class="comment">%     statusLogging(handles.LogWindow, processing_log_text)</span>
1327 <span class="comment">%</span>
1328 <span class="comment">%     % Store the data:</span>
1329 <span class="comment">%     % ---------------</span>
1330 <span class="comment">%     guiparams.z = z;</span>
1331 <span class="comment">%     guiparams.A = A;</span>
1332 <span class="comment">%     guiparams.V = V;</span>
1333 <span class="comment">%     setappdata(handles.figure1,'guiparams',guiparams)</span>
1334     
1335       
1336     <span class="comment">% Update the GUI:</span>
1337     <span class="comment">% ---------------</span>
1338     <a href="#_sub89" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
1339 <span class="keyword">end</span>
1340 <span class="comment">% [EOF] loadDataCallback</span>
1341 
1342 
1343 
1344 <span class="comment">% --------------------------------------------------------------------</span>
1345 <a name="_sub46" href="#_subfunctions" class="code">function saveDataCallback(hObject, eventdata, handles)</a>
1346 <span class="comment">% SaveMATFile_Callback(handles.SaveMATFile,eventdata,handles)</span>
1347 
1348 <span class="comment">% Get the Application data:</span>
1349 <span class="comment">% -------------------------</span>
1350 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1351 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1352 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1353 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1354 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
1355 
1356 [the_file,the_path] = <span class="keyword">...</span>
1357     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
1358     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
1359     fullfile(guiparams.mat_path,guiparams.savefile));
1360 
1361 <span class="comment">% Save the processed data to a MAT file:</span>
1362 <span class="comment">% --------------------------------------</span>
1363 <span class="keyword">if</span> ischar(the_file)
1364     guiparams.mat_path = the_path;
1365     guiparams.mat_file = the_file;
1366     guiparams.savefile = the_file;
1367     
1368     <span class="comment">% Re-store the Application data:</span>
1369     <span class="comment">% ------------------------------</span>
1370     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1371     
1372     <span class="comment">% Update the preferences:</span>
1373     <span class="comment">% -----------------------</span>
1374     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1375     guiprefs.mat_path = the_path;
1376     guiprefs.mat_file = the_file;
1377     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1378     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
1379     
1380     [pathstr,filename,extension] = fileparts([guiparams.mat_path guiparams.savefile]);
1381     savefile = fullfile(pathstr,[filename extension]);
1382     <span class="comment">%h = msgbox(['Saving processed data in MAT File ''' filename extension ''''], ...</span>
1383     <span class="comment">%    'Saving Processed Data File...'); %#ok&lt;NASGU&gt;</span>
1384     log_text = {<span class="keyword">...</span>
1385         <span class="string">'Saving Processed Data File...'</span>;<span class="keyword">...</span>
1386         savefile};
1387     statusLogging(handles.LogWindow,log_text)
1388     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
1389 <span class="keyword">end</span>
1390 
1391 <span class="comment">% [EOF] saveDataCallback</span>
1392 
1393 
1394 <span class="comment">% --------------------------------------------------------------------</span>
1395 <a name="_sub47" href="#_subfunctions" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a>
1396 
1397 <span class="comment">% Get the Application data:</span>
1398 <span class="comment">% -------------------------</span>
1399 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1400 z   = guiparams.z;
1401 A   = guiparams.A;
1402 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
1403 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
1404 
1405 <span class="comment">% Compute multibeam bathymetry:</span>
1406 <span class="comment">% -----------------------------</span>
1407 msgbox(<span class="string">'Processing Bathymetry...Please Be Patient'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
1408 <span class="comment">%A = VMT_MBBathy(z,A,savefile,handles.beam_angle,handles.MagneticVariation,handles.WSE);</span>
1409 <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>(z,A,savefile, <span class="keyword">...</span>
1410     guiparams.beam_angle, <span class="keyword">...</span>
1411     guiparams.magnetic_variation, <span class="keyword">...</span>
1412     guiparams.wse, <span class="keyword">...</span>
1413     guiparams.output_auxiliary_data);
1414 
1415 msgbox(<span class="string">'Bathymetry Output Complete'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
1416 
1417 <span class="comment">% [EOF] saveBathymetryCallback</span>
1418 
1419 <span class="comment">% --------------------------------------------------------------------</span>
1420 <a name="_sub48" href="#_subfunctions" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a>
1421 
1422 <span class="comment">% Get the Application data:</span>
1423 <span class="comment">% -------------------------</span>
1424 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1425 
1426 [guiparams.english_units,guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
1427     guiparams.presentation,guiparams.print] = <span class="keyword">...</span>
1428     plotParametersDialog(guiparams.english_units, <span class="keyword">...</span>
1429     guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
1430     guiparams.presentation,guiparams.print,<span class="keyword">...</span>
1431     handles.figure1);
1432 
1433 <span class="comment">% Update the GUI:</span>
1434 <span class="comment">% ---------------</span>
1435 <span class="keyword">if</span> guiparams.english_units
1436     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1437     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1438 <span class="keyword">else</span>
1439     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1440     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1441 <span class="keyword">end</span>
1442 
1443 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
1444     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1445     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1446 <span class="keyword">else</span>
1447     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1448     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1449 <span class="keyword">end</span>
1450 
1451 <span class="keyword">if</span> guiparams.presentation
1452     <a href="#_sub34" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
1453 <span class="comment">%     set(handles.menuStylePrint,           'Checked','off')</span>
1454 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','on')</span>
1455 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','off')</span>
1456 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','on')</span>
1457 <span class="keyword">else</span>
1458     <a href="#_sub33" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
1459 <span class="comment">%     set(handles.menuStylePrint,           'Checked','on')</span>
1460 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','off')</span>
1461 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','on')</span>
1462 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','off')</span>
1463 <span class="keyword">end</span>
1464 
1465 <span class="comment">% Re-store the Application data:</span>
1466 <span class="comment">% ------------------------------</span>
1467 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1468 
1469 <span class="comment">% [EOF] plottingParametersCallback</span>
1470 
1471 
1472 <span class="comment">% --------------------------------------------------------------------</span>
1473 <a name="_sub49" href="#_subfunctions" class="code">function processingParametersCallback(hObject, eventdata, handles)</a>
1474 
1475 <span class="comment">% Get the Application data:</span>
1476 <span class="comment">% -------------------------</span>
1477 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1478 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1479 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1480 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1481 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
1482 
1483 <span class="comment">% [EOF] processingParametersCallback</span>
1484 
1485 
1486 <span class="comment">% --------------------------------------------------------------------</span>
1487 <a name="_sub50" href="#_subfunctions" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a>
1488 <span class="comment">% Plot 1</span>
1489 
1490 <span class="comment">% Get the Application data:</span>
1491 <span class="comment">% -------------------------</span>
1492 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1493 z = guiparams.z;
1494 A = guiparams.A;
1495 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
1496 <span class="comment">% Map = guiparams.Map;</span>
1497 setends = guiparams.set_cross_section_endpoints;
1498 
1499 <span class="comment">% Preprocess the data:</span>
1500 <span class="comment">% --------------------</span>
1501 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
1502 
1503 <span class="comment">% Push messages to Log Window:</span>
1504 <span class="comment">% ----------------------------</span>
1505 log_text = {<span class="keyword">...</span>
1506     <span class="string">'   Preprocessing complete.'</span>;<span class="keyword">...</span>
1507     <span class="string">'   Begin Data Processing...'</span>};
1508 statusLogging(handles.LogWindow, log_text)
1509 
1510 <span class="comment">% Process the transects:</span>
1511 <span class="comment">% ----------------------</span>
1512 A(1).hgns = guiparams.horizontal_grid_node_spacing;
1513 A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
1514 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
1515     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction);
1516 
1517 <span class="comment">% Compute the smoothed variables</span>
1518 <span class="comment">% ------------------------------</span>
1519 <span class="comment">% This is required so that the V struc is complete at any point during</span>
1520 <span class="comment">% runtime.</span>
1521 V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
1522     <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
1523     guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
1524     guiparams.vertical_smoothing_window);
1525 
1526 <span class="comment">% Push messages to Log Window:</span>
1527 <span class="comment">% ----------------------------</span>
1528 statusLogging(handles.LogWindow, processing_log_text)
1529 
1530 <span class="comment">% Store the data:</span>
1531 <span class="comment">% ---------------</span>
1532 guiparams.z = z;
1533 guiparams.A = A;
1534 guiparams.V = V;
1535 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1536 
1537 <span class="comment">% Push messages to Log Window:</span>
1538 <span class="comment">% ----------------------------</span>
1539 log_text = {<span class="string">'Plotting Shiptracks (reprocessing)'</span>};
1540 statusLogging(handles.LogWindow, log_text)
1541 
1542 <span class="comment">% Create or replot the Shiptracks</span>
1543 <span class="comment">% -------------------------------</span>
1544 <span class="comment">% Grab the axes to the plot</span>
1545 <span class="comment">% axes(handles.Plot1Shiptracks);</span>
1546 <a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>(A,V,z,setends,handles.Plot1Shiptracks); <span class="comment">% PLOT 1</span>
1547 
1548 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
1549 <span class="comment">% New plot display window</span>
1550 <span class="comment">% h = VMT_CreatePlotDisplay('shiptracks');</span>
1551 <span class="comment">% h = figure(1); clf</span>
1552 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
1553 
1554 <span class="comment">% [EOF] shiptracksPlotCallback</span>
1555 
1556 
1557 <span class="comment">% --------------------------------------------------------------------</span>
1558 <a name="_sub51" href="#_subfunctions" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a>
1559 <span class="comment">% Plot 2</span>
1560 
1561 <span class="comment">% Get the Application data:</span>
1562 <span class="comment">% -------------------------</span>
1563 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1564 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1565 
1566 <span class="keyword">if</span> iscell(guiparams.mat_file) <span class="comment">% Multiple MAT files loaded</span>
1567     <span class="comment">% Push messages to Log Window:</span>
1568     <span class="comment">% ----------------------------</span>
1569     log_text = {<span class="string">'Plotting Multiple Transects (Planview)'</span>};
1570     statusLogging(handles.LogWindow, log_text)
1571     
1572        
1573     <span class="comment">% Push plotting parameters to log window:</span>
1574     <span class="comment">% ---------------------------------------</span>
1575     log_text = {<span class="keyword">...</span>
1576         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
1577         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
1578         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
1579         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
1580         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
1581         };
1582     statusLogging(handles.LogWindow, log_text)
1583     
1584     <span class="comment">% Plot the data:</span>
1585     <span class="comment">% --------------</span>
1586     z = [];
1587     A = [];
1588     V = [];
1589     Map = [];
1590     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
1591     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
1592         depth_range, <span class="keyword">...</span>
1593         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
1594         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
1595         guiparams.smoothing_window_size, <span class="keyword">...</span>
1596         guiparams.display_shoreline, <span class="keyword">...</span>
1597         guiparams.english_units, <span class="keyword">...</span>
1598         guiparams.mat_file, <span class="keyword">...</span>
1599         guiparams.mat_path); <span class="comment">% PLOT2</span>
1600     statusLogging(handles.LogWindow, log_text)
1601     
1602     <span class="comment">% Plot a Shoreline Map:</span>
1603     <span class="comment">% ---------------------</span>
1604     <span class="keyword">if</span> guiparams.display_shoreline
1605         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
1606             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
1607             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
1608             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
1609         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
1610             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
1611             Map.UTMe   = mapdata(:,1);
1612             Map.UTMn   = mapdata(:,2);
1613             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
1614             <span class="comment">%Map.UTMzone = zone;</span>
1615         <span class="keyword">else</span>
1616             Map = [];
1617         <span class="keyword">end</span>
1618         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
1619         log_text = {<span class="keyword">...</span>
1620             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
1621             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
1622             };
1623         statusLogging(handles.LogWindow, log_text)
1624     <span class="keyword">else</span>
1625         Map = [];
1626     <span class="keyword">end</span>
1627     
1628 <span class="keyword">else</span>
1629     z = guiparams.z;
1630     A = guiparams.A;
1631     <span class="comment">% V = guiparams.V;</span>
1632     Map = guiparams.Map;
1633     
1634     <span class="comment">% Push messages to Log Window:</span>
1635     <span class="comment">% ----------------------------</span>
1636     log_text = {<span class="string">'Plotting Depth Averaged Vectors (reprocessing)'</span>};
1637     statusLogging(handles.LogWindow, log_text)
1638     
1639         
1640     <span class="comment">% Preprocess the data:</span>
1641     <span class="comment">% --------------------</span>
1642     A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
1643     
1644     <span class="comment">% Process the transects:</span>
1645     <span class="comment">% ----------------------</span>
1646     A(1).hgns = guiparams.horizontal_grid_node_spacing;
1647     A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
1648     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
1649         guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction);
1650     
1651     <span class="comment">% Compute the smoothed variables</span>
1652     <span class="comment">% ------------------------------</span>
1653     <span class="comment">% This is required so that the V struc is complete at any point during</span>
1654     <span class="comment">% runtime.</span>
1655     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
1656         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
1657         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
1658         guiparams.vertical_smoothing_window);
1659     
1660     <span class="comment">% Push messages to Log Window:</span>
1661     <span class="comment">% ----------------------------</span>
1662     statusLogging(handles.LogWindow, processing_log_text)
1663     
1664     <span class="comment">% Plot the cross section:</span>
1665     <span class="comment">% -----------------------</span>
1666     log_text = {<span class="keyword">...</span>
1667         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
1668         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
1669         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
1670         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
1671         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
1672         };
1673     statusLogging(handles.LogWindow, log_text)
1674     
1675     <span class="comment">% Plot the data:</span>
1676     <span class="comment">% --------------</span>
1677     <span class="comment">%msgbox('Plotting Plan View','VMT Status','help','replace');</span>
1678     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
1679     
1680     
1681     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
1682         depth_range, <span class="keyword">...</span>
1683         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
1684         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
1685         guiparams.smoothing_window_size, <span class="keyword">...</span>
1686         guiparams.display_shoreline, <span class="keyword">...</span>
1687         guiparams.english_units, <span class="keyword">...</span>
1688         guiparams.mat_file, <span class="keyword">...</span>
1689         guiparams.mat_path); <span class="comment">% PLOT2</span>
1690     statusLogging(handles.LogWindow, log_text)
1691     
1692     <span class="comment">% Plot a Shoreline Map:</span>
1693     <span class="comment">% ---------------------</span>
1694     <span class="keyword">if</span> guiparams.display_shoreline
1695         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
1696             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
1697             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
1698             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
1699         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
1700             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
1701             Map.UTMe   = mapdata(:,1);
1702             Map.UTMn   = mapdata(:,2);
1703             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
1704             <span class="comment">%Map.UTMzone = zone;</span>
1705         <span class="keyword">else</span>
1706             Map = [];
1707         <span class="keyword">end</span>
1708         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
1709         log_text = {<span class="keyword">...</span>
1710             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
1711             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
1712             };
1713         statusLogging(handles.LogWindow, log_text)
1714     <span class="keyword">else</span>
1715         Map = [];
1716     <span class="keyword">end</span>
1717     
1718 <span class="keyword">end</span>
1719 
1720 <span class="keyword">if</span> guiparams.add_background
1721     [guiprefs,log_text] = <a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>(guiprefs);
1722     statusLogging(handles.LogWindow, log_text)
1723 <span class="keyword">end</span>
1724 
1725 <span class="comment">% Update guiparams</span>
1726 <span class="comment">% ----------------</span>
1727 guiparams.z   = z;
1728 guiparams.A   = A;
1729 guiparams.V   = V;
1730 guiparams.Map = Map;
1731 guiparams.iric_anv_planview_data = PVdata;
1732 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams);
1733 
1734 <span class="comment">% Update preferences</span>
1735 <span class="comment">% ------------------</span>
1736 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1737 <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'shoreline'</span>)
1738 <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'aerial'</span>)
1739 
1740 <span class="comment">% Force plot to be formated properly</span>
1741 <span class="comment">% ----------------------------------</span>
1742 <span class="keyword">if</span> guiparams.presentation
1743     <a href="#_sub34" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
1744 <span class="keyword">else</span>
1745     <a href="#_sub33" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
1746 <span class="keyword">end</span>
1747 
1748 <span class="comment">% Start the Graphics Control Gui</span>
1749 <span class="comment">% ------------------------------</span>
1750 VMT_GraphicsControl
1751 
1752 <span class="comment">% [EOF] planviewPlotCallback</span>
1753 
1754 
1755 <span class="comment">% --------------------------------------------------------------------</span>
1756 <a name="_sub52" href="#_subfunctions" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a>
1757 <span class="comment">% Plot 3</span>
1758 
1759 <span class="comment">% Get the Application data:</span>
1760 <span class="comment">% -------------------------</span>
1761 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1762 z = guiparams.z;
1763 A = guiparams.A;
1764 <span class="comment">% V = guiparams.V;</span>
1765 <span class="comment">% Map = guiparams.Map;</span>
1766 
1767 <span class="comment">% Preprocess the data:</span>
1768 <span class="comment">% --------------------</span>
1769 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
1770 
1771 <span class="comment">% Push messages to Log Window:</span>
1772 <span class="comment">% ----------------------------</span>
1773 log_text = {<span class="string">'Plotting Cross Section (reprocessing)'</span>};
1774 statusLogging(handles.LogWindow, log_text)
1775 
1776 <span class="comment">% Process the transects:</span>
1777 <span class="comment">% ----------------------</span>
1778 A(1).hgns = guiparams.horizontal_grid_node_spacing;
1779 A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
1780 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
1781     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction);
1782 
1783 <span class="comment">% Push messages to Log Window:</span>
1784 <span class="comment">% ----------------------------</span>
1785 statusLogging(handles.LogWindow, processing_log_text)
1786 
1787 <span class="comment">% Plot the cross section:</span>
1788 <span class="comment">% -----------------------</span>
1789 log_text = {<span class="keyword">...</span>
1790     <span class="string">'Cross Section Plotting Parameters'</span>;<span class="keyword">...</span>
1791     sprintf(<span class="string">'   Contour variable: %s'</span>          ,guiparams.contours(guiparams.idx_contour).string);<span class="keyword">...</span>
1792     sprintf(<span class="string">'   Vertical exaggeration: %d'</span>     ,guiparams.vertical_exaggeration);<span class="keyword">...</span>
1793     sprintf(<span class="string">'   Vector scale: %3.1f'</span>           ,guiparams.vector_scale_cross_section);<span class="keyword">...</span>
1794     sprintf(<span class="string">'   Horizontal vector spacing: %d'</span> ,guiparams.horizontal_vector_spacing);<span class="keyword">...</span>
1795     sprintf(<span class="string">'   Vertical vector spacing: %d'</span>   ,guiparams.vertical_vector_spacing);<span class="keyword">...</span>
1796     sprintf(<span class="string">'   Horizontal smooting window: %d'</span>,guiparams.horizontal_smoothing_window);<span class="keyword">...</span>
1797     sprintf(<span class="string">'   Vertical smoothing window: %d'</span> ,guiparams.vertical_smoothing_window);<span class="keyword">...</span>
1798     };
1799 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
1800     log_text = vertcat(log_text, {<span class="keyword">...</span>
1801         sprintf(<span class="string">'   Vector variable: %s'</span>,guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).string);<span class="keyword">...</span>
1802         sprintf(<span class="string">'   Inc. vertical component?: %d'</span>,guiparams.include_vertical_velocity)<span class="keyword">...</span>
1803         });
1804 <span class="keyword">end</span>
1805 <span class="comment">% Push messages to Log Window:</span>
1806 <span class="comment">% ----------------------------</span>
1807 statusLogging(handles.LogWindow, log_text)
1808 
1809 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
1810     <span class="comment">%msgbox('Plotting Cross Section','VMT Status','help','replace')</span>
1811 <span class="comment">%     V = VMT_SmoothVar(V, ...</span>
1812 <span class="comment">%         ...guiparams.contour, ...</span>
1813 <span class="comment">%         guiparams.horizontal_smoothing_window, ...</span>
1814 <span class="comment">%         guiparams.vertical_smoothing_window);</span>
1815     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
1816         <span class="keyword">...</span><span class="comment">guiparams.secondary_flow_vector_variable, ...</span>
1817         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
1818         guiparams.vertical_smoothing_window);
1819     [~,A,V,plot_cont_log_text] = <a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,varargin)">VMT_PlotXSContQuiver</a>(z,A,V, <span class="keyword">...</span>
1820         guiparams.contour, <span class="keyword">...</span>
1821         guiparams.vector_scale_cross_section, <span class="keyword">...</span>
1822         guiparams.vertical_exaggeration, <span class="keyword">...</span>
1823         guiparams.horizontal_vector_spacing, <span class="keyword">...</span>
1824         guiparams.vertical_vector_spacing, <span class="keyword">...</span>
1825         guiparams.secondary_flow_vector_variable, <span class="keyword">...</span>
1826         guiparams.include_vertical_velocity, <span class="keyword">...</span>
1827         guiparams.english_units); <span class="comment">%#ok&lt;ASGLU&gt; % PLOT3</span>
1828     
1829 <span class="keyword">elseif</span> ~guiparams.plot_secondary_flow_vectors
1830     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
1831         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
1832         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
1833         guiparams.vertical_smoothing_window);
1834     
1835     [~,A,V,zmin,zmax,plot_cont_log_text] = <a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english)">VMT_PlotXSCont</a>(z,A,V, <span class="keyword">...</span>
1836         guiparams.contour, <span class="keyword">...</span>
1837         guiparams.vertical_exaggeration, <span class="keyword">...</span>
1838         guiparams.english_units);  <span class="comment">%#ok&lt;ASGLU&gt;</span>
1839     
1840     guiparams.zmin = zmin;
1841     guiparams.zmax = zmax;
1842     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1843 <span class="keyword">end</span>
1844 
1845 <span class="comment">% Force plot to be formated properly</span>
1846 <span class="comment">% ----------------------------------</span>
1847 <span class="keyword">if</span> guiparams.presentation
1848     <a href="#_sub34" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
1849 <span class="keyword">else</span>
1850     <a href="#_sub33" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
1851 <span class="keyword">end</span>
1852 
1853 <span class="comment">% Re-store the Application data:</span>
1854 <span class="comment">% ------------------------------</span>
1855 guiparams.V = V;
1856 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1857 
1858 <span class="comment">% Start the Graphics Control Gui</span>
1859 <span class="comment">% ------------------------------</span>
1860 VMT_GraphicsControl
1861 
1862 <span class="comment">% Push messages to Log Window:</span>
1863 <span class="comment">% ----------------------------</span>
1864 statusLogging(handles.LogWindow, plot_cont_log_text)
1865 <span class="comment">% msgbox('Plotting Complete','VMT Status','help','replace')</span>
1866 
1867 <span class="comment">% [EOF] crosssectionPlotCallback</span>
1868 
1869 
1870 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
1871 <span class="comment">% DATA EXPORT CALLBACKS %</span>
1872 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
1873 
1874 <span class="comment">% --------------------------------------------------------------------</span>
1875 <a name="_sub53" href="#_subfunctions" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a>
1876 <span class="comment">% saveDataCallback(hObject, eventdata, handles)</span>
1877 
1878 <span class="comment">% Get the Application data:</span>
1879 <span class="comment">% -------------------------</span>
1880 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1881 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1882 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1883 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1884 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
1885 
1886 [the_file,the_path] = <span class="keyword">...</span>
1887     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
1888     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
1889     fullfile(guiparams.mat_path,guiparams.savefile));
1890 
1891 <span class="comment">% Save the processed data to a MAT file:</span>
1892 <span class="comment">% --------------------------------------</span>
1893 <span class="keyword">if</span> ischar(the_file)
1894     guiparams.mat_path = the_path;
1895     guiparams.mat_file = the_file;
1896     guiparams.savefile = the_file;
1897     
1898     <span class="comment">% Re-store the Application data:</span>
1899     <span class="comment">% ------------------------------</span>
1900     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1901     
1902     <span class="comment">% Update the preferences:</span>
1903     <span class="comment">% -----------------------</span>
1904     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1905     guiprefs.mat_path = the_path;
1906     guiprefs.mat_file = the_file;
1907     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1908     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
1909     
1910     [~,filename,extension] = fileparts(guiparams.savefile);
1911     savefile = [filename extension];
1912     h = msgbox([<span class="string">'Saving processed data in MAT File '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
1913         <span class="string">'Saving Processed Data File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1914     disp(<span class="string">'Saving Processed Data File...'</span>)
1915     disp(savefile)
1916     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
1917 <span class="keyword">end</span>
1918 
1919 <span class="comment">% [EOF] SaveMATFile_Callback</span>
1920 
1921 
1922 <span class="comment">% --------------------------------------------------------------------</span>
1923 <a name="_sub54" href="#_subfunctions" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a>
1924 
1925 <span class="comment">% Get the Application data:</span>
1926 <span class="comment">% -------------------------</span>
1927 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1928 <span class="comment">% z   = guiparams.z;</span>
1929 <span class="comment">% A   = guiparams.A;</span>
1930 V   = guiparams.V;
1931 <span class="comment">% Map = guiparams.Map;</span>
1932 
1933 [the_file,the_path] = <span class="keyword">...</span>
1934     uiputfile({<span class="string">'*.dat'</span>,<span class="string">'Tecplot Files (*.dat)'</span>}, <span class="keyword">...</span>
1935     <span class="string">'Save Tecplot File'</span>, <span class="keyword">...</span>
1936     fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
1937 
1938 <span class="comment">% Output the data (no smoothing) to Tecplot:</span>
1939 <span class="comment">% ------------------------------------------</span>
1940 <span class="keyword">if</span> ischar(the_file)
1941     guiparams.tecplot_path = the_path;
1942     guiparams.tecplot_file = the_file;
1943     
1944     <span class="comment">% Re-store the Application data:</span>
1945     <span class="comment">% ------------------------------</span>
1946     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1947     
1948     <span class="comment">% Update the preferences:</span>
1949     <span class="comment">% -----------------------</span>
1950     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1951     guiprefs.tecplot_path = the_path;
1952     guiprefs.tecplot_file = the_file;
1953     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1954     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'tecplot'</span>)
1955     
1956     <span class="comment">% Push to log window</span>
1957     <span class="comment">% ------------------</span>
1958     log_text = {<span class="keyword">...</span>
1959         <span class="string">'Exporting Data to Tecplot (*.dat) File...'</span>;<span class="keyword">...</span>
1960         <span class="string">'Directory:'</span>;<span class="keyword">...</span>
1961         the_path;<span class="keyword">...</span>
1962         [<span class="string">'Filename: '</span> the_file]};
1963     statusLogging(handles.LogWindow,log_text)
1964         
1965     <span class="keyword">if</span> isempty(V)
1966         A = guiparams.A;
1967         A(1).hgns = guiparams.horizontal_grid_node_spacing;
1968         A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
1969         [~,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
1970             guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
1971             guiparams.unit_discharge_correction);
1972     <span class="keyword">end</span>
1973     <a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
1974     
1975     <span class="comment">% Push to log window</span>
1976     <span class="comment">% ------------------</span>
1977     log_text = {<span class="string">'Exporting XS Bathy Data to Tecplot (*.dat) File...'</span>};
1978     statusLogging(handles.LogWindow,log_text)
1979     
1980     <a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
1981     
1982     <span class="comment">% Push to log window</span>
1983     <span class="comment">% ------------------</span>
1984     log_text = {<span class="string">'Tecplot Export Complete'</span>};
1985     statusLogging(handles.LogWindow,log_text)
1986    
1987 <span class="keyword">end</span>
1988 
1989 <span class="comment">% [EOF] SaveTechplotFile_Callback</span>
1990 
1991 
1992 <span class="comment">% --------------------------------------------------------------------</span>
1993 <a name="_sub55" href="#_subfunctions" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a>
1994 
1995 <span class="comment">% Get the Application data:</span>
1996 <span class="comment">% -------------------------</span>
1997 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1998 <span class="comment">% z   = guiparams.z;</span>
1999 A   = guiparams.A;
2000 V   = guiparams.V;
2001 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2002 
2003 [the_file,the_path] = <span class="keyword">...</span>
2004     uiputfile({<span class="string">'*.kmz'</span>,<span class="string">'Google Earth Files (*.kmz)'</span>}, <span class="keyword">...</span>
2005     <span class="string">'Save Google Earth File'</span>, <span class="keyword">...</span>
2006     fullfile(guiparams.kmz_path,guiparams.kmz_file));
2007 
2008 <span class="comment">% Save the processed data to a Google Earth (KMZ) file:</span>
2009 <span class="comment">% -----------------------------------------------------</span>
2010 <span class="keyword">if</span> ischar(the_file)
2011     guiparams.kmz_path = the_path;
2012     guiparams.kmz_file = the_file;
2013     
2014     <span class="comment">% Re-store the Application data:</span>
2015     <span class="comment">% ------------------------------</span>
2016     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2017     
2018     <span class="comment">% Update the preferences:</span>
2019     <span class="comment">% -----------------------</span>
2020     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2021     guiprefs.kmz_path = the_path;
2022     guiprefs.kmz_file = the_file;
2023     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2024     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'kmz'</span>)
2025     
2026     <span class="comment">%     if guiparams.display_shoreline</span>
2027     <span class="comment">%         VMT_Shoreline2GE_3D(A,Map, ...</span>
2028     <span class="comment">%                             guiparams.vertical_exaggeration, ...</span>
2029     <span class="comment">%                             guiparams.vertical_offset);</span>
2030     <span class="comment">%     end</span>
2031     <span class="keyword">if</span> isempty(V)
2032         A = guiparams.A;
2033         A(1).hgns = guiparams.horizontal_grid_node_spacing;
2034         A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2035         [~,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2036             guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2037             guiparams.unit_discharge_correction);
2038     <span class="keyword">end</span>
2039     <a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>(A,V,[], <span class="keyword">...</span>
2040         fullfile(guiparams.kmz_path,guiparams.kmz_file), <span class="keyword">...</span>
2041         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2042         guiparams.vertical_offset);
2043 <span class="keyword">end</span>
2044 
2045 <span class="comment">% [EOF] SaveGoogleEarthFile_Callback</span>
2046 
2047 
2048 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2049 <span class="comment">% DATA EXPORT/BATHYMETRY CALLBACKS %</span>
2050 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2051 
2052 <span class="comment">% --------------------------------------------------------------------</span>
2053 <a name="_sub56" href="#_subfunctions" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
2054 
2055 <span class="comment">% Get the Application data:</span>
2056 <span class="comment">% -------------------------</span>
2057 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2058 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2059 z = guiparams.z;
2060 A = guiparams.A;
2061 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
2062 <span class="comment">% Map = guiparams.Map;</span>
2063 setends = guiparams.set_cross_section_endpoints;
2064 
2065 [the_file,the_path] = <span class="keyword">...</span>
2066     uiputfile({<span class="string">'*.csv'</span>,<span class="string">'Multibeam Bathymetry Files (*.csv)'</span>}, <span class="keyword">...</span>
2067     <span class="string">'Export Multibeam Bathymetry'</span>, <span class="keyword">...</span>
2068     fullfile(guiprefs.multibeambathymetry_path, <span class="keyword">...</span>
2069     guiprefs.multibeambathymetry_file));
2070 
2071 <span class="keyword">if</span> ischar(the_file)
2072     guiparams.multibeambathymetry_path = the_path;
2073     guiparams.multibeambathymetry_file = the_file;
2074     
2075     <span class="comment">% Re-store the Application data:</span>
2076     <span class="comment">% ------------------------------</span>
2077     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2078     
2079     <span class="comment">% Update the preferences:</span>
2080     <span class="comment">% -----------------------</span>
2081     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2082     guiprefs.multibeambathymetry_path = the_path;
2083     guiprefs.multibeambathymetry_file = the_file;
2084     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2085     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'multibeambathymetry'</span>)
2086     
2087     <span class="keyword">if</span> guiparams.output_auxiliary_data
2088     <span class="keyword">end</span>
2089     
2090     <span class="comment">%msgbox('Processing Bathymetry...Please Be Patient','VMT Status','help','replace')</span>
2091     
2092     savefile = fullfile(guiparams.multibeambathymetry_path, <span class="keyword">...</span>
2093         guiparams.multibeambathymetry_file);
2094     
2095     log_text = {<span class="string">'Multibeam bathymetry file saved to:'</span>;<span class="keyword">...</span>
2096         [<span class="string">'   '</span> savefile]};
2097     statusLogging(handles.LogWindow,log_text)
2098     
2099     <span class="comment">% Process the transects:</span>
2100     <span class="comment">% ----------------------</span>
2101     A(1).hgns = guiparams.horizontal_grid_node_spacing;
2102     A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2103     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2104         guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction);
2105     
2106     <span class="comment">% Compute the smoothed variables</span>
2107     <span class="comment">% ------------------------------</span>
2108     <span class="comment">% This is required so that the V struc is complete at any point during</span>
2109     <span class="comment">% runtime.</span>
2110     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2111         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2112         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2113         guiparams.vertical_smoothing_window);
2114     
2115     <span class="comment">% Push messages to Log Window:</span>
2116     <span class="comment">% ----------------------------</span>
2117     statusLogging(handles.LogWindow, processing_log_text)
2118 
2119     
2120     <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>(guiparams.z, <span class="keyword">...</span>
2121         guiparams.A, <span class="keyword">...</span>
2122         savefile, <span class="keyword">...</span>
2123         guiparams.beam_angle, <span class="keyword">...</span>
2124         guiparams.magnetic_variation, <span class="keyword">...</span>
2125         guiparams.wse, <span class="keyword">...</span>
2126         guiparams.output_auxiliary_data);
2127     
2128     <span class="comment">%msgbox('Bathymetry Output Complete','VMT Status','help','replace')</span>
2129     
2130 <span class="keyword">end</span>
2131 
2132 <span class="comment">% [EOF] ExportMultibeamBathymetry_Callback</span>
2133 
2134 
2135 <span class="comment">% --------------------------------------------------------------------</span>
2136 <a name="_sub57" href="#_subfunctions" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a>
2137 <span class="comment">% Get the beam angle</span>
2138 
2139 <span class="comment">% Get the Application data:</span>
2140 <span class="comment">% -------------------------</span>
2141 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2142 
2143 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2144 <span class="comment">% ----------------------------------------------------------------</span>
2145 new_beam_angle = str2double(get(hObject,<span class="string">'String'</span>));
2146 is_a_number = ~isnan(new_beam_angle);
2147 is_positive = new_beam_angle&gt;=0;
2148 
2149 <span class="comment">% Modify the Application data:</span>
2150 <span class="comment">% ----------------------------</span>
2151 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2152     guiparams.beam_angle = new_beam_angle;
2153     
2154     <span class="comment">% Re-store the Application data:</span>
2155     <span class="comment">% ------------------------------</span>
2156     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2157     
2158 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2159     set(hObject,<span class="string">'String'</span>,guiparams.beam_angle)
2160 <span class="keyword">end</span>
2161 
2162 <span class="comment">% [EOF] BeamAngle_Callback</span>
2163 
2164 
2165 <span class="comment">% --------------------------------------------------------------------</span>
2166 <a name="_sub58" href="#_subfunctions" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a>
2167 <span class="comment">% Get the Magnetic Variation</span>
2168 
2169 <span class="comment">% Get the Application data:</span>
2170 <span class="comment">% -------------------------</span>
2171 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2172 
2173 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2174 <span class="comment">% ----------------------------------------------------------------</span>
2175 new_magnetic_variation = str2double(get(hObject,<span class="string">'String'</span>));
2176 is_a_number = ~isnan(new_magnetic_variation);
2177 is_positive = new_magnetic_variation&gt;=0;
2178 
2179 <span class="comment">% Modify the Application data:</span>
2180 <span class="comment">% ----------------------------</span>
2181 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2182     guiparams.magnetic_variation = new_magnetic_variation;
2183     
2184     <span class="comment">% Re-store the Application data:</span>
2185     <span class="comment">% ------------------------------</span>
2186     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2187     
2188 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2189     set(hObject,<span class="string">'String'</span>,guiparams.magnetic_variation)
2190 <span class="keyword">end</span>
2191 
2192 <span class="comment">% [EOF] MagneticVariation_Callback</span>
2193 
2194 
2195 <span class="comment">% --------------------------------------------------------------------</span>
2196 <a name="_sub59" href="#_subfunctions" class="code">function WSE_Callback(hObject, eventdata, handles)</a>
2197 
2198 <span class="comment">% Get the Application data:</span>
2199 <span class="comment">% -------------------------</span>
2200 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2201 
2202 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2203 <span class="comment">% ----------------------------------------------------------------</span>
2204 new_wse = str2double(get(hObject,<span class="string">'String'</span>));
2205 is_a_number = ~isnan(new_wse);
2206 is_positive = new_wse&gt;=0;
2207 
2208 <span class="comment">% Modify the Application data:</span>
2209 <span class="comment">% ----------------------------</span>
2210 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2211     guiparams.wse = new_wse;
2212     
2213     <span class="comment">% Re-store the Application data:</span>
2214     <span class="comment">% ------------------------------</span>
2215     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2216     
2217 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2218     set(hObject,<span class="string">'String'</span>,guiparams.wse)
2219 <span class="keyword">end</span>
2220 
2221 <span class="comment">% [EOF] WSE_Callback</span>
2222 
2223 
2224 <span class="comment">% --------------------------------------------------------------------</span>
2225 <a name="_sub60" href="#_subfunctions" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a>
2226 <span class="comment">% Bathymetry Auxiliary Data</span>
2227 
2228 <span class="comment">% Get the Application data:</span>
2229 <span class="comment">% -------------------------</span>
2230 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2231 
2232 <span class="comment">% Modify the Application data:</span>
2233 <span class="comment">% ----------------------------</span>
2234 guiparams.output_auxiliary_data = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2235 
2236 <span class="comment">% Re-store the Application data:</span>
2237 <span class="comment">% ------------------------------</span>
2238 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2239 
2240 <span class="comment">% [EOF] OutputAuxiliaryData_Callback</span>
2241 
2242 
2243 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2244 <span class="comment">% PLOTTING/PLAN VIEW PLOT CALLBACKS %</span>
2245 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2246 
2247 <span class="comment">% --------------------------------------------------------------------</span>
2248 <a name="_sub61" href="#_subfunctions" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a>
2249 
2250 <span class="comment">% Get the Application data:</span>
2251 <span class="comment">% -------------------------</span>
2252 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2253 
2254 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2255 <span class="comment">% ----------------------------------------------------------------</span>
2256 new_depth_range_min = str2double(get(hObject,<span class="string">'String'</span>));
2257 is_a_number = ~isnan(new_depth_range_min);
2258 is_positive = new_depth_range_min&gt;=0;
2259 
2260 <span class="comment">% Modify the Application data:</span>
2261 <span class="comment">% ----------------------------</span>
2262 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2263     guiparams.depth_range_min = new_depth_range_min;
2264     
2265     <span class="comment">% Re-store the Application data:</span>
2266     <span class="comment">% ------------------------------</span>
2267     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2268     
2269 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2270     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_min)
2271 <span class="keyword">end</span>
2272 
2273 <span class="comment">% [EOF] DepthRangeMin_Callback</span>
2274 
2275 
2276 <span class="comment">% --------------------------------------------------------------------</span>
2277 <a name="_sub62" href="#_subfunctions" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a>
2278 
2279 <span class="comment">% Get the Application data:</span>
2280 <span class="comment">% -------------------------</span>
2281 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2282 
2283 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2284 <span class="comment">% ----------------------------------------------------------------</span>
2285 new_depth_range_max = str2double(get(hObject,<span class="string">'String'</span>));
2286 is_a_number = ~isnan(new_depth_range_max);
2287 is_positive = new_depth_range_max&gt;=0;
2288 
2289 <span class="comment">% Modify the Application data:</span>
2290 <span class="comment">% ----------------------------</span>
2291 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2292     guiparams.depth_range_max = new_depth_range_max;
2293     
2294     <span class="comment">% Re-store the Application data:</span>
2295     <span class="comment">% ------------------------------</span>
2296     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2297     
2298 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2299     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_max)
2300 <span class="keyword">end</span>
2301 
2302 <span class="comment">% [EOF] DepthMax_Callback</span>
2303 
2304 
2305 <span class="comment">% --------------------------------------------------------------------</span>
2306 <a name="_sub63" href="#_subfunctions" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a>
2307 <span class="comment">% Set quiver scale (contour)</span>
2308 
2309 <span class="comment">% Get the Application data:</span>
2310 <span class="comment">% -------------------------</span>
2311 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2312 
2313 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2314 <span class="comment">% ----------------------------------------------------------------</span>
2315 new_vector_scale_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
2316 is_a_number = ~isnan(new_vector_scale_plan_view);
2317 is_positive = new_vector_scale_plan_view&gt;=0;
2318 
2319 <span class="comment">% Modify the Application data:</span>
2320 <span class="comment">% ----------------------------</span>
2321 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2322     guiparams.vector_scale_plan_view = round(new_vector_scale_plan_view);
2323     
2324     <span class="comment">% Re-store the Application data:</span>
2325     <span class="comment">% ------------------------------</span>
2326     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2327     
2328 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2329     set(hObject,<span class="string">'String'</span>,guiparams.vector_scale_plan_view)
2330 <span class="keyword">end</span>
2331 
2332 <span class="comment">% [EOF] VectorScalePlanView_Callback</span>
2333 
2334 
2335 <span class="comment">% --------------------------------------------------------------------</span>
2336 <a name="_sub64" href="#_subfunctions" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a>
2337 <span class="comment">% Set quiver spacing (contour, horizontal)</span>
2338 
2339 <span class="comment">% Get the Application data:</span>
2340 <span class="comment">% -------------------------</span>
2341 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2342 
2343 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2344 <span class="comment">% ----------------------------------------------------------------</span>
2345 new_vector_spacing_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
2346 is_a_number = ~isnan(new_vector_spacing_plan_view);
2347 is_positive = new_vector_spacing_plan_view&gt;=0;
2348 
2349 <span class="comment">% Modify the Application data:</span>
2350 <span class="comment">% ----------------------------</span>
2351 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2352     guiparams.vector_spacing_plan_view = round(new_vector_spacing_plan_view);
2353     
2354     <span class="comment">% Re-store the Application data:</span>
2355     <span class="comment">% ------------------------------</span>
2356     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2357     
2358 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2359     set(hObject,<span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
2360 <span class="keyword">end</span>
2361 
2362 <span class="comment">% [EOF] VectorSpacingPlanview_Callback</span>
2363 
2364 
2365 <span class="comment">% --------------------------------------------------------------------</span>
2366 <a name="_sub65" href="#_subfunctions" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a>
2367 <span class="comment">% Plan View smoothing window size</span>
2368 
2369 <span class="comment">% Get the Application data:</span>
2370 <span class="comment">% -------------------------</span>
2371 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2372 
2373 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2374 <span class="comment">% ----------------------------------------------------------------</span>
2375 new_smoothing_window_size = str2double(get(hObject,<span class="string">'String'</span>));
2376 is_a_number = ~isnan(new_smoothing_window_size);
2377 is_positive = new_smoothing_window_size&gt;=0;
2378 
2379 <span class="comment">% Modify the Application data:</span>
2380 <span class="comment">% ----------------------------</span>
2381 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2382     guiparams.smoothing_window_size = round(new_smoothing_window_size);
2383     
2384     <span class="comment">% Re-store the Application data:</span>
2385     <span class="comment">% ------------------------------</span>
2386     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2387     
2388 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2389     set(hObject,<span class="string">'String'</span>,guiparams.smoothing_window_size)
2390 <span class="keyword">end</span>
2391 
2392 <span class="comment">% [EOF] SmoothingWindowSize_Callback</span>
2393 
2394 
2395 <span class="comment">% --------------------------------------------------------------------</span>
2396 <a name="_sub66" href="#_subfunctions" class="code">function DisplayShoreline_Callback(hObject, eventdata, handles)</a>
2397 
2398 <span class="comment">% Get the Application data:</span>
2399 <span class="comment">% -------------------------</span>
2400 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2401 
2402 <span class="comment">% Modify the Application data:</span>
2403 <span class="comment">% ----------------------------</span>
2404 guiparams.display_shoreline = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2405 
2406 <span class="comment">% Re-store the Application data:</span>
2407 <span class="comment">% ------------------------------</span>
2408 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2409 
2410 <span class="comment">% [EOF] DisplayShoreline_Callback</span>
2411 
2412 
2413 <span class="comment">% --------------------------------------------------------------------</span>
2414 <a name="_sub67" href="#_subfunctions" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a>
2415 
2416 <span class="comment">% Get the Application data:</span>
2417 <span class="comment">% -------------------------</span>
2418 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2419 
2420 <span class="comment">% Modify the Application data:</span>
2421 <span class="comment">% ----------------------------</span>
2422 guiparams.add_background = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2423 
2424 <span class="comment">% Re-store the Application data:</span>
2425 <span class="comment">% ------------------------------</span>
2426 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2427 
2428 <span class="comment">% [EOF] AddBackground_Callback</span>
2429 
2430 
2431 <span class="comment">% --------------------------------------------------------------------</span>
2432 <a name="_sub68" href="#_subfunctions" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a>
2433 <a href="#_sub51" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
2434 <span class="comment">% [EOF] PlotPlanView_Callback</span>
2435 
2436 
2437 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2438 <span class="comment">% PLOTTING/SHIP TRACKS PLOT CALLBACKS %</span>
2439 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2440 
2441 <span class="comment">% --------------------------------------------------------------------</span>
2442 <a name="_sub69" href="#_subfunctions" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a>
2443 <span class="comment">% Set the horizontal grid node spacing</span>
2444 
2445 <span class="comment">% Get the Application data:</span>
2446 <span class="comment">% -------------------------</span>
2447 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2448 
2449 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2450 <span class="comment">% ----------------------------------------------------------------</span>
2451 new_horizontal_grid_node_spacing = str2double(get(hObject,<span class="string">'String'</span>));
2452 is_a_number = ~isnan(new_horizontal_grid_node_spacing);
2453 is_positive = new_horizontal_grid_node_spacing&gt;=0;
2454 
2455 <span class="comment">% Modify the Application data:</span>
2456 <span class="comment">% ----------------------------</span>
2457 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2458     guiparams.horizontal_grid_node_spacing = round(new_horizontal_grid_node_spacing);
2459     
2460     <span class="comment">% Re-store the Application data:</span>
2461     <span class="comment">% ------------------------------</span>
2462     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2463     
2464 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2465     set(hObject,<span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
2466 <span class="keyword">end</span>
2467 
2468 <span class="comment">% [EOF] HorizontalGridNodeSpacing_Callback</span>
2469 
2470 
2471 <span class="comment">% --------------------------------------------------------------------</span>
2472 <a name="_sub70" href="#_subfunctions" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
2473 <span class="comment">% Set the cross section endpoints manually</span>
2474 
2475 <span class="comment">% Get the Application data:</span>
2476 <span class="comment">% -------------------------</span>
2477 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2478 
2479 <span class="comment">% Modify the Application data:</span>
2480 <span class="comment">% ----------------------------</span>
2481 guiparams.set_cross_section_endpoints = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2482 
2483 <span class="comment">% Re-store the Application data:</span>
2484 <span class="comment">% ------------------------------</span>
2485 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2486 
2487 <span class="comment">% [EOF] SetCrossSectionEndpoints_Callback</span>
2488 
2489 
2490 <span class="comment">% --------------------------------------------------------------------</span>
2491 <a name="_sub71" href="#_subfunctions" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a>
2492 <a href="#_sub50" class="code" title="subfunction shiptracksPlotCallback(hObject, eventdata, handles)">shiptracksPlotCallback</a>(hObject, eventdata, handles)
2493 <span class="comment">% [EOF] PlotShiptracks_Callback</span>
2494 
2495 
2496 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2497 <span class="comment">% PLOTTING/CROSS SECTION PLOT CALLBACKS %</span>
2498 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2499 
2500 <span class="comment">% --------------------------------------------------------------------</span>
2501 <a name="_sub72" href="#_subfunctions" class="code">function Contour_Callback(hObject, eventdata, handles)</a>
2502 
2503 <span class="comment">% Get the Application data:</span>
2504 <span class="comment">% -------------------------</span>
2505 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2506 
2507 <span class="comment">% Modify the Application data:</span>
2508 <span class="comment">% ----------------------------</span>
2509 idx_variable = get(hObject,<span class="string">'Value'</span>);
2510 guiparams.idx_contour = idx_variable;
2511 guiparams.contour = guiparams.contours(idx_variable).variable;
2512 
2513 <span class="comment">% Re-store the Application data:</span>
2514 <span class="comment">% ------------------------------</span>
2515 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2516 
2517 <span class="comment">% [EOF] Contour_Callback</span>
2518 
2519 
2520 <span class="comment">% --------------------------------------------------------------------</span>
2521 <a name="_sub73" href="#_subfunctions" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a>
2522 <span class="comment">% Set vertical exaggeration</span>
2523 
2524 <span class="comment">% Get the Application data:</span>
2525 <span class="comment">% -------------------------</span>
2526 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2527 
2528 <span class="comment">% Modify the Application data:</span>
2529 <span class="comment">% ----------------------------</span>
2530 guiparams.vertical_exaggeration = str2double(get(hObject,<span class="string">'String'</span>));
2531 
2532 <span class="comment">% Re-store the Application data:</span>
2533 <span class="comment">% ------------------------------</span>
2534 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2535 
2536 <span class="comment">% Update the GUI:</span>
2537 <span class="comment">% ---------------</span>
2538 <span class="comment">% updateGUI(handles,guiparams)</span>
2539 
2540 <span class="comment">% [EOF] VerticalExaggeration_Callback</span>
2541 
2542 
2543 <span class="comment">% --------------------------------------------------------------------</span>
2544 <a name="_sub74" href="#_subfunctions" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a>
2545 
2546 <span class="comment">% Get the Application data:</span>
2547 <span class="comment">% -------------------------</span>
2548 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2549 
2550 <span class="comment">% Modify the Application data:</span>
2551 <span class="comment">% ----------------------------</span>
2552 guiparams.vector_scale_cross_section = str2double(get(hObject,<span class="string">'String'</span>));
2553 
2554 <span class="comment">% Re-store the Application data:</span>
2555 <span class="comment">% ------------------------------</span>
2556 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2557 
2558 <span class="comment">% Update the GUI:</span>
2559 <span class="comment">% ---------------</span>
2560 <span class="comment">% updateGUI(handles,guiparams)</span>
2561 
2562 <span class="comment">% [EOF] VectorScaleCrossSection_Callback</span>
2563 
2564 
2565 <span class="comment">% --------------------------------------------------------------------</span>
2566 <a name="_sub75" href="#_subfunctions" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a>
2567 
2568 <span class="comment">% Get the Application data:</span>
2569 <span class="comment">% -------------------------</span>
2570 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2571 
2572 <span class="comment">% Modify the Application data:</span>
2573 <span class="comment">% ----------------------------</span>
2574 guiparams.horizontal_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
2575 
2576 <span class="comment">% Re-store the Application data:</span>
2577 <span class="comment">% ------------------------------</span>
2578 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2579 
2580 <span class="comment">% Update the GUI:</span>
2581 <span class="comment">% ---------------</span>
2582 <span class="comment">% updateGUI(handles,guiparams)</span>
2583 
2584 <span class="comment">% [EOF] HorizontalVectorSpacing_Callback</span>
2585 
2586 
2587 <span class="comment">% --------------------------------------------------------------------</span>
2588 <a name="_sub76" href="#_subfunctions" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a>
2589 <span class="comment">% Get the vertical quiver spacing for contour plots</span>
2590 
2591 <span class="comment">% Get the Application data:</span>
2592 <span class="comment">% -------------------------</span>
2593 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2594 
2595 <span class="comment">% Modify the Application data:</span>
2596 <span class="comment">% ----------------------------</span>
2597 guiparams.vertical_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
2598 
2599 <span class="comment">% Re-store the Application data:</span>
2600 <span class="comment">% ------------------------------</span>
2601 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2602 
2603 <span class="comment">% Update the GUI:</span>
2604 <span class="comment">% ---------------</span>
2605 <span class="comment">% updateGUI(handles,guiparams)</span>
2606 
2607 <span class="comment">% [EOF] VerticalVectorSpacing_Callback</span>
2608 
2609 
2610 <span class="comment">% --------------------------------------------------------------------</span>
2611 <a name="_sub77" href="#_subfunctions" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
2612 <span class="comment">% Horizontal Smoothing</span>
2613 
2614 <span class="comment">% Get the Application data:</span>
2615 <span class="comment">% -------------------------</span>
2616 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2617 
2618 <span class="comment">% Modify the Application data:</span>
2619 <span class="comment">% ----------------------------</span>
2620 guiparams.horizontal_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
2621 
2622 <span class="comment">% Re-store the Application data:</span>
2623 <span class="comment">% ------------------------------</span>
2624 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2625 
2626 <span class="comment">% Update the GUI:</span>
2627 <span class="comment">% ---------------</span>
2628 <span class="comment">% updateGUI(handles,guiparams)</span>
2629 
2630 <span class="comment">% [EOF] HorizontalSmoothingWindow_Callback</span>
2631 
2632 
2633 <span class="comment">% --------------------------------------------------------------------</span>
2634 <a name="_sub78" href="#_subfunctions" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
2635 <span class="comment">% Vertical Smoothing</span>
2636 
2637 <span class="comment">% Get the Application data:</span>
2638 <span class="comment">% -------------------------</span>
2639 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2640 
2641 <span class="comment">% Modify the Application data:</span>
2642 <span class="comment">% ----------------------------</span>
2643 guiparams.vertical_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
2644 
2645 <span class="comment">% Re-store the Application data:</span>
2646 <span class="comment">% ------------------------------</span>
2647 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2648 
2649 <span class="comment">% Update the GUI:</span>
2650 <span class="comment">% ---------------</span>
2651 <span class="comment">% updateGUI(handles,guiparams)</span>
2652 
2653 <span class="comment">% [EOF] VerticalSmoothingWindow_Callback</span>
2654 
2655 
2656 <span class="comment">% --------------------------------------------------------------------</span>
2657 <a name="_sub79" href="#_subfunctions" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a>
2658 
2659 <span class="comment">% Get the Application data:</span>
2660 <span class="comment">% -------------------------</span>
2661 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2662 
2663 <span class="comment">% Modify the Application data:</span>
2664 <span class="comment">% ----------------------------</span>
2665 guiparams.plot_secondary_flow_vectors = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2666 
2667 <span class="comment">% Re-store the Application data:</span>
2668 <span class="comment">% ------------------------------</span>
2669 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2670 
2671 <span class="comment">% [EOF] PlotSecondaryFlowVectors_Callback</span>
2672 
2673 
2674 <span class="comment">% --------------------------------------------------------------------</span>
2675 <a name="_sub80" href="#_subfunctions" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a>
2676 
2677 <span class="comment">% Get the Application data:</span>
2678 <span class="comment">% -------------------------</span>
2679 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2680 
2681 <span class="comment">% Modify the Application data:</span>
2682 <span class="comment">% ----------------------------</span>
2683 idx_variable = get(hObject,<span class="string">'Value'</span>);
2684 guiparams.idx_secondary_flow_vector_variable = idx_variable;
2685 guiparams.secondary_flow_vector_variable = guiparams.secondary_flows(idx_variable).variable;
2686 
2687 <span class="comment">% Re-store the Application data:</span>
2688 <span class="comment">% ------------------------------</span>
2689 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2690 
2691 <span class="comment">% [EOF] SecondaryFlowVectorVariable_Callback</span>
2692 
2693 
2694 <span class="comment">% --------------------------------------------------------------------</span>
2695 <a name="_sub81" href="#_subfunctions" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a>
2696 
2697 <span class="comment">% Get the Application data:</span>
2698 <span class="comment">% -------------------------</span>
2699 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2700 
2701 <span class="comment">% Modify the Application data:</span>
2702 <span class="comment">% ----------------------------</span>
2703 guiparams.include_vertical_velocity = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2704 
2705 <span class="comment">% Re-store the Application data:</span>
2706 <span class="comment">% ------------------------------</span>
2707 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2708 
2709 <span class="comment">% [EOF] IncludeVerticalVelocity_Callback</span>
2710 
2711 
2712 <span class="comment">% --------------------------------------------------------------------</span>
2713 <a name="_sub82" href="#_subfunctions" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a>
2714 <a href="#_sub52" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
2715 <span class="comment">% [EOF] PlotCrossSection_Callback</span>
2716 
2717 
2718 <span class="comment">% --------------------------------------------------------------------</span>
2719 <a name="_sub83" href="#_subfunctions" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a>
2720 set(handles.LogWindow,<span class="string">'string'</span>,<span class="string">''</span>)
2721 <span class="comment">% [EOF] ClearLog_Callback</span>
2722 
2723 <span class="comment">% --------------------------------------------------------------------</span>
2724 <a name="_sub84" href="#_subfunctions" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a>
2725 
2726 <span class="comment">% Get the Application data:</span>
2727 <span class="comment">% -------------------------</span>
2728 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2729 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2730 <span class="comment">% z   = guiparams.z;   %#ok&lt;NASGU&gt;</span>
2731 <span class="comment">% A   = guiparams.A;   %#ok&lt;NASGU&gt;</span>
2732 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
2733 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
2734 
2735 [the_file,the_path] = <span class="keyword">...</span>
2736     uiputfile({<span class="string">'*.txt'</span>,<span class="string">'TXT-Files (*.txt)'</span>}, <span class="keyword">...</span>
2737     <span class="string">'Choose where to save the log file'</span>, <span class="keyword">...</span>
2738     fullfile(guiprefs.log_path,guiprefs.log_file));
2739 
2740 <span class="comment">% Save the log to a TXT file:</span>
2741 <span class="comment">% ---------------------------</span>
2742 <span class="keyword">if</span> ischar(the_file)
2743     guiparams.log_path = the_path;
2744     guiparams.log_file = the_file;
2745     <span class="comment">%guiparams.savefile = the_file;</span>
2746     
2747     <span class="comment">% Re-store the Application data:</span>
2748     <span class="comment">% ------------------------------</span>
2749     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2750     
2751     <span class="comment">% Update the preferences:</span>
2752     <span class="comment">% -----------------------</span>
2753     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2754     guiprefs.log_path = the_path;
2755     guiprefs.log_file = the_file;
2756     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2757     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'log'</span>)
2758     
2759     [~,filename,extension] = fileparts(the_file);
2760     savefile = [the_path filename extension];
2761     h = msgbox([<span class="string">'Saving log to: '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
2762         <span class="string">'Saving Log File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2763     
2764     logfile = get(handles.LogWindow,<span class="string">'string'</span>);
2765     [nrows,~]= size(logfile);
2766     fid = fopen(savefile, <span class="string">'w'</span>);
2767     <span class="keyword">for</span> row=1:nrows
2768         fprintf(fid, <span class="string">'%s \n'</span>, logfile{row,:});
2769     <span class="keyword">end</span>
2770     fclose(fid);
2771 <span class="keyword">end</span>
2772 <span class="comment">% [EOF] SaveLog_Callback</span>
2773 
2774 <span class="comment">%%%%%%%%%%%%%%%%</span>
2775 <span class="comment">% SUBFUNCTIONS %</span>
2776 <span class="comment">%%%%%%%%%%%%%%%%</span>
2777 
2778 <span class="comment">% --------------------------------------------------------------------</span>
2779 <a name="_sub85" href="#_subfunctions" class="code">function handles = buildToolbar(handles)</a>
2780 
2781 icons = <a href="#_sub101" class="code" title="subfunction icons = getIcons">getIcons</a>;
2782 ht = uitoolbar(<span class="string">'Parent'</span>,handles.figure1);
2783 
2784 <span class="comment">% Load data</span>
2785 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_open.png');</span>
2786 <span class="comment">% icon = double(icon)/(2^16-1);</span>
2787 <span class="comment">% icon(icon==0) = NaN;</span>
2788 handles.toolbarLoadData = <span class="keyword">...</span>
2789     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
2790     <span class="string">'CData'</span>,        icons(1).data, <span class="keyword">...</span>
2791     <span class="string">'TooltipString'</span>,<span class="string">'Open ASCII File'</span>);
2792 
2793 <span class="comment">% Save data</span>
2794 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_save.png');</span>
2795 <span class="comment">% icon = double(icon)/(2^16-1);</span>
2796 <span class="comment">% icon(icon==0) = NaN;</span>
2797 handles.toolbarSaveMatFile = <span class="keyword">...</span>
2798     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
2799     <span class="string">'CData'</span>,        icons(2).data, <span class="keyword">...</span>
2800     <span class="string">'TooltipString'</span>,<span class="string">'Save MAT File'</span>, <span class="keyword">...</span>
2801     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
2802 
2803 
2804 <span class="comment">% Save bathymetry</span>
2805 <span class="comment">%icon = ones(16,16,3);</span>
2806 handles.toolbarSaveBathymetry = <span class="keyword">...</span>
2807     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
2808     <span class="string">'CData'</span>,        icons(5).data, <span class="keyword">...</span>
2809     <span class="string">'TooltipString'</span>,<span class="string">'Export Bathymetry'</span>);
2810 
2811 <span class="comment">% Save figures</span>
2812 <span class="comment">% icon = ones(16,16,3);</span>
2813 handles.toolbarSaveFigures = <span class="keyword">...</span>
2814     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
2815     <span class="string">'CData'</span>,        icons(6).data, <span class="keyword">...</span>
2816     <span class="string">'TooltipString'</span>,<span class="string">'Export Figures'</span>);
2817 
2818 <span class="comment">% Save Excel File</span>
2819 <span class="comment">% icon = ones(16,16,3);</span>
2820 handles.toolbarSaveExcel = <span class="keyword">...</span>
2821     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
2822     <span class="string">'CData'</span>,        icons(7).data, <span class="keyword">...</span>
2823     <span class="string">'TooltipString'</span>,<span class="string">'Export Excel File'</span>);
2824 
2825 
2826 <span class="comment">% Plotting parameters</span>
2827 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\PlotGeneralElement.gif');</span>
2828 <span class="comment">% icon = ind2rgb(icon,map);</span>
2829 handles.toolbarPlottingParameters = <span class="keyword">...</span>
2830     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
2831     <span class="string">'CData'</span>,        icons(3).data, <span class="keyword">...</span>
2832     <span class="string">'TooltipString'</span>,<span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
2833     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
2834 
2835 <span class="comment">% Processing parameters</span>
2836 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
2837 <span class="comment">% icon = ind2rgb(icon,map);</span>
2838 handles.toolbarProcessingParameters = <span class="keyword">...</span>
2839     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
2840     <span class="string">'CData'</span>,        icons(4).data, <span class="keyword">...</span>
2841     <span class="string">'TooltipString'</span>,<span class="string">'Processing Parameters'</span>);
2842 
2843 <span class="comment">% % Plot 1: Shiptracks</span>
2844 <span class="comment">% handles.shiptracksPlot = ...</span>
2845 <span class="comment">%     uipushtool('Parent',       ht, ...</span>
2846 <span class="comment">%                'CData',        icon, ...</span>
2847 <span class="comment">%                'TooltipString','Shiptracks plot', ...</span>
2848 <span class="comment">%                'Separator',    'on');</span>
2849 <span class="comment">%</span>
2850 <span class="comment">% % Plot 2: Plan view</span>
2851 <span class="comment">% handles.planviewPlot = ...</span>
2852 <span class="comment">%     uipushtool('Parent',       ht, ...</span>
2853 <span class="comment">%                'CData',        icon, ...</span>
2854 <span class="comment">%                'TooltipString','Plan view plot');</span>
2855 <span class="comment">%</span>
2856 <span class="comment">% % Plot 3: Cross section</span>
2857 <span class="comment">% handles.crosssectionPlot = ...</span>
2858 <span class="comment">%     uipushtool('Parent',       ht, ...</span>
2859 <span class="comment">%                'CData',        icon, ...</span>
2860 <span class="comment">%                'TooltipString','Cross section plot');</span>
2861 
2862 set(handles.toolbarLoadData,            <span class="string">'ClickedCallback'</span>,{@<a href="#_sub45" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>,handles})
2863 set(handles.toolbarSaveMatFile,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub46" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>,handles})
2864 set(handles.toolbarSaveBathymetry,      <span class="string">'ClickedCallback'</span>,{@<a href="#_sub56" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>,handles})
2865 set(handles.toolbarSaveFigures,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub17" class="code" title="subfunction menuExportFigures_Callback(hObject, eventdata, handles)">menuExportFigures_Callback</a>,handles})
2866 set(handles.toolbarSaveExcel,           <span class="string">'ClickedCallback'</span>,{@<a href="#_sub21" class="code" title="subfunction menuSaveExcel_Callback(hObject, eventdata, handles)">menuSaveExcel_Callback</a>,handles})
2867 set(handles.toolbarPlottingParameters,  <span class="string">'ClickedCallback'</span>,{@<a href="#_sub48" class="code" title="subfunction plottingParametersCallback(hObject, eventdata, handles)">plottingParametersCallback</a>,handles})
2868 set(handles.toolbarProcessingParameters,<span class="string">'ClickedCallback'</span>,{@<a href="#_sub49" class="code" title="subfunction processingParametersCallback(hObject, eventdata, handles)">processingParametersCallback</a>,handles})
2869 <span class="comment">% set(handles.shiptracksPlot,      'ClickedCallback',{@shiptracksPlotCallback,handles})</span>
2870 <span class="comment">% set(handles.planviewPlot,        'ClickedCallback',{@planviewPlotCallback,handles})</span>
2871 <span class="comment">% set(handles.crosssectionPlot,    'ClickedCallback',{@crosssectionPlotCallback,handles})</span>
2872 
2873 <span class="comment">% [EOF] buildtoolbar</span>
2874 
2875 
2876 <span class="comment">% --------------------------------------------------------------------</span>
2877 <a name="_sub86" href="#_subfunctions" class="code">function load_prefs(hfigure)</a>
2878 <span class="comment">% Load the GUI preferences.  Also, initialize preferences if they don't</span>
2879 <span class="comment">% already exist.</span>
2880 
2881 <span class="comment">% Preferences:</span>
2882 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
2883 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
2884 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
2885 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
2886 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
2887 <span class="comment">% 'log'                  Path and filename of last Log file</span>
2888 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
2889 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
2890 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
2891 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
2892 
2893 <span class="comment">% Originals</span>
2894 <span class="comment">% prefs = {'ascii2gispath' 'ascii2kmlpath' 'asciipath'   'doqqpath' ...</span>
2895 <span class="comment">%          'endspath'      'logpath'       'matpath'     'savedpath' ...</span>
2896 <span class="comment">%          'shorepath'     'stapath'       'ysidatapath' 'ysidatapath'};</span>
2897 
2898 <span class="comment">% ASCII</span>
2899 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>)
2900     ascii = getpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>);
2901     <span class="keyword">if</span> exist(ascii.path,<span class="string">'dir'</span>)
2902         guiprefs.ascii_path = ascii.path;
2903     <span class="keyword">else</span>
2904         guiprefs.ascii_path = pwd;
2905     <span class="keyword">end</span>
2906     does_exist = false(1,length(ascii.file));
2907     <span class="keyword">for</span> k = 1:length(ascii.file) <span class="comment">% Check each file one-by-one</span>
2908         does_exist(k) = exist(fullfile(ascii.path,ascii.file{k}),<span class="string">'file'</span>);
2909     <span class="keyword">end</span>
2910     <span class="keyword">if</span> any(does_exist)
2911         guiprefs.ascii_file = ascii.file(does_exist);
2912     <span class="keyword">else</span>
2913         guiprefs.ascii_file = {<span class="string">''</span>};
2914     <span class="keyword">end</span>
2915 <span class="keyword">else</span> <span class="comment">% Initialize ASCII</span>
2916     guiprefs.ascii_path = pwd;
2917     guiprefs.ascii_file = {<span class="string">''</span>};
2918     
2919     ascii.path = pwd;
2920     ascii.file = {<span class="string">''</span>};
2921     setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
2922 <span class="keyword">end</span>
2923 
2924 <span class="comment">% MAT</span>
2925 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>)
2926     mat = getpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>);
2927     <span class="keyword">if</span> exist(mat.path,<span class="string">'dir'</span>)
2928         guiprefs.mat_path = mat.path;
2929     <span class="keyword">else</span>
2930         guiprefs.mat_path = pwd;
2931     <span class="keyword">end</span>
2932     
2933     <span class="keyword">if</span> iscell(mat.file)
2934         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file{1}),<span class="string">'file'</span>)
2935             guiprefs.mat_file = mat.file;
2936         <span class="keyword">else</span>
2937             guiprefs.mat_file = <span class="string">''</span>;
2938         <span class="keyword">end</span>
2939     <span class="keyword">else</span>
2940         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file),<span class="string">'file'</span>)
2941             guiprefs.mat_file = mat.file;
2942         <span class="keyword">else</span>
2943             guiprefs.mat_file = <span class="string">''</span>;
2944         <span class="keyword">end</span>
2945     <span class="keyword">end</span>
2946 <span class="keyword">else</span> <span class="comment">% Initialize MAT</span>
2947     guiprefs.mat_path = pwd;
2948     guiprefs.mat_file = <span class="string">''</span>;
2949     
2950     mat.path = pwd;
2951     mat.file = <span class="string">''</span>;
2952     setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
2953 <span class="keyword">end</span>
2954 
2955 <span class="comment">% TECPLOT</span>
2956 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>)
2957     tecplot = getpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>);
2958     <span class="keyword">if</span> exist(tecplot.path,<span class="string">'dir'</span>)
2959         guiprefs.tecplot_path = tecplot.path;
2960     <span class="keyword">else</span>
2961         guiprefs.tecplot_path = pwd;
2962     <span class="keyword">end</span>
2963     <span class="keyword">if</span> exist(fullfile(tecplot.path,tecplot.file),<span class="string">'file'</span>)
2964         guiprefs.tecplot_file = tecplot.file;
2965     <span class="keyword">else</span>
2966         guiprefs.tecplot_file = <span class="string">''</span>;
2967     <span class="keyword">end</span>
2968 <span class="keyword">else</span> <span class="comment">% Initialize TECPLOT</span>
2969     guiprefs.tecplot_path = pwd;
2970     guiprefs.tecplot_file = <span class="string">''</span>;
2971     
2972     tecplot.path = pwd;
2973     tecplot.file = <span class="string">''</span>;
2974     setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
2975 <span class="keyword">end</span>
2976 
2977 <span class="comment">% KMZ</span>
2978 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>)
2979     kmz = getpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>);
2980     <span class="keyword">if</span> exist(kmz.path,<span class="string">'dir'</span>)
2981         guiprefs.kmz_path = kmz.path;
2982     <span class="keyword">else</span>
2983         guiprefs.kmz_path = pwd;
2984     <span class="keyword">end</span>
2985     <span class="keyword">if</span> exist(fullfile(kmz.path,kmz.file),<span class="string">'file'</span>)
2986         guiprefs.kmz_file = kmz.file;
2987     <span class="keyword">else</span>
2988         guiprefs.kmz_file = <span class="string">''</span>;
2989     <span class="keyword">end</span>
2990 <span class="keyword">else</span> <span class="comment">% Initialize KMZ</span>
2991     guiprefs.kmz_path = pwd;
2992     guiprefs.kmz_file = <span class="string">''</span>;
2993     
2994     kmz.path = pwd;
2995     kmz.file = <span class="string">''</span>;
2996     setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
2997 <span class="keyword">end</span>
2998 
2999 <span class="comment">% MULTIBEAM BATHYMETRY</span>
3000 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>)
3001     multibeambathymetry = getpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>);
3002     <span class="keyword">if</span> exist(multibeambathymetry.path,<span class="string">'dir'</span>)
3003         guiprefs.multibeambathymetry_path = multibeambathymetry.path;
3004     <span class="keyword">else</span>
3005         guiprefs.multibeambathymetry_path = pwd;
3006     <span class="keyword">end</span>
3007     <span class="keyword">if</span> exist(fullfile(multibeambathymetry.path,multibeambathymetry.file),<span class="string">'file'</span>)
3008         guiprefs.multibeambathymetry_file = multibeambathymetry.file;
3009     <span class="keyword">else</span>
3010         guiprefs.multibeambathymetry_file = <span class="string">''</span>;
3011     <span class="keyword">end</span>
3012 <span class="keyword">else</span> <span class="comment">% Initialize MULTIBEAM BATHYMETRY</span>
3013     guiprefs.multibeambathymetry_path = pwd;
3014     guiprefs.multibeambathymetry_file = <span class="string">''</span>;
3015     
3016     multibeambathymetry.path = pwd;
3017     multibeambathymetry.file = <span class="string">''</span>;
3018     setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
3019 <span class="keyword">end</span>
3020 
3021 <span class="comment">% Log</span>
3022 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'log'</span>)
3023     log = getpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>);
3024     <span class="keyword">if</span> exist(log.path,<span class="string">'dir'</span>)
3025         guiprefs.log_path = log.path;
3026     <span class="keyword">else</span>
3027         guiprefs.log_path = pwd;
3028     <span class="keyword">end</span>
3029     <span class="keyword">if</span> exist(fullfile(log.path,log.file),<span class="string">'file'</span>)
3030         guiprefs.log_file = log.file;
3031     <span class="keyword">else</span>
3032         guiprefs.log_file = <span class="string">''</span>;
3033     <span class="keyword">end</span>
3034 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
3035     guiprefs.log_path = pwd;
3036     guiprefs.log_file = <span class="string">''</span>;
3037     
3038     log.path = pwd;
3039     log.file = <span class="string">''</span>;
3040     setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
3041 <span class="keyword">end</span>
3042 
3043 <span class="comment">% iRic</span>
3044 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>)
3045     iric = getpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>);
3046     <span class="keyword">if</span> exist(iric.path,<span class="string">'dir'</span>)
3047         guiprefs.iric_path = iric.path;
3048     <span class="keyword">else</span>
3049         guiprefs.iric_path = pwd;
3050     <span class="keyword">end</span>
3051     <span class="keyword">if</span> exist(fullfile(iric.path,iric.file),<span class="string">'file'</span>)
3052         guiprefs.iric_file = iric.file;
3053     <span class="keyword">else</span>
3054         guiprefs.iric_file = <span class="string">''</span>;
3055     <span class="keyword">end</span>
3056 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
3057     guiprefs.iric_path = pwd;
3058     guiprefs.iric_file = <span class="string">''</span>;
3059     
3060     iric.path = pwd;
3061     iric.file = <span class="string">''</span>;
3062     setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
3063 <span class="keyword">end</span>
3064 
3065 <span class="comment">% excel</span>
3066 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>)
3067     excel = getpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>);
3068     <span class="keyword">if</span> exist(excel.path,<span class="string">'dir'</span>)
3069         guiprefs.excel_path = excel.path;
3070     <span class="keyword">else</span>
3071         guiprefs.excel_path = pwd;
3072     <span class="keyword">end</span>
3073     <span class="keyword">if</span> exist(fullfile(excel.path,excel.file),<span class="string">'file'</span>)
3074         guiprefs.excel_file = excel.file;
3075     <span class="keyword">else</span>
3076         guiprefs.excel_file = <span class="string">''</span>;
3077     <span class="keyword">end</span>
3078 <span class="keyword">else</span> <span class="comment">% Initialize pref</span>
3079     guiprefs.excel_path = pwd;
3080     guiprefs.excel_file = <span class="string">''</span>;
3081     
3082     excel.path = pwd;
3083     excel.file = <span class="string">''</span>;
3084     setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
3085 <span class="keyword">end</span>
3086 
3087 <span class="comment">% aerial</span>
3088 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>)
3089     aerial = getpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>);
3090     <span class="keyword">if</span> exist(aerial.path,<span class="string">'dir'</span>)
3091         guiprefs.aerial_path = aerial.path;
3092     <span class="keyword">else</span>
3093         guiprefs.aerial_path = pwd;
3094     <span class="keyword">end</span>
3095     does_exist = false(1,length(aerial.file));
3096     <span class="keyword">if</span> iscell(aerial.file)
3097     <span class="keyword">for</span> k = 1:numel(aerial.file) <span class="comment">% Check each file one-by-one</span>
3098         does_exist(k) = exist(fullfile(aerial.path,aerial.file{k}),<span class="string">'file'</span>);
3099     <span class="keyword">end</span>
3100     <span class="keyword">else</span>
3101         does_exist = exist(fullfile(aerial.path,aerial.file),<span class="string">'file'</span>);
3102     <span class="keyword">end</span>
3103     <span class="keyword">if</span> any(does_exist)
3104         guiprefs.aerial_file = aerial.file;
3105     <span class="keyword">else</span>
3106         guiprefs.aerial_file = {<span class="string">''</span>};
3107     <span class="keyword">end</span>
3108 <span class="keyword">else</span> <span class="comment">% Initialize aerial</span>
3109     guiprefs.aerial_path = pwd;
3110     guiprefs.aerial_file = {<span class="string">''</span>};
3111     
3112     aerial.path = pwd;
3113     aerial.file = {<span class="string">''</span>};
3114     setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
3115 <span class="keyword">end</span>
3116 
3117 <span class="comment">% shoreline</span>
3118 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>)
3119     shoreline = getpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>);
3120     <span class="keyword">if</span> exist(shoreline.path,<span class="string">'dir'</span>)
3121         guiprefs.shoreline_path = shoreline.path;
3122     <span class="keyword">else</span>
3123         guiprefs.shoreline_path = pwd;
3124     <span class="keyword">end</span>
3125     
3126     <span class="keyword">if</span> iscell(shoreline.file)
3127         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file{1}),<span class="string">'file'</span>)
3128             guiprefs.shoreline_file = shoreline.file;
3129         <span class="keyword">else</span>
3130             guiprefs.shoreline_file = <span class="string">''</span>;
3131         <span class="keyword">end</span>
3132     <span class="keyword">else</span>
3133         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file),<span class="string">'file'</span>)
3134             guiprefs.shoreline_file = shoreline.file;
3135         <span class="keyword">else</span>
3136             guiprefs.shoreline_file = <span class="string">''</span>;
3137         <span class="keyword">end</span>
3138     <span class="keyword">end</span>
3139 <span class="keyword">else</span> <span class="comment">% Initialize shoreline</span>
3140     guiprefs.shoreline_path = pwd;
3141     guiprefs.shoreline_file = <span class="string">''</span>;
3142     
3143     shoreline.path = pwd;
3144     shoreline.file = <span class="string">''</span>;
3145     setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
3146 <span class="keyword">end</span>
3147 <span class="comment">% guiprefs.presentation = true;</span>
3148 <span class="comment">% guiprefs.print        = false;</span>
3149 
3150 <span class="comment">% for k = 1:length(prefs)</span>
3151 <span class="comment">%     newpref = '';</span>
3152 <span class="comment">%     if ispref('VMT',prefs{k})</span>
3153 <span class="comment">%         stored_newpref = getpref('VMT',prefs{k});</span>
3154 <span class="comment">%         if exist(stored_newpref,'dir')</span>
3155 <span class="comment">%             newpref = stored_newpref;</span>
3156 <span class="comment">%         else</span>
3157 <span class="comment">%             setpref('VMT',prefs{k},newpref)</span>
3158 <span class="comment">%         end</span>
3159 <span class="comment">%     end</span>
3160 <span class="comment">%     guiprefs.(prefs{k}) = newpref;</span>
3161 <span class="comment">% end</span>
3162 
3163 setappdata(hfigure,<span class="string">'guiprefs'</span>,guiprefs)
3164 
3165 <span class="comment">% [EOF] load_prefs</span>
3166 
3167 
3168 <span class="comment">% --------------------------------------------------------------------</span>
3169 <a name="_sub87" href="#_subfunctions" class="code">function store_prefs(hfigure,pref)</a>
3170 <span class="comment">% Store preferences in the Application data and in the persistent</span>
3171 <span class="comment">% preferences data.</span>
3172 
3173 <span class="comment">% Preferences:</span>
3174 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
3175 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
3176 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
3177 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
3178 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
3179 <span class="comment">% 'log'                  Path and filename of last Log file</span>
3180 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
3181 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
3182 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
3183 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
3184 
3185 guiprefs = getappdata(hfigure,<span class="string">'guiprefs'</span>);
3186 
3187 <span class="keyword">switch</span> pref
3188     <span class="keyword">case</span> <span class="string">'ascii'</span>
3189         ascii.path = guiprefs.ascii_path;
3190         ascii.file = guiprefs.ascii_file;
3191         setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
3192     <span class="keyword">case</span> <span class="string">'mat'</span>
3193         mat.path = guiprefs.mat_path;
3194         mat.file = guiprefs.mat_file;
3195         setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
3196     <span class="keyword">case</span> <span class="string">'tecplot'</span>
3197         tecplot.path = guiprefs.tecplot_path;
3198         tecplot.file = guiprefs.tecplot_file;
3199         setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
3200     <span class="keyword">case</span> <span class="string">'kmz'</span>
3201         kmz.path = guiprefs.kmz_path;
3202         kmz.file = guiprefs.kmz_file;
3203         setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
3204     <span class="keyword">case</span> <span class="string">'multibeambathymetry'</span>
3205         multibeambathymetry.path = guiprefs.multibeambathymetry_path;
3206         multibeambathymetry.file = guiprefs.multibeambathymetry_file;
3207         setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
3208     <span class="keyword">case</span> <span class="string">'log'</span>
3209         log.path = guiprefs.log_path;
3210         log.file = guiprefs.log_file;
3211         setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
3212     <span class="keyword">case</span> <span class="string">'iric'</span>
3213         iric.path = guiprefs.iric_path;
3214         iric.file = guiprefs.iric_file;
3215         setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
3216     <span class="keyword">case</span> <span class="string">'excel'</span>
3217         excel.path = guiprefs.excel_path;
3218         excel.file = guiprefs.excel_file;
3219         setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
3220     <span class="keyword">case</span> <span class="string">'aerial'</span>
3221         aerial.path = guiprefs.aerial_path;
3222         aerial.file = guiprefs.aerial_file;
3223         setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
3224     <span class="keyword">case</span> <span class="string">'shoreline'</span>
3225         shoreline.path = guiprefs.shoreline_path;
3226         shoreline.file = guiprefs.shoreline_file;
3227         setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
3228     <span class="keyword">otherwise</span>
3229 <span class="keyword">end</span>
3230 
3231 <span class="comment">% if ismember(pref,prefs)</span>
3232 <span class="comment">%     setpref('VMT',pref,value)</span>
3233 <span class="comment">%</span>
3234 <span class="comment">%     guiprefs = getappdata(hfigure,'guiprefs');</span>
3235 <span class="comment">%     guiprefs.(pref) = value;</span>
3236 <span class="comment">%     setappdata(hfigure,'guiprefs',guiprefs)</span>
3237 <span class="comment">% end</span>
3238 
3239 <span class="comment">% [EOF] store_prefs</span>
3240 
3241 
3242 <span class="comment">% --------------------------------------------------------------------</span>
3243 <a name="_sub88" href="#_subfunctions" class="code">function initGUI(handles)</a>
3244 <span class="comment">% Initialize the UI controls in the GUI.</span>
3245 
3246 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3247 
3248 <span class="comment">% Set the name and version</span>
3249 set(handles.figure1,<span class="string">'Name'</span>,[<span class="string">'Velocity Mapping Toolbox (VMT) '</span> guiparams.vmt_version], <span class="keyword">...</span>
3250     <span class="string">'DockControls'</span>,<span class="string">'off'</span>)
3251 <span class="comment">%set(handles.VMTversion,             'String',guiparams.vmt_version)</span>
3252 
3253 <span class="comment">% Set the PLOT 1 axis labels</span>
3254 axes(handles.Plot1Shiptracks);
3255 set(handles.Plot1Shiptracks,<span class="string">'DataAspectRatio'</span>,[1 1 1],<span class="string">'PlotBoxAspectRatio'</span>,[1 1 1])
3256 xlabel(<span class="string">'UTM Easting (m)'</span>)
3257 ylabel(<span class="string">'UTM Northing (m)'</span>)
3258 box on
3259 grid on
3260 <span class="comment">% ticks_format('%6.0f','%8.0f'); %formats the ticks for UTM</span>
3261 
3262 <span class="comment">%%%%%%%%%%%%</span>
3263 <span class="comment">% MENU BAR %</span>
3264 <span class="comment">%%%%%%%%%%%%</span>
3265 <span class="keyword">if</span> guiparams.english_units
3266     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3267     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
3268 <span class="keyword">else</span>
3269     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3270     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
3271 <span class="keyword">end</span>
3272 
3273 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
3274     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
3275     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3276 <span class="keyword">else</span>
3277     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
3278     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3279 <span class="keyword">end</span>
3280 
3281 
3282 <span class="keyword">if</span> guiparams.print
3283     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3284     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
3285     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3286     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3287 <span class="keyword">elseif</span> guiparams.presentation
3288     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3289     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
3290     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3291     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3292 <span class="keyword">else</span>
3293 <span class="keyword">end</span>
3294 
3295 
3296 <span class="comment">%%%%%%%%%%%%%%%</span>
3297 <span class="comment">% DATA EXPORT %</span>
3298 <span class="comment">%%%%%%%%%%%%%%%</span>
3299 <span class="comment">% BathymetryPanel</span>
3300 <span class="comment">% set(handles.BeamAngle,                  'String',guiparams.beam_angle)</span>
3301 <span class="comment">% set(handles.MagneticVariation,          'String',guiparams.magnetic_variation)</span>
3302 <span class="comment">% set(handles.WSE,                        'String',guiparams.wse)</span>
3303 <span class="comment">% set(handles.OutputAuxiliaryData,        'Value', guiparams.output_auxiliary_data)</span>
3304 
3305 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
3306 <span class="comment">% PLOTTING/PLAN VIEW %</span>
3307 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
3308 <span class="comment">% PlanViewPanel</span>
3309 set(handles.DepthRangeMin,              <span class="string">'String'</span>,guiparams.depth_range_min)
3310 set(handles.DepthRangeMax,              <span class="string">'String'</span>,guiparams.depth_range_max)
3311 set(handles.VectorScalePlanView,        <span class="string">'String'</span>,guiparams.vector_scale_plan_view)
3312 set(handles.VectorSpacingPlanview,      <span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
3313 set(handles.SmoothingWindowSize,        <span class="string">'String'</span>,guiparams.smoothing_window_size)
3314 set(handles.DisplayShoreline,           <span class="string">'Value'</span>, guiparams.display_shoreline)
3315 set(handles.AddBackground,              <span class="string">'Value'</span>, guiparams.add_background)
3316 
3317 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
3318 <span class="comment">% PLOTTING/SHIP TRACKS %</span>
3319 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
3320 <span class="comment">% ShiptracksPanel</span>
3321 set(handles.HorizontalGridNodeSpacing,  <span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
3322 <span class="comment">%set(handles.SetCrossSectionEndpoints,   'Value', guiparams.set_cross_section_endpoints)</span>
3323 
3324 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3325 <span class="comment">% PLOTTING/CROSS SECTIONS %</span>
3326 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3327 <span class="comment">% CrossSectionsPanel</span>
3328 set(handles.Contour,                    <span class="string">'String'</span>,{guiparams.contours.string}, <span class="keyword">...</span>
3329     <span class="string">'Value'</span>, guiparams.idx_contour)
3330 set(handles.VerticalExaggeration,       <span class="string">'String'</span>,guiparams.vertical_exaggeration)
3331 set(handles.VectorScaleCrossSection,    <span class="string">'String'</span>,guiparams.vector_scale_cross_section)
3332 set(handles.HorizontalVectorSpacing,    <span class="string">'String'</span>,guiparams.horizontal_vector_spacing)
3333 set(handles.VerticalVectorSpacing,      <span class="string">'String'</span>,guiparams.vertical_vector_spacing)
3334 set(handles.HorizontalSmoothingWindow,  <span class="string">'String'</span>,guiparams.horizontal_smoothing_window)
3335 set(handles.VerticalSmoothingWindow,    <span class="string">'String'</span>,guiparams.vertical_smoothing_window)
3336 set(handles.PlotSecondaryFlowVectors,   <span class="string">'Value'</span>, guiparams.plot_secondary_flow_vectors)
3337 set(handles.SecondaryFlowVectorVariable,<span class="string">'String'</span>,{guiparams.secondary_flows.string}, <span class="keyword">...</span>
3338     <span class="string">'Value'</span>, guiparams.idx_secondary_flow_vector_variable)
3339 set(handles.IncludeVerticalVelocity,    <span class="string">'Value'</span>, guiparams.include_vertical_velocity)
3340 
3341 <span class="comment">% set(handles.EnglishUnits,               'Value',guiparams.english_units)</span>
3342 
3343 <span class="comment">% [EOF] initGUI</span>
3344 
3345 
3346 <span class="comment">% --------------------------------------------------------------------</span>
3347 <a name="_sub89" href="#_subfunctions" class="code">function set_enable(handles,enable_state)</a>
3348 
3349 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3350 
3351 <span class="keyword">switch</span> enable_state
3352     <span class="keyword">case</span> <span class="string">'init'</span>
3353         set([handles.menuFile
3354             handles.menuOpen
3355             handles.menuOpenASCII
3356             handles.menuOpenMAT
3357             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3358         
3359         set([handles.toolbarLoadData
3360             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3361         set([handles.toolbarSaveMatFile
3362             handles.toolbarSaveBathymetry
3363             handles.toolbarSaveFigures
3364             handles.toolbarSaveExcel
3365             handles.toolbarPlottingParameters
3366             handles.toolbarProcessingParameters
3367             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3368         
3369         set([handles.DepthRangeMin
3370             handles.DepthRangeMax
3371             handles.VectorScalePlanView
3372             handles.VectorSpacingPlanview
3373             handles.SmoothingWindowSize
3374             handles.DisplayShoreline
3375             handles.AddBackground
3376             handles.PlotPlanView
3377             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3378         
3379         set([handles.HorizontalGridNodeSpacing
3380             handles.PlotShiptracks
3381             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3382         
3383         set([handles.Contour
3384             handles.VerticalExaggeration
3385             handles.VectorScaleCrossSection
3386             handles.HorizontalVectorSpacing
3387             handles.VerticalVectorSpacing
3388             handles.HorizontalSmoothingWindow
3389             handles.VerticalSmoothingWindow
3390             handles.PlotSecondaryFlowVectors
3391             handles.SecondaryFlowVectorVariable
3392             handles.IncludeVerticalVelocity
3393             handles.PlotCrossSection
3394             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3395         
3396     <span class="keyword">case</span> <span class="string">'fileloaded'</span>
3397         set([handles.menuFile
3398             handles.menuOpen
3399             handles.menuOpenASCII
3400             handles.menuOpenMAT
3401             handles.menuSaveMAT
3402             handles.menuSaveTecplot
3403             handles.menuSaveKMZFile
3404             handles.menuParameters
3405             handles.menuPlottingParameters
3406             handles.menuMetric
3407             handles.menuEnglish
3408             handles.menuBathymetryExportSettings
3409             handles.menuExportMultibeamBathymetry
3410             handles.menuKMZExport
3411             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3412         
3413         set([handles.toolbarLoadData
3414             handles.toolbarSaveMatFile
3415             handles.toolbarSaveBathymetry
3416             handles.toolbarSaveExcel
3417             handles.toolbarSaveFigures
3418             handles.toolbarPlottingParameters
3419             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3420         set([handles.toolbarProcessingParameters
3421             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3422         
3423            
3424         set([handles.DepthRangeMin
3425             handles.DepthRangeMax
3426             handles.VectorScalePlanView
3427             handles.VectorSpacingPlanview
3428             handles.SmoothingWindowSize
3429             handles.DisplayShoreline
3430             handles.PlotPlanView
3431             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3432         <span class="keyword">if</span> guiparams.has_mapping_toolbox
3433             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3434         <span class="keyword">else</span>
3435             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3436         <span class="keyword">end</span>
3437         
3438         set([handles.HorizontalGridNodeSpacing
3439             handles.PlotShiptracks
3440             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3441         
3442         set([handles.Contour
3443             handles.VerticalExaggeration
3444             handles.VectorScaleCrossSection
3445             handles.HorizontalVectorSpacing
3446             handles.VerticalVectorSpacing
3447             handles.HorizontalSmoothingWindow
3448             handles.VerticalSmoothingWindow
3449             handles.PlotSecondaryFlowVectors
3450             handles.SecondaryFlowVectorVariable
3451             handles.IncludeVerticalVelocity
3452             handles.PlotCrossSection
3453             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3454     <span class="keyword">case</span> <span class="string">'multiplematfiles'</span>
3455         set([handles.menuFile
3456             handles.menuOpen
3457             handles.menuOpenASCII
3458             handles.menuOpenMAT
3459             handles.menuParameters
3460             handles.menuPlottingParameters
3461             handles.menuMetric
3462             handles.menuEnglish
3463             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3464         set([handles.menuSaveMAT
3465             handles.menuBathymetryExportSettings
3466             handles.menuExportMultibeamBathymetry
3467             handles.menuKMZExport
3468             handles.menuSaveKMZFile
3469             handles.menuSaveTecplot
3470             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3471         
3472         set([handles.toolbarLoadData
3473             handles.toolbarSaveFigures
3474             handles.toolbarPlottingParameters
3475             handles.toolbarSaveExcel
3476             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3477         set([handles.toolbarProcessingParameters
3478             handles.toolbarSaveMatFile
3479             handles.toolbarSaveBathymetry
3480             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3481         
3482         set([handles.DepthRangeMin
3483             handles.DepthRangeMax
3484             handles.VectorScalePlanView
3485             handles.VectorSpacingPlanview
3486             handles.SmoothingWindowSize
3487             handles.DisplayShoreline
3488             handles.PlotPlanView
3489             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3490         <span class="keyword">if</span> guiparams.has_mapping_toolbox
3491             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3492         <span class="keyword">else</span>
3493             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3494         <span class="keyword">end</span>
3495         
3496         set([handles.HorizontalGridNodeSpacing
3497             handles.PlotShiptracks
3498             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3499         
3500         set([handles.Contour
3501             handles.VerticalExaggeration
3502             handles.VectorScaleCrossSection
3503             handles.HorizontalVectorSpacing
3504             handles.VerticalVectorSpacing
3505             handles.HorizontalSmoothingWindow
3506             handles.VerticalSmoothingWindow
3507             handles.PlotSecondaryFlowVectors
3508             handles.SecondaryFlowVectorVariable
3509             handles.IncludeVerticalVelocity
3510             handles.PlotCrossSection
3511             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3512     <span class="keyword">otherwise</span>
3513 <span class="keyword">end</span>
3514 
3515 <span class="comment">% [EOF] set_enable</span>
3516 
3517 <span class="comment">%% Compute the longitudinal dispersion coefficient</span>
3518 
3519 <span class="comment">%% --- Executes on button press in zerosecq_chkbox.</span>
3520 <span class="comment">%function zerosecq_chkbox_Callback(hObject, eventdata, handles)</span>
3521 <span class="comment">% hObject    handle to zerosecq_chkbox (see GCBO)</span>
3522 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
3523 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
3524 
3525 <span class="comment">% Hint: get(hObject,'Value') returns toggle state of zerosecq_chkbox</span>
3526 
3527 
3528 <span class="comment">% --------------------------------------------------------------------</span>
3529 <a name="_sub90" href="#_subfunctions" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] = </a><span class="keyword">...</span>
3530     plotParametersDialog(english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style,hf)
3531 
3532 w = 500;
3533 h = 110;
3534 dx = 10;
3535 dy = 35;
3536 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
3537 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
3538     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
3539     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
3540     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
3541     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
3542     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
3543     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
3544     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3545     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
3546     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
3547     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
3548 dialog_params.english_units               = english_units;
3549 dialog_params.set_cross_section_endpoints = set_cross_section_endpoints;
3550 dialog_params.presentation                = plot_presentation_style; <span class="comment">%presentation;</span>
3551 dialog_params.print                       = plot_print_style; <span class="comment">%print;</span>
3552 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3553 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
3554 
3555 <span class="comment">% Build the graphics:</span>
3556 <span class="comment">% -------------------</span>
3557 handles.UnitsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
3558     <span class="string">'Title'</span>, <span class="string">'Units'</span>, <span class="keyword">...</span>
3559     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3560     <span class="string">'Position'</span>,[dx dy (w-3*dx)/3 h-dx-dy+10]);
3561 handles.UnitsMetric = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3562     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
3563     <span class="string">'String'</span>,<span class="string">'Metric'</span>, <span class="keyword">...</span>
3564     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3565     <span class="string">'Position'</span>,[15 35 100 22]);
3566 handles.UnitsEnglish = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3567     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
3568     <span class="string">'String'</span>,<span class="string">'English'</span>, <span class="keyword">...</span>
3569     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3570     <span class="string">'Position'</span>,[15 10 100 22]);
3571 
3572 handles.EndpointsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
3573     <span class="string">'Title'</span>, <span class="string">'Cross-Section Endpoints'</span>, <span class="keyword">...</span>
3574     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3575     <span class="string">'Position'</span>,[(w+dx)/3 dy (w-3*dx)/3 h-dx-dy+10]);
3576 handles.EndpointsAutomatic = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3577     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
3578     <span class="string">'String'</span>,<span class="string">'Automatic'</span>, <span class="keyword">...</span>
3579     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3580     <span class="string">'Position'</span>,[15 35 100 22]);
3581 handles.EndpointsManual = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3582     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
3583     <span class="string">'String'</span>,<span class="string">'Set Manually'</span>, <span class="keyword">...</span>
3584     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3585     <span class="string">'Position'</span>,[15 10 100 22]);
3586 
3587 handles.StylePanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
3588     <span class="string">'Title'</span>, <span class="string">'Plot Style'</span>, <span class="keyword">...</span>
3589     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3590     <span class="string">'Position'</span>,[w-w/3 dy (w-3*dx)/3 h-dx-dy+10]);
3591 handles.StylePresentation = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3592     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
3593     <span class="string">'String'</span>,<span class="string">'Presentation'</span>, <span class="keyword">...</span>
3594     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3595     <span class="string">'Position'</span>,[15 35 100 22]);
3596 handles.StylePrint = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3597     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
3598     <span class="string">'String'</span>,<span class="string">'Print'</span>, <span class="keyword">...</span>
3599     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3600     <span class="string">'Position'</span>,[15 10 100 22]);
3601 
3602 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
3603     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
3604     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
3605     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
3606     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
3607 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
3608     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
3609     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
3610     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
3611     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
3612 
3613 <span class="comment">% Update the UI controls:</span>
3614 <span class="comment">% -----------------------</span>
3615 <span class="keyword">if</span> dialog_params.english_units
3616     set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
3617     set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
3618 <span class="keyword">else</span>
3619     set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
3620     set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
3621 <span class="keyword">end</span>
3622 <span class="keyword">if</span> dialog_params.set_cross_section_endpoints
3623     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
3624     set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
3625 <span class="keyword">else</span>
3626     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
3627     set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
3628 <span class="keyword">end</span>
3629 <span class="keyword">if</span> dialog_params.presentation
3630     set(handles.StylePresentation, <span class="string">'Value'</span>,1)
3631     set(handles.StylePrint,        <span class="string">'Value'</span>,0)
3632 <span class="keyword">else</span>
3633     set(handles.StylePresentation, <span class="string">'Value'</span>,0)
3634     set(handles.StylePrint,        <span class="string">'Value'</span>,1)
3635 <span class="keyword">end</span>
3636 
3637 <span class="comment">% Set the callbacks:</span>
3638 <span class="comment">% ------------------</span>
3639 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub96" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>, handles.OK})
3640 set(handles.UnitsMetric,       <span class="string">'Callback'</span>,       {@<a href="#_sub91" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'metric'</span>})
3641 set(handles.UnitsEnglish,      <span class="string">'Callback'</span>,       {@<a href="#_sub91" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'english'</span>})
3642 set(handles.EndpointsAutomatic,<span class="string">'Callback'</span>,       {@<a href="#_sub92" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'auto'</span>})
3643 set(handles.EndpointsManual,   <span class="string">'Callback'</span>,       {@<a href="#_sub92" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'manual'</span>})
3644 set(handles.StylePresentation, <span class="string">'Callback'</span>,       {@<a href="#_sub93" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'presentation'</span>})
3645 set(handles.StylePrint,        <span class="string">'Callback'</span>,       {@<a href="#_sub93" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'print'</span>})
3646 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub94" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
3647 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub95" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
3648 
3649 <span class="comment">% Position the dialog and make it visible:</span>
3650 <span class="comment">% ----------------------------------------</span>
3651 fpos = get(hf,<span class="string">'Position'</span>);
3652 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
3653 movegui(handles.Figure,dpos)
3654 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
3655 
3656 <span class="comment">% Hold the dialog open:</span>
3657 <span class="comment">% ---------------------</span>
3658 waitfor(handles.OK)
3659 
3660 <span class="comment">% Return the outputs and close the dialog:</span>
3661 <span class="comment">% ----------------------------------------</span>
3662 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3663 english_units = dialog_params.english_units;
3664 set_cross_section_endpoints = dialog_params.set_cross_section_endpoints;
3665 plot_presentation_style =  dialog_params.presentation;
3666 plot_print_style =  dialog_params.print;
3667 
3668 delete(handles.Figure)
3669 
3670 <span class="comment">% [EOF] plotParametersDialog</span>
3671 
3672 
3673 <span class="comment">% --------------------------------------------------------------------</span>
3674 <a name="_sub91" href="#_subfunctions" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a>
3675 
3676 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3677 <span class="keyword">switch</span> the_units
3678     <span class="keyword">case</span> <span class="string">'metric'</span>
3679         dialog_params.english_units = false;
3680         
3681         set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
3682         set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
3683     <span class="keyword">case</span> <span class="string">'english'</span>
3684         dialog_params.english_units = true;
3685         
3686         set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
3687         set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
3688     <span class="keyword">otherwise</span>
3689 <span class="keyword">end</span>
3690 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3691 
3692 <span class="comment">% [EOF] dialogUnits</span>
3693 
3694 <span class="comment">% --------------------------------------------------------------------</span>
3695 <a name="_sub92" href="#_subfunctions" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a>
3696 
3697 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3698 <span class="keyword">switch</span> the_endpoints
3699     <span class="keyword">case</span> <span class="string">'auto'</span>
3700         dialog_params.set_cross_section_endpoints = false;
3701         
3702         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
3703         set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
3704     <span class="keyword">case</span> <span class="string">'manual'</span>
3705         dialog_params.set_cross_section_endpoints = true;
3706         
3707         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
3708         set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
3709     <span class="keyword">otherwise</span>
3710 <span class="keyword">end</span>
3711 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3712 
3713 <span class="comment">% [EOF] dialogEnpoints</span>
3714 
3715 <a name="_sub93" href="#_subfunctions" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a>
3716 
3717 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3718 <span class="keyword">switch</span> the_style
3719     <span class="keyword">case</span> <span class="string">'presentation'</span>
3720         dialog_params.presentation  = true;
3721         dialog_params.print         = false;
3722         
3723         set(handles.StylePresentation,<span class="string">'Value'</span>,1)
3724         set(handles.StylePrint,       <span class="string">'Value'</span>,0)
3725     <span class="keyword">case</span> <span class="string">'print'</span>
3726         dialog_params.presentation  = false;
3727         dialog_params.print         = true;
3728         
3729         set(handles.StylePresentation,<span class="string">'Value'</span>,0)
3730         set(handles.StylePrint,       <span class="string">'Value'</span>,1)
3731     <span class="keyword">otherwise</span>
3732 <span class="keyword">end</span>
3733 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3734 
3735 <span class="comment">% [EOF] dialogEnpoints</span>
3736 
3737 <span class="comment">% --------------------------------------------------------------------</span>
3738 <a name="_sub94" href="#_subfunctions" class="code">function dialogOK(hObject,eventdata,h_OK)</a>
3739 
3740 delete(h_OK)
3741 
3742 <span class="comment">% [EOF] dialogOK</span>
3743 
3744 <span class="comment">% --------------------------------------------------------------------</span>
3745 <a name="_sub95" href="#_subfunctions" class="code">function dialogCancel(hObject,eventdata,handles)</a>
3746 <span class="comment">% Return the original inputs</span>
3747 dialog_params = getappdata(handles.Figure,<span class="string">'original_dialog_params'</span>);
3748 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3749 delete(handles.OK)
3750 
3751 <span class="comment">% [EOF] dialogCancel</span>
3752 
3753 <span class="comment">% --------------------------------------------------------------------</span>
3754 <a name="_sub96" href="#_subfunctions" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a>
3755 
3756 delete(h_OK)
3757 
3758 <span class="comment">% [EOF] dialogCloseReq</span>
3759 
3760 <a name="_sub97" href="#_subfunctions" class="code">function [beam_angle,magnetic_variation,wse,output_auxiliary_data] = exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,hf)</a>
3761 w = 230;
3762 h = 200;
3763 dx = 10;
3764 dy = 35;
3765 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
3766 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Export Settings'</span>, <span class="keyword">...</span>
3767     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
3768     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
3769     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
3770     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
3771     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
3772     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
3773     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3774     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
3775     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
3776     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
3777 dialog_params.beam_angle             = beam_angle;
3778 dialog_params.magnetic_variation     = magnetic_variation;
3779 dialog_params.wse                    = wse;
3780 dialog_params.output_auxiliary_data = output_auxiliary_data;
3781 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3782 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
3783 
3784 <span class="comment">% Build the graphics:</span>
3785 <span class="comment">% -------------------</span>
3786 ph = 150;
3787 handles.BathymetryPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
3788     <span class="string">'Title'</span>, <span class="string">'Bathymetry'</span>, <span class="keyword">...</span>
3789     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3790     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
3791 handles.BeamAngleText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
3792     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
3793     <span class="string">'String'</span>,<span class="string">'Beam Angle (deg)'</span>, <span class="keyword">...</span>
3794     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
3795     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
3796     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3797     <span class="string">'Position'</span>,[dx+5 h-ph+60-4 100 22]);
3798 handles.BeamAngle = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
3799     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
3800     <span class="keyword">...</span><span class="comment">'String','Beam Angle (deg)', ...</span>
3801     <span class="string">'String'</span>,beam_angle,<span class="keyword">...</span>
3802     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
3803     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3804     <span class="string">'Position'</span>,[w-dx-80 h-ph+60 50 22]);
3805 handles.MagneticVariationText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
3806     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
3807     <span class="string">'String'</span>,<span class="string">'Magnetic Variation'</span>, <span class="keyword">...</span>
3808     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
3809     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
3810     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3811     <span class="string">'Position'</span>,[dx+5 h-ph+30-4 100 22]);
3812 handles.MagneticVariation = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
3813     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
3814     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
3815     <span class="string">'String'</span>,magnetic_variation,<span class="keyword">...</span>
3816     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
3817     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3818     <span class="string">'Position'</span>,[w-dx-80 h-ph+30 50 22]);
3819 handles.WSEText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
3820     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
3821     <span class="string">'String'</span>,<span class="string">'WSE (m)'</span>, <span class="keyword">...</span>
3822     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
3823     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
3824     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3825     <span class="string">'Position'</span>,[dx+5 h-ph-4 100 22]);
3826 handles.WSE = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
3827     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
3828     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
3829     <span class="string">'String'</span>,wse,<span class="keyword">...</span>
3830     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
3831     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3832     <span class="string">'Position'</span>,[w-dx-80 h-ph 50 22]);
3833 handles.OutputauxiliaryData = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3834     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
3835     <span class="string">'String'</span>,<span class="string">'Output auxiliary Data'</span>, <span class="keyword">...</span>
3836     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3837     <span class="string">'Position'</span>,[dx+5 20 w-2*dx-30 22]);
3838 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
3839     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
3840     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
3841     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
3842     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
3843 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
3844     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
3845     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
3846     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
3847     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
3848 
3849 <span class="comment">% Update the UI controls:</span>
3850 <span class="comment">% -----------------------</span>
3851 set(handles.BeamAngle,                <span class="string">'String'</span>,dialog_params.beam_angle)
3852 set(handles.MagneticVariation,        <span class="string">'String'</span>,dialog_params.magnetic_variation)
3853 set(handles.WSE,                      <span class="string">'String'</span>,dialog_params.wse)
3854 set(handles.OutputauxiliaryData,     <span class="string">'Value'</span>, double(dialog_params.output_auxiliary_data))
3855 
3856 <span class="comment">% Set the callbacks:</span>
3857 <span class="comment">% ------------------</span>
3858 set(handles.Figure,                      <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub96" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
3859 set(handles.BeamAngle,                   <span class="string">'Callback'</span>,       {@<a href="#_sub98" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
3860 set(handles.MagneticVariation,           <span class="string">'Callback'</span>,       {@<a href="#_sub98" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
3861 set(handles.WSE,                         <span class="string">'Callback'</span>,       {@<a href="#_sub98" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
3862 set(handles.OutputauxiliaryData,        <span class="string">'Callback'</span>,       {@<a href="#_sub98" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
3863 set(handles.OK,                          <span class="string">'Callback'</span>,       {@<a href="#_sub94" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,      handles.OK})
3864 set(handles.Cancel,                      <span class="string">'Callback'</span>,       {@<a href="#_sub95" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,  handles})
3865 
3866 <span class="comment">% Position the dialog and make it visible:</span>
3867 <span class="comment">% ----------------------------------------</span>
3868 fpos = get(hf,<span class="string">'Position'</span>);
3869 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
3870 movegui(handles.Figure,dpos)
3871 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
3872 
3873 <span class="comment">% Hold the dialog open:</span>
3874 <span class="comment">% ---------------------</span>
3875 waitfor(handles.OK)
3876 
3877 <span class="comment">% Return the outputs and close the dialog:</span>
3878 <span class="comment">% ----------------------------------------</span>
3879 dialog_params           = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3880 beam_angle              = dialog_params.beam_angle;
3881 magnetic_variation      = dialog_params.magnetic_variation;
3882 wse                     = dialog_params.wse;
3883 output_auxiliary_data  = logical(dialog_params.output_auxiliary_data);
3884 
3885 delete(handles.Figure)
3886 
3887 <span class="comment">% [EOF] exportSettingsDialog</span>
3888 
3889 <span class="comment">% --------------------------------------------------------------------</span>
3890 <a name="_sub98" href="#_subfunctions" class="code">function dialogExportSettings(hObject,eventdata,handles)</a>
3891 
3892 <span class="comment">% Grab the current data</span>
3893 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3894 
3895 <span class="comment">% Set it according to the dialog box values</span>
3896 dialog_params.beam_angle                = get(handles.BeamAngle,<span class="string">'String'</span>);
3897 dialog_params.magnetic_variation        = get(handles.MagneticVariation,<span class="string">'String'</span>);
3898 dialog_params.wse                       = get(handles.WSE,<span class="string">'String'</span>);
3899 dialog_params.output_auxiliary_data    = get(handles.OutputauxiliaryData,<span class="string">'Value'</span>);
3900 
3901 <span class="comment">% Re-store the application data</span>
3902 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3903 
3904 <span class="comment">% [EOF] dialogExportSettings</span>
3905 
3906 <a name="_sub99" href="#_subfunctions" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a>
3907 
3908 w = 230;
3909 h = 200;
3910 dx = 10;
3911 dy = 35;
3912 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
3913 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Select open figures to export'</span>, <span class="keyword">...</span>
3914     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
3915     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
3916     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
3917     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
3918     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
3919     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
3920     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3921     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
3922     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
3923     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
3924 dialog_params.figure_names               = figure_names;
3925 dialog_params.selected_figures           = <span class="string">''</span>;
3926 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3927 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
3928 
3929 <span class="comment">% Build the graphics:</span>
3930 <span class="comment">% -------------------</span>
3931 handles.ListboxPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
3932     <span class="string">'Title'</span>, <span class="string">'Figures'</span>, <span class="keyword">...</span>
3933     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3934     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
3935 handles.Figures = uicontrol(<span class="string">'Style'</span>,<span class="string">'listbox'</span>, <span class="keyword">...</span>
3936     <span class="string">'Parent'</span>,handles.ListboxPanel, <span class="keyword">...</span>
3937     <span class="string">'BackGroundColor'</span>,<span class="string">'white'</span>,<span class="keyword">...</span>
3938     <span class="string">'String'</span>,figure_names, <span class="keyword">...</span>
3939     <span class="string">'Min'</span>, 0,<span class="keyword">...</span>
3940     <span class="string">'Max'</span>, 2,<span class="keyword">...</span>
3941     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3942     <span class="string">'Position'</span>,[15 35 (w-5*dx) 100]);
3943 
3944 
3945 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
3946     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
3947     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
3948     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
3949     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
3950 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
3951     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
3952     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
3953     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
3954     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
3955 
3956 <span class="comment">% Update the UI controls:</span>
3957 <span class="comment">% -----------------------</span>
3958 
3959 
3960 <span class="comment">% Set the callbacks:</span>
3961 <span class="comment">% ------------------</span>
3962 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub96" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
3963 set(handles.Figures,           <span class="string">'Callback'</span>,       {@<a href="#_sub100" class="code" title="subfunction dialogSelectFigures(hObject,eventdata,handles)">dialogSelectFigures</a>    handles})
3964 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub94" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
3965 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub95" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
3966 
3967 <span class="comment">% Position the dialog and make it visible:</span>
3968 <span class="comment">% ----------------------------------------</span>
3969 fpos = get(hf,<span class="string">'Position'</span>);
3970 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
3971 movegui(handles.Figure,dpos)
3972 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
3973 
3974 <span class="comment">% Hold the dialog open:</span>
3975 <span class="comment">% ---------------------</span>
3976 waitfor(handles.OK)
3977 
3978 <span class="comment">% Return the outputs and close the dialog:</span>
3979 <span class="comment">% ----------------------------------------</span>
3980 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3981 selected_figures = dialog_params.selected_figures;
3982 
3983 delete(handles.Figure)
3984 
3985 <span class="comment">% [EOF] openFiguresDialog</span>
3986 
3987 <span class="comment">% --------------------------------------------------------------------</span>
3988 <a name="_sub100" href="#_subfunctions" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a>
3989 
3990 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3991 
3992 idx_selected = get(handles.Figures,<span class="string">'Value'</span>);
3993 fig_names    = get(handles.Figures,<span class="string">'String'</span>);
3994 selected     = fig_names(idx_selected);
3995 dialog_params.selected_figures = selected;
3996 
3997 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3998 
3999 
4000 
4001 <span class="comment">% --------------------------------------------------------------------</span>
4002 <a name="_sub101" href="#_subfunctions" class="code">function icons = getIcons</a>
4003 
4004 <span class="comment">% Load data</span>
4005 idx = 1;
4006 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4007     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
4008     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   129   120   135   188   NaN   NaN   NaN
4009     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN    96   189   NaN   NaN   130   NaN    95   NaN
4010     NaN   NaN   206   206   206   206   NaN   NaN   NaN   NaN   NaN   NaN   NaN    84    79   NaN
4011     NaN   206   255   255   255   255   198   197   NaN   NaN   NaN   NaN    83    79    76   NaN
4012     198   255   255   255   255   255   255   198   198   198   198   198   198   212   212   NaN
4013     198   255   255   255   255   255   255   255   255   255   255   255   198   157   197   NaN
4014     198   255   226   198   198   198   198   198   198   198   198   198   198   198   177   NaN
4015     198   255   198   218   255   255   255   255   255   255   255   255   255   255   161   NaN
4016     198   253   198   247   255   255   255   255   255   255   255   255   255   251   155   NaN
4017     198   226   201   255   255   255   255   255   255   255   255   255   231   206   165   NaN
4018     198   207   215   255   255   255   255   255   255   255   255   255   239   198   159   NaN
4019     198   198   240   255   255   255   255   255   255   255   255   255   222   157   159   NaN
4020     198   199   255   255   255   255   255   255   255   255   255   255   191   165   159   NaN
4021     NaN   165   165   165   165   165   165   165   165   165   165   165   165   159   159   NaN
4022     NaN   NaN   159   159   159   159   159   159   159   159   159   159   159   159   NaN   NaN]/255;
4023 
4024 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4025     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
4026     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   145   137   149   195   NaN   NaN   NaN
4027     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   116   196   NaN   NaN   145   NaN   116   NaN
4028     NaN   NaN   162   162   162   162   NaN   NaN   NaN   NaN   NaN   NaN   NaN   107   105   NaN
4029     NaN   162   255   255   255   255   154   197   NaN   NaN   NaN   NaN   106   104   103   NaN
4030     154   255   255   255   255   255   255   154   154   154   154   154   154   208   208   NaN
4031     154   243   243   243   243   243   243   255   255   255   255   255   154   123   197   NaN
4032     154   235   193   154   154   154   154   154   154   154   154   154   154   154   137   NaN
4033     154   215   154   191   255   255   251   255   255   255   255   255   231   255   126   NaN
4034     154   213   154   240   255   255   255   255   255   255   255   255   199   249   123   NaN
4035     154   179   160   255   247   247   247   247   247   247   247   247   190   188   115   NaN
4036     154   162   184   255   235   235   235   235   235   235   235   231   186   154   169   NaN
4037     154   154   228   255   227   227   227   227   227   227   227   223   178   123   169   NaN
4038     154   156   255   215   215   215   215   215   215   215   215   215   153   115   169   NaN
4039     NaN   115   115   115   115   115   115   115   115   115   115   115   115   169   169   NaN
4040     NaN   NaN   169   169   169   169   169   169   169   169   169   169   169   169   NaN   NaN]/255;
4041 
4042 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4043     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
4044     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   166   161   170   202   NaN   NaN   NaN
4045     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   149   205   NaN   NaN   166   NaN   148   NaN
4046     NaN   NaN    34    34    34    34   NaN   NaN   NaN   NaN   NaN   NaN   NaN   141   144   NaN
4047     NaN    34   255   255   255   255    25   197   NaN   NaN   NaN   NaN   142   145   147   NaN
4048     25   255   156   156   156   156   255    25    25    25    25    25    25   200   200   NaN
4049     25   156   140   140   140   140   140   255   255   255   255   255    25    26   197   NaN
4050     25   132    80    25    25    25    25    25    25    25    25    25    25    25    25   NaN
4051     25   132    25   108   255   255   247   255   255   255   255   255   132   255    25   NaN
4052     25   112    25   137   156   156   156   156   156   156   156   156    91   150    25   NaN
4053     25    67    33   165   148   148   148   148   148   148   148   148    83    92    13   NaN
4054     25    38    64   156   132   132   132   132   132   132   132   132    67    25   176   NaN
4055     25    26   122   156   124   124   124   124   124   124   124   124    67    26   176   NaN
4056     25    28   156   108   108   108   108   108   108   108   108   108    41    13   176   NaN
4057     NaN    13    13    13    13    13    13    13    13    13    13    13    13   176   176   NaN
4058     NaN   NaN   176   176   176   176   176   176   176   176   176   176   176   176   NaN   NaN]/255;
4059 
4060 <span class="comment">% Save data</span>
4061 idx = idx+1;
4062 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4063     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
4064     NaN    0.6902    0.6902    0.6902    0.6902    0.6902    0.6274    0.6274    0.5647    0.5647    0.5647    0.5019    0.5019    0.4392    0.2510       NaN
4065     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.3137    0.3765    0.2510    0.4670
4066     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.2510    0.1882    0.2510    0.4670
4067     NaN    0.6274    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.1882    0.5019    0.2510    0.4670
4068     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.1882    0.4392    0.2510    0.4670
4069     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.1255    0.3765    0.2510    0.4670
4070     NaN    0.5647    0.7529    0.3765    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.7529    0.0627    0.3765    0.2510    0.4670
4071     NaN    0.5647    0.7529    0.6902    0.3765    0.3137    0.3137    0.2510    0.1882    0.1882    0.1255    0.0627    0.3765    0.3137    0.2510    0.4670
4072     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5019    0.5019    0.5019    0.4392    0.4392    0.3765    0.3137    0.3137    0.2510    0.4670
4073     NaN    0.5019    0.6902    0.6274    0.5647    0.3137    0.3137    0.3137    0.3137    0.3137    0.3765    0.3137    0.3137    0.2510    0.2510    0.4670
4074     NaN    0.4392    0.6274    0.5647    0.5019    0.3137       NaN    0.1882    0.8157    0.8157    0.3765    0.2510    0.2510    0.2510    0.2510    0.4670
4075     NaN    0.4392    0.6274    0.5019    0.5019    0.3137    0.1882    0.4392    0.8784    0.8784    0.4392    0.1882    0.2510    0.1882    0.2510    0.4670
4076     NaN    0.4392    0.5647    0.5019    0.1255    0.1255    0.6902    0.6902    0.7529    0.7529    0.3137    0.1882    0.1882    0.1882    0.2510    0.4670
4077     NaN    0.7333    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.4670
4078     NaN       NaN    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670];
4079 
4080 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4081     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
4082     NaN    0.7216    0.7216    0.6902    0.6902    0.6588    0.6274    0.5961    0.5647    0.5647    0.5333    0.5019    0.4706    0.4706    0.2196       NaN
4083     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.3451    0.3451    0.2196    0.5378
4084     NaN    0.6902    0.7529    0.5333    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.3137    0.1882    0.2196    0.5378
4085     NaN    0.6588    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.3137    0.4706    0.2196    0.5378
4086     NaN    0.6274    0.7529    0.4706    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.2824    0.4392    0.2196    0.5378
4087     NaN    0.5961    0.7529    0.4392    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.2510    0.4078    0.2196    0.5378
4088     NaN    0.5647    0.7529    0.4078    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.7843    0.2196    0.3765    0.2196    0.5378
4089     NaN    0.5333    0.7216    0.7216    0.3765    0.3765    0.3451    0.3137    0.3137    0.2824    0.2510    0.2196    0.3765    0.3451    0.2196    0.5378
4090     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5333    0.5019    0.4706    0.4392    0.4078    0.3765    0.3451    0.3137    0.2196    0.5378
4091     NaN    0.4706    0.6588    0.6274    0.5647    0.3451    0.3451    0.3451    0.3451    0.3765    0.4078    0.3451    0.3137    0.2824    0.2196    0.5378
4092     NaN    0.4706    0.6274    0.5647    0.5333    0.3451       NaN    0.2510    0.8470    0.8784    0.4706    0.2824    0.2824    0.2510    0.2196    0.5378
4093     NaN    0.4392    0.5961    0.5333    0.5019    0.3451    0.2510    0.4706    0.8784    0.9098    0.5019    0.2510    0.2510    0.2510    0.2196    0.5378
4094     NaN    0.4078    0.5647    0.5019    0.2824    0.1882    0.7216    0.7216    0.7529    0.7843    0.3137    0.2510    0.2510    0.2196    0.2196    0.5378
4095     NaN    0.7176    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.5378
4096     NaN       NaN    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378];
4097 
4098 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4099     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
4100     NaN    0.9412    0.9412    0.9412    0.9412    0.9412    0.9412    0.8784    0.8784    0.8784    0.8784    0.8784    0.8157    0.8157    0.4392       NaN
4101     NaN    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.7529    0.6902    0.4392    0.5997
4102     NaN    0.9412    1.0000    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.7529    0.3765    0.4392    0.5997
4103     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.6902    0.8784    0.4392    0.5997
4104     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.6902    0.8157    0.4392    0.5997
4105     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.6274    0.8157    0.4392    0.5997
4106     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.8784    0.6274    0.7529    0.4392    0.5997
4107     NaN    0.8784    1.0000    1.0000    0.8157    0.7529    0.7529    0.7529    0.6902    0.6902    0.6274    0.6274    0.7529    0.7529    0.4392    0.5997
4108     NaN    0.8784    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8784    0.8157    0.8157    0.7529    0.7529    0.6902    0.4392    0.5997
4109     NaN    0.8157    1.0000    1.0000    0.9412    0.4392    0.4392    0.4392    0.4392    0.4392    0.5019    0.7529    0.6902    0.6902    0.4392    0.5997
4110     NaN    0.8157    1.0000    0.9412    0.9412    0.4392       NaN    0.2510    0.9412    0.9412    0.5019    0.6902    0.6902    0.6274    0.4392    0.5997
4111     NaN    0.8157    1.0000    0.9412    0.8784    0.4392    0.2510    0.5647    0.9412    0.9412    0.5647    0.6274    0.6274    0.6274    0.4392    0.5997
4112     NaN    0.8157    0.9412    0.8784    0.6902    0.2510    0.7529    0.7529    0.8157    0.8157    0.3137    0.6274    0.6274    0.6274    0.4392    0.5997
4113     NaN    0.8275    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.5997
4114     NaN       NaN    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997];
4115 
4116 <span class="comment">% Plotting parameters</span>
4117 idx = idx+1;
4118 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4119     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
4120     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4121     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4122     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
4123     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
4124     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
4125     0   101   239   255   224   109   255   255   255   247    79   254   254   123    36   165
4126     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
4127     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
4128     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
4129     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
4130     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
4131     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
4132     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4133     0     0     0     1     0     0     0     0     0     0     0     0     0     0     0   165
4134     255   165   165   165   172   165   165   165   165   165   165   165   165   165   165   165]/255;
4135 
4136 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4137     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
4138     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0     0
4139     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4140     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
4141     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
4142     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
4143     0   101   239   255   224   109   255   255   255   247    79   254   254   123     0   165
4144     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
4145     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
4146     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
4147     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
4148     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
4149     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
4150     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4151     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   165
4152     0   165   165   165   153   165   165   165   165   165   165   165   165   165   165   165]/255;
4153 
4154 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4155     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
4156     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4157     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4158     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4159     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4160     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4161     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4162     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4163     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4164     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4165     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4166     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4167     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4168     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4169     0    24    39     0     0     0     0     0     0     0     0     0     0     0     0   145
4170     255   145   145   145   134   145   145   145   145   145   145   145   145   145   145   145]/255;
4171 
4172 <span class="comment">% Processing parameters</span>
4173 idx = idx+1;
4174 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4175     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
4176     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
4177     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4178     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4179     255     0   255   255   107   255   255   107   255   255   107   255   107   255     0   255
4180     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4181     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4182     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4183     255     0   255   255   107   255   107   255   107   255   255   107   255   255     0   255
4184     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4185     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4186     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4187     255     0   255   107   255   107   255   107   255   255   107   255   107   255     0   255
4188     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4189     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4190     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
4191 
4192 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4193     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
4194     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
4195     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4196     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4197     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
4198     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4199     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4200     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4201     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
4202     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4203     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4204     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4205     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
4206     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4207     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4208     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
4209 
4210 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4211     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
4212     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
4213     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4214     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4215     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
4216     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4217     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4218     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4219     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
4220     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4221     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4222     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4223     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
4224     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4225     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4226     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
4227 
4228 <span class="comment">% Export bathymetry dialog</span>
4229 idx = idx+1;
4230 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4231     [226    226    226    226    226    226    226    197    220    226    226    226    226    226    226    226
4232     226    226    226    226    226    227    241    144    158    241    228    228    229    228    229    226
4233     226    243    243    243    237    237    246    164    119    242    232    225    226    218    243    206
4234     179    152    153    166    148    148    177    179    63    185    141    146    154    151    179    189
4235     167    4    134    175    151    164    161    198    122    255    212    233    215    199    140    185
4236     134    50    209    241    255    255    133    118    15    20    28    94    4    0    0    89
4237     136    0    0    0    0    0    0    0    0    0    0    0    0    21    56    140
4238     208    255    226    233    255    242    215    232    251    237    226    233    207    222    156    139
4239     172    159    152    153    166    145    178    147    169    164    161    163    154    153    128    135
4240     160    164    148    139    171    150    165    154    165    185    166    173    190    190    148    162
4241     214    233    211    203    217    212    217    238    202    236    213    222    230    224    184    184
4242     219    206    174    190    219    204    201    218    183    224    219    222    217    202    176    182
4243     210    182    183    214    225    220    203    229    175    217    220    220    222    212    184    185
4244     197    175    207    224    223    220    205    231    170    221    220    220    222    217    191    187
4245     186    193    223    224    220    201    203    228    171    224    218    220    222    215    190    187
4246     189    211    220    216    204    201    214    213    187    213    216    220    220    212    193    189
4247     ]/255;
4248 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4249     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
4250     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
4251     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
4252     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
4253     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
4254     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
4255     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
4256     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
4257     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
4258     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
4259     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
4260     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
4261     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
4262     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
4263     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
4264     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
4265     ]/255;
4266 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4267     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
4268     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
4269     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
4270     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
4271     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
4272     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
4273     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
4274     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
4275     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
4276     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
4277     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
4278     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
4279     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
4280     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
4281     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
4282     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
4283     ]/255;
4284 
4285 <span class="comment">% Export Figures Dialog</span>
4286 idx = idx + 1;
4287 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4288     [NaN    NaN    10    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
4289     NaN    NaN    67    255    255    255    255    255    255    255    201    141    NaN    NaN    NaN    NaN
4290     NaN    NaN    43    255    241    240    241    246    252    255    186    220    151    NaN    NaN    NaN
4291     NaN    NaN    42    255    238    237    237    236    238    254    210    178    214    38    NaN    NaN
4292     NaN    NaN    43    255    241    241    241    241    240    244    252    255    255    79    NaN    NaN
4293     NaN    NaN    47    255    232    232    225    224    224    223    220    238    255    69    NaN    NaN
4294     NaN    NaN    55    233    114    225    230    223    221    221    215    237    255    67    NaN    NaN
4295     4    NaN    37    181    168    126    193    214    205    200    203    242    255    67    NaN    NaN
4296     41    164    134    153    144    139    131    209    238    223    242    240    255    67    NaN    NaN
4297     41    118    91    91    122    125    120    106    170    241    245    241    255    67    NaN    NaN
4298     41    113    91    89    97    108    99    89    117    205    190    230    255    67    NaN    NaN
4299     41    124    94    88    78    74    81    179    255    252    244    241    255    67    NaN    NaN
4300     13    34    76    187    88    92    222    255    255    250    250    250    255    73    NaN    NaN
4301     NaN    NaN    69    236    121    227    255    243    238    238    238    238    255    82    NaN    NaN
4302     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
4303 
4304 
4305 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4306     [NaN    NaN    10    24    24    24    24    24    24    24    22    4    NaN    NaN    NaN    NaN
4307     NaN    NaN    69    255    255    255    255    255    255    255    204    144    NaN    NaN    NaN    NaN
4308     NaN    NaN    45    255    241    240    241    246    252    255    189    222    155    NaN    NaN    NaN
4309     NaN    NaN    43    255    238    237    237    236    238    254    210    179    215    39    NaN    NaN
4310     NaN    NaN    44    255    241    241    241    241    240    244    252    255    255    80    NaN    NaN
4311     NaN    NaN    49    255    231    230    225    224    224    223    220    238    255    70    NaN    NaN
4312     NaN    NaN    56    227    136    214    227    223    221    221    215    237    255    68    NaN    NaN
4313     4    NaN    19    157    243    154    181    210    204    200    203    242    255    67    NaN    NaN
4314     51    255    231    225    219    217    172    197    232    222    242    240    255    67    NaN    NaN
4315     52    227    184    183    195    201    204    172    169    239    245    241    255    67    NaN    NaN
4316     51    218    177    177    180    187    187    177    130    202    190    230    255    67    NaN    NaN
4317     51    237    195    183    172    170    152    175    255    251    244    241    255    67    NaN    NaN
4318     15    38    72    173    183    149    211    255    255    250    250    250    255    73    NaN    NaN
4319     NaN    NaN    65    226    174    214    252    242    238    238    238    238    255    84    NaN    NaN
4320     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
4321 
4322 
4323 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4324     [NaN    NaN    9    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
4325     NaN    NaN    66    255    255    255    255    255    255    255    196    139    NaN    NaN    NaN    NaN
4326     NaN    NaN    42    255    239    238    238    244    252    255    186    216    148    NaN    NaN    NaN
4327     NaN    NaN    41    255    236    235    235    234    237    251    210    176    212    36    NaN    NaN
4328     NaN    NaN    42    255    239    239    239    239    238    241    252    255    255    78    NaN    NaN
4329     NaN    NaN    46    255    233    232    224    223    223    223    219    235    255    67    NaN    NaN
4330     NaN    NaN    53    240    101    232    230    221    219    218    213    235    255    65    NaN    NaN
4331     5    NaN    60    212    94    107    205    215    203    198    201    240    255    66    NaN    NaN
4332     34    56    40    80    70    62    94    222    241    221    240    238    255    66    NaN    NaN
4333     35    10    2    0    51    55    36    46    176    240    243    239    255    66    NaN    NaN
4334     35    11    9    7    16    34    12    6    110    204    188    228    255    66    NaN    NaN
4335     35    14    0    0    0    0    14    187    255    251    242    239    255    66    NaN    NaN
4336     12    37    84    206    0    41    234    255    255    248    248    248    255    72    NaN    NaN
4337     NaN    NaN    69    249    79    239    255    240    236    236    236    236    255    80    NaN    NaN
4338     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
4339 
4340 <span class="comment">% Export Excel File</span>
4341 idx = idx + 1;
4342 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4343     [NaN    NaN    NaN    NaN    NaN    NaN  106  252  255  255  255  255  255  255  255  255
4344    38  136  109  101   96   77   95  134  106   99   93   87   90   66  255  255
4345    52  197  232  217  210  202  191  178  170  164  160  159  155   15  255  255
4346    51  181  255  255  255  255  255  255  255  255  255  255  253    9  255  255
4347    49  174  245  153  156  175  255  255  181  153  149  205  245    0  255  255
4348    47  168  199  122  149  100  155  183   99   99   15  117  245    0  255  241
4349    45  158  255  146  146  141   87   68  120   34   86  255  238    0  252  232
4350    42  144  255  255  158  158  143   74   68  117  255  255  230    0  255  255
4351    40  134  255  255  169   15  150  111   68   81  105  167  236    0  230  217
4352    37  131  255  158   99  106   10  143  117   50   51  165  252    0  255  254
4353    35  122  208    0   22   32    8   17  110   20    0   13  212    0  255  245
4354    33  115  255  255  255  255  255  250  146  113  119  106  217    0  236  217
4355    31  109  255  254  252  251  250  255  255  255  255  255  241    0  255  251
4356    29  116  190  168  164  157  145  133  126  121  117  118  112    0  215  205
4357    20   63   47   38   36   20   38   83   64   51   52   55   64   20  255  241
4358     NaN    NaN    NaN    NaN    NaN    NaN   96  249  252  228  237  251  249  203  241  246]/255;
4359 
4360 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4361     [NaN    NaN    NaN    NaN    NaN    NaN  114  252  255  255  255  255  255  255  255  255
4362    49  180  152  145  140  118  140  173  150  139  132  126  126  106  255  255
4363    67  249  252  242  237  231  221  207  201  196  194  193  193   75  255  255
4364    66  232  255  255  255  255  255  255  255  255  255  255  255   68  255  255
4365    64  226  251  197  191  200  255  255  194  170  168  214  253   61  255  255
4366    62  220  224  183  207  173  189  202  167  175  116  172  253   58  255  246
4367    60  211  255  190  196  203  166  131  187  134  148  255  249   54  254  240
4368    57  199  255  255  198  203  202  158  132  168  255  255  245   47  255  255
4369    54  190  255  255  200  110  199  185  155  147  160  203  251   44  240  230
4370    52  187  255  204  187  194  121  204  189  139   99  179  255   39  255  254
4371    49  180  230   42   49   53   36   64  182   98   65   70  228   36  255  248
4372    47  171  255  255  255  255  255  255  186  115  124  114  235   34  243  229
4373    45  166  255  255  254  254  255  255  255  255  255  255  255   33  255  252
4374    43  176  222  206  204  200  190  180  174  171  169  169  169   32  229  220
4375    30  101   81   74   69   54   72  116   96   84   84   84   94   55  255  245
4376     NaN    NaN    NaN    NaN    NaN    NaN  105  251  253  237  242  252  251  218  246  249]/255;
4377 
4378 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4379     [ NaN    NaN    NaN    NaN    NaN    NaN  125  253  255  255  255  255  255  255  255  255
4380    34  118   92   84   79   56   83  111   88   79   73   69   74   45  255  255
4381    46  180  228  207  203  195  182  169  159  155  149  149  145    0  255  255
4382    45  163  255  255  255  255  255  255  255  255  255  255  254    0  255  255
4383    42  156  248  152  155  176  255  255  181  154  147  206  245    0  255  255
4384    40  150  202  117  136   87  154  181   90   84    8  120  243    0  255  252
4385    38  138  255  145  137  131   81   65  106   27   86  255  238    0  255  250
4386    35  122  255  255  159  152  137   75   62  121  255  255  229    0  255  255
4387    33  113  255  255  171   13  145  111   67   76   84  159  234    0  255  247
4388    30  109  255  160   89   97   10  136  111   36   33  159  251    0  255  255
4389    28   99  211    0   12   23    2   11  101    0    0   13  209    0  255  253
4390    26   92  255  255  255  255  255  250  146  111  117  104  213    0  255  245
4391    23   89  255  255  255  255  255  255  255  255  255  255  241    0  255  254
4392    22   93  180  156  151  141  129  114  105   98   93   93   83    0  255  239
4393    15   43   26   17   15    0   25   63   45   39   38   39   44    9  255  252
4394     NaN    NaN    NaN    NaN    NaN    NaN  117  253  255  249  251  255  254  239  252  254]/255;
4395 
4396 <span class="comment">% [EOF] getIcons</span>
4397 
4398 <a name="_sub102" href="#_subfunctions" class="code">function guiparams = createGUIparams</a>
4399 <span class="comment">% Creates the guiparams structure with specified defaults.</span>
4400 
4401 <span class="comment">% Organized by GUI panels</span>
4402 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
4403 <span class="comment">% SHIPTRACKS PLOT %</span>
4404 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
4405 guiparams.horizontal_grid_node_spacing       = 1.0;
4406 
4407 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
4408 <span class="comment">% CROSS SECTION PLOT %</span>
4409 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
4410 guiparams.contours                           = <span class="string">''</span>; <span class="comment">% Set below</span>
4411 guiparams.contour                            = <span class="string">''</span>; <span class="comment">% Set below</span>
4412 guiparams.idx_contour                        = 1;
4413 guiparams.vertical_exaggeration              = 10;
4414 guiparams.vector_scale_cross_section         = 0.2;
4415 guiparams.horizontal_vector_spacing          = 1;
4416 guiparams.vertical_vector_spacing            = 1;
4417 guiparams.horizontal_smoothing_window        = 1;
4418 guiparams.vertical_smoothing_window          = 1;
4419 guiparams.plot_secondary_flow_vectors        = true;
4420 guiparams.secondary_flows                    = <span class="string">''</span>; <span class="comment">% Set below</span>
4421 guiparams.secondary_flow_vector_variable     = <span class="string">''</span>; <span class="comment">% Set below</span>
4422 guiparams.idx_secondary_flow_vector_variable = 1;
4423 guiparams.include_vertical_velocity          = true;
4424 
4425 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
4426 <span class="comment">% PLAN VIEW PLOT %</span>
4427 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
4428 guiparams.depth_range_min                    = 0;
4429 guiparams.depth_range_max                    = inf;
4430 guiparams.vector_scale_plan_view             = 1;
4431 guiparams.vector_spacing_plan_view           = 1;
4432 guiparams.smoothing_window_size              = 1;
4433 guiparams.display_shoreline                  = false;
4434 guiparams.add_background                     = false;
4435 
4436 <span class="comment">%%%%%%%%%%%%%%%</span>
4437 <span class="comment">% DATA EXPORT %</span>
4438 <span class="comment">%%%%%%%%%%%%%%%</span>
4439 guiparams.beam_angle                         = 20.0;
4440 guiparams.magnetic_variation                 = 0.0;
4441 guiparams.wse                                = 0.0;
4442 guiparams.output_auxiliary_data              = false;
4443 
4444 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
4445 <span class="comment">% Contour variables %</span>
4446 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
4447 idx = 1;
4448 guiparams.contours(idx).string   = <span class="string">'Streamwise Velocity (u)'</span>;
4449 guiparams.contours(idx).variable = <span class="string">'streamwise'</span>;
4450 idx = idx + 1;
4451 guiparams.contours(idx).string   = <span class="string">'Transverse Velocity (v)'</span>;
4452 guiparams.contours(idx).variable = <span class="string">'transverse'</span>;
4453 idx = idx + 1;
4454 guiparams.contours(idx).string   = <span class="string">'Vertical Velocity (w)'</span>;
4455 guiparams.contours(idx).variable = <span class="string">'vertical'</span>;
4456 idx = idx + 1;
4457 guiparams.contours(idx).string   = <span class="string">'Velocity Magnitude'</span>;
4458 guiparams.contours(idx).variable = <span class="string">'mag'</span>;
4459 idx = idx + 1;
4460 guiparams.contours(idx).string   = <span class="string">'East Velocity (E)'</span>;
4461 guiparams.contours(idx).variable = <span class="string">'east'</span>;
4462 idx = idx + 1;
4463 guiparams.contours(idx).string   = <span class="string">'North Velocity (N)'</span>;
4464 guiparams.contours(idx).variable = <span class="string">'north'</span>;
4465 idx = idx + 1;
4466 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (zsd)'</span>;
4467 guiparams.contours(idx).variable = <span class="string">'primary_zsd'</span>;
4468 idx = idx + 1;
4469 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (zsd)'</span>;
4470 guiparams.contours(idx).variable = <span class="string">'secondary_zsd'</span>;
4471 idx = idx + 1;
4472 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (Roz)'</span>;
4473 guiparams.contours(idx).variable = <span class="string">'primary_roz'</span>;
4474 idx = idx + 1;
4475 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (Roz)'</span>;
4476 guiparams.contours(idx).variable = <span class="string">'secondary_roz'</span>;
4477 idx = idx + 1;
4478 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Downstream Comp.)'</span>;
4479 guiparams.contours(idx).variable = <span class="string">'primary_roz_x'</span>;
4480 idx = idx + 1;
4481 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Cross-Stream Comp.)'</span>;
4482 guiparams.contours(idx).variable = <span class="string">'primary_roz_y'</span>;
4483 idx = idx + 1;
4484 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Downstream Comp.)'</span>;
4485 guiparams.contours(idx).variable = <span class="string">'secondary_roz_x'</span>;
4486 idx = idx + 1;
4487 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Cross-Stream Comp.)'</span>;
4488 guiparams.contours(idx).variable = <span class="string">'secondary_roz_y'</span>;
4489 idx = idx + 1;
4490 guiparams.contours(idx).string   = <span class="string">'Backscatter'</span>;
4491 guiparams.contours(idx).variable = <span class="string">'backscatter'</span>;
4492 idx = idx + 1;
4493 guiparams.contours(idx).string   = <span class="string">'Flow Direction (deg.)'</span>;
4494 guiparams.contours(idx).variable = <span class="string">'flowangle'</span>;
4495 
4496 guiparams.contour = guiparams.contours(guiparams.idx_contour).variable;
4497 
4498 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4499 <span class="comment">% Secondary Flow Vector Variables %</span>
4500 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4501 idx = 1;
4502 guiparams.secondary_flows(idx).string   = <span class="string">'Transverse'</span>;
4503 guiparams.secondary_flows(idx).variable = <span class="string">'transverse'</span>;
4504 idx = idx + 1;
4505 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (zsd)'</span>;
4506 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_zsd'</span>;
4507 idx = idx + 1;
4508 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz)'</span>;
4509 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz'</span>;
4510 idx = idx + 1;
4511 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz, Cross-Stream Comp)'</span>;
4512 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz_y'</span>;
4513 idx = idx + 1;
4514 guiparams.secondary_flows(idx).string   = <span class="string">'Primary (Roz, Cross-Stream Comp)'</span>;
4515 guiparams.secondary_flows(idx).variable  = <span class="string">'primary_roz_y'</span>;
4516 
4517 guiparams.secondary_flow_vector_variable = <span class="keyword">...</span>
4518     guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).variable;
4519 
4520 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4521 <span class="comment">% INTERNAL SETTINGS &amp; DEFAULTS %</span>
4522 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4523 <span class="comment">% Menu bar options</span>
4524 guiparams.presentation                       = true;
4525 guiparams.print                              = false;
4526 guiparams.set_cross_section_endpoints        = false;
4527 guiparams.unit_discharge_correction          = false;
4528 guiparams.english_units                      = false;
4529 guiparams.vertical_offset                    = 0;
4530 <span class="comment">% guiparams.plot_ship_tracks                   = false;</span>
4531 <span class="comment">% guiparams.plot_planview                      = false;</span>
4532 <span class="comment">% guiparams.plot_cross_section                 = false;</span>
4533 
4534 <span class="comment">% File location defaults</span>
4535 guiparams.ascii_path                        = pwd;
4536 guiparams.ascii_file                        = <span class="string">''</span>;
4537 guiparams.mat_path                          = pwd;
4538 guiparams.mat_file                          = <span class="string">''</span>;
4539 guiparams.tecplot_path                      = pwd;
4540 guiparams.tecplot_file                      = <span class="string">''</span>;
4541 guiparams.kmz_path                          = pwd;
4542 guiparams.kmz_file                          = <span class="string">''</span>;
4543 guiparams.multibeambathymetry_path          = pwd;
4544 guiparams.multibeambathymetry_file          = <span class="string">''</span>;
4545 guiparams.log_path                          = pwd;
4546 guiparams.log_file                          = <span class="string">''</span>;
4547 <span class="comment">% Avoids problems of not finding the MCR root when running as a standalone</span>
4548 <span class="comment">% application</span>
4549 <span class="keyword">if</span> isdeployed 
4550     guiparams.has_mapping_toolbox           = true;
4551 <span class="keyword">else</span>
4552     guiparams.has_mapping_toolbox               = <span class="keyword">...</span>
4553         ~isempty(dir(fullfile(matlabroot,<span class="string">'toolbox'</span>,<span class="string">'map'</span>)));
4554 <span class="keyword">end</span>
4555 
4556 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4557 <span class="comment">% IN MEMORY DATA STORAGE %</span>
4558 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4559 guiparams.z                      = [];
4560 guiparams.A                      = [];
4561 guiparams.V                      = [];
4562 guiparams.Map                    = [];
4563 guiparams.savefile               = [];
4564 guiparams.iric_anv_planview_data = [];
4565 <span class="comment">% guiparams.zmin = []; % Don't need to store these?</span>
4566 <span class="comment">% guiparams.zmax = [];</span>
4567 <span class="comment">% guiprefs = getappdata(handles.figure1,'guiprefs');</span>
4568 guiparams.data_folder = <span class="string">''</span>;
4569 guiparams.data_files  = {<span class="string">''</span>};
4570 
4571 <span class="comment">% [EOF] createGUIparams</span>
4572 
4573 <span class="comment">% [EOF] VMT</span></pre></div>
<hr><address>Generated on Wed 14-Aug-2013 08:31:52 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>