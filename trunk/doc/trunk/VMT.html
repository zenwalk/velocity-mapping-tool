<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of VMT</title>
  <meta name="keywords" content="VMT">
  <meta name="description" content="--- THE VELOCITY MAPPING TOOLBOX ---">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html trunk -->
<h1>VMT
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>--- THE VELOCITY MAPPING TOOLBOX ---</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function varargout = VMT(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> --- THE VELOCITY MAPPING TOOLBOX ---
 
 VMT is a Matlab-based software for processing and visualizing ADCP data
 collected along transects in rivers or other bodies of water. VMT allows
 rapid processing, visualization, and analysis of a range of ADCP datasets
 and includes utilities to export ADCP data to files compatible with
 ArcGIS, Tecplot, and Google Earth. The software can be used to explore
 patterns of three-dimensional fluid motion through several methods for
 calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et
 al., 2000). The software also includes capabilities for analyzing the
 acoustic backscatter and bathymetric data from the ADCP. A user-friendly
 graphical user interface (GUI) enhances program functionality and
 provides ready access to two- and three- dimensional plotting functions,
 allowing rapid display and interrogation of velocity, backscatter, and
 bathymetry data.
 
 CITATION: 
 Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.
 L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,
 J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and
 visualization suite for moving-vessel ADCP measurements. Earth Surf.
 Process. Landforms. doi: 10.1002/esp.3367

__________________________________________________________________________
 P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center
 (pjackson@usgs.gov)

 Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.
__________________________________________________________________________</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>	Takes the processed data structure and writes a TecPlot ASCII data file.</li><li><a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>	Takes the processed data structure and writes a TecPlot ASCII data file</li><li><a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>	Computes the multibeam bathymetry from the four beams of the ADCP</li><li><a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>	Outputs the mean cross section (3-D) from VMT to Google Earth (saved as a</li><li><a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>	Prompts the user for a geotiff DOQQ (USGS) and overlays the aerial image</li><li><a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>	This function plots a plan view of the measurement region with a vector</li><li><a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>	Plots the shiptracks, and interpolated grid in the VMT GUI axes. Also</li><li><a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>	Plots a shoreline map given the shoreline data structure 'Map' (see</li><li><a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english)">VMT_PlotXSCont</a>	Plots contours for the variable 'var' within the mean cross section given</li><li><a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,varargin)">VMT_PlotXSContQuiver</a>	This function plots the the contour plot (mean XS) for the variable 'var'</li><li><a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>	This function is a driver to preprocess the transects data.  Several</li><li><a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>	Driver program to process multiple transects at a single cross-section</li><li><a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>	Read in multiple ASCII output files from WinRiver or WinRiverII.</li><li><a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>	Saves the figures (specified by fignums) from VMT as .PNG or EPS files</li><li><a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>	This routine smooths all processed variables in V struct. By default is</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a></li><li><a href="#_sub2" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub3" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub4" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub5" class="code">function menuFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub6" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub7" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub8" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub9" class="code">function menuSave_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub10" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub11" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub12" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub13" class="code">function menuExport_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub14" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub15" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub16" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub17" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub18" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub19" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub20" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub21" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub22" class="code">function menuParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub23" class="code">function menuProcessingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub24" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub25" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub26" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub27" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub28" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub29" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub30" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub31" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub32" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub33" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub34" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub35" class="code">function menuKMZExport_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub36" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub37" class="code">function menuTools_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub38" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub39" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub40" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub41" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub42" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub43" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub44" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub45" class="code">function loadDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub46" class="code">function saveDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub47" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub48" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub49" class="code">function processingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub50" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub51" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub52" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub53" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub54" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub55" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub56" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub57" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub58" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub59" class="code">function WSE_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub60" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub61" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub62" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub63" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub64" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub65" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub66" class="code">function DisplayShoreline_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub67" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub68" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub69" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub70" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub71" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub72" class="code">function Contour_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub73" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub74" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub75" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub76" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub77" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub78" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub79" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub80" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub81" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub82" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub83" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub84" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub85" class="code">function handles = buildToolbar(handles)</a></li><li><a href="#_sub86" class="code">function load_prefs(hfigure)</a></li><li><a href="#_sub87" class="code">function store_prefs(hfigure,pref)</a></li><li><a href="#_sub88" class="code">function initGUI(handles)</a></li><li><a href="#_sub89" class="code">function set_enable(handles,enable_state)</a></li><li><a href="#_sub90" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] =</a></li><li><a href="#_sub91" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a></li><li><a href="#_sub92" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a></li><li><a href="#_sub93" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a></li><li><a href="#_sub94" class="code">function dialogOK(hObject,eventdata,h_OK)</a></li><li><a href="#_sub95" class="code">function dialogCancel(hObject,eventdata,handles)</a></li><li><a href="#_sub96" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a></li><li><a href="#_sub97" class="code">function [beam_angle,magnetic_variation,wse,output_auxilliary_data] = exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxilliary_data,hf)</a></li><li><a href="#_sub98" class="code">function dialogExportSettings(hObject,eventdata,handles)</a></li><li><a href="#_sub99" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a></li><li><a href="#_sub100" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a></li><li><a href="#_sub101" class="code">function icons = getIcons</a></li><li><a href="#_sub102" class="code">function guiparams = createGUIparams</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function varargout = VMT(varargin)</a>
0002 <span class="comment">% --- THE VELOCITY MAPPING TOOLBOX ---</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% VMT is a Matlab-based software for processing and visualizing ADCP data</span>
0005 <span class="comment">% collected along transects in rivers or other bodies of water. VMT allows</span>
0006 <span class="comment">% rapid processing, visualization, and analysis of a range of ADCP datasets</span>
0007 <span class="comment">% and includes utilities to export ADCP data to files compatible with</span>
0008 <span class="comment">% ArcGIS, Tecplot, and Google Earth. The software can be used to explore</span>
0009 <span class="comment">% patterns of three-dimensional fluid motion through several methods for</span>
0010 <span class="comment">% calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et</span>
0011 <span class="comment">% al., 2000). The software also includes capabilities for analyzing the</span>
0012 <span class="comment">% acoustic backscatter and bathymetric data from the ADCP. A user-friendly</span>
0013 <span class="comment">% graphical user interface (GUI) enhances program functionality and</span>
0014 <span class="comment">% provides ready access to two- and three- dimensional plotting functions,</span>
0015 <span class="comment">% allowing rapid display and interrogation of velocity, backscatter, and</span>
0016 <span class="comment">% bathymetry data.</span>
0017 <span class="comment">%</span>
0018 <span class="comment">% CITATION:</span>
0019 <span class="comment">% Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.</span>
0020 <span class="comment">% L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,</span>
0021 <span class="comment">% J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and</span>
0022 <span class="comment">% visualization suite for moving-vessel ADCP measurements. Earth Surf.</span>
0023 <span class="comment">% Process. Landforms. doi: 10.1002/esp.3367</span>
0024 <span class="comment">%</span>
0025 <span class="comment">%__________________________________________________________________________</span>
0026 <span class="comment">% P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center</span>
0027 <span class="comment">% (pjackson@usgs.gov)</span>
0028 <span class="comment">%</span>
0029 <span class="comment">% Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.</span>
0030 <span class="comment">%__________________________________________________________________________</span>
0031 
0032 <span class="comment">% Begin initialization code - DO NOT EDIT</span>
0033 gui_Singleton = 1;
0034 gui_State = struct(<span class="string">'gui_Name'</span>,       mfilename, <span class="keyword">...</span>
0035     <span class="string">'gui_Singleton'</span>,  gui_Singleton, <span class="keyword">...</span>
0036     <span class="string">'gui_OpeningFcn'</span>, @<a href="#_sub1" class="code" title="subfunction VMT_OpeningFcn(hObject, eventdata, handles, varargin)">VMT_OpeningFcn</a>, <span class="keyword">...</span>
0037     <span class="string">'gui_OutputFcn'</span>,  @<a href="#_sub2" class="code" title="subfunction varargout = VMT_OutputFcn(hObject, eventdata, handles)">VMT_OutputFcn</a>, <span class="keyword">...</span>
0038     <span class="string">'gui_LayoutFcn'</span>,  [] , <span class="keyword">...</span>
0039     <span class="string">'gui_Callback'</span>,   []);
0040 <span class="keyword">if</span> nargin &amp;&amp; ischar(varargin{1})
0041     gui_State.gui_Callback = str2func(varargin{1});
0042 <span class="keyword">end</span>
0043 
0044 <span class="comment">% If ERROR, write a txt file with the error dump info</span>
0045 <span class="keyword">try</span>
0046 <span class="keyword">if</span> nargout
0047     [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
0048 <span class="keyword">else</span>
0049     gui_mainfcn(gui_State, varargin{:});
0050 <span class="keyword">end</span>
0051 
0052 <span class="keyword">catch</span> err
0053     <span class="keyword">if</span> isdeployed
0054         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
0055             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
0056         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
0057             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
0058             errLogFileName},<span class="keyword">...</span>
0059             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0060             <span class="string">'error'</span>);
0061         fid = fopen(errLogFileName,<span class="string">'W'</span>);
0062         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
0063         fclose(fid);
0064         rethrow(err)
0065     <span class="keyword">else</span>
0066         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
0067             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0068             <span class="string">'error'</span>);
0069         rethrow(err);
0070     <span class="keyword">end</span>
0071 <span class="keyword">end</span>
0072 <span class="comment">% End initialization code - DO NOT EDIT</span>
0073 
0074 <span class="comment">%#ok&lt;*DEFNU,*INUSL,*INUSD&gt;</span>
0075 
0076 <span class="comment">% --- Executes just before VMT is made visible.</span>
0077 <a name="_sub1" href="#_subfunctions" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a>
0078 <span class="comment">% This function has no output args, see OutputFcn.</span>
0079 <span class="comment">% hObject    handle to figure</span>
0080 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0081 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0082 <span class="comment">% varargin   command line arguments to VMT (see VARARGIN)</span>
0083 
0084 <span class="comment">% Choose default command line output for VMT</span>
0085 handles.output = hObject;
0086 
0087 <span class="comment">% Build the GUI toolbar:</span>
0088 <span class="comment">% ----------------------</span>
0089 handles = <a href="#_sub85" class="code" title="subfunction handles = buildToolbar(handles)">buildToolbar</a>(handles);
0090 
0091 <span class="comment">% Ensure path to utils &amp; docs is available</span>
0092 <span class="comment">% ----------------------------------------</span>
0093 <span class="keyword">if</span> ~isdeployed
0094     filesep = <span class="string">'\'</span>; <span class="comment">% windows</span>
0095     utilspath = [pwd filesep <span class="string">'utils'</span>];
0096     docspath  = [pwd filesep <span class="string">'doc'</span>];
0097     toolspath = [pwd filesep <span class="string">'tools'</span>];
0098     addpath(utilspath,docspath,toolspath)
0099 <span class="keyword">end</span>
0100 
0101 <span class="comment">% Update handles structure</span>
0102 <span class="comment">% ------------------------</span>
0103 guidata(hObject, handles);
0104 
0105 <span class="comment">% Load the GUI preferences:</span>
0106 <span class="comment">% -------------------------</span>
0107 <a href="#_sub86" class="code" title="subfunction load_prefs(hfigure)">load_prefs</a>(handles.figure1)
0108 
0109 <span class="comment">% Initialize the GUI parameters:</span>
0110 <span class="comment">% ------------------------------</span>
0111 guiparams = <a href="#_sub102" class="code" title="subfunction guiparams = createGUIparams">createGUIparams</a>;
0112 guiparams.vmt_version = <span class="string">'v4.02'</span>;
0113 
0114 <span class="comment">% Draw the VMT Background</span>
0115 <span class="comment">% -----------------</span>
0116 pos = get(handles.figure1,<span class="string">'position'</span>);
0117 axes(handles.VMTBackground);
0118 <span class="keyword">if</span> ~isdeployed <span class="comment">%isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0119     X = imread(<span class="string">'VMT_Background.png'</span>);
0120     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0121 <span class="keyword">else</span>
0122     X = imread(<span class="string">'VMT_Background.png'</span>);
0123     X = imresize(X, [pos(4) pos(3)]);
0124     X = uint8(X);
0125     imshow(X,<span class="string">'Border'</span>,<span class="string">'tight'</span>)
0126 <span class="keyword">end</span>
0127 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0128 
0129 <span class="comment">% Store the application data:</span>
0130 <span class="comment">% ---------------------------</span>
0131 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0132 
0133 <span class="comment">% Initialize the GUI:</span>
0134 <span class="comment">% -------------------</span>
0135 <a href="#_sub88" class="code" title="subfunction initGUI(handles)">initGUI</a>(handles)
0136 <a href="#_sub89" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'init'</span>)
0137 <span class="comment">% set(handles.GraphicsExportPanel,'Visible','off')</span>
0138 <span class="comment">% set(handles.ProcessingPanel,'Visible','off')</span>
0139 pos = get(handles.figure1,<span class="string">'Position'</span>);
0140 <span class="comment">% pos(3) = 545;</span>
0141 set(handles.figure1,<span class="string">'Position'</span>,pos)
0142 set(handles.figure1,<span class="string">'Resize'</span>,<span class="string">'on'</span>)
0143 
0144 <span class="comment">% Allow access to the VMT Main GUI info by other sub-GUIs by pushing it to</span>
0145 <span class="comment">% the root</span>
0146 setappdata(0  , <span class="string">'hVMTgui'</span>    , gcf);
0147 
0148 <span class="comment">% UIWAIT makes VMT wait for user response (see UIRESUME)</span>
0149 <span class="comment">% uiwait(handles.figure1);</span>
0150 <span class="comment">% [EOF] VMT_OpeningFcn</span>
0151 
0152 
0153 <span class="comment">% --- Outputs from this function are returned to the command line.</span>
0154 <a name="_sub2" href="#_subfunctions" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a>
0155 <span class="comment">% varargout  cell array for returning output args (see VARARGOUT);</span>
0156 <span class="comment">% hObject    handle to figure</span>
0157 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0158 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0159 
0160 <span class="comment">% Get default command line output from handles structure</span>
0161 varargout{1} = handles.output;
0162 <span class="comment">% [EOF] VMT_OutputFcn</span>
0163 
0164 <span class="comment">% --- Executes when figure1 is resized.</span>
0165 <a name="_sub3" href="#_subfunctions" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a>
0166 
0167 <span class="comment">% Draw the VMT Background</span>
0168 <span class="comment">% -----------------</span>
0169 pos = get(handles.figure1,<span class="string">'position'</span>);
0170 axes(handles.VMTBackground);
0171 <span class="keyword">if</span> ~isdeployed <span class="comment">%isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0172     X = imread(<span class="string">'VMT_Background.png'</span>);
0173     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0174 <span class="keyword">else</span>
0175     X = imread(<span class="string">'VMT_Background.png'</span>);
0176     X = imresize(X, [pos(4) pos(3)]);
0177     X = uint8(X);
0178     imshow(X,<span class="string">'Border'</span>,<span class="string">'tight'</span>)
0179 <span class="keyword">end</span>
0180 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0181 
0182 <span class="comment">% --- Executes when user attempts to close figure1.</span>
0183 <a name="_sub4" href="#_subfunctions" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a>
0184 <span class="comment">% hObject    handle to figure1 (see GCBO)</span>
0185 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0186 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0187 
0188 <span class="comment">% Hint: delete(hObject) closes the figure</span>
0189 close_button = questdlg(<span class="keyword">...</span>
0190     <span class="string">'You are about to exit VMT. Any unsaved work will be lost. Are you sure?'</span>,<span class="keyword">...</span>
0191     <span class="string">'Exit VMT?'</span>,<span class="string">'No'</span>);
0192 <span class="keyword">switch</span> close_button
0193     <span class="keyword">case</span> <span class="string">'Yes'</span>
0194         delete(hObject)
0195         close all hidden
0196     <span class="keyword">otherwise</span>
0197         <span class="keyword">return</span>
0198 <span class="keyword">end</span>
0199 <span class="comment">% [EOF] figure1_CloseRequestFcn</span>
0200 
0201 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0202 <span class="comment">% MENU BAR CALLBACKS %</span>
0203 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0204 
0205 <span class="comment">% --------------------------------------------------------------------</span>
0206 <a name="_sub5" href="#_subfunctions" class="code">function menuFile_Callback(hObject, eventdata, handles)</a>
0207 <span class="comment">% Empty</span>
0208 
0209 <span class="comment">% --------------------------------------------------------------------</span>
0210 <a name="_sub6" href="#_subfunctions" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a>
0211 <span class="comment">% Empty</span>
0212 
0213 <span class="comment">% --------------------------------------------------------------------</span>
0214 <a name="_sub7" href="#_subfunctions" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a>
0215 <a href="#_sub45" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>(hObject, eventdata, handles)
0216 <span class="comment">% [EOF] menuOpenASCII_Callback</span>
0217 
0218 <span class="comment">% --------------------------------------------------------------------</span>
0219 <a name="_sub8" href="#_subfunctions" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a>
0220 
0221 <span class="comment">% Get the Application data:</span>
0222 <span class="comment">% -------------------------</span>
0223 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0224 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0225 
0226 <span class="comment">% Ask the user to select files:</span>
0227 <span class="comment">% -----------------------------</span>
0228 <span class="comment">% current_file = fullfile(guiparams.data_folder,guiparams.data_files{1});</span>
0229 <span class="comment">% current_file = fullfile(guiprefs.mat_path,guiprefs.mat_file);</span>
0230 <span class="keyword">if</span> iscell(guiprefs.mat_file)
0231     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file{1});
0232 <span class="keyword">else</span>
0233     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file);
0234 <span class="keyword">end</span>
0235 [filename,pathname] = <span class="keyword">...</span>
0236     uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-files (*.mat)'</span>}, <span class="keyword">...</span>
0237     <span class="string">'Select MAT File'</span>, <span class="keyword">...</span>
0238     uifile, <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
0239 
0240 <span class="keyword">if</span> ischar(filename) <span class="comment">% Single MAT file loaded</span>
0241     <span class="comment">% Load the data:</span>
0242     <span class="comment">% --------------</span>
0243     vars = load(fullfile(pathname,filename));
0244     
0245     <span class="comment">% Make sure the selected file is a valid file:</span>
0246     <span class="comment">% --------------------------------------------</span>
0247     varnames = fieldnames(vars);
0248     <span class="keyword">if</span> isequal(sort(varnames),{<span class="string">'A'</span> <span class="string">'Map'</span> <span class="string">'V'</span> <span class="string">'z'</span>}')
0249         guiparams.mat_path = pathname;
0250         guiparams.mat_file = filename;
0251         guiparams.z = vars.z;
0252         guiparams.A = vars.A;
0253         guiparams.V = vars.V;
0254         
0255         <span class="comment">% Update the preferences:</span>
0256         <span class="comment">% -----------------------</span>
0257         guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0258         guiprefs.mat_path = pathname;
0259         guiprefs.mat_file = filename;
0260         setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0261         <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0262                      
0263         <span class="comment">% Re-store the Application Data:</span>
0264         <span class="comment">% ------------------------------</span>
0265         setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0266         
0267         <span class="comment">% Update the GUI:</span>
0268         <span class="comment">% ---------------</span>
0269         <a href="#_sub89" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
0270     <span class="keyword">else</span> <span class="comment">% Not a valid file</span>
0271         errordlg(<span class="string">'The selected file is not a valid ADCP data MAT file.'</span>, <span class="keyword">...</span>
0272             <span class="string">'Invalid File...'</span>)
0273     <span class="keyword">end</span>
0274     
0275 <span class="keyword">elseif</span> iscell(filename) <span class="comment">% Multiple MAT files loaded</span>
0276     <span class="comment">% Set the filenames</span>
0277     <span class="comment">% -----------------</span>
0278     guiparams.mat_path = pathname;
0279     guiparams.mat_file = filename;
0280     
0281     <span class="comment">% Push status to log window</span>
0282     <span class="comment">% -------------------------</span>
0283     log_text = {<span class="keyword">...</span>
0284         <span class="string">'Loading previously processed MAT files.'</span>;<span class="keyword">...</span>
0285         <span class="string">'Directory:'</span>};
0286     log_text = vertcat(log_text, pathname, {<span class="string">'Files:'</span>}, filename');
0287     statusLogging(handles.LogWindow,log_text)
0288     
0289     <span class="comment">% Update the Application Data:</span>
0290     <span class="comment">% ------------------------------</span>
0291     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0292     
0293     <span class="comment">% Update the persistent preferences:</span>
0294     <span class="comment">% ----------------------------------</span>
0295     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0296     guiprefs.mat_path = pathname;
0297     guiprefs.mat_file = filename;
0298     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0299     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0300         
0301     <span class="comment">% Update the GUI:</span>
0302     <span class="comment">% ---------------</span>
0303     <a href="#_sub89" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'multiplematfiles'</span>)
0304 <span class="keyword">end</span>
0305 
0306 <span class="comment">% [EOF] menuOpenMAT_Callback</span>
0307 
0308 <span class="comment">% --------------------------------------------------------------------</span>
0309 <a name="_sub9" href="#_subfunctions" class="code">function menuSave_Callback(hObject, eventdata, handles)</a>
0310 <span class="comment">% Empty</span>
0311 
0312 <span class="comment">% --------------------------------------------------------------------</span>
0313 <a name="_sub10" href="#_subfunctions" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a>
0314 <a href="#_sub46" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>(hObject, eventdata, handles)
0315 <span class="comment">% [EOF] menuSaveMAT_Callback</span>
0316 
0317 <span class="comment">% --------------------------------------------------------------------</span>
0318 <a name="_sub11" href="#_subfunctions" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a>
0319 <a href="#_sub54" class="code" title="subfunction SaveTecplotFile_Callback(hObject, eventdata, handles)">SaveTecplotFile_Callback</a>(handles,eventdata,handles)
0320 <span class="comment">% [EOF] menuSaveTecplot_Callback</span>
0321 
0322 <span class="comment">% --------------------------------------------------------------------</span>
0323 <a name="_sub12" href="#_subfunctions" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a>
0324 <a href="#_sub55" class="code" title="subfunction SaveGoogleEarthFile_Callback(hObject, eventdata, handles)">SaveGoogleEarthFile_Callback</a>(handles,eventdata,handles)
0325 <span class="comment">% [EOF] menuSaveKMZFile_Callback</span>
0326 
0327 <span class="comment">% --------------------------------------------------------------------</span>
0328 <a name="_sub13" href="#_subfunctions" class="code">function menuExport_Callback(hObject, eventdata, handles)</a>
0329 <span class="comment">% Empty</span>
0330 
0331 <span class="comment">% --------------------------------------------------------------------</span>
0332 <a name="_sub14" href="#_subfunctions" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a>
0333 <span class="comment">% Empty</span>
0334 
0335 <span class="comment">% --------------------------------------------------------------------</span>
0336 <a name="_sub15" href="#_subfunctions" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a>
0337 
0338 <span class="comment">% Get the Application Data:</span>
0339 <span class="comment">% -------------------------</span>
0340 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0341 
0342 <span class="comment">% Update the Application Data:</span>
0343 <span class="comment">% ----------------------------</span>
0344 guiparams.print        = true;
0345 guiparams.presentation = false;
0346 
0347 <span class="comment">% Re-store the Application data:</span>
0348 <span class="comment">% ------------------------------</span>
0349 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0350 
0351 <span class="comment">% Update the GUI:</span>
0352 <span class="comment">% ---------------</span>
0353 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0354 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
0355 
0356 <span class="comment">% [EOF] menuPrintFormat_Callback</span>
0357 
0358 
0359 <span class="comment">% --------------------------------------------------------------------</span>
0360 <a name="_sub16" href="#_subfunctions" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a>
0361 
0362 <span class="comment">% Get the Application Data:</span>
0363 <span class="comment">% -------------------------</span>
0364 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0365 
0366 <span class="comment">% Update the Application Data:</span>
0367 <span class="comment">% ----------------------------</span>
0368 guiparams.print        = false;
0369 guiparams.presentation = true;
0370 
0371 <span class="comment">% Re-store the Application data:</span>
0372 <span class="comment">% ------------------------------</span>
0373 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0374 
0375 <span class="comment">% Update the GUI:</span>
0376 <span class="comment">% ---------------</span>
0377 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0378 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
0379 
0380 <span class="comment">% [EOF] menuPresentationFormat_Callback</span>
0381 
0382 <span class="comment">% --------------------------------------------------------------------</span>
0383 <a name="_sub17" href="#_subfunctions" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a>
0384 <span class="comment">% Get the Application data:</span>
0385 <span class="comment">% -------------------------</span>
0386 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0387 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0388 
0389 <span class="comment">% Find what plots exist already</span>
0390 fig_handles = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0391 fig_names   = get(fig_handles,<span class="string">'name'</span>);
0392 
0393 <span class="comment">% Remove the VMT GUI as a valid figure in the list</span>
0394 [~, idx] = ismember(get(handles.figure1,<span class="string">'Name'</span>), fig_names);
0395 <span class="keyword">if</span> ~isempty(idx)
0396     fig_names(idx) = [];
0397 <span class="keyword">end</span>
0398 
0399 <span class="keyword">if</span> guiparams.presentation
0400     figure_style = <span class="string">'presentation'</span>;
0401 <span class="keyword">else</span>
0402     figure_style = <span class="string">'print'</span>;
0403 <span class="keyword">end</span>
0404 
0405 [selected_figures] = <a href="#_sub99" class="code" title="subfunction [selected_figures] = openFiguresDialog(figure_names,hf)">openFiguresDialog</a>(fig_names,handles.figure1);
0406 
0407 <span class="keyword">if</span> isempty(selected_figures) <span class="comment">% User pressed cancel</span>
0408     <span class="keyword">return</span>
0409 <span class="keyword">else</span>
0410     <span class="keyword">for</span> i = 1:length(selected_figures)
0411         <a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>(guiprefs.mat_path,selected_figures(i),figure_style)
0412     <span class="keyword">end</span>
0413 <span class="keyword">end</span>
0414 
0415 
0416 <span class="comment">% [EOF] menuExportFigures_Callback</span>
0417 
0418 <span class="comment">% --------------------------------------------------------------------</span>
0419 <a name="_sub18" href="#_subfunctions" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a>
0420 <span class="comment">% Get the Application data:</span>
0421 <span class="comment">% -------------------------</span>
0422 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0423 beam_angle = guiparams.beam_angle; 
0424 magnetic_variation = guiparams.magnetic_variation; 
0425 wse = guiparams.wse;
0426 output_auxilliary_data = guiparams.output_auxiliary_data; 
0427 
0428 <span class="comment">% Open dialog and allow user to select settings</span>
0429 <span class="comment">% ---------------------------------------------</span>
0430 [guiparams.beam_angle,<span class="keyword">...</span>
0431     guiparams.magnetic_variation,<span class="keyword">...</span>
0432     guiparams.wse,<span class="keyword">...</span>
0433     guiparams.output_auxilliary_data] = <span class="keyword">...</span>
0434     <a href="#_sub97" class="code" title="subfunction [beam_angle,magnetic_variation,wse,output_auxilliary_data] = exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxilliary_data,hf)">exportSettingsDialog</a>(beam_angle,magnetic_variation,wse,output_auxilliary_data,handles.figure1);
0435 
0436 <span class="comment">% Re-store the Application data:</span>
0437 <span class="comment">% ------------------------------</span>
0438 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0439 
0440 <span class="comment">% [EOF] menuExportSettings_Callback</span>
0441 
0442 <span class="comment">% --------------------------------------------------------------------</span>
0443 <a name="_sub19" href="#_subfunctions" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
0444 <a href="#_sub56" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>(hObject, eventdata, handles);
0445 <span class="comment">% [EOF] menuExportMultibeamBathymetry_Callback</span>
0446 
0447 
0448 <span class="comment">% --------------------------------------------------------------------</span>
0449 <a name="_sub20" href="#_subfunctions" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a>
0450 
0451 <span class="comment">% Get the Application Data:</span>
0452 <span class="comment">% -------------------------</span>
0453 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0454 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0455 PVdata    = guiparams.iric_anv_planview_data;
0456 iric_path = guiprefs.iric_path;
0457 iric_file = guiprefs.iric_file;
0458 
0459 <span class="comment">% Is there any planview data?</span>
0460 <span class="keyword">if</span> isempty(PVdata)
0461     <span class="comment">% Nothing to do, warn user</span>
0462     log_text = {<span class="string">'No planview plot data to export. User must Plot Plan View first.'</span>};
0463     warndlg(log_text{:},<span class="string">'Nothing to export'</span>)
0464 <span class="keyword">else</span>
0465     <span class="comment">% Save the planview data as output and to an *.anv file with spacing</span>
0466     <span class="comment">% and smoothing (for iRiC)</span>
0467     log_text = {<span class="string">'Exporting iRic formated ANV vector file...'</span>};
0468     [iric_file,iric_path] = uiputfile(<span class="string">'*.anv'</span>,<span class="string">'Save *.anv file'</span>,<span class="keyword">...</span>
0469         fullfile(iric_path,iric_file));
0470     
0471     <span class="keyword">if</span> ischar(iric_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0472         outfile = fullfile(iric_path,iric_file);
0473         log_text = vertcat(log_text,{outfile});
0474         ofid   = fopen(outfile, <span class="string">'wt'</span>);
0475         outcount = fprintf(ofid,<span class="keyword">...</span>
0476             <span class="string">'%8.2f  %8.2f  %5.2f  %3.3f  %3.3f\n'</span>,PVdata.outmat);
0477         fclose(ofid);
0478     <span class="keyword">else</span>
0479         <span class="comment">% Return default iric_path and iric_file</span>
0480         iric_path = guiprefs.iric_path;
0481         iric_file = guiprefs.iric_file;
0482     <span class="keyword">end</span>
0483 <span class="keyword">end</span>
0484 
0485 <span class="comment">% Push messages to Log Window:</span>
0486 <span class="comment">% ----------------------------</span>
0487 statusLogging(handles.LogWindow, log_text)
0488 
0489 <span class="comment">% Store the persistent preferences:</span>
0490 <span class="comment">% ---------------------------------</span>
0491 guiprefs.iric_file = iric_file;
0492 guiprefs.iric_path = iric_path;
0493 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0494 <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'iric'</span>)
0495 
0496 <span class="comment">% [EOF] menuSaveANVFile_Callback</span>
0497 
0498 <span class="comment">% --------------------------------------------------------------------</span>
0499 <a name="_sub21" href="#_subfunctions" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a>
0500 <span class="comment">% Get the Application Data:</span>
0501 <span class="comment">% -------------------------</span>
0502 guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0503 guiprefs    = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0504 excel_path  = guiprefs.excel_path;
0505 excel_file  = guiprefs.excel_file;
0506 
0507 <span class="comment">% Push messages to Log Window:</span>
0508 <span class="comment">% ----------------------------</span>
0509 log_text = {<span class="string">'Exporting Excel File (reprocessing dataset; this will create new plots)'</span>};
0510 statusLogging(handles.LogWindow, log_text)
0511 
0512 <span class="comment">% If there are multiple MAT files loaded, go ahead and export just the DAV</span>
0513 <span class="comment">% data.</span>
0514 <span class="keyword">if</span> iscell(guiparams.mat_file)
0515     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0516     <a href="#_sub51" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0517     <span class="comment">% Refresh the Application Data:</span>
0518     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0519     z           = guiparams.z;
0520     A           = guiparams.A;
0521     V           = guiparams.V;
0522     Map         = guiparams.Map;
0523     wse         = guiparams.wse;
0524     PVdata      = guiparams.iric_anv_planview_data;
0525     log_text = {<span class="string">'Writing data to Excel file...'</span>;<span class="keyword">...</span>
0526         <span class="string">'Multiple transected loaded. Will export Planview Data Only!'</span>};
0527     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
0528         fullfile(excel_path,excel_file));
0529     
0530     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0531         outfile = fullfile(excel_path,excel_file);
0532         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0533         
0534     <span class="keyword">else</span>
0535         <span class="comment">% Return default excel_path and excel_file</span>
0536         excel_path = guiprefs.excel_path;
0537         excel_file = guiprefs.excel_file;
0538         outfile = fullfile(excel_path,excel_file);
0539         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0540     <span class="keyword">end</span>
0541     
0542     <span class="comment">% Delete the old file if it exists</span>
0543     <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
0544         log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
0545             [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
0546             <span class="string">'already exists. Overwriting file...'</span>});
0547         delete(outfile)
0548     <span class="keyword">end</span>
0549     
0550     <span class="comment">% Save DAV data to an Excel File</span>
0551     hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
0552     vmin = num2str(guiparams.depth_range_min);
0553     vmax = num2str(guiparams.depth_range_max);
0554     pvheaders = {<span class="keyword">...</span>
0555         <span class="string">'UTM_East'</span> <span class="string">'UTM_North'</span> <span class="string">'Elev_m'</span><span class="keyword">...</span>
0556         [<span class="string">'EastDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0557         [<span class="string">'NorthDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]};
0558     pvdata = num2cell(PVdata.outmat');
0559     pvout = vertcat(pvheaders,pvdata);
0560     xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
0561     waitbar(4/5,hwait)
0562     
0563     <span class="comment">% Push messages to Log Window:</span>
0564     <span class="comment">% ----------------------------</span>
0565     statusLogging(handles.LogWindow, log_text)
0566 <span class="keyword">else</span>
0567     
0568     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0569     <a href="#_sub51" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0570     <a href="#_sub52" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
0571     <span class="comment">% Refresh the Application Data:</span>
0572     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0573     z           = guiparams.z;
0574     A           = guiparams.A;
0575     V           = guiparams.V;
0576     Map         = guiparams.Map;
0577     wse         = guiparams.wse;
0578     PVdata      = guiparams.iric_anv_planview_data;
0579     
0580     
0581     log_text = {<span class="string">'Writing data to Excel file...'</span>};
0582     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
0583         fullfile(excel_path,excel_file));
0584     
0585     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0586         outfile = fullfile(excel_path,excel_file);
0587         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0588         
0589         <span class="comment">% Delete the old file if it exists</span>
0590         <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
0591             log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
0592                 [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
0593                 <span class="string">'already exists. Overwriting file...'</span>});
0594             delete(outfile)
0595         <span class="keyword">end</span>
0596         
0597         <span class="comment">% Push messages to Log Window:</span>
0598         <span class="comment">% ----------------------------</span>
0599         statusLogging(handles.LogWindow, log_text)
0600         
0601         <span class="comment">% Save MCS Summary to an Excel File</span>
0602         hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
0603         xlswrite(outfile,{<span class="string">'Files:'</span>},<span class="string">'VMTSummary'</span>,<span class="string">'H4'</span>); waitbar(1/5,hwait)
0604         sout = guiparams.data_files';
0605         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'I4'</span>); waitbar(2/5,hwait)
0606         sout = {<span class="keyword">...</span>
0607             <span class="string">'VMT: Summary of Mean Cross Section'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0608             <span class="string">'VMT '</span> guiparams.vmt_version <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0609             <span class="string">'Date Processed: '</span> datestr(now) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0610             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0611             <span class="string">'Mean Cross Section (MCS) Properties'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0612             <span class="string">'Horz. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.horizontal_grid_node_spacing;<span class="keyword">...</span>
0613             <span class="string">'Vert. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> single(guiparams.A(1).Sup.binSize_cm)/100;<span class="keyword">...</span>
0614             <span class="string">'Endpoints:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">'UTM_East'</span>    <span class="string">'UTM_North'</span>;<span class="keyword">...</span>
0615             <span class="string">'Left Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xLeftBank V.yLeftBank;<span class="keyword">...</span>
0616             <span class="string">'Right Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xRightBank V.yRightBank;<span class="keyword">...</span>
0617             <span class="string">'Total Length in meters'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.dl;<span class="keyword">...</span>
0618             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0619             <span class="string">'Mean Flow Direction (deg)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.mfd;<span class="keyword">...</span>
0620             <span class="string">'in geographic coordinates'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0621             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0622             <span class="string">'Slope'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.m;<span class="keyword">...</span>
0623             <span class="string">'Intercept'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.b;<span class="keyword">...</span>
0624             <span class="string">'Theta (deg)'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.theta};
0625         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'A1'</span>); waitbar(3/5,hwait)
0626         
0627         <span class="comment">% Save DAV data to an Excel File</span>
0628         vmin = num2str(guiparams.depth_range_min);
0629         vmax = num2str(guiparams.depth_range_max);
0630         pvheaders = {<span class="keyword">...</span>
0631             <span class="string">'UTM_East'</span> <span class="string">'UTM_North'</span> <span class="string">'Elev_m'</span><span class="keyword">...</span>
0632             [<span class="string">'EastDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0633             [<span class="string">'NorthDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]};
0634         pvdata = num2cell(PVdata.outmat');
0635         pvout = vertcat(pvheaders,pvdata);
0636         xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
0637         waitbar(4/5,hwait)
0638         
0639         <span class="comment">% Save MCS data to an Excel File</span>
0640         mcsheaders = {<span class="keyword">...</span>
0641             <span class="string">'UTM_East'</span> <span class="keyword">...</span>
0642             <span class="string">'UTM_North'</span><span class="keyword">...</span>
0643             <span class="string">'Distance from Left Bank, in meters'</span><span class="keyword">...</span>
0644             <span class="string">'Elevation, in meters'</span><span class="keyword">...</span>
0645             <span class="string">'Bed Elevation, in meters'</span><span class="keyword">...</span>
0646             <span class="string">'East Velocity, in cm/s'</span><span class="keyword">...</span>
0647             <span class="string">'North Velocity, in cm/s'</span><span class="keyword">...</span>
0648             <span class="string">'Vertical Velocity, in cm/s'</span><span class="keyword">...</span>
0649             <span class="string">'Velocity Magnitude, in cm/s'</span><span class="keyword">...</span>
0650             <span class="string">'Velocity Direction, in degrees (geographic coordinates)'</span><span class="keyword">...</span>
0651             <span class="string">'Streamwise Velocity, in cm/s'</span><span class="keyword">...</span>
0652             <span class="string">'Transverse Velocity, in cm/s'</span><span class="keyword">...</span>
0653             <span class="string">'Primary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
0654             <span class="string">'Secondary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
0655             <span class="string">'Primary Velocity (roz), in cm/s'</span><span class="keyword">...</span>
0656             <span class="string">'Secondary Velocity (roz), in cm/s'</span>};
0657         
0658         mcsdata = [<span class="keyword">...</span>
0659             V.mcsX(:)<span class="keyword">...</span>
0660             V.mcsY(:)<span class="keyword">...</span>
0661             V.mcsDist(:)<span class="keyword">...</span>
0662             (wse - V.mcsDepth(:))<span class="keyword">...</span>
0663             repmat((wse - V.mcsBed(:)),size(V.mcsX,1),1)<span class="keyword">...</span>
0664             V.mcsEast(:)<span class="keyword">...</span>
0665             V.mcsNorth(:)<span class="keyword">...</span>
0666             V.mcsVert(:)<span class="keyword">...</span>
0667             V.mcsMag(:)<span class="keyword">...</span>
0668             V.mcsDir(:)<span class="keyword">...</span>
0669             V.u(:)<span class="keyword">...</span>
0670             V.v(:)<span class="keyword">...</span>
0671             V.vp(:)<span class="keyword">...</span>
0672             V.vs(:)<span class="keyword">...</span>
0673             V.Roz.up(:)<span class="keyword">...</span>
0674             V.Roz.us(:)];
0675         mcsdata(isnan(mcsdata)) = -9999;
0676         
0677         mcsout = vertcat(mcsheaders,num2cell(mcsdata));
0678         xlswrite(outfile,mcsout,<span class="string">'MeanCrossSection'</span>);
0679         waitbar(1,hwait)
0680         delete(hwait)
0681         
0682     <span class="keyword">else</span>
0683         <span class="comment">% Return default excel_path and excel_file</span>
0684         excel_path = guiprefs.excel_path;
0685         excel_file = guiprefs.excel_file;
0686         outfile = fullfile(excel_path,excel_file);
0687         log_text = {<span class="string">'User aborted Excel export...'</span>};
0688     <span class="keyword">end</span>
0689     
0690     
0691     
0692 <span class="keyword">end</span>
0693 
0694 <span class="comment">% Push messages to Log Window:</span>
0695 <span class="comment">% ----------------------------</span>
0696 statusLogging(handles.LogWindow, log_text)
0697 
0698 <span class="comment">% Store the persistent preferences:</span>
0699 <span class="comment">% ---------------------------------</span>
0700 guiprefs.excel_file = excel_file;
0701 guiprefs.excel_path = excel_path;
0702 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0703 <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'excel'</span>)
0704 
0705 <span class="comment">% [EOF] menuSaveExcel_Callback</span>
0706 
0707 <span class="comment">% --------------------------------------------------------------------</span>
0708 <a name="_sub22" href="#_subfunctions" class="code">function menuParameters_Callback(hObject, eventdata, handles)</a>
0709 <span class="comment">% Empty</span>
0710 
0711 <span class="comment">% --------------------------------------------------------------------</span>
0712 <a name="_sub23" href="#_subfunctions" class="code">function menuProcessingParameters_Callback(hObject, eventdata, handles)</a>
0713 <span class="comment">% Empty</span>
0714 
0715 <span class="comment">% --------------------------------------------------------------------</span>
0716 <a name="_sub24" href="#_subfunctions" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a>
0717 <span class="comment">% Turn ON or OFF Unit Discharge Correction</span>
0718 
0719 <span class="comment">% Get the Application Data:</span>
0720 <span class="comment">% -------------------------</span>
0721 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0722 
0723 <span class="comment">% Update the GUI &amp; Application Data:</span>
0724 <span class="comment">% ----------------------------------</span>
0725 status = get(handles.menuUnitDischargeCorrection,<span class="string">'Checked'</span>);
0726 <span class="keyword">switch</span> status
0727     <span class="keyword">case</span> <span class="string">'on'</span> <span class="comment">% Turn it off</span>
0728         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0729         guiparams.unit_discharge_correction = false;
0730     <span class="keyword">case</span> <span class="string">'off'</span> <span class="comment">% Turn it on</span>
0731         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0732         guiparams.unit_discharge_correction = true;
0733 <span class="keyword">end</span>
0734 
0735 <span class="comment">% Re-store the Application data:</span>
0736 <span class="comment">% ------------------------------</span>
0737 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0738 
0739 
0740 <span class="comment">%  [EOF] menuUnitDischargeCorrection_Callback</span>
0741 
0742 <span class="comment">% --------------------------------------------------------------------</span>
0743 <a name="_sub25" href="#_subfunctions" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a>
0744 <span class="comment">% Empty</span>
0745 
0746 <span class="comment">% --------------------------------------------------------------------</span>
0747 <a name="_sub26" href="#_subfunctions" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a>
0748 <span class="comment">% Empty</span>
0749 
0750 <span class="comment">% --------------------------------------------------------------------</span>
0751 <a name="_sub27" href="#_subfunctions" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a>
0752 <span class="comment">% Set the Plotting Parameter Units to &quot;metric&quot;</span>
0753 
0754 <span class="comment">% Get the Application Data:</span>
0755 <span class="comment">% -------------------------</span>
0756 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0757 
0758 <span class="comment">% Update the Application Data:</span>
0759 <span class="comment">% ----------------------------</span>
0760 guiparams.english_units = false;
0761 
0762 <span class="comment">% Re-store the Application data:</span>
0763 <span class="comment">% ------------------------------</span>
0764 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0765 
0766 <span class="comment">% Update the GUI:</span>
0767 <span class="comment">% ---------------</span>
0768 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0769 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
0770 
0771 <span class="comment">% [EOF] menuMetric_Callback</span>
0772 
0773 
0774 <span class="comment">% --------------------------------------------------------------------</span>
0775 <a name="_sub28" href="#_subfunctions" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a>
0776 <span class="comment">% Set the Plotting Parameter Units to &quot;english&quot;</span>
0777 
0778 <span class="comment">% Get the Application Data:</span>
0779 <span class="comment">% -------------------------</span>
0780 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0781 
0782 <span class="comment">% Update the Application Data:</span>
0783 <span class="comment">% ----------------------------</span>
0784 guiparams.english_units = true;
0785 
0786 <span class="comment">% Re-store the Application data:</span>
0787 <span class="comment">% ------------------------------</span>
0788 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0789 
0790 <span class="comment">% Update the GUI:</span>
0791 <span class="comment">% ---------------</span>
0792 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0793 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
0794 
0795 <span class="comment">% [EOF] menuEnglish_Callback</span>
0796 
0797 
0798 <span class="comment">% --------------------------------------------------------------------</span>
0799 <a name="_sub29" href="#_subfunctions" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
0800 <span class="comment">% Empty</span>
0801 
0802 <span class="comment">% --------------------------------------------------------------------</span>
0803 <a name="_sub30" href="#_subfunctions" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a>
0804 <span class="comment">% Set cross-section endpoints automatically</span>
0805 
0806 <span class="comment">% Get the Application Data:</span>
0807 <span class="comment">% -------------------------</span>
0808 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0809 
0810 <span class="comment">% Update the Application Data:</span>
0811 <span class="comment">% ----------------------------</span>
0812 guiparams.set_cross_section_endpoints = false;
0813 
0814 <span class="comment">% Re-store the Application data:</span>
0815 <span class="comment">% ------------------------------</span>
0816 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0817 
0818 <span class="comment">% Update the GUI:</span>
0819 <span class="comment">% ---------------</span>
0820 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0821 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0822 
0823 <span class="comment">% [EOF] menuCrossSectionEndpointAutomatic_Callback</span>
0824 
0825 
0826 <span class="comment">% --------------------------------------------------------------------</span>
0827 <a name="_sub31" href="#_subfunctions" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a>
0828 <span class="comment">% Set cross-section endpoints manually</span>
0829 
0830 <span class="comment">% Get the Application Data:</span>
0831 <span class="comment">% -------------------------</span>
0832 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0833 
0834 <span class="comment">% Update the Application Data:</span>
0835 <span class="comment">% ----------------------------</span>
0836 guiparams.set_cross_section_endpoints = true;
0837 
0838 <span class="comment">% Re-store the Application data:</span>
0839 <span class="comment">% ------------------------------</span>
0840 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0841 
0842 <span class="comment">% Update the GUI:</span>
0843 <span class="comment">% ---------------</span>
0844 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0845 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0846 
0847 <span class="comment">% [EOF] menuCrossSectionEndpointManual_Callback</span>
0848 
0849 
0850 
0851 
0852 <span class="comment">% --------------------------------------------------------------------</span>
0853 <a name="_sub32" href="#_subfunctions" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a>
0854 <span class="comment">% Empty</span>
0855 
0856 <span class="comment">% --------------------------------------------------------------------</span>
0857 <a name="_sub33" href="#_subfunctions" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a>
0858 
0859 <span class="comment">% Get the Application Data:</span>
0860 <span class="comment">% -------------------------</span>
0861 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0862 
0863 <span class="comment">% Update the Application Data:</span>
0864 <span class="comment">% ----------------------------</span>
0865 guiparams.print        = true;
0866 guiparams.presentation = false;
0867 
0868 <span class="comment">% Re-store the Application data:</span>
0869 <span class="comment">% ------------------------------</span>
0870 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0871 
0872 <span class="comment">% Update the GUI:</span>
0873 <span class="comment">% ---------------</span>
0874 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0875 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0876 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0877 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
0878 
0879 <span class="comment">% Modify the existing figures</span>
0880 <span class="comment">% ---------------------------</span>
0881 <span class="comment">% Find what plots exist already</span>
0882 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0883 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0884 
0885 <span class="comment">% Defaults for Print Stlye Figure</span>
0886 BkgdColor   = <span class="string">'white'</span>;
0887 AxColor     = <span class="string">'black'</span>;
0888 FigColor    = <span class="string">'white'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
0889 FntSize     = 14;
0890 
0891 <span class="comment">% Loop through valid figures and adjust</span>
0892 <span class="comment">% -------------------------------------</span>
0893 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0894     
0895     <span class="keyword">for</span> i = 1:length(valid_names)
0896         <span class="keyword">switch</span> valid_names{i}
0897             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
0898                 <span class="comment">% Focus the figure</span>
0899                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0900                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0901                     figure(hff)
0902                     
0903                     <span class="comment">% Make the changes to figure</span>
0904                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
0905                     set(gca,<span class="string">'FontSize'</span>,FntSize)
0906                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
0907                     set(gca,<span class="string">'Color'</span>,FigColor)
0908                     set(gca,<span class="string">'XColor'</span>,AxColor)
0909                     set(gca,<span class="string">'YColor'</span>,AxColor)
0910                     set(gca,<span class="string">'ZColor'</span>,AxColor)
0911                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
0912                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0913                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0914                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0915                 <span class="keyword">end</span>
0916             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
0917                 <span class="comment">% Focus the figure</span>
0918                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0919                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0920                     figure(hff)
0921                     
0922                     <span class="comment">% Make the changes to figure</span>
0923                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
0924                     set(gca,<span class="string">'FontSize'</span>,FntSize)
0925                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
0926                     set(gca,<span class="string">'Color'</span>,FigColor)
0927                     set(gca,<span class="string">'XColor'</span>,AxColor)
0928                     set(gca,<span class="string">'YColor'</span>,AxColor)
0929                     set(gca,<span class="string">'ZColor'</span>,AxColor)
0930                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
0931                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0932                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0933                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0934                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
0935                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
0936                 <span class="keyword">end</span>
0937             <span class="keyword">otherwise</span>
0938         <span class="keyword">end</span>
0939     <span class="keyword">end</span>
0940     
0941     
0942 <span class="keyword">end</span>
0943 
0944 
0945 <span class="comment">%[EOF] menuStylePrint_Callback</span>
0946 
0947 
0948 <span class="comment">% --------------------------------------------------------------------</span>
0949 <a name="_sub34" href="#_subfunctions" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a>
0950 <span class="comment">% Get the Application Data:</span>
0951 <span class="comment">% -------------------------</span>
0952 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0953 
0954 <span class="comment">% Update the Application Data:</span>
0955 <span class="comment">% ----------------------------</span>
0956 guiparams.print        = false;
0957 guiparams.presentation = true;
0958 
0959 <span class="comment">% Re-store the Application data:</span>
0960 <span class="comment">% ------------------------------</span>
0961 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0962 
0963 <span class="comment">% Update the GUI:</span>
0964 <span class="comment">% ---------------</span>
0965 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0966 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0967 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0968 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
0969 
0970 <span class="comment">% Modify the existing figures</span>
0971 <span class="comment">% ---------------------------</span>
0972 <span class="comment">% Find what plots exist already</span>
0973 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0974 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0975 
0976 <span class="comment">% Defaults for Presentation Stlye Figure</span>
0977 <span class="comment">% --------------------------------------</span>
0978 BkgdColor   = <span class="string">'black'</span>;
0979 AxColor     = <span class="string">'white'</span>;
0980 FigColor    = <span class="string">'black'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
0981 FntSize     = 14;
0982 
0983 <span class="comment">% Loop through valid figures and adjust</span>
0984 <span class="comment">% -------------------------------------</span>
0985 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0986     
0987     <span class="keyword">for</span> i = 1:length(valid_names)
0988         <span class="keyword">switch</span> valid_names{i}
0989             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
0990                 <span class="comment">% Focus the figure</span>
0991                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0992                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0993                     figure(hff)
0994                     
0995                     <span class="comment">% Make the changes to figure</span>
0996                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
0997                     set(gca,<span class="string">'FontSize'</span>,FntSize)
0998                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
0999                     set(gca,<span class="string">'Color'</span>,FigColor)
1000                     set(gca,<span class="string">'XColor'</span>,AxColor)
1001                     set(gca,<span class="string">'YColor'</span>,AxColor)
1002                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1003                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1004                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1005                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1006                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1007                 <span class="keyword">end</span>
1008             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
1009                 <span class="comment">% Focus the figure</span>
1010                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
1011                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1012                     figure(hff)
1013                     
1014                     <span class="comment">% Make the changes to figure</span>
1015                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1016                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1017                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1018                     set(gca,<span class="string">'Color'</span>,[0.3 0.3 0.3]) <span class="comment">%FigColor)</span>
1019                     set(gca,<span class="string">'XColor'</span>,AxColor)
1020                     set(gca,<span class="string">'YColor'</span>,AxColor)
1021                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1022                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1023                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1024                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1025                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1026                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
1027                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
1028                 <span class="keyword">end</span>
1029             <span class="keyword">otherwise</span>
1030         <span class="keyword">end</span>
1031     <span class="keyword">end</span>
1032     
1033     
1034 <span class="keyword">end</span>
1035 
1036 <span class="comment">% [EOF] menuStylePresentation_Callback</span>
1037 
1038 <span class="comment">% --------------------------------------------------------------------</span>
1039 <a name="_sub35" href="#_subfunctions" class="code">function menuKMZExport_Callback(hObject, eventdata, handles)</a>
1040 
1041 <span class="comment">% Get the Application data:</span>
1042 <span class="comment">% -------------------------</span>
1043 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1044 
1045 <span class="comment">% Initialize the answer:</span>
1046 <span class="comment">% ----------------------</span>
1047 numstr = {num2str(guiparams.vertical_offset)};
1048 answer = NaN;
1049 <span class="keyword">while</span> isnan(answer)
1050     answer = inputdlg(<span class="string">'Vertical Offset (m)'</span>,<span class="string">'KMZ Export'</span>,1,numstr);
1051     
1052     <span class="keyword">if</span> isempty(answer) <span class="comment">% User hits &quot;Cancel&quot;</span>
1053         <span class="keyword">return</span>
1054     <span class="keyword">end</span>
1055     
1056     answer = str2double(answer); <span class="comment">% A non-numeric char will be NaN</span>
1057     <span class="comment">% A numeric char will be a double</span>
1058 <span class="keyword">end</span>
1059 
1060 <span class="comment">% Re-store the Application data:</span>
1061 <span class="comment">% ------------------------------</span>
1062 guiparams.vertical_offset = answer;
1063 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1064 
1065 <span class="comment">% [EOF] menuKMZExport_Callback</span>
1066 
1067 <span class="comment">% --------------------------------------------------------------------</span>
1068 <a name="_sub36" href="#_subfunctions" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a>
1069 <span class="comment">% Not implemented</span>
1070 
1071 <span class="comment">% --------------------------------------------------------------------</span>
1072 <a name="_sub37" href="#_subfunctions" class="code">function menuTools_Callback(hObject, eventdata, handles)</a>
1073 <span class="comment">% Empty</span>
1074 
1075 <span class="comment">% --------------------------------------------------------------------</span>
1076 <a name="_sub38" href="#_subfunctions" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a>
1077 ASCII2GIS_GUI
1078 <span class="comment">% [EOF] menuASCII2GIS_Callback</span>
1079 
1080 <span class="comment">% --------------------------------------------------------------------</span>
1081 <a name="_sub39" href="#_subfunctions" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a>
1082 
1083 <span class="comment">% Get the Application preferences:</span>
1084 <span class="comment">% --------------------------------</span>
1085 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1086 
1087 inpath = guiprefs.kmz_path;
1088 <span class="keyword">if</span> iscell(guiprefs.kmz_file)
1089     infile = guiprefs.kmz_file{1};
1090 <span class="keyword">else</span>
1091     infile = guiprefs.kmz_file;
1092 <span class="keyword">end</span>
1093 [log_text,outpath,outfile] = ASCII2KML(inpath,infile);
1094 
1095 guiprefs.kmz_path = outpath;
1096 guiprefs.kmz_file = outfile;
1097 
1098 <span class="comment">% Update persistent preferences</span>
1099 <span class="comment">% -----------------------------</span>
1100 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1101 
1102 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1103 
1104 <span class="comment">% --------------------------------------------------------------------</span>
1105 <a name="_sub40" href="#_subfunctions" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a>
1106 <span class="comment">% Empty</span>
1107 
1108 <span class="comment">% --------------------------------------------------------------------</span>
1109 <a name="_sub41" href="#_subfunctions" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a>
1110 <span class="keyword">try</span>
1111     web(<span class="string">'http://code.google.com/p/velocity-mapping-tool/wiki/UserGuide?tm=6'</span>)
1112 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
1113     <span class="keyword">if</span> isdeployed
1114         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1115             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1116         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1117             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1118             errLogFileName},<span class="keyword">...</span>
1119             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1120             <span class="string">'error'</span>);
1121         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1122         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1123         fclose(fid);
1124         rethrow(err)
1125     <span class="keyword">else</span>
1126         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1127             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1128             <span class="string">'error'</span>);
1129         rethrow(err);
1130     <span class="keyword">end</span>
1131 <span class="keyword">end</span>
1132 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1133 
1134 <span class="comment">% --------------------------------------------------------------------</span>
1135 <a name="_sub42" href="#_subfunctions" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a>
1136 <span class="comment">% Get the Application data:</span>
1137 <span class="comment">% -------------------------</span>
1138 <span class="comment">% guiparams = getappdata(handles.figure1,'guiparams'); %#ok&lt;NASGU&gt;</span>
1139 
1140 <span class="keyword">try</span>
1141     <span class="comment">% Construct a URL to a local file which can be interpreted by any</span>
1142     <span class="comment">% web-browser</span>
1143     rootpath = strrep(pwd,filesep,<span class="string">'/'</span>);
1144     webaddress = [<span class="string">'file:///'</span> rootpath <span class="string">'/doc/index.html'</span>];
1145     system([<span class="string">'start '</span> webaddress]);
1146 <span class="comment">%     [stat,h,url] = web(webaddress) % Produced with m2html (FEX)</span>
1147 <span class="keyword">catch</span> err 
1148     <span class="keyword">if</span> isdeployed
1149         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1150             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1151         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1152             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1153             errLogFileName},<span class="keyword">...</span>
1154             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1155             <span class="string">'error'</span>);
1156         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1157         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1158         fclose(fid);
1159         rethrow(err)
1160     <span class="keyword">else</span>
1161         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1162             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1163             <span class="string">'error'</span>);
1164         rethrow(err);
1165     <span class="keyword">end</span>
1166 <span class="keyword">end</span>
1167 
1168 <span class="comment">% [EOF] menuFunctionLibrary_Callback</span>
1169 
1170 <span class="comment">% --------------------------------------------------------------------</span>
1171 <a name="_sub43" href="#_subfunctions" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a>
1172 
1173 <span class="comment">% Get the Application data:</span>
1174 <span class="comment">% -------------------------</span>
1175 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1176 
1177 <span class="comment">% Check version tag against the web, and display a message</span>
1178 <span class="keyword">try</span>
1179     current_vmt_version = urlread(<span class="string">'http://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt'</span>);
1180     <span class="comment">%     current_vmt_version = urlread('http://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt');</span>
1181 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
1182     <span class="keyword">if</span> isdeployed
1183         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1184             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1185         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1186             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1187             errLogFileName},<span class="keyword">...</span>
1188             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1189             <span class="string">'error'</span>);
1190         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1191         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1192         fclose(fid);
1193         rethrow(err)
1194     <span class="keyword">else</span>
1195         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1196             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1197             <span class="string">'error'</span>);
1198         rethrow(err);
1199     <span class="keyword">end</span>
1200 <span class="keyword">end</span>
1201 
1202 <span class="keyword">if</span> strcmpi(guiparams.vmt_version,current_vmt_version)
1203     h = msgbox(<span class="string">'VMT is currently up to date, no updates available.'</span>,<span class="string">'Check for updates'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1204 <span class="keyword">else</span>
1205     h = msgbox(<span class="string">'VMT is out of date. Please visit the VMT homepage.'</span>,<span class="string">'Check for updates'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1206 <span class="keyword">end</span>
1207 <span class="comment">% [EOF] menuCheckForUpdates_Callback</span>
1208 
1209 <span class="comment">% --------------------------------------------------------------------</span>
1210 <a name="_sub44" href="#_subfunctions" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a>
1211 
1212 <span class="comment">% Get the Application data:</span>
1213 <span class="comment">% -------------------------</span>
1214 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1215 messagestr = <span class="keyword">...</span>
1216     {<span class="string">'The Velocity Mapping Toolbox'</span>;<span class="keyword">...</span>
1217     [<span class="string">'   Version: '</span> guiparams.vmt_version];<span class="keyword">...</span>
1218     <span class="string">''</span>;<span class="keyword">...</span>
1219     <span class="string">''</span>;<span class="keyword">...</span>
1220     <span class="string">'With collaborations from:'</span>;<span class="keyword">...</span>
1221     <span class="string">'   U.S. Geological Survey'</span>;<span class="keyword">...</span>
1222     <span class="string">'   University of Illinois'</span>;<span class="keyword">...</span>
1223     <span class="string">'   University of Hull'</span>;<span class="keyword">...</span>
1224     <span class="string">''</span>;<span class="keyword">...</span>
1225     <span class="string">''</span>;<span class="keyword">...</span>
1226     <span class="string">'Citation: '</span>;<span class="keyword">...</span>
1227     <span class="string">'   Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L.,'</span>;<span class="keyword">...</span>
1228     <span class="string">'   Rhoads, B. L., Oberg, K. A., Best, J. L., Mueller, D. S.,'</span>;<span class="keyword">...</span>
1229     <span class="string">'   Johnson, K. K. and Riley, J. D. (2013), Velocity Mapping'</span>;<span class="keyword">...</span>
1230     <span class="string">'   Toolbox (VMT): a processing and visualization suite for'</span>;<span class="keyword">...</span>
1231     <span class="string">'   moving-vessel ADCP measurements. Earth Surf. Process.'</span>;<span class="keyword">...</span>
1232     <span class="string">'   Landforms.doi: 10.1002/esp.3367'</span>};
1233 h = msgbox(messagestr,<span class="string">'About VMT'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1234 <span class="comment">% [EOF] menuAbout_Callback</span>
1235 
1236 
1237 
1238 
1239 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
1240 <span class="comment">% TOOLBAR CALLBACKS %</span>
1241 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
1242 
1243 <span class="comment">% --------------------------------------------------------------------</span>
1244 <a name="_sub45" href="#_subfunctions" class="code">function loadDataCallback(hObject, eventdata, handles)</a>
1245 <span class="comment">% Read Files into Data Structure using tfile.</span>
1246 
1247 <span class="comment">% Get the Application data:</span>
1248 <span class="comment">% -------------------------</span>
1249 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1250 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1251 
1252 <span class="comment">% Ask the user to select files:</span>
1253 <span class="comment">% -----------------------------</span>
1254 current_file = fullfile(guiprefs.ascii_path,guiprefs.ascii_file{1});
1255 [filename,pathname] = uigetfile({<span class="string">'*_ASC.TXT'</span>,<span class="string">'ASCII (*_ASC.TXT)'</span>}, <span class="keyword">...</span>
1256     <span class="string">'Select the ASCII Output Files'</span>, <span class="keyword">...</span>
1257     current_file, <span class="keyword">...</span>
1258     <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
1259 
1260 <span class="keyword">if</span> ischar(pathname) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
1261     guiparams.data_folder = pathname;
1262     <span class="keyword">if</span> ischar(filename)
1263         filename = {filename};
1264     <span class="keyword">end</span>
1265     guiparams.data_files = filename;
1266     guiparams.mat_file = <span class="string">''</span>;
1267     
1268     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1269     
1270    
1271     
1272     <span class="comment">% Update the preferences:</span>
1273     <span class="comment">% -----------------------</span>
1274     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1275     guiprefs.ascii_path = pathname;
1276     guiprefs.ascii_file = filename;
1277     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1278     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'ascii'</span>)
1279     
1280     <span class="comment">% Push messages to Log Window:</span>
1281     <span class="comment">% ----------------------------</span>
1282     log_text = {<span class="keyword">...</span>
1283         <span class="string">''</span>;<span class="keyword">...</span>
1284         [<span class="string">'%--- '</span> datestr(now) <span class="string">' ---%'</span>];<span class="keyword">...</span>
1285         <span class="string">'Current Project Directory:'</span>;<span class="keyword">...</span>
1286         guiparams.data_folder;
1287         <span class="string">'Loading the following files into memory:'</span>;<span class="keyword">...</span>
1288         char(filename)};
1289     statusLogging(handles.LogWindow, log_text)
1290     
1291     <span class="comment">% Read the file(s)</span>
1292     <span class="comment">% ----------------</span>
1293     [~,~,savefile,A,z] = <span class="keyword">...</span>
1294         <a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>(guiparams.data_folder,guiparams.data_files);
1295     guiparams.savefile = savefile;
1296     guiparams.A        = A;
1297     guiparams.z        = z;
1298     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1299 <span class="comment">%</span>
1300 <span class="comment">%     % Preprocess the data:</span>
1301 <span class="comment">%     % --------------------</span>
1302 <span class="comment">%     A = VMT_PreProcess(z,A);</span>
1303 <span class="comment">%</span>
1304 <span class="comment">%     % Push messages to Log Window:</span>
1305 <span class="comment">%     % ----------------------------</span>
1306 <span class="comment">%     log_text = {...</span>
1307 <span class="comment">%         '   Preprocessing complete.';...</span>
1308 <span class="comment">%         '   Begin Data Processing...'};</span>
1309 <span class="comment">%     statusLogging(handles.LogWindow, log_text)</span>
1310 <span class="comment">%</span>
1311 <span class="comment">%     A(1).hgns = guiparams.horizontal_grid_node_spacing;</span>
1312 <span class="comment">%     A(1).wse  = guiparams.wse;  %Set the WSE to entered value</span>
1313 <span class="comment">%     [A,V,processing_log_text] = VMT_ProcessTransects(z,A,...</span>
1314 <span class="comment">%         guiparams.set_cross_section_endpoints,...</span>
1315 <span class="comment">%         guiparams.unit_discharge_correction);</span>
1316 <span class="comment">%</span>
1317 <span class="comment">%     % Push messages to Log Window:</span>
1318 <span class="comment">%     % ----------------------------</span>
1319 <span class="comment">%     statusLogging(handles.LogWindow, processing_log_text)</span>
1320 <span class="comment">%</span>
1321 <span class="comment">%     % Store the data:</span>
1322 <span class="comment">%     % ---------------</span>
1323 <span class="comment">%     guiparams.z = z;</span>
1324 <span class="comment">%     guiparams.A = A;</span>
1325 <span class="comment">%     guiparams.V = V;</span>
1326 <span class="comment">%     setappdata(handles.figure1,'guiparams',guiparams)</span>
1327     
1328       
1329     <span class="comment">% Update the GUI:</span>
1330     <span class="comment">% ---------------</span>
1331     <a href="#_sub89" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
1332 <span class="keyword">end</span>
1333 <span class="comment">% [EOF] loadDataCallback</span>
1334 
1335 
1336 
1337 <span class="comment">% --------------------------------------------------------------------</span>
1338 <a name="_sub46" href="#_subfunctions" class="code">function saveDataCallback(hObject, eventdata, handles)</a>
1339 <span class="comment">% SaveMATFile_Callback(handles.SaveMATFile,eventdata,handles)</span>
1340 
1341 <span class="comment">% Get the Application data:</span>
1342 <span class="comment">% -------------------------</span>
1343 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1344 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1345 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1346 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1347 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
1348 
1349 [the_file,the_path] = <span class="keyword">...</span>
1350     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
1351     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
1352     fullfile(guiparams.mat_path,guiparams.savefile));
1353 
1354 <span class="comment">% Save the processed data to a MAT file:</span>
1355 <span class="comment">% --------------------------------------</span>
1356 <span class="keyword">if</span> ischar(the_file)
1357     guiparams.mat_path = the_path;
1358     guiparams.mat_file = the_file;
1359     guiparams.savefile = the_file;
1360     
1361     <span class="comment">% Re-store the Application data:</span>
1362     <span class="comment">% ------------------------------</span>
1363     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1364     
1365     <span class="comment">% Update the preferences:</span>
1366     <span class="comment">% -----------------------</span>
1367     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1368     guiprefs.mat_path = the_path;
1369     guiprefs.mat_file = the_file;
1370     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1371     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
1372     
1373     [pathstr,filename,extension] = fileparts([guiparams.mat_path guiparams.savefile]);
1374     savefile = fullfile(pathstr,[filename extension]);
1375     <span class="comment">%h = msgbox(['Saving processed data in MAT File ''' filename extension ''''], ...</span>
1376     <span class="comment">%    'Saving Processed Data File...'); %#ok&lt;NASGU&gt;</span>
1377     log_text = {<span class="keyword">...</span>
1378         <span class="string">'Saving Processed Data File...'</span>;<span class="keyword">...</span>
1379         savefile};
1380     statusLogging(handles.LogWindow,log_text)
1381     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
1382 <span class="keyword">end</span>
1383 
1384 <span class="comment">% [EOF] saveDataCallback</span>
1385 
1386 
1387 <span class="comment">% --------------------------------------------------------------------</span>
1388 <a name="_sub47" href="#_subfunctions" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a>
1389 
1390 <span class="comment">% Get the Application data:</span>
1391 <span class="comment">% -------------------------</span>
1392 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1393 z   = guiparams.z;
1394 A   = guiparams.A;
1395 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
1396 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
1397 
1398 <span class="comment">% Compute multibeam bathymetry:</span>
1399 <span class="comment">% -----------------------------</span>
1400 msgbox(<span class="string">'Processing Bathymetry...Please Be Patient'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
1401 <span class="comment">%A = VMT_MBBathy(z,A,savefile,handles.beam_angle,handles.MagneticVariation,handles.WSE);</span>
1402 <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>(z,A,savefile, <span class="keyword">...</span>
1403     guiparams.beam_angle, <span class="keyword">...</span>
1404     guiparams.magnetic_variation, <span class="keyword">...</span>
1405     guiparams.wse, <span class="keyword">...</span>
1406     guiparams.output_auxiliary_data);
1407 
1408 msgbox(<span class="string">'Bathymetry Output Complete'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
1409 
1410 <span class="comment">% [EOF] saveBathymetryCallback</span>
1411 
1412 <span class="comment">% --------------------------------------------------------------------</span>
1413 <a name="_sub48" href="#_subfunctions" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a>
1414 
1415 <span class="comment">% Get the Application data:</span>
1416 <span class="comment">% -------------------------</span>
1417 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1418 
1419 [guiparams.english_units,guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
1420     guiparams.presentation,guiparams.print] = <span class="keyword">...</span>
1421     plotParametersDialog(guiparams.english_units, <span class="keyword">...</span>
1422     guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
1423     guiparams.presentation,guiparams.print,<span class="keyword">...</span>
1424     handles.figure1);
1425 
1426 <span class="comment">% Update the GUI:</span>
1427 <span class="comment">% ---------------</span>
1428 <span class="keyword">if</span> guiparams.english_units
1429     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1430     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1431 <span class="keyword">else</span>
1432     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1433     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1434 <span class="keyword">end</span>
1435 
1436 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
1437     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1438     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1439 <span class="keyword">else</span>
1440     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1441     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1442 <span class="keyword">end</span>
1443 
1444 <span class="keyword">if</span> guiparams.presentation
1445     <a href="#_sub34" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
1446 <span class="comment">%     set(handles.menuStylePrint,           'Checked','off')</span>
1447 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','on')</span>
1448 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','off')</span>
1449 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','on')</span>
1450 <span class="keyword">else</span>
1451     <a href="#_sub33" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
1452 <span class="comment">%     set(handles.menuStylePrint,           'Checked','on')</span>
1453 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','off')</span>
1454 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','on')</span>
1455 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','off')</span>
1456 <span class="keyword">end</span>
1457 
1458 <span class="comment">% Re-store the Application data:</span>
1459 <span class="comment">% ------------------------------</span>
1460 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1461 
1462 <span class="comment">% [EOF] plottingParametersCallback</span>
1463 
1464 
1465 <span class="comment">% --------------------------------------------------------------------</span>
1466 <a name="_sub49" href="#_subfunctions" class="code">function processingParametersCallback(hObject, eventdata, handles)</a>
1467 
1468 <span class="comment">% Get the Application data:</span>
1469 <span class="comment">% -------------------------</span>
1470 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1471 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1472 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1473 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1474 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
1475 
1476 <span class="comment">% [EOF] processingParametersCallback</span>
1477 
1478 
1479 <span class="comment">% --------------------------------------------------------------------</span>
1480 <a name="_sub50" href="#_subfunctions" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a>
1481 <span class="comment">% Plot 1</span>
1482 
1483 <span class="comment">% Get the Application data:</span>
1484 <span class="comment">% -------------------------</span>
1485 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1486 z = guiparams.z;
1487 A = guiparams.A;
1488 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
1489 <span class="comment">% Map = guiparams.Map;</span>
1490 setends = guiparams.set_cross_section_endpoints;
1491 
1492 <span class="comment">% Preprocess the data:</span>
1493 <span class="comment">% --------------------</span>
1494 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
1495 
1496 <span class="comment">% Push messages to Log Window:</span>
1497 <span class="comment">% ----------------------------</span>
1498 log_text = {<span class="keyword">...</span>
1499     <span class="string">'   Preprocessing complete.'</span>;<span class="keyword">...</span>
1500     <span class="string">'   Begin Data Processing...'</span>};
1501 statusLogging(handles.LogWindow, log_text)
1502 
1503 <span class="comment">% Process the transects:</span>
1504 <span class="comment">% ----------------------</span>
1505 A(1).hgns = guiparams.horizontal_grid_node_spacing;
1506 A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
1507 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
1508     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction);
1509 
1510 <span class="comment">% Compute the smoothed variables</span>
1511 <span class="comment">% ------------------------------</span>
1512 <span class="comment">% This is required so that the V struc is complete at any point during</span>
1513 <span class="comment">% runtime.</span>
1514 V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
1515     <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
1516     guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
1517     guiparams.vertical_smoothing_window);
1518 
1519 <span class="comment">% Push messages to Log Window:</span>
1520 <span class="comment">% ----------------------------</span>
1521 statusLogging(handles.LogWindow, processing_log_text)
1522 
1523 <span class="comment">% Store the data:</span>
1524 <span class="comment">% ---------------</span>
1525 guiparams.z = z;
1526 guiparams.A = A;
1527 guiparams.V = V;
1528 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1529 
1530 <span class="comment">% Push messages to Log Window:</span>
1531 <span class="comment">% ----------------------------</span>
1532 log_text = {<span class="string">'Plotting Shiptracks (reprocessing)'</span>};
1533 statusLogging(handles.LogWindow, log_text)
1534 
1535 <span class="comment">% Create or replot the Shiptracks</span>
1536 <span class="comment">% -------------------------------</span>
1537 <span class="comment">% Grab the axes to the plot</span>
1538 <span class="comment">% axes(handles.Plot1Shiptracks);</span>
1539 <a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>(A,V,z,setends,handles.Plot1Shiptracks); <span class="comment">% PLOT 1</span>
1540 
1541 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
1542 <span class="comment">% New plot display window</span>
1543 <span class="comment">% h = VMT_CreatePlotDisplay('shiptracks');</span>
1544 <span class="comment">% h = figure(1); clf</span>
1545 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
1546 
1547 <span class="comment">% [EOF] shiptracksPlotCallback</span>
1548 
1549 
1550 <span class="comment">% --------------------------------------------------------------------</span>
1551 <a name="_sub51" href="#_subfunctions" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a>
1552 <span class="comment">% Plot 2</span>
1553 
1554 <span class="comment">% Get the Application data:</span>
1555 <span class="comment">% -------------------------</span>
1556 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1557 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1558 
1559 <span class="keyword">if</span> iscell(guiparams.mat_file) <span class="comment">% Multiple MAT files loaded</span>
1560     <span class="comment">% Push messages to Log Window:</span>
1561     <span class="comment">% ----------------------------</span>
1562     log_text = {<span class="string">'Plotting Multiple Transects (Planview)'</span>};
1563     statusLogging(handles.LogWindow, log_text)
1564     
1565        
1566     <span class="comment">% Push plotting parameters to log window:</span>
1567     <span class="comment">% ---------------------------------------</span>
1568     log_text = {<span class="keyword">...</span>
1569         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
1570         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
1571         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
1572         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
1573         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
1574         };
1575     statusLogging(handles.LogWindow, log_text)
1576     
1577     <span class="comment">% Plot the data:</span>
1578     <span class="comment">% --------------</span>
1579     z = [];
1580     A = [];
1581     V = [];
1582     Map = [];
1583     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
1584     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
1585         depth_range, <span class="keyword">...</span>
1586         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
1587         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
1588         guiparams.smoothing_window_size, <span class="keyword">...</span>
1589         guiparams.display_shoreline, <span class="keyword">...</span>
1590         guiparams.english_units, <span class="keyword">...</span>
1591         guiparams.mat_file, <span class="keyword">...</span>
1592         guiparams.mat_path); <span class="comment">% PLOT2</span>
1593     statusLogging(handles.LogWindow, log_text)
1594     
1595     <span class="comment">% Plot a Shoreline Map:</span>
1596     <span class="comment">% ---------------------</span>
1597     <span class="keyword">if</span> guiparams.display_shoreline
1598         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
1599             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
1600             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
1601             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
1602         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
1603             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
1604             Map.UTMe   = mapdata(:,1);
1605             Map.UTMn   = mapdata(:,2);
1606             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
1607             <span class="comment">%Map.UTMzone = zone;</span>
1608         <span class="keyword">else</span>
1609             Map = [];
1610         <span class="keyword">end</span>
1611         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
1612         log_text = {<span class="keyword">...</span>
1613             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
1614             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
1615             };
1616         statusLogging(handles.LogWindow, log_text)
1617     <span class="keyword">else</span>
1618         Map = [];
1619     <span class="keyword">end</span>
1620     
1621 <span class="keyword">else</span>
1622     z = guiparams.z;
1623     A = guiparams.A;
1624     <span class="comment">% V = guiparams.V;</span>
1625     Map = guiparams.Map;
1626     
1627     <span class="comment">% Push messages to Log Window:</span>
1628     <span class="comment">% ----------------------------</span>
1629     log_text = {<span class="string">'Plotting Depth Averaged Vectors (reprocessing)'</span>};
1630     statusLogging(handles.LogWindow, log_text)
1631     
1632         
1633     <span class="comment">% Preprocess the data:</span>
1634     <span class="comment">% --------------------</span>
1635     A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
1636     
1637     <span class="comment">% Process the transects:</span>
1638     <span class="comment">% ----------------------</span>
1639     A(1).hgns = guiparams.horizontal_grid_node_spacing;
1640     A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
1641     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
1642         guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction);
1643     
1644     <span class="comment">% Compute the smoothed variables</span>
1645     <span class="comment">% ------------------------------</span>
1646     <span class="comment">% This is required so that the V struc is complete at any point during</span>
1647     <span class="comment">% runtime.</span>
1648     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
1649         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
1650         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
1651         guiparams.vertical_smoothing_window);
1652     
1653     <span class="comment">% Push messages to Log Window:</span>
1654     <span class="comment">% ----------------------------</span>
1655     statusLogging(handles.LogWindow, processing_log_text)
1656     
1657     <span class="comment">% Plot the cross section:</span>
1658     <span class="comment">% -----------------------</span>
1659     log_text = {<span class="keyword">...</span>
1660         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
1661         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
1662         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
1663         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
1664         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
1665         };
1666     statusLogging(handles.LogWindow, log_text)
1667     
1668     <span class="comment">% Plot the data:</span>
1669     <span class="comment">% --------------</span>
1670     <span class="comment">%msgbox('Plotting Plan View','VMT Status','help','replace');</span>
1671     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
1672     
1673     
1674     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
1675         depth_range, <span class="keyword">...</span>
1676         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
1677         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
1678         guiparams.smoothing_window_size, <span class="keyword">...</span>
1679         guiparams.display_shoreline, <span class="keyword">...</span>
1680         guiparams.english_units, <span class="keyword">...</span>
1681         guiparams.mat_file, <span class="keyword">...</span>
1682         guiparams.mat_path); <span class="comment">% PLOT2</span>
1683     statusLogging(handles.LogWindow, log_text)
1684     
1685     <span class="comment">% Plot a Shoreline Map:</span>
1686     <span class="comment">% ---------------------</span>
1687     <span class="keyword">if</span> guiparams.display_shoreline
1688         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
1689             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
1690             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
1691             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
1692         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
1693             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
1694             Map.UTMe   = mapdata(:,1);
1695             Map.UTMn   = mapdata(:,2);
1696             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
1697             <span class="comment">%Map.UTMzone = zone;</span>
1698         <span class="keyword">else</span>
1699             Map = [];
1700         <span class="keyword">end</span>
1701         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
1702         log_text = {<span class="keyword">...</span>
1703             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
1704             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
1705             };
1706         statusLogging(handles.LogWindow, log_text)
1707     <span class="keyword">else</span>
1708         Map = [];
1709     <span class="keyword">end</span>
1710     
1711 <span class="keyword">end</span>
1712 
1713 <span class="keyword">if</span> guiparams.add_background
1714     [guiprefs,log_text] = <a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>(guiprefs);
1715     statusLogging(handles.LogWindow, log_text)
1716 <span class="keyword">end</span>
1717 
1718 <span class="comment">% Update guiparams</span>
1719 <span class="comment">% ----------------</span>
1720 guiparams.z   = z;
1721 guiparams.A   = A;
1722 guiparams.V   = V;
1723 guiparams.Map = Map;
1724 guiparams.iric_anv_planview_data = PVdata;
1725 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams);
1726 
1727 <span class="comment">% Update preferences</span>
1728 <span class="comment">% ------------------</span>
1729 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1730 <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'shoreline'</span>)
1731 <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'aerial'</span>)
1732 
1733 <span class="comment">% Force plot to be formated properly</span>
1734 <span class="comment">% ----------------------------------</span>
1735 <span class="keyword">if</span> guiparams.presentation
1736     <a href="#_sub34" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
1737 <span class="keyword">else</span>
1738     <a href="#_sub33" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
1739 <span class="keyword">end</span>
1740 
1741 <span class="comment">% Start the Graphics Control Gui</span>
1742 <span class="comment">% ------------------------------</span>
1743 VMT_GraphicsControl
1744 
1745 <span class="comment">% [EOF] planviewPlotCallback</span>
1746 
1747 
1748 <span class="comment">% --------------------------------------------------------------------</span>
1749 <a name="_sub52" href="#_subfunctions" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a>
1750 <span class="comment">% Plot 3</span>
1751 
1752 <span class="comment">% Get the Application data:</span>
1753 <span class="comment">% -------------------------</span>
1754 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1755 z = guiparams.z;
1756 A = guiparams.A;
1757 <span class="comment">% V = guiparams.V;</span>
1758 <span class="comment">% Map = guiparams.Map;</span>
1759 
1760 <span class="comment">% Preprocess the data:</span>
1761 <span class="comment">% --------------------</span>
1762 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
1763 
1764 <span class="comment">% Push messages to Log Window:</span>
1765 <span class="comment">% ----------------------------</span>
1766 log_text = {<span class="string">'Plotting Cross Section (reprocessing)'</span>};
1767 statusLogging(handles.LogWindow, log_text)
1768 
1769 <span class="comment">% Process the transects:</span>
1770 <span class="comment">% ----------------------</span>
1771 A(1).hgns = guiparams.horizontal_grid_node_spacing;
1772 A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
1773 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
1774     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction);
1775 
1776 <span class="comment">% Push messages to Log Window:</span>
1777 <span class="comment">% ----------------------------</span>
1778 statusLogging(handles.LogWindow, processing_log_text)
1779 
1780 <span class="comment">% Plot the cross section:</span>
1781 <span class="comment">% -----------------------</span>
1782 log_text = {<span class="keyword">...</span>
1783     <span class="string">'Cross Section Plotting Parameters'</span>;<span class="keyword">...</span>
1784     sprintf(<span class="string">'   Contour variable: %s'</span>          ,guiparams.contours(guiparams.idx_contour).string);<span class="keyword">...</span>
1785     sprintf(<span class="string">'   Vertical exaggeration: %d'</span>     ,guiparams.vertical_exaggeration);<span class="keyword">...</span>
1786     sprintf(<span class="string">'   Vector scale: %3.1f'</span>           ,guiparams.vector_scale_cross_section);<span class="keyword">...</span>
1787     sprintf(<span class="string">'   Horizontal vector spacing: %d'</span> ,guiparams.horizontal_vector_spacing);<span class="keyword">...</span>
1788     sprintf(<span class="string">'   Vertical vector spacing: %d'</span>   ,guiparams.vertical_vector_spacing);<span class="keyword">...</span>
1789     sprintf(<span class="string">'   Horizontal smooting window: %d'</span>,guiparams.horizontal_smoothing_window);<span class="keyword">...</span>
1790     sprintf(<span class="string">'   Vertical smoothing window: %d'</span> ,guiparams.vertical_smoothing_window);<span class="keyword">...</span>
1791     };
1792 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
1793     log_text = vertcat(log_text, {<span class="keyword">...</span>
1794         sprintf(<span class="string">'   Vector variable: %s'</span>,guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).string);<span class="keyword">...</span>
1795         sprintf(<span class="string">'   Inc. vertical component?: %d'</span>,guiparams.include_vertical_velocity)<span class="keyword">...</span>
1796         });
1797 <span class="keyword">end</span>
1798 <span class="comment">% Push messages to Log Window:</span>
1799 <span class="comment">% ----------------------------</span>
1800 statusLogging(handles.LogWindow, log_text)
1801 
1802 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
1803     <span class="comment">%msgbox('Plotting Cross Section','VMT Status','help','replace')</span>
1804 <span class="comment">%     V = VMT_SmoothVar(V, ...</span>
1805 <span class="comment">%         ...guiparams.contour, ...</span>
1806 <span class="comment">%         guiparams.horizontal_smoothing_window, ...</span>
1807 <span class="comment">%         guiparams.vertical_smoothing_window);</span>
1808     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
1809         <span class="keyword">...</span><span class="comment">guiparams.secondary_flow_vector_variable, ...</span>
1810         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
1811         guiparams.vertical_smoothing_window);
1812     [~,A,V,plot_cont_log_text] = <a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,varargin)">VMT_PlotXSContQuiver</a>(z,A,V, <span class="keyword">...</span>
1813         guiparams.contour, <span class="keyword">...</span>
1814         guiparams.vector_scale_cross_section, <span class="keyword">...</span>
1815         guiparams.vertical_exaggeration, <span class="keyword">...</span>
1816         guiparams.horizontal_vector_spacing, <span class="keyword">...</span>
1817         guiparams.vertical_vector_spacing, <span class="keyword">...</span>
1818         guiparams.secondary_flow_vector_variable, <span class="keyword">...</span>
1819         guiparams.include_vertical_velocity, <span class="keyword">...</span>
1820         guiparams.english_units); <span class="comment">%#ok&lt;ASGLU&gt; % PLOT3</span>
1821     
1822 <span class="keyword">elseif</span> ~guiparams.plot_secondary_flow_vectors
1823     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
1824         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
1825         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
1826         guiparams.vertical_smoothing_window);
1827     
1828     [~,A,V,zmin,zmax,plot_cont_log_text] = <a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english)">VMT_PlotXSCont</a>(z,A,V, <span class="keyword">...</span>
1829         guiparams.contour, <span class="keyword">...</span>
1830         guiparams.vertical_exaggeration, <span class="keyword">...</span>
1831         guiparams.english_units);  <span class="comment">%#ok&lt;ASGLU&gt;</span>
1832     
1833     guiparams.zmin = zmin;
1834     guiparams.zmax = zmax;
1835     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1836 <span class="keyword">end</span>
1837 
1838 <span class="comment">% Force plot to be formated properly</span>
1839 <span class="comment">% ----------------------------------</span>
1840 <span class="keyword">if</span> guiparams.presentation
1841     <a href="#_sub34" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
1842 <span class="keyword">else</span>
1843     <a href="#_sub33" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
1844 <span class="keyword">end</span>
1845 
1846 <span class="comment">% Re-store the Application data:</span>
1847 <span class="comment">% ------------------------------</span>
1848 guiparams.V = V;
1849 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1850 
1851 <span class="comment">% Start the Graphics Control Gui</span>
1852 <span class="comment">% ------------------------------</span>
1853 VMT_GraphicsControl
1854 
1855 <span class="comment">% Push messages to Log Window:</span>
1856 <span class="comment">% ----------------------------</span>
1857 statusLogging(handles.LogWindow, plot_cont_log_text)
1858 <span class="comment">% msgbox('Plotting Complete','VMT Status','help','replace')</span>
1859 
1860 <span class="comment">% [EOF] crosssectionPlotCallback</span>
1861 
1862 
1863 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
1864 <span class="comment">% DATA EXPORT CALLBACKS %</span>
1865 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
1866 
1867 <span class="comment">% --------------------------------------------------------------------</span>
1868 <a name="_sub53" href="#_subfunctions" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a>
1869 <span class="comment">% saveDataCallback(hObject, eventdata, handles)</span>
1870 
1871 <span class="comment">% Get the Application data:</span>
1872 <span class="comment">% -------------------------</span>
1873 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1874 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1875 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1876 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1877 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
1878 
1879 [the_file,the_path] = <span class="keyword">...</span>
1880     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
1881     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
1882     fullfile(guiparams.mat_path,guiparams.savefile));
1883 
1884 <span class="comment">% Save the processed data to a MAT file:</span>
1885 <span class="comment">% --------------------------------------</span>
1886 <span class="keyword">if</span> ischar(the_file)
1887     guiparams.mat_path = the_path;
1888     guiparams.mat_file = the_file;
1889     guiparams.savefile = the_file;
1890     
1891     <span class="comment">% Re-store the Application data:</span>
1892     <span class="comment">% ------------------------------</span>
1893     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1894     
1895     <span class="comment">% Update the preferences:</span>
1896     <span class="comment">% -----------------------</span>
1897     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1898     guiprefs.mat_path = the_path;
1899     guiprefs.mat_file = the_file;
1900     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1901     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
1902     
1903     [~,filename,extension] = fileparts(guiparams.savefile);
1904     savefile = [filename extension];
1905     h = msgbox([<span class="string">'Saving processed data in MAT File '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
1906         <span class="string">'Saving Processed Data File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1907     disp(<span class="string">'Saving Processed Data File...'</span>)
1908     disp(savefile)
1909     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
1910 <span class="keyword">end</span>
1911 
1912 <span class="comment">% [EOF] SaveMATFile_Callback</span>
1913 
1914 
1915 <span class="comment">% --------------------------------------------------------------------</span>
1916 <a name="_sub54" href="#_subfunctions" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a>
1917 
1918 <span class="comment">% Get the Application data:</span>
1919 <span class="comment">% -------------------------</span>
1920 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1921 <span class="comment">% z   = guiparams.z;</span>
1922 <span class="comment">% A   = guiparams.A;</span>
1923 V   = guiparams.V;
1924 <span class="comment">% Map = guiparams.Map;</span>
1925 
1926 [the_file,the_path] = <span class="keyword">...</span>
1927     uiputfile({<span class="string">'*.dat'</span>,<span class="string">'Tecplot Files (*.dat)'</span>}, <span class="keyword">...</span>
1928     <span class="string">'Save Tecplot File'</span>, <span class="keyword">...</span>
1929     fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
1930 
1931 <span class="comment">% Output the data (no smoothing) to Tecplot:</span>
1932 <span class="comment">% ------------------------------------------</span>
1933 <span class="keyword">if</span> ischar(the_file)
1934     guiparams.tecplot_path = the_path;
1935     guiparams.tecplot_file = the_file;
1936     
1937     <span class="comment">% Re-store the Application data:</span>
1938     <span class="comment">% ------------------------------</span>
1939     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1940     
1941     <span class="comment">% Update the preferences:</span>
1942     <span class="comment">% -----------------------</span>
1943     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1944     guiprefs.tecplot_path = the_path;
1945     guiprefs.tecplot_file = the_file;
1946     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1947     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'tecplot'</span>)
1948     
1949     <span class="comment">% Push to log window</span>
1950     <span class="comment">% ------------------</span>
1951     log_text = {<span class="keyword">...</span>
1952         <span class="string">'Exporting Data to Tecplot (*.dat) File...'</span>;<span class="keyword">...</span>
1953         <span class="string">'Directory:'</span>;<span class="keyword">...</span>
1954         the_path;<span class="keyword">...</span>
1955         [<span class="string">'Filename: '</span> the_file]};
1956     statusLogging(handles.LogWindow,log_text)
1957         
1958     <span class="keyword">if</span> isempty(V)
1959         A = guiparams.A;
1960         A(1).hgns = guiparams.horizontal_grid_node_spacing;
1961         A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
1962         [~,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
1963             guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
1964             guiparams.unit_discharge_correction);
1965     <span class="keyword">end</span>
1966     <a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
1967     
1968     <span class="comment">% Push to log window</span>
1969     <span class="comment">% ------------------</span>
1970     log_text = {<span class="string">'Exporting XS Bathy Data to Tecplot (*.dat) File...'</span>};
1971     statusLogging(handles.LogWindow,log_text)
1972     
1973     <a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
1974     
1975     <span class="comment">% Push to log window</span>
1976     <span class="comment">% ------------------</span>
1977     log_text = {<span class="string">'Tecplot Export Complete'</span>};
1978     statusLogging(handles.LogWindow,log_text)
1979    
1980 <span class="keyword">end</span>
1981 
1982 <span class="comment">% [EOF] SaveTechplotFile_Callback</span>
1983 
1984 
1985 <span class="comment">% --------------------------------------------------------------------</span>
1986 <a name="_sub55" href="#_subfunctions" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a>
1987 
1988 <span class="comment">% Get the Application data:</span>
1989 <span class="comment">% -------------------------</span>
1990 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1991 <span class="comment">% z   = guiparams.z;</span>
1992 A   = guiparams.A;
1993 V   = guiparams.V;
1994 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
1995 
1996 [the_file,the_path] = <span class="keyword">...</span>
1997     uiputfile({<span class="string">'*.kmz'</span>,<span class="string">'Google Earth Files (*.kmz)'</span>}, <span class="keyword">...</span>
1998     <span class="string">'Save Google Earth File'</span>, <span class="keyword">...</span>
1999     fullfile(guiparams.kmz_path,guiparams.kmz_file));
2000 
2001 <span class="comment">% Save the processed data to a Google Earth (KMZ) file:</span>
2002 <span class="comment">% -----------------------------------------------------</span>
2003 <span class="keyword">if</span> ischar(the_file)
2004     guiparams.kmz_path = the_path;
2005     guiparams.kmz_file = the_file;
2006     
2007     <span class="comment">% Re-store the Application data:</span>
2008     <span class="comment">% ------------------------------</span>
2009     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2010     
2011     <span class="comment">% Update the preferences:</span>
2012     <span class="comment">% -----------------------</span>
2013     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2014     guiprefs.kmz_path = the_path;
2015     guiprefs.kmz_file = the_file;
2016     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2017     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'kmz'</span>)
2018     
2019     <span class="comment">%     if guiparams.display_shoreline</span>
2020     <span class="comment">%         VMT_Shoreline2GE_3D(A,Map, ...</span>
2021     <span class="comment">%                             guiparams.vertical_exaggeration, ...</span>
2022     <span class="comment">%                             guiparams.vertical_offset);</span>
2023     <span class="comment">%     end</span>
2024     <span class="keyword">if</span> isempty(V)
2025         A = guiparams.A;
2026         A(1).hgns = guiparams.horizontal_grid_node_spacing;
2027         A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2028         [~,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2029             guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2030             guiparams.unit_discharge_correction);
2031     <span class="keyword">end</span>
2032     <a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>(A,V,[], <span class="keyword">...</span>
2033         fullfile(guiparams.kmz_path,guiparams.kmz_file), <span class="keyword">...</span>
2034         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2035         guiparams.vertical_offset);
2036 <span class="keyword">end</span>
2037 
2038 <span class="comment">% [EOF] SaveGoogleEarthFile_Callback</span>
2039 
2040 
2041 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2042 <span class="comment">% DATA EXPORT/BATHYMETRY CALLBACKS %</span>
2043 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2044 
2045 <span class="comment">% --------------------------------------------------------------------</span>
2046 <a name="_sub56" href="#_subfunctions" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
2047 
2048 <span class="comment">% Get the Application data:</span>
2049 <span class="comment">% -------------------------</span>
2050 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2051 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2052 
2053 [the_file,the_path] = <span class="keyword">...</span>
2054     uiputfile({<span class="string">'*.csv'</span>,<span class="string">'Multibeam Bathymetry Files (*.csv)'</span>}, <span class="keyword">...</span>
2055     <span class="string">'Export Multibeam Bathymetry'</span>, <span class="keyword">...</span>
2056     fullfile(guiprefs.multibeambathymetry_path, <span class="keyword">...</span>
2057     guiprefs.multibeambathymetry_file));
2058 
2059 <span class="keyword">if</span> ischar(the_file)
2060     guiparams.multibeambathymetry_path = the_path;
2061     guiparams.multibeambathymetry_file = the_file;
2062     
2063     <span class="comment">% Re-store the Application data:</span>
2064     <span class="comment">% ------------------------------</span>
2065     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2066     
2067     <span class="comment">% Update the preferences:</span>
2068     <span class="comment">% -----------------------</span>
2069     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2070     guiprefs.multibeambathymetry_path = the_path;
2071     guiprefs.multibeambathymetry_file = the_file;
2072     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2073     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'multibeambathymetry'</span>)
2074     
2075     <span class="keyword">if</span> guiparams.output_auxiliary_data
2076     <span class="keyword">end</span>
2077     
2078     <span class="comment">%msgbox('Processing Bathymetry...Please Be Patient','VMT Status','help','replace')</span>
2079     
2080     savefile = fullfile(guiparams.multibeambathymetry_path, <span class="keyword">...</span>
2081         guiparams.multibeambathymetry_file);
2082     
2083     log_text = {<span class="string">'Multibeam bathymetry file saved to:'</span>;<span class="keyword">...</span>
2084         [<span class="string">'   '</span> savefile]};
2085     statusLogging(handles.LogWindow,log_text)
2086     
2087     <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>(guiparams.z, <span class="keyword">...</span>
2088         guiparams.A, <span class="keyword">...</span>
2089         savefile, <span class="keyword">...</span>
2090         guiparams.beam_angle, <span class="keyword">...</span>
2091         guiparams.magnetic_variation, <span class="keyword">...</span>
2092         guiparams.wse, <span class="keyword">...</span>
2093         guiparams.output_auxiliary_data);
2094     
2095     <span class="comment">%msgbox('Bathymetry Output Complete','VMT Status','help','replace')</span>
2096     
2097 <span class="keyword">end</span>
2098 
2099 <span class="comment">% [EOF] ExportMultibeamBathymetry_Callback</span>
2100 
2101 
2102 <span class="comment">% --------------------------------------------------------------------</span>
2103 <a name="_sub57" href="#_subfunctions" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a>
2104 <span class="comment">% Get the beam angle</span>
2105 
2106 <span class="comment">% Get the Application data:</span>
2107 <span class="comment">% -------------------------</span>
2108 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2109 
2110 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2111 <span class="comment">% ----------------------------------------------------------------</span>
2112 new_beam_angle = str2double(get(hObject,<span class="string">'String'</span>));
2113 is_a_number = ~isnan(new_beam_angle);
2114 is_positive = new_beam_angle&gt;=0;
2115 
2116 <span class="comment">% Modify the Application data:</span>
2117 <span class="comment">% ----------------------------</span>
2118 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2119     guiparams.beam_angle = new_beam_angle;
2120     
2121     <span class="comment">% Re-store the Application data:</span>
2122     <span class="comment">% ------------------------------</span>
2123     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2124     
2125 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2126     set(hObject,<span class="string">'String'</span>,guiparams.beam_angle)
2127 <span class="keyword">end</span>
2128 
2129 <span class="comment">% [EOF] BeamAngle_Callback</span>
2130 
2131 
2132 <span class="comment">% --------------------------------------------------------------------</span>
2133 <a name="_sub58" href="#_subfunctions" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a>
2134 <span class="comment">% Get the Magnetic Variation</span>
2135 
2136 <span class="comment">% Get the Application data:</span>
2137 <span class="comment">% -------------------------</span>
2138 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2139 
2140 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2141 <span class="comment">% ----------------------------------------------------------------</span>
2142 new_magnetic_variation = str2double(get(hObject,<span class="string">'String'</span>));
2143 is_a_number = ~isnan(new_magnetic_variation);
2144 is_positive = new_magnetic_variation&gt;=0;
2145 
2146 <span class="comment">% Modify the Application data:</span>
2147 <span class="comment">% ----------------------------</span>
2148 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2149     guiparams.magnetic_variation = new_magnetic_variation;
2150     
2151     <span class="comment">% Re-store the Application data:</span>
2152     <span class="comment">% ------------------------------</span>
2153     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2154     
2155 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2156     set(hObject,<span class="string">'String'</span>,guiparams.magnetic_variation)
2157 <span class="keyword">end</span>
2158 
2159 <span class="comment">% [EOF] MagneticVariation_Callback</span>
2160 
2161 
2162 <span class="comment">% --------------------------------------------------------------------</span>
2163 <a name="_sub59" href="#_subfunctions" class="code">function WSE_Callback(hObject, eventdata, handles)</a>
2164 
2165 <span class="comment">% Get the Application data:</span>
2166 <span class="comment">% -------------------------</span>
2167 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2168 
2169 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2170 <span class="comment">% ----------------------------------------------------------------</span>
2171 new_wse = str2double(get(hObject,<span class="string">'String'</span>));
2172 is_a_number = ~isnan(new_wse);
2173 is_positive = new_wse&gt;=0;
2174 
2175 <span class="comment">% Modify the Application data:</span>
2176 <span class="comment">% ----------------------------</span>
2177 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2178     guiparams.wse = new_wse;
2179     
2180     <span class="comment">% Re-store the Application data:</span>
2181     <span class="comment">% ------------------------------</span>
2182     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2183     
2184 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2185     set(hObject,<span class="string">'String'</span>,guiparams.wse)
2186 <span class="keyword">end</span>
2187 
2188 <span class="comment">% [EOF] WSE_Callback</span>
2189 
2190 
2191 <span class="comment">% --------------------------------------------------------------------</span>
2192 <a name="_sub60" href="#_subfunctions" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a>
2193 <span class="comment">% Bathymetry Auxillary Data</span>
2194 
2195 <span class="comment">% Get the Application data:</span>
2196 <span class="comment">% -------------------------</span>
2197 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2198 
2199 <span class="comment">% Modify the Application data:</span>
2200 <span class="comment">% ----------------------------</span>
2201 guiparams.output_auxiliary_data = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2202 
2203 <span class="comment">% Re-store the Application data:</span>
2204 <span class="comment">% ------------------------------</span>
2205 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2206 
2207 <span class="comment">% [EOF] OutputAuxiliaryData_Callback</span>
2208 
2209 
2210 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2211 <span class="comment">% PLOTTING/PLAN VIEW PLOT CALLBACKS %</span>
2212 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2213 
2214 <span class="comment">% --------------------------------------------------------------------</span>
2215 <a name="_sub61" href="#_subfunctions" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a>
2216 
2217 <span class="comment">% Get the Application data:</span>
2218 <span class="comment">% -------------------------</span>
2219 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2220 
2221 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2222 <span class="comment">% ----------------------------------------------------------------</span>
2223 new_depth_range_min = str2double(get(hObject,<span class="string">'String'</span>));
2224 is_a_number = ~isnan(new_depth_range_min);
2225 is_positive = new_depth_range_min&gt;=0;
2226 
2227 <span class="comment">% Modify the Application data:</span>
2228 <span class="comment">% ----------------------------</span>
2229 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2230     guiparams.depth_range_min = new_depth_range_min;
2231     
2232     <span class="comment">% Re-store the Application data:</span>
2233     <span class="comment">% ------------------------------</span>
2234     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2235     
2236 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2237     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_min)
2238 <span class="keyword">end</span>
2239 
2240 <span class="comment">% [EOF] DepthRangeMin_Callback</span>
2241 
2242 
2243 <span class="comment">% --------------------------------------------------------------------</span>
2244 <a name="_sub62" href="#_subfunctions" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a>
2245 
2246 <span class="comment">% Get the Application data:</span>
2247 <span class="comment">% -------------------------</span>
2248 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2249 
2250 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2251 <span class="comment">% ----------------------------------------------------------------</span>
2252 new_depth_range_max = str2double(get(hObject,<span class="string">'String'</span>));
2253 is_a_number = ~isnan(new_depth_range_max);
2254 is_positive = new_depth_range_max&gt;=0;
2255 
2256 <span class="comment">% Modify the Application data:</span>
2257 <span class="comment">% ----------------------------</span>
2258 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2259     guiparams.depth_range_max = new_depth_range_max;
2260     
2261     <span class="comment">% Re-store the Application data:</span>
2262     <span class="comment">% ------------------------------</span>
2263     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2264     
2265 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2266     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_max)
2267 <span class="keyword">end</span>
2268 
2269 <span class="comment">% [EOF] DepthMax_Callback</span>
2270 
2271 
2272 <span class="comment">% --------------------------------------------------------------------</span>
2273 <a name="_sub63" href="#_subfunctions" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a>
2274 <span class="comment">% Set quiver scale (contour)</span>
2275 
2276 <span class="comment">% Get the Application data:</span>
2277 <span class="comment">% -------------------------</span>
2278 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2279 
2280 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2281 <span class="comment">% ----------------------------------------------------------------</span>
2282 new_vector_scale_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
2283 is_a_number = ~isnan(new_vector_scale_plan_view);
2284 is_positive = new_vector_scale_plan_view&gt;=0;
2285 
2286 <span class="comment">% Modify the Application data:</span>
2287 <span class="comment">% ----------------------------</span>
2288 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2289     guiparams.vector_scale_plan_view = round(new_vector_scale_plan_view);
2290     
2291     <span class="comment">% Re-store the Application data:</span>
2292     <span class="comment">% ------------------------------</span>
2293     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2294     
2295 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2296     set(hObject,<span class="string">'String'</span>,guiparams.vector_scale_plan_view)
2297 <span class="keyword">end</span>
2298 
2299 <span class="comment">% [EOF] VectorScalePlanView_Callback</span>
2300 
2301 
2302 <span class="comment">% --------------------------------------------------------------------</span>
2303 <a name="_sub64" href="#_subfunctions" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a>
2304 <span class="comment">% Set quiver spacing (contour, horizontal)</span>
2305 
2306 <span class="comment">% Get the Application data:</span>
2307 <span class="comment">% -------------------------</span>
2308 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2309 
2310 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2311 <span class="comment">% ----------------------------------------------------------------</span>
2312 new_vector_spacing_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
2313 is_a_number = ~isnan(new_vector_spacing_plan_view);
2314 is_positive = new_vector_spacing_plan_view&gt;=0;
2315 
2316 <span class="comment">% Modify the Application data:</span>
2317 <span class="comment">% ----------------------------</span>
2318 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2319     guiparams.vector_spacing_plan_view = round(new_vector_spacing_plan_view);
2320     
2321     <span class="comment">% Re-store the Application data:</span>
2322     <span class="comment">% ------------------------------</span>
2323     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2324     
2325 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2326     set(hObject,<span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
2327 <span class="keyword">end</span>
2328 
2329 <span class="comment">% [EOF] VectorSpacingPlanview_Callback</span>
2330 
2331 
2332 <span class="comment">% --------------------------------------------------------------------</span>
2333 <a name="_sub65" href="#_subfunctions" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a>
2334 <span class="comment">% Plan View smoothing window size</span>
2335 
2336 <span class="comment">% Get the Application data:</span>
2337 <span class="comment">% -------------------------</span>
2338 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2339 
2340 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2341 <span class="comment">% ----------------------------------------------------------------</span>
2342 new_smoothing_window_size = str2double(get(hObject,<span class="string">'String'</span>));
2343 is_a_number = ~isnan(new_smoothing_window_size);
2344 is_positive = new_smoothing_window_size&gt;=0;
2345 
2346 <span class="comment">% Modify the Application data:</span>
2347 <span class="comment">% ----------------------------</span>
2348 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2349     guiparams.smoothing_window_size = round(new_smoothing_window_size);
2350     
2351     <span class="comment">% Re-store the Application data:</span>
2352     <span class="comment">% ------------------------------</span>
2353     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2354     
2355 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2356     set(hObject,<span class="string">'String'</span>,guiparams.smoothing_window_size)
2357 <span class="keyword">end</span>
2358 
2359 <span class="comment">% [EOF] SmoothingWindowSize_Callback</span>
2360 
2361 
2362 <span class="comment">% --------------------------------------------------------------------</span>
2363 <a name="_sub66" href="#_subfunctions" class="code">function DisplayShoreline_Callback(hObject, eventdata, handles)</a>
2364 
2365 <span class="comment">% Get the Application data:</span>
2366 <span class="comment">% -------------------------</span>
2367 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2368 
2369 <span class="comment">% Modify the Application data:</span>
2370 <span class="comment">% ----------------------------</span>
2371 guiparams.display_shoreline = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2372 
2373 <span class="comment">% Re-store the Application data:</span>
2374 <span class="comment">% ------------------------------</span>
2375 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2376 
2377 <span class="comment">% [EOF] DisplayShoreline_Callback</span>
2378 
2379 
2380 <span class="comment">% --------------------------------------------------------------------</span>
2381 <a name="_sub67" href="#_subfunctions" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a>
2382 
2383 <span class="comment">% Get the Application data:</span>
2384 <span class="comment">% -------------------------</span>
2385 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2386 
2387 <span class="comment">% Modify the Application data:</span>
2388 <span class="comment">% ----------------------------</span>
2389 guiparams.add_background = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2390 
2391 <span class="comment">% Re-store the Application data:</span>
2392 <span class="comment">% ------------------------------</span>
2393 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2394 
2395 <span class="comment">% [EOF] AddBackground_Callback</span>
2396 
2397 
2398 <span class="comment">% --------------------------------------------------------------------</span>
2399 <a name="_sub68" href="#_subfunctions" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a>
2400 <a href="#_sub51" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
2401 <span class="comment">% [EOF] PlotPlanView_Callback</span>
2402 
2403 
2404 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2405 <span class="comment">% PLOTTING/SHIP TRACKS PLOT CALLBACKS %</span>
2406 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2407 
2408 <span class="comment">% --------------------------------------------------------------------</span>
2409 <a name="_sub69" href="#_subfunctions" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a>
2410 <span class="comment">% Set the horizontal grid node spacing</span>
2411 
2412 <span class="comment">% Get the Application data:</span>
2413 <span class="comment">% -------------------------</span>
2414 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2415 
2416 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2417 <span class="comment">% ----------------------------------------------------------------</span>
2418 new_horizontal_grid_node_spacing = str2double(get(hObject,<span class="string">'String'</span>));
2419 is_a_number = ~isnan(new_horizontal_grid_node_spacing);
2420 is_positive = new_horizontal_grid_node_spacing&gt;=0;
2421 
2422 <span class="comment">% Modify the Application data:</span>
2423 <span class="comment">% ----------------------------</span>
2424 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2425     guiparams.horizontal_grid_node_spacing = round(new_horizontal_grid_node_spacing);
2426     
2427     <span class="comment">% Re-store the Application data:</span>
2428     <span class="comment">% ------------------------------</span>
2429     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2430     
2431 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2432     set(hObject,<span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
2433 <span class="keyword">end</span>
2434 
2435 <span class="comment">% [EOF] HorizontalGridNodeSpacing_Callback</span>
2436 
2437 
2438 <span class="comment">% --------------------------------------------------------------------</span>
2439 <a name="_sub70" href="#_subfunctions" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
2440 <span class="comment">% Set the cross section endpoints manually</span>
2441 
2442 <span class="comment">% Get the Application data:</span>
2443 <span class="comment">% -------------------------</span>
2444 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2445 
2446 <span class="comment">% Modify the Application data:</span>
2447 <span class="comment">% ----------------------------</span>
2448 guiparams.set_cross_section_endpoints = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2449 
2450 <span class="comment">% Re-store the Application data:</span>
2451 <span class="comment">% ------------------------------</span>
2452 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2453 
2454 <span class="comment">% [EOF] SetCrossSectionEndpoints_Callback</span>
2455 
2456 
2457 <span class="comment">% --------------------------------------------------------------------</span>
2458 <a name="_sub71" href="#_subfunctions" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a>
2459 <a href="#_sub50" class="code" title="subfunction shiptracksPlotCallback(hObject, eventdata, handles)">shiptracksPlotCallback</a>(hObject, eventdata, handles)
2460 <span class="comment">% [EOF] PlotShiptracks_Callback</span>
2461 
2462 
2463 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2464 <span class="comment">% PLOTTING/CROSS SECTION PLOT CALLBACKS %</span>
2465 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2466 
2467 <span class="comment">% --------------------------------------------------------------------</span>
2468 <a name="_sub72" href="#_subfunctions" class="code">function Contour_Callback(hObject, eventdata, handles)</a>
2469 
2470 <span class="comment">% Get the Application data:</span>
2471 <span class="comment">% -------------------------</span>
2472 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2473 
2474 <span class="comment">% Modify the Application data:</span>
2475 <span class="comment">% ----------------------------</span>
2476 idx_variable = get(hObject,<span class="string">'Value'</span>);
2477 guiparams.idx_contour = idx_variable;
2478 guiparams.contour = guiparams.contours(idx_variable).variable;
2479 
2480 <span class="comment">% Re-store the Application data:</span>
2481 <span class="comment">% ------------------------------</span>
2482 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2483 
2484 <span class="comment">% [EOF] Contour_Callback</span>
2485 
2486 
2487 <span class="comment">% --------------------------------------------------------------------</span>
2488 <a name="_sub73" href="#_subfunctions" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a>
2489 <span class="comment">% Set vertical exaggeration</span>
2490 
2491 <span class="comment">% Get the Application data:</span>
2492 <span class="comment">% -------------------------</span>
2493 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2494 
2495 <span class="comment">% Modify the Application data:</span>
2496 <span class="comment">% ----------------------------</span>
2497 guiparams.vertical_exaggeration = str2double(get(hObject,<span class="string">'String'</span>));
2498 
2499 <span class="comment">% Re-store the Application data:</span>
2500 <span class="comment">% ------------------------------</span>
2501 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2502 
2503 <span class="comment">% Update the GUI:</span>
2504 <span class="comment">% ---------------</span>
2505 <span class="comment">% updateGUI(handles,guiparams)</span>
2506 
2507 <span class="comment">% [EOF] VerticalExaggeration_Callback</span>
2508 
2509 
2510 <span class="comment">% --------------------------------------------------------------------</span>
2511 <a name="_sub74" href="#_subfunctions" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a>
2512 
2513 <span class="comment">% Get the Application data:</span>
2514 <span class="comment">% -------------------------</span>
2515 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2516 
2517 <span class="comment">% Modify the Application data:</span>
2518 <span class="comment">% ----------------------------</span>
2519 guiparams.vector_scale_cross_section = str2double(get(hObject,<span class="string">'String'</span>));
2520 
2521 <span class="comment">% Re-store the Application data:</span>
2522 <span class="comment">% ------------------------------</span>
2523 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2524 
2525 <span class="comment">% Update the GUI:</span>
2526 <span class="comment">% ---------------</span>
2527 <span class="comment">% updateGUI(handles,guiparams)</span>
2528 
2529 <span class="comment">% [EOF] VectorScaleCrossSection_Callback</span>
2530 
2531 
2532 <span class="comment">% --------------------------------------------------------------------</span>
2533 <a name="_sub75" href="#_subfunctions" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a>
2534 
2535 <span class="comment">% Get the Application data:</span>
2536 <span class="comment">% -------------------------</span>
2537 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2538 
2539 <span class="comment">% Modify the Application data:</span>
2540 <span class="comment">% ----------------------------</span>
2541 guiparams.horizontal_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
2542 
2543 <span class="comment">% Re-store the Application data:</span>
2544 <span class="comment">% ------------------------------</span>
2545 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2546 
2547 <span class="comment">% Update the GUI:</span>
2548 <span class="comment">% ---------------</span>
2549 <span class="comment">% updateGUI(handles,guiparams)</span>
2550 
2551 <span class="comment">% [EOF] HorizontalVectorSpacing_Callback</span>
2552 
2553 
2554 <span class="comment">% --------------------------------------------------------------------</span>
2555 <a name="_sub76" href="#_subfunctions" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a>
2556 <span class="comment">% Get the vertical quiver spacing for contour plots</span>
2557 
2558 <span class="comment">% Get the Application data:</span>
2559 <span class="comment">% -------------------------</span>
2560 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2561 
2562 <span class="comment">% Modify the Application data:</span>
2563 <span class="comment">% ----------------------------</span>
2564 guiparams.vertical_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
2565 
2566 <span class="comment">% Re-store the Application data:</span>
2567 <span class="comment">% ------------------------------</span>
2568 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2569 
2570 <span class="comment">% Update the GUI:</span>
2571 <span class="comment">% ---------------</span>
2572 <span class="comment">% updateGUI(handles,guiparams)</span>
2573 
2574 <span class="comment">% [EOF] VerticalVectorSpacing_Callback</span>
2575 
2576 
2577 <span class="comment">% --------------------------------------------------------------------</span>
2578 <a name="_sub77" href="#_subfunctions" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
2579 <span class="comment">% Horizontal Smoothing</span>
2580 
2581 <span class="comment">% Get the Application data:</span>
2582 <span class="comment">% -------------------------</span>
2583 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2584 
2585 <span class="comment">% Modify the Application data:</span>
2586 <span class="comment">% ----------------------------</span>
2587 guiparams.horizontal_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
2588 
2589 <span class="comment">% Re-store the Application data:</span>
2590 <span class="comment">% ------------------------------</span>
2591 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2592 
2593 <span class="comment">% Update the GUI:</span>
2594 <span class="comment">% ---------------</span>
2595 <span class="comment">% updateGUI(handles,guiparams)</span>
2596 
2597 <span class="comment">% [EOF] HorizontalSmoothingWindow_Callback</span>
2598 
2599 
2600 <span class="comment">% --------------------------------------------------------------------</span>
2601 <a name="_sub78" href="#_subfunctions" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
2602 <span class="comment">% Vertical Smoothing</span>
2603 
2604 <span class="comment">% Get the Application data:</span>
2605 <span class="comment">% -------------------------</span>
2606 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2607 
2608 <span class="comment">% Modify the Application data:</span>
2609 <span class="comment">% ----------------------------</span>
2610 guiparams.vertical_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
2611 
2612 <span class="comment">% Re-store the Application data:</span>
2613 <span class="comment">% ------------------------------</span>
2614 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2615 
2616 <span class="comment">% Update the GUI:</span>
2617 <span class="comment">% ---------------</span>
2618 <span class="comment">% updateGUI(handles,guiparams)</span>
2619 
2620 <span class="comment">% [EOF] VerticalSmoothingWindow_Callback</span>
2621 
2622 
2623 <span class="comment">% --------------------------------------------------------------------</span>
2624 <a name="_sub79" href="#_subfunctions" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a>
2625 
2626 <span class="comment">% Get the Application data:</span>
2627 <span class="comment">% -------------------------</span>
2628 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2629 
2630 <span class="comment">% Modify the Application data:</span>
2631 <span class="comment">% ----------------------------</span>
2632 guiparams.plot_secondary_flow_vectors = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2633 
2634 <span class="comment">% Re-store the Application data:</span>
2635 <span class="comment">% ------------------------------</span>
2636 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2637 
2638 <span class="comment">% [EOF] PlotSecondaryFlowVectors_Callback</span>
2639 
2640 
2641 <span class="comment">% --------------------------------------------------------------------</span>
2642 <a name="_sub80" href="#_subfunctions" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a>
2643 
2644 <span class="comment">% Get the Application data:</span>
2645 <span class="comment">% -------------------------</span>
2646 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2647 
2648 <span class="comment">% Modify the Application data:</span>
2649 <span class="comment">% ----------------------------</span>
2650 idx_variable = get(hObject,<span class="string">'Value'</span>);
2651 guiparams.idx_secondary_flow_vector_variable = idx_variable;
2652 guiparams.secondary_flow_vector_variable = guiparams.secondary_flows(idx_variable).variable;
2653 
2654 <span class="comment">% Re-store the Application data:</span>
2655 <span class="comment">% ------------------------------</span>
2656 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2657 
2658 <span class="comment">% [EOF] SecondaryFlowVectorVariable_Callback</span>
2659 
2660 
2661 <span class="comment">% --------------------------------------------------------------------</span>
2662 <a name="_sub81" href="#_subfunctions" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a>
2663 
2664 <span class="comment">% Get the Application data:</span>
2665 <span class="comment">% -------------------------</span>
2666 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2667 
2668 <span class="comment">% Modify the Application data:</span>
2669 <span class="comment">% ----------------------------</span>
2670 guiparams.include_vertical_velocity = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2671 
2672 <span class="comment">% Re-store the Application data:</span>
2673 <span class="comment">% ------------------------------</span>
2674 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2675 
2676 <span class="comment">% [EOF] IncludeVerticalVelocity_Callback</span>
2677 
2678 
2679 <span class="comment">% --------------------------------------------------------------------</span>
2680 <a name="_sub82" href="#_subfunctions" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a>
2681 <a href="#_sub52" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
2682 <span class="comment">% [EOF] PlotCrossSection_Callback</span>
2683 
2684 
2685 <span class="comment">% --------------------------------------------------------------------</span>
2686 <a name="_sub83" href="#_subfunctions" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a>
2687 set(handles.LogWindow,<span class="string">'string'</span>,<span class="string">''</span>)
2688 <span class="comment">% [EOF] ClearLog_Callback</span>
2689 
2690 <span class="comment">% --------------------------------------------------------------------</span>
2691 <a name="_sub84" href="#_subfunctions" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a>
2692 
2693 <span class="comment">% Get the Application data:</span>
2694 <span class="comment">% -------------------------</span>
2695 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2696 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2697 <span class="comment">% z   = guiparams.z;   %#ok&lt;NASGU&gt;</span>
2698 <span class="comment">% A   = guiparams.A;   %#ok&lt;NASGU&gt;</span>
2699 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
2700 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
2701 
2702 [the_file,the_path] = <span class="keyword">...</span>
2703     uiputfile({<span class="string">'*.txt'</span>,<span class="string">'TXT-Files (*.txt)'</span>}, <span class="keyword">...</span>
2704     <span class="string">'Choose where to save the log file'</span>, <span class="keyword">...</span>
2705     fullfile(guiprefs.log_path,guiprefs.log_file));
2706 
2707 <span class="comment">% Save the log to a TXT file:</span>
2708 <span class="comment">% ---------------------------</span>
2709 <span class="keyword">if</span> ischar(the_file)
2710     guiparams.log_path = the_path;
2711     guiparams.log_file = the_file;
2712     <span class="comment">%guiparams.savefile = the_file;</span>
2713     
2714     <span class="comment">% Re-store the Application data:</span>
2715     <span class="comment">% ------------------------------</span>
2716     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2717     
2718     <span class="comment">% Update the preferences:</span>
2719     <span class="comment">% -----------------------</span>
2720     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2721     guiprefs.log_path = the_path;
2722     guiprefs.log_file = the_file;
2723     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2724     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'log'</span>)
2725     
2726     [~,filename,extension] = fileparts(the_file);
2727     savefile = [the_path filename extension];
2728     h = msgbox([<span class="string">'Saving log to: '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
2729         <span class="string">'Saving Log File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2730     
2731     logfile = get(handles.LogWindow,<span class="string">'string'</span>);
2732     [nrows,~]= size(logfile);
2733     fid = fopen(savefile, <span class="string">'w'</span>);
2734     <span class="keyword">for</span> row=1:nrows
2735         fprintf(fid, <span class="string">'%s \n'</span>, logfile{row,:});
2736     <span class="keyword">end</span>
2737     fclose(fid);
2738 <span class="keyword">end</span>
2739 <span class="comment">% [EOF] SaveLog_Callback</span>
2740 
2741 <span class="comment">%%%%%%%%%%%%%%%%</span>
2742 <span class="comment">% SUBFUNCTIONS %</span>
2743 <span class="comment">%%%%%%%%%%%%%%%%</span>
2744 
2745 <span class="comment">% --------------------------------------------------------------------</span>
2746 <a name="_sub85" href="#_subfunctions" class="code">function handles = buildToolbar(handles)</a>
2747 
2748 icons = <a href="#_sub101" class="code" title="subfunction icons = getIcons">getIcons</a>;
2749 ht = uitoolbar(<span class="string">'Parent'</span>,handles.figure1);
2750 
2751 <span class="comment">% Load data</span>
2752 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_open.png');</span>
2753 <span class="comment">% icon = double(icon)/(2^16-1);</span>
2754 <span class="comment">% icon(icon==0) = NaN;</span>
2755 handles.toolbarLoadData = <span class="keyword">...</span>
2756     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
2757     <span class="string">'CData'</span>,        icons(1).data, <span class="keyword">...</span>
2758     <span class="string">'TooltipString'</span>,<span class="string">'Open ASCII File'</span>);
2759 
2760 <span class="comment">% Save data</span>
2761 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_save.png');</span>
2762 <span class="comment">% icon = double(icon)/(2^16-1);</span>
2763 <span class="comment">% icon(icon==0) = NaN;</span>
2764 handles.toolbarSaveMatFile = <span class="keyword">...</span>
2765     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
2766     <span class="string">'CData'</span>,        icons(2).data, <span class="keyword">...</span>
2767     <span class="string">'TooltipString'</span>,<span class="string">'Save MAT File'</span>, <span class="keyword">...</span>
2768     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
2769 
2770 
2771 <span class="comment">% Save bathymetry</span>
2772 <span class="comment">%icon = ones(16,16,3);</span>
2773 handles.toolbarSaveBathymetry = <span class="keyword">...</span>
2774     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
2775     <span class="string">'CData'</span>,        icons(5).data, <span class="keyword">...</span>
2776     <span class="string">'TooltipString'</span>,<span class="string">'Export Bathymetry'</span>);
2777 
2778 <span class="comment">% Save figures</span>
2779 <span class="comment">% icon = ones(16,16,3);</span>
2780 handles.toolbarSaveFigures = <span class="keyword">...</span>
2781     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
2782     <span class="string">'CData'</span>,        icons(6).data, <span class="keyword">...</span>
2783     <span class="string">'TooltipString'</span>,<span class="string">'Export Figures'</span>);
2784 
2785 <span class="comment">% Save Excel File</span>
2786 <span class="comment">% icon = ones(16,16,3);</span>
2787 handles.toolbarSaveExcel = <span class="keyword">...</span>
2788     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
2789     <span class="string">'CData'</span>,        icons(7).data, <span class="keyword">...</span>
2790     <span class="string">'TooltipString'</span>,<span class="string">'Export Excel File'</span>);
2791 
2792 
2793 <span class="comment">% Plotting parameters</span>
2794 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\PlotGeneralElement.gif');</span>
2795 <span class="comment">% icon = ind2rgb(icon,map);</span>
2796 handles.toolbarPlottingParameters = <span class="keyword">...</span>
2797     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
2798     <span class="string">'CData'</span>,        icons(3).data, <span class="keyword">...</span>
2799     <span class="string">'TooltipString'</span>,<span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
2800     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
2801 
2802 <span class="comment">% Processing parameters</span>
2803 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
2804 <span class="comment">% icon = ind2rgb(icon,map);</span>
2805 handles.toolbarProcessingParameters = <span class="keyword">...</span>
2806     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
2807     <span class="string">'CData'</span>,        icons(4).data, <span class="keyword">...</span>
2808     <span class="string">'TooltipString'</span>,<span class="string">'Processing Parameters'</span>);
2809 
2810 <span class="comment">% % Plot 1: Shiptracks</span>
2811 <span class="comment">% handles.shiptracksPlot = ...</span>
2812 <span class="comment">%     uipushtool('Parent',       ht, ...</span>
2813 <span class="comment">%                'CData',        icon, ...</span>
2814 <span class="comment">%                'TooltipString','Shiptracks plot', ...</span>
2815 <span class="comment">%                'Separator',    'on');</span>
2816 <span class="comment">%</span>
2817 <span class="comment">% % Plot 2: Plan view</span>
2818 <span class="comment">% handles.planviewPlot = ...</span>
2819 <span class="comment">%     uipushtool('Parent',       ht, ...</span>
2820 <span class="comment">%                'CData',        icon, ...</span>
2821 <span class="comment">%                'TooltipString','Plan view plot');</span>
2822 <span class="comment">%</span>
2823 <span class="comment">% % Plot 3: Cross section</span>
2824 <span class="comment">% handles.crosssectionPlot = ...</span>
2825 <span class="comment">%     uipushtool('Parent',       ht, ...</span>
2826 <span class="comment">%                'CData',        icon, ...</span>
2827 <span class="comment">%                'TooltipString','Cross section plot');</span>
2828 
2829 set(handles.toolbarLoadData,            <span class="string">'ClickedCallback'</span>,{@<a href="#_sub45" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>,handles})
2830 set(handles.toolbarSaveMatFile,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub46" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>,handles})
2831 set(handles.toolbarSaveBathymetry,      <span class="string">'ClickedCallback'</span>,{@<a href="#_sub56" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>,handles})
2832 set(handles.toolbarSaveFigures,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub17" class="code" title="subfunction menuExportFigures_Callback(hObject, eventdata, handles)">menuExportFigures_Callback</a>,handles})
2833 set(handles.toolbarSaveExcel,           <span class="string">'ClickedCallback'</span>,{@<a href="#_sub21" class="code" title="subfunction menuSaveExcel_Callback(hObject, eventdata, handles)">menuSaveExcel_Callback</a>,handles})
2834 set(handles.toolbarPlottingParameters,  <span class="string">'ClickedCallback'</span>,{@<a href="#_sub48" class="code" title="subfunction plottingParametersCallback(hObject, eventdata, handles)">plottingParametersCallback</a>,handles})
2835 set(handles.toolbarProcessingParameters,<span class="string">'ClickedCallback'</span>,{@<a href="#_sub49" class="code" title="subfunction processingParametersCallback(hObject, eventdata, handles)">processingParametersCallback</a>,handles})
2836 <span class="comment">% set(handles.shiptracksPlot,      'ClickedCallback',{@shiptracksPlotCallback,handles})</span>
2837 <span class="comment">% set(handles.planviewPlot,        'ClickedCallback',{@planviewPlotCallback,handles})</span>
2838 <span class="comment">% set(handles.crosssectionPlot,    'ClickedCallback',{@crosssectionPlotCallback,handles})</span>
2839 
2840 <span class="comment">% [EOF] buildtoolbar</span>
2841 
2842 
2843 <span class="comment">% --------------------------------------------------------------------</span>
2844 <a name="_sub86" href="#_subfunctions" class="code">function load_prefs(hfigure)</a>
2845 <span class="comment">% Load the GUI preferences.  Also, initialize preferences if they don't</span>
2846 <span class="comment">% already exist.</span>
2847 
2848 <span class="comment">% Preferences:</span>
2849 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
2850 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
2851 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
2852 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
2853 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
2854 <span class="comment">% 'log'                  Path and filename of last Log file</span>
2855 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
2856 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
2857 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
2858 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
2859 
2860 <span class="comment">% Originals</span>
2861 <span class="comment">% prefs = {'ascii2gispath' 'ascii2kmlpath' 'asciipath'   'doqqpath' ...</span>
2862 <span class="comment">%          'endspath'      'logpath'       'matpath'     'savedpath' ...</span>
2863 <span class="comment">%          'shorepath'     'stapath'       'ysidatapath' 'ysidatapath'};</span>
2864 
2865 <span class="comment">% ASCII</span>
2866 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>)
2867     ascii = getpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>);
2868     <span class="keyword">if</span> exist(ascii.path,<span class="string">'dir'</span>)
2869         guiprefs.ascii_path = ascii.path;
2870     <span class="keyword">else</span>
2871         guiprefs.ascii_path = pwd;
2872     <span class="keyword">end</span>
2873     does_exist = false(1,length(ascii.file));
2874     <span class="keyword">for</span> k = 1:length(ascii.file) <span class="comment">% Check each file one-by-one</span>
2875         does_exist(k) = exist(fullfile(ascii.path,ascii.file{k}),<span class="string">'file'</span>);
2876     <span class="keyword">end</span>
2877     <span class="keyword">if</span> any(does_exist)
2878         guiprefs.ascii_file = ascii.file(does_exist);
2879     <span class="keyword">else</span>
2880         guiprefs.ascii_file = {<span class="string">''</span>};
2881     <span class="keyword">end</span>
2882 <span class="keyword">else</span> <span class="comment">% Initialize ASCII</span>
2883     guiprefs.ascii_path = pwd;
2884     guiprefs.ascii_file = {<span class="string">''</span>};
2885     
2886     ascii.path = pwd;
2887     ascii.file = {<span class="string">''</span>};
2888     setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
2889 <span class="keyword">end</span>
2890 
2891 <span class="comment">% MAT</span>
2892 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>)
2893     mat = getpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>);
2894     <span class="keyword">if</span> exist(mat.path,<span class="string">'dir'</span>)
2895         guiprefs.mat_path = mat.path;
2896     <span class="keyword">else</span>
2897         guiprefs.mat_path = pwd;
2898     <span class="keyword">end</span>
2899     
2900     <span class="keyword">if</span> iscell(mat.file)
2901         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file{1}),<span class="string">'file'</span>)
2902             guiprefs.mat_file = mat.file;
2903         <span class="keyword">else</span>
2904             guiprefs.mat_file = <span class="string">''</span>;
2905         <span class="keyword">end</span>
2906     <span class="keyword">else</span>
2907         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file),<span class="string">'file'</span>)
2908             guiprefs.mat_file = mat.file;
2909         <span class="keyword">else</span>
2910             guiprefs.mat_file = <span class="string">''</span>;
2911         <span class="keyword">end</span>
2912     <span class="keyword">end</span>
2913 <span class="keyword">else</span> <span class="comment">% Initialize MAT</span>
2914     guiprefs.mat_path = pwd;
2915     guiprefs.mat_file = <span class="string">''</span>;
2916     
2917     mat.path = pwd;
2918     mat.file = <span class="string">''</span>;
2919     setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
2920 <span class="keyword">end</span>
2921 
2922 <span class="comment">% TECPLOT</span>
2923 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>)
2924     tecplot = getpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>);
2925     <span class="keyword">if</span> exist(tecplot.path,<span class="string">'dir'</span>)
2926         guiprefs.tecplot_path = tecplot.path;
2927     <span class="keyword">else</span>
2928         guiprefs.tecplot_path = pwd;
2929     <span class="keyword">end</span>
2930     <span class="keyword">if</span> exist(fullfile(tecplot.path,tecplot.file),<span class="string">'file'</span>)
2931         guiprefs.tecplot_file = tecplot.file;
2932     <span class="keyword">else</span>
2933         guiprefs.tecplot_file = <span class="string">''</span>;
2934     <span class="keyword">end</span>
2935 <span class="keyword">else</span> <span class="comment">% Initialize TECPLOT</span>
2936     guiprefs.tecplot_path = pwd;
2937     guiprefs.tecplot_file = <span class="string">''</span>;
2938     
2939     tecplot.path = pwd;
2940     tecplot.file = <span class="string">''</span>;
2941     setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
2942 <span class="keyword">end</span>
2943 
2944 <span class="comment">% KMZ</span>
2945 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>)
2946     kmz = getpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>);
2947     <span class="keyword">if</span> exist(kmz.path,<span class="string">'dir'</span>)
2948         guiprefs.kmz_path = kmz.path;
2949     <span class="keyword">else</span>
2950         guiprefs.kmz_path = pwd;
2951     <span class="keyword">end</span>
2952     <span class="keyword">if</span> exist(fullfile(kmz.path,kmz.file),<span class="string">'file'</span>)
2953         guiprefs.kmz_file = kmz.file;
2954     <span class="keyword">else</span>
2955         guiprefs.kmz_file = <span class="string">''</span>;
2956     <span class="keyword">end</span>
2957 <span class="keyword">else</span> <span class="comment">% Initialize KMZ</span>
2958     guiprefs.kmz_path = pwd;
2959     guiprefs.kmz_file = <span class="string">''</span>;
2960     
2961     kmz.path = pwd;
2962     kmz.file = <span class="string">''</span>;
2963     setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
2964 <span class="keyword">end</span>
2965 
2966 <span class="comment">% MULTIBEAM BATHYMETRY</span>
2967 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>)
2968     multibeambathymetry = getpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>);
2969     <span class="keyword">if</span> exist(multibeambathymetry.path,<span class="string">'dir'</span>)
2970         guiprefs.multibeambathymetry_path = multibeambathymetry.path;
2971     <span class="keyword">else</span>
2972         guiprefs.multibeambathymetry_path = pwd;
2973     <span class="keyword">end</span>
2974     <span class="keyword">if</span> exist(fullfile(multibeambathymetry.path,multibeambathymetry.file),<span class="string">'file'</span>)
2975         guiprefs.multibeambathymetry_file = multibeambathymetry.file;
2976     <span class="keyword">else</span>
2977         guiprefs.multibeambathymetry_file = <span class="string">''</span>;
2978     <span class="keyword">end</span>
2979 <span class="keyword">else</span> <span class="comment">% Initialize MULTIBEAM BATHYMETRY</span>
2980     guiprefs.multibeambathymetry_path = pwd;
2981     guiprefs.multibeambathymetry_file = <span class="string">''</span>;
2982     
2983     multibeambathymetry.path = pwd;
2984     multibeambathymetry.file = <span class="string">''</span>;
2985     setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
2986 <span class="keyword">end</span>
2987 
2988 <span class="comment">% Log</span>
2989 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'log'</span>)
2990     log = getpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>);
2991     <span class="keyword">if</span> exist(log.path,<span class="string">'dir'</span>)
2992         guiprefs.log_path = log.path;
2993     <span class="keyword">else</span>
2994         guiprefs.log_path = pwd;
2995     <span class="keyword">end</span>
2996     <span class="keyword">if</span> exist(fullfile(log.path,log.file),<span class="string">'file'</span>)
2997         guiprefs.log_file = log.file;
2998     <span class="keyword">else</span>
2999         guiprefs.log_file = <span class="string">''</span>;
3000     <span class="keyword">end</span>
3001 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
3002     guiprefs.log_path = pwd;
3003     guiprefs.log_file = <span class="string">''</span>;
3004     
3005     log.path = pwd;
3006     log.file = <span class="string">''</span>;
3007     setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
3008 <span class="keyword">end</span>
3009 
3010 <span class="comment">% iRic</span>
3011 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>)
3012     iric = getpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>);
3013     <span class="keyword">if</span> exist(iric.path,<span class="string">'dir'</span>)
3014         guiprefs.iric_path = iric.path;
3015     <span class="keyword">else</span>
3016         guiprefs.iric_path = pwd;
3017     <span class="keyword">end</span>
3018     <span class="keyword">if</span> exist(fullfile(iric.path,iric.file),<span class="string">'file'</span>)
3019         guiprefs.iric_file = iric.file;
3020     <span class="keyword">else</span>
3021         guiprefs.iric_file = <span class="string">''</span>;
3022     <span class="keyword">end</span>
3023 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
3024     guiprefs.iric_path = pwd;
3025     guiprefs.iric_file = <span class="string">''</span>;
3026     
3027     iric.path = pwd;
3028     iric.file = <span class="string">''</span>;
3029     setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
3030 <span class="keyword">end</span>
3031 
3032 <span class="comment">% excel</span>
3033 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>)
3034     excel = getpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>);
3035     <span class="keyword">if</span> exist(excel.path,<span class="string">'dir'</span>)
3036         guiprefs.excel_path = excel.path;
3037     <span class="keyword">else</span>
3038         guiprefs.excel_path = pwd;
3039     <span class="keyword">end</span>
3040     <span class="keyword">if</span> exist(fullfile(excel.path,excel.file),<span class="string">'file'</span>)
3041         guiprefs.excel_file = excel.file;
3042     <span class="keyword">else</span>
3043         guiprefs.excel_file = <span class="string">''</span>;
3044     <span class="keyword">end</span>
3045 <span class="keyword">else</span> <span class="comment">% Initialize pref</span>
3046     guiprefs.excel_path = pwd;
3047     guiprefs.excel_file = <span class="string">''</span>;
3048     
3049     excel.path = pwd;
3050     excel.file = <span class="string">''</span>;
3051     setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
3052 <span class="keyword">end</span>
3053 
3054 <span class="comment">% aerial</span>
3055 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>)
3056     aerial = getpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>);
3057     <span class="keyword">if</span> exist(aerial.path,<span class="string">'dir'</span>)
3058         guiprefs.aerial_path = aerial.path;
3059     <span class="keyword">else</span>
3060         guiprefs.aerial_path = pwd;
3061     <span class="keyword">end</span>
3062     does_exist = false(1,length(aerial.file));
3063     <span class="keyword">if</span> iscell(aerial.file)
3064     <span class="keyword">for</span> k = 1:numel(aerial.file) <span class="comment">% Check each file one-by-one</span>
3065         does_exist(k) = exist(fullfile(aerial.path,aerial.file{k}),<span class="string">'file'</span>);
3066     <span class="keyword">end</span>
3067     <span class="keyword">else</span>
3068         does_exist = exist(fullfile(aerial.path,aerial.file),<span class="string">'file'</span>);
3069     <span class="keyword">end</span>
3070     <span class="keyword">if</span> any(does_exist)
3071         guiprefs.aerial_file = aerial.file;
3072     <span class="keyword">else</span>
3073         guiprefs.aerial_file = {<span class="string">''</span>};
3074     <span class="keyword">end</span>
3075 <span class="keyword">else</span> <span class="comment">% Initialize aerial</span>
3076     guiprefs.aerial_path = pwd;
3077     guiprefs.aerial_file = {<span class="string">''</span>};
3078     
3079     aerial.path = pwd;
3080     aerial.file = {<span class="string">''</span>};
3081     setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
3082 <span class="keyword">end</span>
3083 
3084 <span class="comment">% shoreline</span>
3085 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>)
3086     shoreline = getpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>);
3087     <span class="keyword">if</span> exist(shoreline.path,<span class="string">'dir'</span>)
3088         guiprefs.shoreline_path = shoreline.path;
3089     <span class="keyword">else</span>
3090         guiprefs.shoreline_path = pwd;
3091     <span class="keyword">end</span>
3092     
3093     <span class="keyword">if</span> iscell(shoreline.file)
3094         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file{1}),<span class="string">'file'</span>)
3095             guiprefs.shoreline_file = shoreline.file;
3096         <span class="keyword">else</span>
3097             guiprefs.shoreline_file = <span class="string">''</span>;
3098         <span class="keyword">end</span>
3099     <span class="keyword">else</span>
3100         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file),<span class="string">'file'</span>)
3101             guiprefs.shoreline_file = shoreline.file;
3102         <span class="keyword">else</span>
3103             guiprefs.shoreline_file = <span class="string">''</span>;
3104         <span class="keyword">end</span>
3105     <span class="keyword">end</span>
3106 <span class="keyword">else</span> <span class="comment">% Initialize shoreline</span>
3107     guiprefs.shoreline_path = pwd;
3108     guiprefs.shoreline_file = <span class="string">''</span>;
3109     
3110     shoreline.path = pwd;
3111     shoreline.file = <span class="string">''</span>;
3112     setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
3113 <span class="keyword">end</span>
3114 <span class="comment">% guiprefs.presentation = true;</span>
3115 <span class="comment">% guiprefs.print        = false;</span>
3116 
3117 <span class="comment">% for k = 1:length(prefs)</span>
3118 <span class="comment">%     newpref = '';</span>
3119 <span class="comment">%     if ispref('VMT',prefs{k})</span>
3120 <span class="comment">%         stored_newpref = getpref('VMT',prefs{k});</span>
3121 <span class="comment">%         if exist(stored_newpref,'dir')</span>
3122 <span class="comment">%             newpref = stored_newpref;</span>
3123 <span class="comment">%         else</span>
3124 <span class="comment">%             setpref('VMT',prefs{k},newpref)</span>
3125 <span class="comment">%         end</span>
3126 <span class="comment">%     end</span>
3127 <span class="comment">%     guiprefs.(prefs{k}) = newpref;</span>
3128 <span class="comment">% end</span>
3129 
3130 setappdata(hfigure,<span class="string">'guiprefs'</span>,guiprefs)
3131 
3132 <span class="comment">% [EOF] load_prefs</span>
3133 
3134 
3135 <span class="comment">% --------------------------------------------------------------------</span>
3136 <a name="_sub87" href="#_subfunctions" class="code">function store_prefs(hfigure,pref)</a>
3137 <span class="comment">% Store preferences in the Application data and in the persistent</span>
3138 <span class="comment">% preferences data.</span>
3139 
3140 <span class="comment">% Preferences:</span>
3141 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
3142 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
3143 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
3144 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
3145 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
3146 <span class="comment">% 'log'                  Path and filename of last Log file</span>
3147 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
3148 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
3149 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
3150 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
3151 
3152 guiprefs = getappdata(hfigure,<span class="string">'guiprefs'</span>);
3153 
3154 <span class="keyword">switch</span> pref
3155     <span class="keyword">case</span> <span class="string">'ascii'</span>
3156         ascii.path = guiprefs.ascii_path;
3157         ascii.file = guiprefs.ascii_file;
3158         setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
3159     <span class="keyword">case</span> <span class="string">'mat'</span>
3160         mat.path = guiprefs.mat_path;
3161         mat.file = guiprefs.mat_file;
3162         setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
3163     <span class="keyword">case</span> <span class="string">'tecplot'</span>
3164         tecplot.path = guiprefs.tecplot_path;
3165         tecplot.file = guiprefs.tecplot_file;
3166         setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
3167     <span class="keyword">case</span> <span class="string">'kmz'</span>
3168         kmz.path = guiprefs.kmz_path;
3169         kmz.file = guiprefs.kmz_file;
3170         setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
3171     <span class="keyword">case</span> <span class="string">'multibeambathymetry'</span>
3172         multibeambathymetry.path = guiprefs.multibeambathymetry_path;
3173         multibeambathymetry.file = guiprefs.multibeambathymetry_file;
3174         setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
3175     <span class="keyword">case</span> <span class="string">'log'</span>
3176         log.path = guiprefs.log_path;
3177         log.file = guiprefs.log_file;
3178         setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
3179     <span class="keyword">case</span> <span class="string">'iric'</span>
3180         iric.path = guiprefs.iric_path;
3181         iric.file = guiprefs.iric_file;
3182         setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
3183     <span class="keyword">case</span> <span class="string">'excel'</span>
3184         excel.path = guiprefs.excel_path;
3185         excel.file = guiprefs.excel_file;
3186         setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
3187     <span class="keyword">case</span> <span class="string">'aerial'</span>
3188         aerial.path = guiprefs.aerial_path;
3189         aerial.file = guiprefs.aerial_file;
3190         setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
3191     <span class="keyword">case</span> <span class="string">'shoreline'</span>
3192         shoreline.path = guiprefs.shoreline_path;
3193         shoreline.file = guiprefs.shoreline_file;
3194         setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
3195     <span class="keyword">otherwise</span>
3196 <span class="keyword">end</span>
3197 
3198 <span class="comment">% if ismember(pref,prefs)</span>
3199 <span class="comment">%     setpref('VMT',pref,value)</span>
3200 <span class="comment">%</span>
3201 <span class="comment">%     guiprefs = getappdata(hfigure,'guiprefs');</span>
3202 <span class="comment">%     guiprefs.(pref) = value;</span>
3203 <span class="comment">%     setappdata(hfigure,'guiprefs',guiprefs)</span>
3204 <span class="comment">% end</span>
3205 
3206 <span class="comment">% [EOF] store_prefs</span>
3207 
3208 
3209 <span class="comment">% --------------------------------------------------------------------</span>
3210 <a name="_sub88" href="#_subfunctions" class="code">function initGUI(handles)</a>
3211 <span class="comment">% Initialize the UI controls in the GUI.</span>
3212 
3213 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3214 
3215 <span class="comment">% Set the name and version</span>
3216 set(handles.figure1,<span class="string">'Name'</span>,[<span class="string">'Velocity Mapping Toolbox (VMT) '</span> guiparams.vmt_version], <span class="keyword">...</span>
3217     <span class="string">'DockControls'</span>,<span class="string">'off'</span>)
3218 <span class="comment">%set(handles.VMTversion,             'String',guiparams.vmt_version)</span>
3219 
3220 <span class="comment">% Set the PLOT 1 axis labels</span>
3221 axes(handles.Plot1Shiptracks);
3222 set(handles.Plot1Shiptracks,<span class="string">'DataAspectRatio'</span>,[1 1 1],<span class="string">'PlotBoxAspectRatio'</span>,[1 1 1])
3223 xlabel(<span class="string">'UTM Easting (m)'</span>)
3224 ylabel(<span class="string">'UTM Northing (m)'</span>)
3225 box on
3226 grid on
3227 <span class="comment">% ticks_format('%6.0f','%8.0f'); %formats the ticks for UTM</span>
3228 
3229 <span class="comment">%%%%%%%%%%%%</span>
3230 <span class="comment">% MENU BAR %</span>
3231 <span class="comment">%%%%%%%%%%%%</span>
3232 <span class="keyword">if</span> guiparams.english_units
3233     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3234     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
3235 <span class="keyword">else</span>
3236     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3237     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
3238 <span class="keyword">end</span>
3239 
3240 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
3241     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
3242     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3243 <span class="keyword">else</span>
3244     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
3245     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3246 <span class="keyword">end</span>
3247 
3248 
3249 <span class="keyword">if</span> guiparams.print
3250     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3251     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
3252     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3253     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3254 <span class="keyword">elseif</span> guiparams.presentation
3255     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3256     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
3257     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3258     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3259 <span class="keyword">else</span>
3260 <span class="keyword">end</span>
3261 
3262 
3263 <span class="comment">%%%%%%%%%%%%%%%</span>
3264 <span class="comment">% DATA EXPORT %</span>
3265 <span class="comment">%%%%%%%%%%%%%%%</span>
3266 <span class="comment">% BathymetryPanel</span>
3267 <span class="comment">% set(handles.BeamAngle,                  'String',guiparams.beam_angle)</span>
3268 <span class="comment">% set(handles.MagneticVariation,          'String',guiparams.magnetic_variation)</span>
3269 <span class="comment">% set(handles.WSE,                        'String',guiparams.wse)</span>
3270 <span class="comment">% set(handles.OutputAuxiliaryData,        'Value', guiparams.output_auxiliary_data)</span>
3271 
3272 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
3273 <span class="comment">% PLOTTING/PLAN VIEW %</span>
3274 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
3275 <span class="comment">% PlanViewPanel</span>
3276 set(handles.DepthRangeMin,              <span class="string">'String'</span>,guiparams.depth_range_min)
3277 set(handles.DepthRangeMax,              <span class="string">'String'</span>,guiparams.depth_range_max)
3278 set(handles.VectorScalePlanView,        <span class="string">'String'</span>,guiparams.vector_scale_plan_view)
3279 set(handles.VectorSpacingPlanview,      <span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
3280 set(handles.SmoothingWindowSize,        <span class="string">'String'</span>,guiparams.smoothing_window_size)
3281 set(handles.DisplayShoreline,           <span class="string">'Value'</span>, guiparams.display_shoreline)
3282 set(handles.AddBackground,              <span class="string">'Value'</span>, guiparams.add_background)
3283 
3284 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
3285 <span class="comment">% PLOTTING/SHIP TRACKS %</span>
3286 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
3287 <span class="comment">% ShiptracksPanel</span>
3288 set(handles.HorizontalGridNodeSpacing,  <span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
3289 <span class="comment">%set(handles.SetCrossSectionEndpoints,   'Value', guiparams.set_cross_section_endpoints)</span>
3290 
3291 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3292 <span class="comment">% PLOTTING/CROSS SECTIONS %</span>
3293 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3294 <span class="comment">% CrossSectionsPanel</span>
3295 set(handles.Contour,                    <span class="string">'String'</span>,{guiparams.contours.string}, <span class="keyword">...</span>
3296     <span class="string">'Value'</span>, guiparams.idx_contour)
3297 set(handles.VerticalExaggeration,       <span class="string">'String'</span>,guiparams.vertical_exaggeration)
3298 set(handles.VectorScaleCrossSection,    <span class="string">'String'</span>,guiparams.vector_scale_cross_section)
3299 set(handles.HorizontalVectorSpacing,    <span class="string">'String'</span>,guiparams.horizontal_vector_spacing)
3300 set(handles.VerticalVectorSpacing,      <span class="string">'String'</span>,guiparams.vertical_vector_spacing)
3301 set(handles.HorizontalSmoothingWindow,  <span class="string">'String'</span>,guiparams.horizontal_smoothing_window)
3302 set(handles.VerticalSmoothingWindow,    <span class="string">'String'</span>,guiparams.vertical_smoothing_window)
3303 set(handles.PlotSecondaryFlowVectors,   <span class="string">'Value'</span>, guiparams.plot_secondary_flow_vectors)
3304 set(handles.SecondaryFlowVectorVariable,<span class="string">'String'</span>,{guiparams.secondary_flows.string}, <span class="keyword">...</span>
3305     <span class="string">'Value'</span>, guiparams.idx_secondary_flow_vector_variable)
3306 set(handles.IncludeVerticalVelocity,    <span class="string">'Value'</span>, guiparams.include_vertical_velocity)
3307 
3308 <span class="comment">% set(handles.EnglishUnits,               'Value',guiparams.english_units)</span>
3309 
3310 <span class="comment">% [EOF] initGUI</span>
3311 
3312 
3313 <span class="comment">% --------------------------------------------------------------------</span>
3314 <a name="_sub89" href="#_subfunctions" class="code">function set_enable(handles,enable_state)</a>
3315 
3316 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3317 
3318 <span class="keyword">switch</span> enable_state
3319     <span class="keyword">case</span> <span class="string">'init'</span>
3320         set([handles.menuFile
3321             handles.menuOpen
3322             handles.menuOpenASCII
3323             handles.menuOpenMAT
3324             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3325         
3326         set([handles.toolbarLoadData
3327             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3328         set([handles.toolbarSaveMatFile
3329             handles.toolbarSaveBathymetry
3330             handles.toolbarSaveFigures
3331             handles.toolbarSaveExcel
3332             handles.toolbarPlottingParameters
3333             handles.toolbarProcessingParameters
3334             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3335         
3336         set([handles.DepthRangeMin
3337             handles.DepthRangeMax
3338             handles.VectorScalePlanView
3339             handles.VectorSpacingPlanview
3340             handles.SmoothingWindowSize
3341             handles.DisplayShoreline
3342             handles.AddBackground
3343             handles.PlotPlanView
3344             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3345         
3346         set([handles.HorizontalGridNodeSpacing
3347             handles.PlotShiptracks
3348             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3349         
3350         set([handles.Contour
3351             handles.VerticalExaggeration
3352             handles.VectorScaleCrossSection
3353             handles.HorizontalVectorSpacing
3354             handles.VerticalVectorSpacing
3355             handles.HorizontalSmoothingWindow
3356             handles.VerticalSmoothingWindow
3357             handles.PlotSecondaryFlowVectors
3358             handles.SecondaryFlowVectorVariable
3359             handles.IncludeVerticalVelocity
3360             handles.PlotCrossSection
3361             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3362         
3363     <span class="keyword">case</span> <span class="string">'fileloaded'</span>
3364         set([handles.menuFile
3365             handles.menuOpen
3366             handles.menuOpenASCII
3367             handles.menuOpenMAT
3368             handles.menuSaveMAT
3369             handles.menuSaveTecplot
3370             handles.menuSaveKMZFile
3371             handles.menuParameters
3372             handles.menuPlottingParameters
3373             handles.menuMetric
3374             handles.menuEnglish
3375             handles.menuBathymetryExportSettings
3376             handles.menuExportMultibeamBathymetry
3377             handles.menuKMZExport
3378             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3379         
3380         set([handles.toolbarLoadData
3381             handles.toolbarSaveMatFile
3382             handles.toolbarSaveBathymetry
3383             handles.toolbarSaveExcel
3384             handles.toolbarSaveFigures
3385             handles.toolbarPlottingParameters
3386             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3387         set([handles.toolbarProcessingParameters
3388             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3389         
3390            
3391         set([handles.DepthRangeMin
3392             handles.DepthRangeMax
3393             handles.VectorScalePlanView
3394             handles.VectorSpacingPlanview
3395             handles.SmoothingWindowSize
3396             handles.DisplayShoreline
3397             handles.PlotPlanView
3398             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3399         <span class="keyword">if</span> guiparams.has_mapping_toolbox
3400             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3401         <span class="keyword">else</span>
3402             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3403         <span class="keyword">end</span>
3404         
3405         set([handles.HorizontalGridNodeSpacing
3406             handles.PlotShiptracks
3407             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3408         
3409         set([handles.Contour
3410             handles.VerticalExaggeration
3411             handles.VectorScaleCrossSection
3412             handles.HorizontalVectorSpacing
3413             handles.VerticalVectorSpacing
3414             handles.HorizontalSmoothingWindow
3415             handles.VerticalSmoothingWindow
3416             handles.PlotSecondaryFlowVectors
3417             handles.SecondaryFlowVectorVariable
3418             handles.IncludeVerticalVelocity
3419             handles.PlotCrossSection
3420             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3421     <span class="keyword">case</span> <span class="string">'multiplematfiles'</span>
3422         set([handles.menuFile
3423             handles.menuOpen
3424             handles.menuOpenASCII
3425             handles.menuOpenMAT
3426             handles.menuParameters
3427             handles.menuPlottingParameters
3428             handles.menuMetric
3429             handles.menuEnglish
3430             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3431         set([handles.menuSaveMAT
3432             handles.menuBathymetryExportSettings
3433             handles.menuExportMultibeamBathymetry
3434             handles.menuKMZExport
3435             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3436         
3437         set([handles.toolbarLoadData
3438             handles.toolbarSaveFigures
3439             handles.toolbarPlottingParameters
3440             handles.toolbarSaveExcel
3441             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3442         set([handles.toolbarProcessingParameters
3443             handles.toolbarSaveMatFile
3444             handles.toolbarSaveBathymetry
3445             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3446         
3447         set([handles.DepthRangeMin
3448             handles.DepthRangeMax
3449             handles.VectorScalePlanView
3450             handles.VectorSpacingPlanview
3451             handles.SmoothingWindowSize
3452             handles.DisplayShoreline
3453             handles.PlotPlanView
3454             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3455         <span class="keyword">if</span> guiparams.has_mapping_toolbox
3456             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3457         <span class="keyword">else</span>
3458             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3459         <span class="keyword">end</span>
3460         
3461         set([handles.HorizontalGridNodeSpacing
3462             handles.PlotShiptracks
3463             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3464         
3465         set([handles.Contour
3466             handles.VerticalExaggeration
3467             handles.VectorScaleCrossSection
3468             handles.HorizontalVectorSpacing
3469             handles.VerticalVectorSpacing
3470             handles.HorizontalSmoothingWindow
3471             handles.VerticalSmoothingWindow
3472             handles.PlotSecondaryFlowVectors
3473             handles.SecondaryFlowVectorVariable
3474             handles.IncludeVerticalVelocity
3475             handles.PlotCrossSection
3476             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3477     <span class="keyword">otherwise</span>
3478 <span class="keyword">end</span>
3479 
3480 <span class="comment">% [EOF] set_enable</span>
3481 
3482 <span class="comment">%% Compute the longitudinal dispersion coefficient</span>
3483 
3484 <span class="comment">%% --- Executes on button press in zerosecq_chkbox.</span>
3485 <span class="comment">%function zerosecq_chkbox_Callback(hObject, eventdata, handles)</span>
3486 <span class="comment">% hObject    handle to zerosecq_chkbox (see GCBO)</span>
3487 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
3488 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
3489 
3490 <span class="comment">% Hint: get(hObject,'Value') returns toggle state of zerosecq_chkbox</span>
3491 
3492 
3493 <span class="comment">% --------------------------------------------------------------------</span>
3494 <a name="_sub90" href="#_subfunctions" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] = </a><span class="keyword">...</span>
3495     plotParametersDialog(english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style,hf)
3496 
3497 w = 500;
3498 h = 110;
3499 dx = 10;
3500 dy = 35;
3501 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
3502 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
3503     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
3504     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
3505     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
3506     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
3507     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
3508     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
3509     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3510     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
3511     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
3512     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
3513 dialog_params.english_units               = english_units;
3514 dialog_params.set_cross_section_endpoints = set_cross_section_endpoints;
3515 dialog_params.presentation                = plot_presentation_style; <span class="comment">%presentation;</span>
3516 dialog_params.print                       = plot_print_style; <span class="comment">%print;</span>
3517 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3518 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
3519 
3520 <span class="comment">% Build the graphics:</span>
3521 <span class="comment">% -------------------</span>
3522 handles.UnitsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
3523     <span class="string">'Title'</span>, <span class="string">'Units'</span>, <span class="keyword">...</span>
3524     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3525     <span class="string">'Position'</span>,[dx dy (w-3*dx)/3 h-dx-dy+10]);
3526 handles.UnitsMetric = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3527     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
3528     <span class="string">'String'</span>,<span class="string">'Metric'</span>, <span class="keyword">...</span>
3529     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3530     <span class="string">'Position'</span>,[15 35 100 22]);
3531 handles.UnitsEnglish = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3532     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
3533     <span class="string">'String'</span>,<span class="string">'English'</span>, <span class="keyword">...</span>
3534     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3535     <span class="string">'Position'</span>,[15 10 100 22]);
3536 
3537 handles.EndpointsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
3538     <span class="string">'Title'</span>, <span class="string">'Cross-Section Endpoints'</span>, <span class="keyword">...</span>
3539     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3540     <span class="string">'Position'</span>,[(w+dx)/3 dy (w-3*dx)/3 h-dx-dy+10]);
3541 handles.EndpointsAutomatic = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3542     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
3543     <span class="string">'String'</span>,<span class="string">'Automatic'</span>, <span class="keyword">...</span>
3544     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3545     <span class="string">'Position'</span>,[15 35 100 22]);
3546 handles.EndpointsManual = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3547     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
3548     <span class="string">'String'</span>,<span class="string">'Set Manually'</span>, <span class="keyword">...</span>
3549     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3550     <span class="string">'Position'</span>,[15 10 100 22]);
3551 
3552 handles.StylePanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
3553     <span class="string">'Title'</span>, <span class="string">'Plot Style'</span>, <span class="keyword">...</span>
3554     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3555     <span class="string">'Position'</span>,[w-w/3 dy (w-3*dx)/3 h-dx-dy+10]);
3556 handles.StylePresentation = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3557     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
3558     <span class="string">'String'</span>,<span class="string">'Presentation'</span>, <span class="keyword">...</span>
3559     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3560     <span class="string">'Position'</span>,[15 35 100 22]);
3561 handles.StylePrint = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3562     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
3563     <span class="string">'String'</span>,<span class="string">'Print'</span>, <span class="keyword">...</span>
3564     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3565     <span class="string">'Position'</span>,[15 10 100 22]);
3566 
3567 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
3568     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
3569     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
3570     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
3571     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
3572 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
3573     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
3574     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
3575     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
3576     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
3577 
3578 <span class="comment">% Update the UI controls:</span>
3579 <span class="comment">% -----------------------</span>
3580 <span class="keyword">if</span> dialog_params.english_units
3581     set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
3582     set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
3583 <span class="keyword">else</span>
3584     set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
3585     set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
3586 <span class="keyword">end</span>
3587 <span class="keyword">if</span> dialog_params.set_cross_section_endpoints
3588     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
3589     set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
3590 <span class="keyword">else</span>
3591     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
3592     set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
3593 <span class="keyword">end</span>
3594 <span class="keyword">if</span> dialog_params.presentation
3595     set(handles.StylePresentation, <span class="string">'Value'</span>,1)
3596     set(handles.StylePrint,        <span class="string">'Value'</span>,0)
3597 <span class="keyword">else</span>
3598     set(handles.StylePresentation, <span class="string">'Value'</span>,0)
3599     set(handles.StylePrint,        <span class="string">'Value'</span>,1)
3600 <span class="keyword">end</span>
3601 
3602 <span class="comment">% Set the callbacks:</span>
3603 <span class="comment">% ------------------</span>
3604 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub96" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
3605 set(handles.UnitsMetric,       <span class="string">'Callback'</span>,       {@<a href="#_sub91" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'metric'</span>})
3606 set(handles.UnitsEnglish,      <span class="string">'Callback'</span>,       {@<a href="#_sub91" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'english'</span>})
3607 set(handles.EndpointsAutomatic,<span class="string">'Callback'</span>,       {@<a href="#_sub92" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'auto'</span>})
3608 set(handles.EndpointsManual,   <span class="string">'Callback'</span>,       {@<a href="#_sub92" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'manual'</span>})
3609 set(handles.StylePresentation, <span class="string">'Callback'</span>,       {@<a href="#_sub93" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'presentation'</span>})
3610 set(handles.StylePrint,        <span class="string">'Callback'</span>,       {@<a href="#_sub93" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'print'</span>})
3611 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub94" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
3612 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub95" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
3613 
3614 <span class="comment">% Position the dialog and make it visible:</span>
3615 <span class="comment">% ----------------------------------------</span>
3616 fpos = get(hf,<span class="string">'Position'</span>);
3617 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
3618 movegui(handles.Figure,dpos)
3619 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
3620 
3621 <span class="comment">% Hold the dialog open:</span>
3622 <span class="comment">% ---------------------</span>
3623 waitfor(handles.OK)
3624 
3625 <span class="comment">% Return the outputs and close the dialog:</span>
3626 <span class="comment">% ----------------------------------------</span>
3627 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3628 english_units = dialog_params.english_units;
3629 set_cross_section_endpoints = dialog_params.set_cross_section_endpoints;
3630 plot_presentation_style =  dialog_params.presentation;
3631 plot_print_style =  dialog_params.print;
3632 
3633 delete(handles.Figure)
3634 
3635 <span class="comment">% [EOF] plotParametersDialog</span>
3636 
3637 
3638 <span class="comment">% --------------------------------------------------------------------</span>
3639 <a name="_sub91" href="#_subfunctions" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a>
3640 
3641 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3642 <span class="keyword">switch</span> the_units
3643     <span class="keyword">case</span> <span class="string">'metric'</span>
3644         dialog_params.english_units = false;
3645         
3646         set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
3647         set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
3648     <span class="keyword">case</span> <span class="string">'english'</span>
3649         dialog_params.english_units = true;
3650         
3651         set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
3652         set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
3653     <span class="keyword">otherwise</span>
3654 <span class="keyword">end</span>
3655 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3656 
3657 <span class="comment">% [EOF] dialogUnits</span>
3658 
3659 <span class="comment">% --------------------------------------------------------------------</span>
3660 <a name="_sub92" href="#_subfunctions" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a>
3661 
3662 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3663 <span class="keyword">switch</span> the_endpoints
3664     <span class="keyword">case</span> <span class="string">'auto'</span>
3665         dialog_params.set_cross_section_endpoints = false;
3666         
3667         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
3668         set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
3669     <span class="keyword">case</span> <span class="string">'manual'</span>
3670         dialog_params.set_cross_section_endpoints = true;
3671         
3672         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
3673         set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
3674     <span class="keyword">otherwise</span>
3675 <span class="keyword">end</span>
3676 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3677 
3678 <span class="comment">% [EOF] dialogEnpoints</span>
3679 
3680 <a name="_sub93" href="#_subfunctions" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a>
3681 
3682 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3683 <span class="keyword">switch</span> the_style
3684     <span class="keyword">case</span> <span class="string">'presentation'</span>
3685         dialog_params.presentation  = true;
3686         dialog_params.print         = false;
3687         
3688         set(handles.StylePresentation,<span class="string">'Value'</span>,1)
3689         set(handles.StylePrint,       <span class="string">'Value'</span>,0)
3690     <span class="keyword">case</span> <span class="string">'print'</span>
3691         dialog_params.presentation  = false;
3692         dialog_params.print         = true;
3693         
3694         set(handles.StylePresentation,<span class="string">'Value'</span>,0)
3695         set(handles.StylePrint,       <span class="string">'Value'</span>,1)
3696     <span class="keyword">otherwise</span>
3697 <span class="keyword">end</span>
3698 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3699 
3700 <span class="comment">% [EOF] dialogEnpoints</span>
3701 
3702 <span class="comment">% --------------------------------------------------------------------</span>
3703 <a name="_sub94" href="#_subfunctions" class="code">function dialogOK(hObject,eventdata,h_OK)</a>
3704 
3705 delete(h_OK)
3706 
3707 <span class="comment">% [EOF] dialogOK</span>
3708 
3709 <span class="comment">% --------------------------------------------------------------------</span>
3710 <a name="_sub95" href="#_subfunctions" class="code">function dialogCancel(hObject,eventdata,handles)</a>
3711 <span class="comment">% Return the original inputs</span>
3712 dialog_params = getappdata(handles.Figure,<span class="string">'original_dialog_params'</span>);
3713 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3714 delete(handles.OK)
3715 
3716 <span class="comment">% [EOF] dialogCancel</span>
3717 
3718 <span class="comment">% --------------------------------------------------------------------</span>
3719 <a name="_sub96" href="#_subfunctions" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a>
3720 
3721 delete(h_OK)
3722 
3723 <span class="comment">% [EOF] dialogCloseReq</span>
3724 
3725 <a name="_sub97" href="#_subfunctions" class="code">function [beam_angle,magnetic_variation,wse,output_auxilliary_data] = exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxilliary_data,hf)</a>
3726 w = 230;
3727 h = 200;
3728 dx = 10;
3729 dy = 35;
3730 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
3731 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Export Settings'</span>, <span class="keyword">...</span>
3732     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
3733     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
3734     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
3735     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
3736     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
3737     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
3738     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3739     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
3740     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
3741     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
3742 dialog_params.beam_angle             = beam_angle;
3743 dialog_params.magnetic_variation     = magnetic_variation;
3744 dialog_params.wse                    = wse;
3745 dialog_params.output_auxilliary_data = output_auxilliary_data;
3746 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3747 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
3748 
3749 <span class="comment">% Build the graphics:</span>
3750 <span class="comment">% -------------------</span>
3751 ph = 150;
3752 handles.BathymetryPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
3753     <span class="string">'Title'</span>, <span class="string">'Bathymetry'</span>, <span class="keyword">...</span>
3754     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3755     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
3756 handles.BeamAngleText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
3757     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
3758     <span class="string">'String'</span>,<span class="string">'Beam Angle (deg)'</span>, <span class="keyword">...</span>
3759     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
3760     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
3761     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3762     <span class="string">'Position'</span>,[dx+5 h-ph+60-4 100 22]);
3763 handles.BeamAngle = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
3764     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
3765     <span class="keyword">...</span><span class="comment">'String','Beam Angle (deg)', ...</span>
3766     <span class="string">'String'</span>,beam_angle,<span class="keyword">...</span>
3767     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
3768     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3769     <span class="string">'Position'</span>,[w-dx-80 h-ph+60 50 22]);
3770 handles.MagneticVariationText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
3771     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
3772     <span class="string">'String'</span>,<span class="string">'Magnetic Variation'</span>, <span class="keyword">...</span>
3773     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
3774     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
3775     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3776     <span class="string">'Position'</span>,[dx+5 h-ph+30-4 100 22]);
3777 handles.MagneticVariation = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
3778     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
3779     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
3780     <span class="string">'String'</span>,magnetic_variation,<span class="keyword">...</span>
3781     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
3782     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3783     <span class="string">'Position'</span>,[w-dx-80 h-ph+30 50 22]);
3784 handles.WSEText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
3785     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
3786     <span class="string">'String'</span>,<span class="string">'WSE (m)'</span>, <span class="keyword">...</span>
3787     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
3788     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
3789     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3790     <span class="string">'Position'</span>,[dx+5 h-ph-4 100 22]);
3791 handles.WSE = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
3792     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
3793     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
3794     <span class="string">'String'</span>,wse,<span class="keyword">...</span>
3795     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
3796     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3797     <span class="string">'Position'</span>,[w-dx-80 h-ph 50 22]);
3798 handles.OutputAuxilliaryData = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3799     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
3800     <span class="string">'String'</span>,<span class="string">'Output Auxilliary Data'</span>, <span class="keyword">...</span>
3801     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3802     <span class="string">'Position'</span>,[dx+5 20 w-2*dx-30 22]);
3803 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
3804     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
3805     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
3806     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
3807     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
3808 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
3809     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
3810     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
3811     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
3812     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
3813 
3814 <span class="comment">% Update the UI controls:</span>
3815 <span class="comment">% -----------------------</span>
3816 set(handles.BeamAngle,                <span class="string">'String'</span>,dialog_params.beam_angle)
3817 set(handles.MagneticVariation,        <span class="string">'String'</span>,dialog_params.magnetic_variation)
3818 set(handles.WSE,                      <span class="string">'String'</span>,dialog_params.wse)
3819 set(handles.OutputAuxilliaryData,     <span class="string">'Value'</span>,dialog_params.output_auxilliary_data)
3820 
3821 <span class="comment">% Set the callbacks:</span>
3822 <span class="comment">% ------------------</span>
3823 set(handles.Figure,                      <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub96" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
3824 set(handles.BeamAngle,                   <span class="string">'Callback'</span>,       {@<a href="#_sub98" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
3825 set(handles.MagneticVariation,           <span class="string">'Callback'</span>,       {@<a href="#_sub98" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
3826 set(handles.WSE,                         <span class="string">'Callback'</span>,       {@<a href="#_sub98" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
3827 set(handles.OutputAuxilliaryData,        <span class="string">'Callback'</span>,       {@<a href="#_sub98" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
3828 set(handles.OK,                          <span class="string">'Callback'</span>,       {@<a href="#_sub94" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,      handles.OK})
3829 set(handles.Cancel,                      <span class="string">'Callback'</span>,       {@<a href="#_sub95" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,  handles})
3830 
3831 <span class="comment">% Position the dialog and make it visible:</span>
3832 <span class="comment">% ----------------------------------------</span>
3833 fpos = get(hf,<span class="string">'Position'</span>);
3834 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
3835 movegui(handles.Figure,dpos)
3836 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
3837 
3838 <span class="comment">% Hold the dialog open:</span>
3839 <span class="comment">% ---------------------</span>
3840 waitfor(handles.OK)
3841 
3842 <span class="comment">% Return the outputs and close the dialog:</span>
3843 <span class="comment">% ----------------------------------------</span>
3844 dialog_params           = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3845 beam_angle              = dialog_params.beam_angle;
3846 magnetic_variation      = dialog_params.magnetic_variation;
3847 wse                     = str2num(dialog_params.wse);
3848 output_auxilliary_data  = dialog_params.output_auxilliary_data;
3849 
3850 delete(handles.Figure)
3851 
3852 <span class="comment">% [EOF] exportSettingsDialog</span>
3853 
3854 <span class="comment">% --------------------------------------------------------------------</span>
3855 <a name="_sub98" href="#_subfunctions" class="code">function dialogExportSettings(hObject,eventdata,handles)</a>
3856 
3857 <span class="comment">% Grab the current data</span>
3858 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3859 
3860 <span class="comment">% Set it according to the dialog box values</span>
3861 dialog_params.beam_angle                = get(handles.BeamAngle,<span class="string">'String'</span>);
3862 dialog_params.magnetic_variation        = get(handles.MagneticVariation,<span class="string">'String'</span>);
3863 dialog_params.wse                       = get(handles.WSE,<span class="string">'String'</span>);
3864 dialog_params.output_auxilliary_data    = get(handles.OutputAuxilliaryData,<span class="string">'Value'</span>);
3865 
3866 <span class="comment">% Re-store the application data</span>
3867 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3868 
3869 <span class="comment">% [EOF] dialogExportSettings</span>
3870 
3871 <a name="_sub99" href="#_subfunctions" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a>
3872 
3873 w = 230;
3874 h = 200;
3875 dx = 10;
3876 dy = 35;
3877 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
3878 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Select open figures to export'</span>, <span class="keyword">...</span>
3879     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
3880     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
3881     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
3882     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
3883     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
3884     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
3885     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3886     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
3887     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
3888     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
3889 dialog_params.figure_names               = figure_names;
3890 dialog_params.selected_figures           = <span class="string">''</span>;
3891 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3892 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
3893 
3894 <span class="comment">% Build the graphics:</span>
3895 <span class="comment">% -------------------</span>
3896 handles.ListboxPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
3897     <span class="string">'Title'</span>, <span class="string">'Figures'</span>, <span class="keyword">...</span>
3898     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3899     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
3900 handles.Figures = uicontrol(<span class="string">'Style'</span>,<span class="string">'listbox'</span>, <span class="keyword">...</span>
3901     <span class="string">'Parent'</span>,handles.ListboxPanel, <span class="keyword">...</span>
3902     <span class="string">'BackGroundColor'</span>,<span class="string">'white'</span>,<span class="keyword">...</span>
3903     <span class="string">'String'</span>,figure_names, <span class="keyword">...</span>
3904     <span class="string">'Min'</span>, 0,<span class="keyword">...</span>
3905     <span class="string">'Max'</span>, 2,<span class="keyword">...</span>
3906     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3907     <span class="string">'Position'</span>,[15 35 (w-5*dx) 100]);
3908 
3909 
3910 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
3911     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
3912     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
3913     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
3914     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
3915 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
3916     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
3917     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
3918     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
3919     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
3920 
3921 <span class="comment">% Update the UI controls:</span>
3922 <span class="comment">% -----------------------</span>
3923 
3924 
3925 <span class="comment">% Set the callbacks:</span>
3926 <span class="comment">% ------------------</span>
3927 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub96" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
3928 set(handles.Figures,           <span class="string">'Callback'</span>,       {@<a href="#_sub100" class="code" title="subfunction dialogSelectFigures(hObject,eventdata,handles)">dialogSelectFigures</a>    handles})
3929 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub94" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
3930 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub95" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
3931 
3932 <span class="comment">% Position the dialog and make it visible:</span>
3933 <span class="comment">% ----------------------------------------</span>
3934 fpos = get(hf,<span class="string">'Position'</span>);
3935 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
3936 movegui(handles.Figure,dpos)
3937 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
3938 
3939 <span class="comment">% Hold the dialog open:</span>
3940 <span class="comment">% ---------------------</span>
3941 waitfor(handles.OK)
3942 
3943 <span class="comment">% Return the outputs and close the dialog:</span>
3944 <span class="comment">% ----------------------------------------</span>
3945 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3946 selected_figures = dialog_params.selected_figures;
3947 
3948 delete(handles.Figure)
3949 
3950 <span class="comment">% [EOF] openFiguresDialog</span>
3951 
3952 <span class="comment">% --------------------------------------------------------------------</span>
3953 <a name="_sub100" href="#_subfunctions" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a>
3954 
3955 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3956 
3957 idx_selected = get(handles.Figures,<span class="string">'Value'</span>);
3958 fig_names    = get(handles.Figures,<span class="string">'String'</span>);
3959 selected     = fig_names(idx_selected);
3960 dialog_params.selected_figures = selected;
3961 
3962 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3963 
3964 
3965 
3966 <span class="comment">% --------------------------------------------------------------------</span>
3967 <a name="_sub101" href="#_subfunctions" class="code">function icons = getIcons</a>
3968 
3969 <span class="comment">% Load data</span>
3970 idx = 1;
3971 icons(idx).data(:,:,1) = <span class="keyword">...</span>
3972     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
3973     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   129   120   135   188   NaN   NaN   NaN
3974     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN    96   189   NaN   NaN   130   NaN    95   NaN
3975     NaN   NaN   206   206   206   206   NaN   NaN   NaN   NaN   NaN   NaN   NaN    84    79   NaN
3976     NaN   206   255   255   255   255   198   197   NaN   NaN   NaN   NaN    83    79    76   NaN
3977     198   255   255   255   255   255   255   198   198   198   198   198   198   212   212   NaN
3978     198   255   255   255   255   255   255   255   255   255   255   255   198   157   197   NaN
3979     198   255   226   198   198   198   198   198   198   198   198   198   198   198   177   NaN
3980     198   255   198   218   255   255   255   255   255   255   255   255   255   255   161   NaN
3981     198   253   198   247   255   255   255   255   255   255   255   255   255   251   155   NaN
3982     198   226   201   255   255   255   255   255   255   255   255   255   231   206   165   NaN
3983     198   207   215   255   255   255   255   255   255   255   255   255   239   198   159   NaN
3984     198   198   240   255   255   255   255   255   255   255   255   255   222   157   159   NaN
3985     198   199   255   255   255   255   255   255   255   255   255   255   191   165   159   NaN
3986     NaN   165   165   165   165   165   165   165   165   165   165   165   165   159   159   NaN
3987     NaN   NaN   159   159   159   159   159   159   159   159   159   159   159   159   NaN   NaN]/255;
3988 
3989 icons(idx).data(:,:,2) = <span class="keyword">...</span>
3990     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
3991     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   145   137   149   195   NaN   NaN   NaN
3992     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   116   196   NaN   NaN   145   NaN   116   NaN
3993     NaN   NaN   162   162   162   162   NaN   NaN   NaN   NaN   NaN   NaN   NaN   107   105   NaN
3994     NaN   162   255   255   255   255   154   197   NaN   NaN   NaN   NaN   106   104   103   NaN
3995     154   255   255   255   255   255   255   154   154   154   154   154   154   208   208   NaN
3996     154   243   243   243   243   243   243   255   255   255   255   255   154   123   197   NaN
3997     154   235   193   154   154   154   154   154   154   154   154   154   154   154   137   NaN
3998     154   215   154   191   255   255   251   255   255   255   255   255   231   255   126   NaN
3999     154   213   154   240   255   255   255   255   255   255   255   255   199   249   123   NaN
4000     154   179   160   255   247   247   247   247   247   247   247   247   190   188   115   NaN
4001     154   162   184   255   235   235   235   235   235   235   235   231   186   154   169   NaN
4002     154   154   228   255   227   227   227   227   227   227   227   223   178   123   169   NaN
4003     154   156   255   215   215   215   215   215   215   215   215   215   153   115   169   NaN
4004     NaN   115   115   115   115   115   115   115   115   115   115   115   115   169   169   NaN
4005     NaN   NaN   169   169   169   169   169   169   169   169   169   169   169   169   NaN   NaN]/255;
4006 
4007 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4008     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
4009     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   166   161   170   202   NaN   NaN   NaN
4010     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   149   205   NaN   NaN   166   NaN   148   NaN
4011     NaN   NaN    34    34    34    34   NaN   NaN   NaN   NaN   NaN   NaN   NaN   141   144   NaN
4012     NaN    34   255   255   255   255    25   197   NaN   NaN   NaN   NaN   142   145   147   NaN
4013     25   255   156   156   156   156   255    25    25    25    25    25    25   200   200   NaN
4014     25   156   140   140   140   140   140   255   255   255   255   255    25    26   197   NaN
4015     25   132    80    25    25    25    25    25    25    25    25    25    25    25    25   NaN
4016     25   132    25   108   255   255   247   255   255   255   255   255   132   255    25   NaN
4017     25   112    25   137   156   156   156   156   156   156   156   156    91   150    25   NaN
4018     25    67    33   165   148   148   148   148   148   148   148   148    83    92    13   NaN
4019     25    38    64   156   132   132   132   132   132   132   132   132    67    25   176   NaN
4020     25    26   122   156   124   124   124   124   124   124   124   124    67    26   176   NaN
4021     25    28   156   108   108   108   108   108   108   108   108   108    41    13   176   NaN
4022     NaN    13    13    13    13    13    13    13    13    13    13    13    13   176   176   NaN
4023     NaN   NaN   176   176   176   176   176   176   176   176   176   176   176   176   NaN   NaN]/255;
4024 
4025 <span class="comment">% Save data</span>
4026 idx = idx+1;
4027 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4028     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
4029     NaN    0.6902    0.6902    0.6902    0.6902    0.6902    0.6274    0.6274    0.5647    0.5647    0.5647    0.5019    0.5019    0.4392    0.2510       NaN
4030     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.3137    0.3765    0.2510    0.4670
4031     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.2510    0.1882    0.2510    0.4670
4032     NaN    0.6274    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.1882    0.5019    0.2510    0.4670
4033     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.1882    0.4392    0.2510    0.4670
4034     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.1255    0.3765    0.2510    0.4670
4035     NaN    0.5647    0.7529    0.3765    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.7529    0.0627    0.3765    0.2510    0.4670
4036     NaN    0.5647    0.7529    0.6902    0.3765    0.3137    0.3137    0.2510    0.1882    0.1882    0.1255    0.0627    0.3765    0.3137    0.2510    0.4670
4037     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5019    0.5019    0.5019    0.4392    0.4392    0.3765    0.3137    0.3137    0.2510    0.4670
4038     NaN    0.5019    0.6902    0.6274    0.5647    0.3137    0.3137    0.3137    0.3137    0.3137    0.3765    0.3137    0.3137    0.2510    0.2510    0.4670
4039     NaN    0.4392    0.6274    0.5647    0.5019    0.3137       NaN    0.1882    0.8157    0.8157    0.3765    0.2510    0.2510    0.2510    0.2510    0.4670
4040     NaN    0.4392    0.6274    0.5019    0.5019    0.3137    0.1882    0.4392    0.8784    0.8784    0.4392    0.1882    0.2510    0.1882    0.2510    0.4670
4041     NaN    0.4392    0.5647    0.5019    0.1255    0.1255    0.6902    0.6902    0.7529    0.7529    0.3137    0.1882    0.1882    0.1882    0.2510    0.4670
4042     NaN    0.7333    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.4670
4043     NaN       NaN    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670];
4044 
4045 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4046     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
4047     NaN    0.7216    0.7216    0.6902    0.6902    0.6588    0.6274    0.5961    0.5647    0.5647    0.5333    0.5019    0.4706    0.4706    0.2196       NaN
4048     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.3451    0.3451    0.2196    0.5378
4049     NaN    0.6902    0.7529    0.5333    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.3137    0.1882    0.2196    0.5378
4050     NaN    0.6588    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.3137    0.4706    0.2196    0.5378
4051     NaN    0.6274    0.7529    0.4706    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.2824    0.4392    0.2196    0.5378
4052     NaN    0.5961    0.7529    0.4392    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.2510    0.4078    0.2196    0.5378
4053     NaN    0.5647    0.7529    0.4078    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.7843    0.2196    0.3765    0.2196    0.5378
4054     NaN    0.5333    0.7216    0.7216    0.3765    0.3765    0.3451    0.3137    0.3137    0.2824    0.2510    0.2196    0.3765    0.3451    0.2196    0.5378
4055     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5333    0.5019    0.4706    0.4392    0.4078    0.3765    0.3451    0.3137    0.2196    0.5378
4056     NaN    0.4706    0.6588    0.6274    0.5647    0.3451    0.3451    0.3451    0.3451    0.3765    0.4078    0.3451    0.3137    0.2824    0.2196    0.5378
4057     NaN    0.4706    0.6274    0.5647    0.5333    0.3451       NaN    0.2510    0.8470    0.8784    0.4706    0.2824    0.2824    0.2510    0.2196    0.5378
4058     NaN    0.4392    0.5961    0.5333    0.5019    0.3451    0.2510    0.4706    0.8784    0.9098    0.5019    0.2510    0.2510    0.2510    0.2196    0.5378
4059     NaN    0.4078    0.5647    0.5019    0.2824    0.1882    0.7216    0.7216    0.7529    0.7843    0.3137    0.2510    0.2510    0.2196    0.2196    0.5378
4060     NaN    0.7176    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.5378
4061     NaN       NaN    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378];
4062 
4063 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4064     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
4065     NaN    0.9412    0.9412    0.9412    0.9412    0.9412    0.9412    0.8784    0.8784    0.8784    0.8784    0.8784    0.8157    0.8157    0.4392       NaN
4066     NaN    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.7529    0.6902    0.4392    0.5997
4067     NaN    0.9412    1.0000    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.7529    0.3765    0.4392    0.5997
4068     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.6902    0.8784    0.4392    0.5997
4069     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.6902    0.8157    0.4392    0.5997
4070     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.6274    0.8157    0.4392    0.5997
4071     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.8784    0.6274    0.7529    0.4392    0.5997
4072     NaN    0.8784    1.0000    1.0000    0.8157    0.7529    0.7529    0.7529    0.6902    0.6902    0.6274    0.6274    0.7529    0.7529    0.4392    0.5997
4073     NaN    0.8784    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8784    0.8157    0.8157    0.7529    0.7529    0.6902    0.4392    0.5997
4074     NaN    0.8157    1.0000    1.0000    0.9412    0.4392    0.4392    0.4392    0.4392    0.4392    0.5019    0.7529    0.6902    0.6902    0.4392    0.5997
4075     NaN    0.8157    1.0000    0.9412    0.9412    0.4392       NaN    0.2510    0.9412    0.9412    0.5019    0.6902    0.6902    0.6274    0.4392    0.5997
4076     NaN    0.8157    1.0000    0.9412    0.8784    0.4392    0.2510    0.5647    0.9412    0.9412    0.5647    0.6274    0.6274    0.6274    0.4392    0.5997
4077     NaN    0.8157    0.9412    0.8784    0.6902    0.2510    0.7529    0.7529    0.8157    0.8157    0.3137    0.6274    0.6274    0.6274    0.4392    0.5997
4078     NaN    0.8275    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.5997
4079     NaN       NaN    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997];
4080 
4081 <span class="comment">% Plotting parameters</span>
4082 idx = idx+1;
4083 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4084     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
4085     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4086     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4087     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
4088     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
4089     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
4090     0   101   239   255   224   109   255   255   255   247    79   254   254   123    36   165
4091     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
4092     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
4093     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
4094     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
4095     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
4096     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
4097     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4098     0     0     0     1     0     0     0     0     0     0     0     0     0     0     0   165
4099     255   165   165   165   172   165   165   165   165   165   165   165   165   165   165   165]/255;
4100 
4101 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4102     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
4103     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0     0
4104     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4105     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
4106     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
4107     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
4108     0   101   239   255   224   109   255   255   255   247    79   254   254   123     0   165
4109     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
4110     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
4111     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
4112     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
4113     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
4114     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
4115     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4116     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   165
4117     0   165   165   165   153   165   165   165   165   165   165   165   165   165   165   165]/255;
4118 
4119 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4120     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
4121     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4122     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4123     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4124     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4125     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4126     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4127     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4128     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4129     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4130     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4131     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4132     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4133     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4134     0    24    39     0     0     0     0     0     0     0     0     0     0     0     0   145
4135     255   145   145   145   134   145   145   145   145   145   145   145   145   145   145   145]/255;
4136 
4137 <span class="comment">% Processing parameters</span>
4138 idx = idx+1;
4139 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4140     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
4141     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
4142     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4143     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4144     255     0   255   255   107   255   255   107   255   255   107   255   107   255     0   255
4145     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4146     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4147     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4148     255     0   255   255   107   255   107   255   107   255   255   107   255   255     0   255
4149     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4150     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4151     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4152     255     0   255   107   255   107   255   107   255   255   107   255   107   255     0   255
4153     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4154     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4155     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
4156 
4157 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4158     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
4159     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
4160     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4161     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4162     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
4163     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4164     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4165     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4166     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
4167     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4168     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4169     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4170     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
4171     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4172     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4173     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
4174 
4175 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4176     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
4177     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
4178     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4179     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4180     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
4181     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4182     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4183     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4184     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
4185     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4186     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4187     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4188     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
4189     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4190     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4191     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
4192 
4193 <span class="comment">% Export bathymetry dialog</span>
4194 idx = idx+1;
4195 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4196     [226    226    226    226    226    226    226    197    220    226    226    226    226    226    226    226
4197     226    226    226    226    226    227    241    144    158    241    228    228    229    228    229    226
4198     226    243    243    243    237    237    246    164    119    242    232    225    226    218    243    206
4199     179    152    153    166    148    148    177    179    63    185    141    146    154    151    179    189
4200     167    4    134    175    151    164    161    198    122    255    212    233    215    199    140    185
4201     134    50    209    241    255    255    133    118    15    20    28    94    4    0    0    89
4202     136    0    0    0    0    0    0    0    0    0    0    0    0    21    56    140
4203     208    255    226    233    255    242    215    232    251    237    226    233    207    222    156    139
4204     172    159    152    153    166    145    178    147    169    164    161    163    154    153    128    135
4205     160    164    148    139    171    150    165    154    165    185    166    173    190    190    148    162
4206     214    233    211    203    217    212    217    238    202    236    213    222    230    224    184    184
4207     219    206    174    190    219    204    201    218    183    224    219    222    217    202    176    182
4208     210    182    183    214    225    220    203    229    175    217    220    220    222    212    184    185
4209     197    175    207    224    223    220    205    231    170    221    220    220    222    217    191    187
4210     186    193    223    224    220    201    203    228    171    224    218    220    222    215    190    187
4211     189    211    220    216    204    201    214    213    187    213    216    220    220    212    193    189
4212     ]/255;
4213 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4214     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
4215     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
4216     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
4217     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
4218     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
4219     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
4220     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
4221     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
4222     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
4223     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
4224     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
4225     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
4226     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
4227     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
4228     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
4229     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
4230     ]/255;
4231 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4232     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
4233     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
4234     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
4235     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
4236     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
4237     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
4238     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
4239     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
4240     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
4241     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
4242     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
4243     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
4244     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
4245     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
4246     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
4247     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
4248     ]/255;
4249 
4250 <span class="comment">% Export Figures Dialog</span>
4251 idx = idx + 1;
4252 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4253     [NaN    NaN    10    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
4254     NaN    NaN    67    255    255    255    255    255    255    255    201    141    NaN    NaN    NaN    NaN
4255     NaN    NaN    43    255    241    240    241    246    252    255    186    220    151    NaN    NaN    NaN
4256     NaN    NaN    42    255    238    237    237    236    238    254    210    178    214    38    NaN    NaN
4257     NaN    NaN    43    255    241    241    241    241    240    244    252    255    255    79    NaN    NaN
4258     NaN    NaN    47    255    232    232    225    224    224    223    220    238    255    69    NaN    NaN
4259     NaN    NaN    55    233    114    225    230    223    221    221    215    237    255    67    NaN    NaN
4260     4    NaN    37    181    168    126    193    214    205    200    203    242    255    67    NaN    NaN
4261     41    164    134    153    144    139    131    209    238    223    242    240    255    67    NaN    NaN
4262     41    118    91    91    122    125    120    106    170    241    245    241    255    67    NaN    NaN
4263     41    113    91    89    97    108    99    89    117    205    190    230    255    67    NaN    NaN
4264     41    124    94    88    78    74    81    179    255    252    244    241    255    67    NaN    NaN
4265     13    34    76    187    88    92    222    255    255    250    250    250    255    73    NaN    NaN
4266     NaN    NaN    69    236    121    227    255    243    238    238    238    238    255    82    NaN    NaN
4267     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
4268 
4269 
4270 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4271     [NaN    NaN    10    24    24    24    24    24    24    24    22    4    NaN    NaN    NaN    NaN
4272     NaN    NaN    69    255    255    255    255    255    255    255    204    144    NaN    NaN    NaN    NaN
4273     NaN    NaN    45    255    241    240    241    246    252    255    189    222    155    NaN    NaN    NaN
4274     NaN    NaN    43    255    238    237    237    236    238    254    210    179    215    39    NaN    NaN
4275     NaN    NaN    44    255    241    241    241    241    240    244    252    255    255    80    NaN    NaN
4276     NaN    NaN    49    255    231    230    225    224    224    223    220    238    255    70    NaN    NaN
4277     NaN    NaN    56    227    136    214    227    223    221    221    215    237    255    68    NaN    NaN
4278     4    NaN    19    157    243    154    181    210    204    200    203    242    255    67    NaN    NaN
4279     51    255    231    225    219    217    172    197    232    222    242    240    255    67    NaN    NaN
4280     52    227    184    183    195    201    204    172    169    239    245    241    255    67    NaN    NaN
4281     51    218    177    177    180    187    187    177    130    202    190    230    255    67    NaN    NaN
4282     51    237    195    183    172    170    152    175    255    251    244    241    255    67    NaN    NaN
4283     15    38    72    173    183    149    211    255    255    250    250    250    255    73    NaN    NaN
4284     NaN    NaN    65    226    174    214    252    242    238    238    238    238    255    84    NaN    NaN
4285     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
4286 
4287 
4288 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4289     [NaN    NaN    9    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
4290     NaN    NaN    66    255    255    255    255    255    255    255    196    139    NaN    NaN    NaN    NaN
4291     NaN    NaN    42    255    239    238    238    244    252    255    186    216    148    NaN    NaN    NaN
4292     NaN    NaN    41    255    236    235    235    234    237    251    210    176    212    36    NaN    NaN
4293     NaN    NaN    42    255    239    239    239    239    238    241    252    255    255    78    NaN    NaN
4294     NaN    NaN    46    255    233    232    224    223    223    223    219    235    255    67    NaN    NaN
4295     NaN    NaN    53    240    101    232    230    221    219    218    213    235    255    65    NaN    NaN
4296     5    NaN    60    212    94    107    205    215    203    198    201    240    255    66    NaN    NaN
4297     34    56    40    80    70    62    94    222    241    221    240    238    255    66    NaN    NaN
4298     35    10    2    0    51    55    36    46    176    240    243    239    255    66    NaN    NaN
4299     35    11    9    7    16    34    12    6    110    204    188    228    255    66    NaN    NaN
4300     35    14    0    0    0    0    14    187    255    251    242    239    255    66    NaN    NaN
4301     12    37    84    206    0    41    234    255    255    248    248    248    255    72    NaN    NaN
4302     NaN    NaN    69    249    79    239    255    240    236    236    236    236    255    80    NaN    NaN
4303     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
4304 
4305 <span class="comment">% Export Excel File</span>
4306 idx = idx + 1;
4307 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4308     [NaN    NaN    NaN    NaN    NaN    NaN  106  252  255  255  255  255  255  255  255  255
4309    38  136  109  101   96   77   95  134  106   99   93   87   90   66  255  255
4310    52  197  232  217  210  202  191  178  170  164  160  159  155   15  255  255
4311    51  181  255  255  255  255  255  255  255  255  255  255  253    9  255  255
4312    49  174  245  153  156  175  255  255  181  153  149  205  245    0  255  255
4313    47  168  199  122  149  100  155  183   99   99   15  117  245    0  255  241
4314    45  158  255  146  146  141   87   68  120   34   86  255  238    0  252  232
4315    42  144  255  255  158  158  143   74   68  117  255  255  230    0  255  255
4316    40  134  255  255  169   15  150  111   68   81  105  167  236    0  230  217
4317    37  131  255  158   99  106   10  143  117   50   51  165  252    0  255  254
4318    35  122  208    0   22   32    8   17  110   20    0   13  212    0  255  245
4319    33  115  255  255  255  255  255  250  146  113  119  106  217    0  236  217
4320    31  109  255  254  252  251  250  255  255  255  255  255  241    0  255  251
4321    29  116  190  168  164  157  145  133  126  121  117  118  112    0  215  205
4322    20   63   47   38   36   20   38   83   64   51   52   55   64   20  255  241
4323     NaN    NaN    NaN    NaN    NaN    NaN   96  249  252  228  237  251  249  203  241  246]/255;
4324 
4325 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4326     [NaN    NaN    NaN    NaN    NaN    NaN  114  252  255  255  255  255  255  255  255  255
4327    49  180  152  145  140  118  140  173  150  139  132  126  126  106  255  255
4328    67  249  252  242  237  231  221  207  201  196  194  193  193   75  255  255
4329    66  232  255  255  255  255  255  255  255  255  255  255  255   68  255  255
4330    64  226  251  197  191  200  255  255  194  170  168  214  253   61  255  255
4331    62  220  224  183  207  173  189  202  167  175  116  172  253   58  255  246
4332    60  211  255  190  196  203  166  131  187  134  148  255  249   54  254  240
4333    57  199  255  255  198  203  202  158  132  168  255  255  245   47  255  255
4334    54  190  255  255  200  110  199  185  155  147  160  203  251   44  240  230
4335    52  187  255  204  187  194  121  204  189  139   99  179  255   39  255  254
4336    49  180  230   42   49   53   36   64  182   98   65   70  228   36  255  248
4337    47  171  255  255  255  255  255  255  186  115  124  114  235   34  243  229
4338    45  166  255  255  254  254  255  255  255  255  255  255  255   33  255  252
4339    43  176  222  206  204  200  190  180  174  171  169  169  169   32  229  220
4340    30  101   81   74   69   54   72  116   96   84   84   84   94   55  255  245
4341     NaN    NaN    NaN    NaN    NaN    NaN  105  251  253  237  242  252  251  218  246  249]/255;
4342 
4343 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4344     [ NaN    NaN    NaN    NaN    NaN    NaN  125  253  255  255  255  255  255  255  255  255
4345    34  118   92   84   79   56   83  111   88   79   73   69   74   45  255  255
4346    46  180  228  207  203  195  182  169  159  155  149  149  145    0  255  255
4347    45  163  255  255  255  255  255  255  255  255  255  255  254    0  255  255
4348    42  156  248  152  155  176  255  255  181  154  147  206  245    0  255  255
4349    40  150  202  117  136   87  154  181   90   84    8  120  243    0  255  252
4350    38  138  255  145  137  131   81   65  106   27   86  255  238    0  255  250
4351    35  122  255  255  159  152  137   75   62  121  255  255  229    0  255  255
4352    33  113  255  255  171   13  145  111   67   76   84  159  234    0  255  247
4353    30  109  255  160   89   97   10  136  111   36   33  159  251    0  255  255
4354    28   99  211    0   12   23    2   11  101    0    0   13  209    0  255  253
4355    26   92  255  255  255  255  255  250  146  111  117  104  213    0  255  245
4356    23   89  255  255  255  255  255  255  255  255  255  255  241    0  255  254
4357    22   93  180  156  151  141  129  114  105   98   93   93   83    0  255  239
4358    15   43   26   17   15    0   25   63   45   39   38   39   44    9  255  252
4359     NaN    NaN    NaN    NaN    NaN    NaN  117  253  255  249  251  255  254  239  252  254]/255;
4360 
4361 <span class="comment">% [EOF] getIcons</span>
4362 
4363 <a name="_sub102" href="#_subfunctions" class="code">function guiparams = createGUIparams</a>
4364 <span class="comment">% Creates the guiparams structure with specified defaults.</span>
4365 
4366 <span class="comment">% Organized by GUI panels</span>
4367 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
4368 <span class="comment">% SHIPTRACKS PLOT %</span>
4369 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
4370 guiparams.horizontal_grid_node_spacing       = 1.0;
4371 
4372 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
4373 <span class="comment">% CROSS SECTION PLOT %</span>
4374 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
4375 guiparams.contours                           = <span class="string">''</span>; <span class="comment">% Set below</span>
4376 guiparams.contour                            = <span class="string">''</span>; <span class="comment">% Set below</span>
4377 guiparams.idx_contour                        = 1;
4378 guiparams.vertical_exaggeration              = 10;
4379 guiparams.vector_scale_cross_section         = 0.2;
4380 guiparams.horizontal_vector_spacing          = 1;
4381 guiparams.vertical_vector_spacing            = 1;
4382 guiparams.horizontal_smoothing_window        = 1;
4383 guiparams.vertical_smoothing_window          = 1;
4384 guiparams.plot_secondary_flow_vectors        = true;
4385 guiparams.secondary_flows                    = <span class="string">''</span>; <span class="comment">% Set below</span>
4386 guiparams.secondary_flow_vector_variable     = <span class="string">''</span>; <span class="comment">% Set below</span>
4387 guiparams.idx_secondary_flow_vector_variable = 1;
4388 guiparams.include_vertical_velocity          = true;
4389 
4390 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
4391 <span class="comment">% PLAN VIEW PLOT %</span>
4392 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
4393 guiparams.depth_range_min                    = 0;
4394 guiparams.depth_range_max                    = inf;
4395 guiparams.vector_scale_plan_view             = 1;
4396 guiparams.vector_spacing_plan_view           = 1;
4397 guiparams.smoothing_window_size              = 1;
4398 guiparams.display_shoreline                  = false;
4399 guiparams.add_background                     = false;
4400 
4401 <span class="comment">%%%%%%%%%%%%%%%</span>
4402 <span class="comment">% DATA EXPORT %</span>
4403 <span class="comment">%%%%%%%%%%%%%%%</span>
4404 guiparams.beam_angle                         = 20.0;
4405 guiparams.magnetic_variation                 = 0.0;
4406 guiparams.wse                                = 0.0;
4407 guiparams.output_auxiliary_data              = false;
4408 
4409 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
4410 <span class="comment">% Contour variables %</span>
4411 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
4412 idx = 1;
4413 guiparams.contours(idx).string   = <span class="string">'Streamwise Velocity (u)'</span>;
4414 guiparams.contours(idx).variable = <span class="string">'streamwise'</span>;
4415 idx = idx + 1;
4416 guiparams.contours(idx).string   = <span class="string">'Transverse Velocity (v)'</span>;
4417 guiparams.contours(idx).variable = <span class="string">'transverse'</span>;
4418 idx = idx + 1;
4419 guiparams.contours(idx).string   = <span class="string">'Vertical Velocity (w)'</span>;
4420 guiparams.contours(idx).variable = <span class="string">'vertical'</span>;
4421 idx = idx + 1;
4422 guiparams.contours(idx).string   = <span class="string">'Velocity Magnitude'</span>;
4423 guiparams.contours(idx).variable = <span class="string">'mag'</span>;
4424 idx = idx + 1;
4425 guiparams.contours(idx).string   = <span class="string">'East Velocity (E)'</span>;
4426 guiparams.contours(idx).variable = <span class="string">'east'</span>;
4427 idx = idx + 1;
4428 guiparams.contours(idx).string   = <span class="string">'North Velocity (N)'</span>;
4429 guiparams.contours(idx).variable = <span class="string">'north'</span>;
4430 idx = idx + 1;
4431 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (zsd)'</span>;
4432 guiparams.contours(idx).variable = <span class="string">'primary_zsd'</span>;
4433 idx = idx + 1;
4434 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (zsd)'</span>;
4435 guiparams.contours(idx).variable = <span class="string">'secondary_zsd'</span>;
4436 idx = idx + 1;
4437 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (Roz)'</span>;
4438 guiparams.contours(idx).variable = <span class="string">'primary_roz'</span>;
4439 idx = idx + 1;
4440 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (Roz)'</span>;
4441 guiparams.contours(idx).variable = <span class="string">'secondary_roz'</span>;
4442 idx = idx + 1;
4443 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Downstream Comp.)'</span>;
4444 guiparams.contours(idx).variable = <span class="string">'primary_roz_x'</span>;
4445 idx = idx + 1;
4446 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Cross-Stream Comp.)'</span>;
4447 guiparams.contours(idx).variable = <span class="string">'primary_roz_y'</span>;
4448 idx = idx + 1;
4449 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Downstream Comp.)'</span>;
4450 guiparams.contours(idx).variable = <span class="string">'secondary_roz_x'</span>;
4451 idx = idx + 1;
4452 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Cross-Stream Comp.)'</span>;
4453 guiparams.contours(idx).variable = <span class="string">'secondary_roz_y'</span>;
4454 idx = idx + 1;
4455 guiparams.contours(idx).string   = <span class="string">'Backscatter'</span>;
4456 guiparams.contours(idx).variable = <span class="string">'backscatter'</span>;
4457 idx = idx + 1;
4458 guiparams.contours(idx).string   = <span class="string">'Flow Direction (deg.)'</span>;
4459 guiparams.contours(idx).variable = <span class="string">'flowangle'</span>;
4460 
4461 guiparams.contour = guiparams.contours(guiparams.idx_contour).variable;
4462 
4463 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4464 <span class="comment">% Secondary Flow Vector Variables %</span>
4465 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4466 idx = 1;
4467 guiparams.secondary_flows(idx).string   = <span class="string">'Transverse'</span>;
4468 guiparams.secondary_flows(idx).variable = <span class="string">'transverse'</span>;
4469 idx = idx + 1;
4470 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (zsd)'</span>;
4471 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_zsd'</span>;
4472 idx = idx + 1;
4473 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz)'</span>;
4474 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz'</span>;
4475 idx = idx + 1;
4476 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz, Cross-Stream Comp)'</span>;
4477 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz_y'</span>;
4478 idx = idx + 1;
4479 guiparams.secondary_flows(idx).string   = <span class="string">'Primary (Roz, Cross-Stream Comp)'</span>;
4480 guiparams.secondary_flows(idx).variable  = <span class="string">'primary_roz_y'</span>;
4481 
4482 guiparams.secondary_flow_vector_variable = <span class="keyword">...</span>
4483     guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).variable;
4484 
4485 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4486 <span class="comment">% INTERNAL SETTINGS &amp; DEFAULTS %</span>
4487 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4488 <span class="comment">% Menu bar options</span>
4489 guiparams.presentation                       = true;
4490 guiparams.print                              = false;
4491 guiparams.set_cross_section_endpoints        = false;
4492 guiparams.unit_discharge_correction          = false;
4493 guiparams.english_units                      = false;
4494 guiparams.vertical_offset                    = 0;
4495 <span class="comment">% guiparams.plot_ship_tracks                   = false;</span>
4496 <span class="comment">% guiparams.plot_planview                      = false;</span>
4497 <span class="comment">% guiparams.plot_cross_section                 = false;</span>
4498 
4499 <span class="comment">% File location defaults</span>
4500 guiparams.ascii_path                        = pwd;
4501 guiparams.ascii_file                        = <span class="string">''</span>;
4502 guiparams.mat_path                          = pwd;
4503 guiparams.mat_file                          = <span class="string">''</span>;
4504 guiparams.tecplot_path                      = pwd;
4505 guiparams.tecplot_file                      = <span class="string">''</span>;
4506 guiparams.kmz_path                          = pwd;
4507 guiparams.kmz_file                          = <span class="string">''</span>;
4508 guiparams.multibeambathymetry_path          = pwd;
4509 guiparams.multibeambathymetry_file          = <span class="string">''</span>;
4510 guiparams.log_path                          = pwd;
4511 guiparams.log_file                          = <span class="string">''</span>;
4512 <span class="comment">% Avoids problems of not finding the MCR root when running as a standalone</span>
4513 <span class="comment">% application</span>
4514 <span class="keyword">if</span> isdeployed 
4515     guiparams.has_mapping_toolbox           = true;
4516 <span class="keyword">else</span>
4517     guiparams.has_mapping_toolbox               = <span class="keyword">...</span>
4518         ~isempty(dir(fullfile(matlabroot,<span class="string">'toolbox'</span>,<span class="string">'map'</span>)));
4519 <span class="keyword">end</span>
4520 
4521 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4522 <span class="comment">% IN MEMORY DATA STORAGE %</span>
4523 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4524 guiparams.z                      = [];
4525 guiparams.A                      = [];
4526 guiparams.V                      = [];
4527 guiparams.Map                    = [];
4528 guiparams.savefile               = [];
4529 guiparams.iric_anv_planview_data = [];
4530 <span class="comment">% guiparams.zmin = []; % Don't need to store these?</span>
4531 <span class="comment">% guiparams.zmax = [];</span>
4532 <span class="comment">% guiprefs = getappdata(handles.figure1,'guiprefs');</span>
4533 guiparams.data_folder = <span class="string">''</span>;
4534 guiparams.data_files  = {<span class="string">''</span>};
4535 
4536 <span class="comment">% [EOF] createGUIparams</span>
4537 
4538 <span class="comment">% [EOF] VMT</span></pre></div>
<hr><address>Generated on Thu 25-Jul-2013 11:02:04 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>