<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of VMT</title>
  <meta name="keywords" content="VMT">
  <meta name="description" content="--- THE VELOCITY MAPPING TOOLBOX ---">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html trunk -->
<h1>VMT
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>--- THE VELOCITY MAPPING TOOLBOX ---</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function varargout = VMT(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> --- THE VELOCITY MAPPING TOOLBOX ---
 
 VMT is a Matlab-based software for processing and visualizing ADCP data
 collected along transects in rivers or other bodies of water. VMT allows
 rapid processing, visualization, and analysis of a range of ADCP datasets
 and includes utilities to export ADCP data to files compatible with
 ArcGIS, Tecplot, and Google Earth. The software can be used to explore
 patterns of three-dimensional fluid motion through several methods for
 calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et
 al., 2000). The software also includes capabilities for analyzing the
 acoustic backscatter and bathymetric data from the ADCP. A user-friendly
 graphical user interface (GUI) enhances program functionality and
 provides ready access to two- and three- dimensional plotting functions,
 allowing rapid display and interrogation of velocity, backscatter, and
 bathymetry data.
 
 CITATION: 
 Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.
 L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,
 J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and
 visualization suite for moving-vessel ADCP measurements. Earth Surf.
 Process. Landforms. doi: 10.1002/esp.3367

__________________________________________________________________________
 P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center
 (pjackson@usgs.gov)

 Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.
__________________________________________________________________________</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>	Takes the processed data structure and writes a TecPlot ASCII data file.</li><li><a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>	Takes the processed data structure and writes a TecPlot ASCII data file</li><li><a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>	Computes the multibeam bathymetry from the four beams of the ADCP</li><li><a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>	Outputs the mean cross section (3-D) from VMT to Google Earth (saved as a</li><li><a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>	Prompts the user for a geotiff DOQQ (USGS) and overlays the aerial image</li><li><a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>	This function plots a plan view of the measurement region with a vector</li><li><a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>	Plots the shiptracks, and interpolated grid in the VMT GUI axes. Also</li><li><a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>	Plots a shoreline map given the shoreline data structure 'Map' (see</li><li><a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english)">VMT_PlotXSCont</a>	Plots contours for the variable 'var' within the mean cross section given</li><li><a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,varargin)">VMT_PlotXSContQuiver</a>	This function plots the the contour plot (mean XS) for the variable 'var'</li><li><a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>	This function is a driver to preprocess the transects data.  Several</li><li><a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>	Driver program to process multiple transects at a single cross-section</li><li><a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>	Read in multiple ASCII output files from WinRiver or WinRiverII.</li><li><a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>	Saves the figures (specified by fignums) from VMT as .PNG or EPS files</li><li><a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>	This routine smooths all processed variables in V struct. By default is</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a></li><li><a href="#_sub2" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub3" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub4" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub5" class="code">function menuFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub6" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub7" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub8" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub9" class="code">function menuSave_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub10" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub11" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub12" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub13" class="code">function menuExport_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub14" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub15" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub16" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub17" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub18" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub19" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub20" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub21" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub22" class="code">function menuParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub23" class="code">function menuProcessingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub24" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub25" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub26" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub27" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub28" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub29" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub30" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub31" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub32" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub33" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub34" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub35" class="code">function menuKMZExport_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub36" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub37" class="code">function menuTools_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub38" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub39" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub40" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub41" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub42" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub43" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub44" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub45" class="code">function loadDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub46" class="code">function saveDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub47" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub48" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub49" class="code">function processingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub50" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub51" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub52" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub53" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub54" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub55" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub56" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub57" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub58" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub59" class="code">function WSE_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub60" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub61" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub62" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub63" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub64" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub65" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub66" class="code">function DisplayShoreline_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub67" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub68" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub69" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub70" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub71" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub72" class="code">function Contour_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub73" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub74" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub75" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub76" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub77" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub78" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub79" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub80" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub81" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub82" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub83" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub84" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub85" class="code">function handles = buildToolbar(handles)</a></li><li><a href="#_sub86" class="code">function load_prefs(hfigure)</a></li><li><a href="#_sub87" class="code">function store_prefs(hfigure,pref)</a></li><li><a href="#_sub88" class="code">function initGUI(handles)</a></li><li><a href="#_sub89" class="code">function set_enable(handles,enable_state)</a></li><li><a href="#_sub90" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] =</a></li><li><a href="#_sub91" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a></li><li><a href="#_sub92" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a></li><li><a href="#_sub93" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a></li><li><a href="#_sub94" class="code">function dialogOK(hObject,eventdata,h_OK)</a></li><li><a href="#_sub95" class="code">function dialogCancel(hObject,eventdata,handles)</a></li><li><a href="#_sub96" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a></li><li><a href="#_sub97" class="code">function [beam_angle,magnetic_variation,wse,output_auxilliary_data] = exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxilliary_data,hf)</a></li><li><a href="#_sub98" class="code">function dialogExportSettings(hObject,eventdata,handles)</a></li><li><a href="#_sub99" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a></li><li><a href="#_sub100" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a></li><li><a href="#_sub101" class="code">function icons = getIcons</a></li><li><a href="#_sub102" class="code">function guiparams = createGUIparams</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function varargout = VMT(varargin)</a>
0002 <span class="comment">% --- THE VELOCITY MAPPING TOOLBOX ---</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% VMT is a Matlab-based software for processing and visualizing ADCP data</span>
0005 <span class="comment">% collected along transects in rivers or other bodies of water. VMT allows</span>
0006 <span class="comment">% rapid processing, visualization, and analysis of a range of ADCP datasets</span>
0007 <span class="comment">% and includes utilities to export ADCP data to files compatible with</span>
0008 <span class="comment">% ArcGIS, Tecplot, and Google Earth. The software can be used to explore</span>
0009 <span class="comment">% patterns of three-dimensional fluid motion through several methods for</span>
0010 <span class="comment">% calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et</span>
0011 <span class="comment">% al., 2000). The software also includes capabilities for analyzing the</span>
0012 <span class="comment">% acoustic backscatter and bathymetric data from the ADCP. A user-friendly</span>
0013 <span class="comment">% graphical user interface (GUI) enhances program functionality and</span>
0014 <span class="comment">% provides ready access to two- and three- dimensional plotting functions,</span>
0015 <span class="comment">% allowing rapid display and interrogation of velocity, backscatter, and</span>
0016 <span class="comment">% bathymetry data.</span>
0017 <span class="comment">%</span>
0018 <span class="comment">% CITATION:</span>
0019 <span class="comment">% Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.</span>
0020 <span class="comment">% L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,</span>
0021 <span class="comment">% J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and</span>
0022 <span class="comment">% visualization suite for moving-vessel ADCP measurements. Earth Surf.</span>
0023 <span class="comment">% Process. Landforms. doi: 10.1002/esp.3367</span>
0024 <span class="comment">%</span>
0025 <span class="comment">%__________________________________________________________________________</span>
0026 <span class="comment">% P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center</span>
0027 <span class="comment">% (pjackson@usgs.gov)</span>
0028 <span class="comment">%</span>
0029 <span class="comment">% Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.</span>
0030 <span class="comment">%__________________________________________________________________________</span>
0031 
0032 <span class="comment">% Begin initialization code - DO NOT EDIT</span>
0033 gui_Singleton = 1;
0034 gui_State = struct(<span class="string">'gui_Name'</span>,       mfilename, <span class="keyword">...</span>
0035     <span class="string">'gui_Singleton'</span>,  gui_Singleton, <span class="keyword">...</span>
0036     <span class="string">'gui_OpeningFcn'</span>, @<a href="#_sub1" class="code" title="subfunction VMT_OpeningFcn(hObject, eventdata, handles, varargin)">VMT_OpeningFcn</a>, <span class="keyword">...</span>
0037     <span class="string">'gui_OutputFcn'</span>,  @<a href="#_sub2" class="code" title="subfunction varargout = VMT_OutputFcn(hObject, eventdata, handles)">VMT_OutputFcn</a>, <span class="keyword">...</span>
0038     <span class="string">'gui_LayoutFcn'</span>,  [] , <span class="keyword">...</span>
0039     <span class="string">'gui_Callback'</span>,   []);
0040 <span class="keyword">if</span> nargin &amp;&amp; ischar(varargin{1})
0041     gui_State.gui_Callback = str2func(varargin{1});
0042 <span class="keyword">end</span>
0043 
0044 <span class="comment">% If ERROR, write a txt file with the error dump info</span>
0045 <span class="keyword">try</span>
0046 <span class="keyword">if</span> nargout
0047     [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
0048 <span class="keyword">else</span>
0049     gui_mainfcn(gui_State, varargin{:});
0050 <span class="keyword">end</span>
0051 
0052 <span class="keyword">catch</span> err
0053     <span class="keyword">if</span> isdeployed
0054         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
0055             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
0056         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
0057             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
0058             errLogFileName},<span class="keyword">...</span>
0059             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0060             <span class="string">'error'</span>);
0061         fid = fopen(errLogFileName,<span class="string">'W'</span>);
0062         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
0063         fclose(fid);
0064         rethrow(err)
0065     <span class="keyword">else</span>
0066         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
0067             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0068             <span class="string">'error'</span>);
0069         rethrow(err);
0070     <span class="keyword">end</span>
0071 <span class="keyword">end</span>
0072 <span class="comment">% End initialization code - DO NOT EDIT</span>
0073 
0074 <span class="comment">%#ok&lt;*DEFNU,*INUSL,*INUSD&gt;</span>
0075 
0076 <span class="comment">% --- Executes just before VMT is made visible.</span>
0077 <a name="_sub1" href="#_subfunctions" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a>
0078 <span class="comment">% This function has no output args, see OutputFcn.</span>
0079 <span class="comment">% hObject    handle to figure</span>
0080 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0081 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0082 <span class="comment">% varargin   command line arguments to VMT (see VARARGIN)</span>
0083 
0084 <span class="comment">% Choose default command line output for VMT</span>
0085 handles.output = hObject;
0086 
0087 <span class="comment">% Build the GUI toolbar:</span>
0088 <span class="comment">% ----------------------</span>
0089 handles = <a href="#_sub85" class="code" title="subfunction handles = buildToolbar(handles)">buildToolbar</a>(handles);
0090 
0091 <span class="comment">% Ensure path to utils &amp; docs is available</span>
0092 <span class="comment">% ----------------------------------------</span>
0093 <span class="keyword">if</span> ~isdeployed
0094     filesep = <span class="string">'\'</span>; <span class="comment">% windows</span>
0095     utilspath = [pwd filesep <span class="string">'utils'</span>];
0096     docspath  = [pwd filesep <span class="string">'doc'</span>];
0097     toolspath = [pwd filesep <span class="string">'tools'</span>];
0098     addpath(utilspath,docspath,toolspath)
0099 <span class="keyword">end</span>
0100 
0101 <span class="comment">% Update handles structure</span>
0102 <span class="comment">% ------------------------</span>
0103 guidata(hObject, handles);
0104 
0105 <span class="comment">% Load the GUI preferences:</span>
0106 <span class="comment">% -------------------------</span>
0107 <a href="#_sub86" class="code" title="subfunction load_prefs(hfigure)">load_prefs</a>(handles.figure1)
0108 
0109 <span class="comment">% Initialize the GUI parameters:</span>
0110 <span class="comment">% ------------------------------</span>
0111 guiparams = <a href="#_sub102" class="code" title="subfunction guiparams = createGUIparams">createGUIparams</a>;
0112 guiparams.vmt_version = <span class="string">'v4.02'</span>;
0113 
0114 <span class="comment">% Draw the VMT Background</span>
0115 <span class="comment">% -----------------</span>
0116 pos = get(handles.figure1,<span class="string">'position'</span>);
0117 axes(handles.VMTBackground);
0118 <span class="keyword">if</span> ~isdeployed <span class="comment">%isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0119     X = imread(<span class="string">'VMT_Background.png'</span>);
0120     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0121 <span class="keyword">else</span>
0122     X = imread(<span class="string">'VMT_Background.png'</span>);
0123     X = imresize(X, [pos(4) pos(3)]);
0124     X = uint8(X);
0125     imshow(X,<span class="string">'Border'</span>,<span class="string">'tight'</span>)
0126 <span class="keyword">end</span>
0127 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0128 
0129 <span class="comment">% Store the application data:</span>
0130 <span class="comment">% ---------------------------</span>
0131 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0132 
0133 <span class="comment">% Initialize the GUI:</span>
0134 <span class="comment">% -------------------</span>
0135 <a href="#_sub88" class="code" title="subfunction initGUI(handles)">initGUI</a>(handles)
0136 <a href="#_sub89" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'init'</span>)
0137 <span class="comment">% set(handles.GraphicsExportPanel,'Visible','off')</span>
0138 <span class="comment">% set(handles.ProcessingPanel,'Visible','off')</span>
0139 pos = get(handles.figure1,<span class="string">'Position'</span>);
0140 <span class="comment">% pos(3) = 545;</span>
0141 set(handles.figure1,<span class="string">'Position'</span>,pos)
0142 set(handles.figure1,<span class="string">'Resize'</span>,<span class="string">'on'</span>)
0143 
0144 <span class="comment">% Allow access to the VMT Main GUI info by other sub-GUIs by pushing it to</span>
0145 <span class="comment">% the root</span>
0146 setappdata(0  , <span class="string">'hVMTgui'</span>    , gcf);
0147 
0148 <span class="comment">% UIWAIT makes VMT wait for user response (see UIRESUME)</span>
0149 <span class="comment">% uiwait(handles.figure1);</span>
0150 <span class="comment">% [EOF] VMT_OpeningFcn</span>
0151 
0152 
0153 <span class="comment">% --- Outputs from this function are returned to the command line.</span>
0154 <a name="_sub2" href="#_subfunctions" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a>
0155 <span class="comment">% varargout  cell array for returning output args (see VARARGOUT);</span>
0156 <span class="comment">% hObject    handle to figure</span>
0157 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0158 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0159 
0160 <span class="comment">% Get default command line output from handles structure</span>
0161 varargout{1} = handles.output;
0162 <span class="comment">% [EOF] VMT_OutputFcn</span>
0163 
0164 <span class="comment">% --- Executes when figure1 is resized.</span>
0165 <a name="_sub3" href="#_subfunctions" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a>
0166 
0167 <span class="comment">% Draw the VMT Background</span>
0168 <span class="comment">% -----------------</span>
0169 pos = get(handles.figure1,<span class="string">'position'</span>);
0170 axes(handles.VMTBackground);
0171 <span class="keyword">if</span> ~isdeployed <span class="comment">%isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0172     X = imread(<span class="string">'VMT_Background.png'</span>);
0173     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0174 <span class="keyword">else</span>
0175     X = imread(<span class="string">'VMT_Background.png'</span>);
0176     X = imresize(X, [pos(4) pos(3)]);
0177     X = uint8(X);
0178     imshow(X,<span class="string">'Border'</span>,<span class="string">'tight'</span>)
0179 <span class="keyword">end</span>
0180 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0181 
0182 <span class="comment">% --- Executes when user attempts to close figure1.</span>
0183 <a name="_sub4" href="#_subfunctions" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a>
0184 <span class="comment">% hObject    handle to figure1 (see GCBO)</span>
0185 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0186 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0187 
0188 <span class="comment">% Hint: delete(hObject) closes the figure</span>
0189 close_button = questdlg(<span class="keyword">...</span>
0190     <span class="string">'You are about to exit VMT. Any unsaved work will be lost. Are you sure?'</span>,<span class="keyword">...</span>
0191     <span class="string">'Exit VMT?'</span>,<span class="string">'No'</span>);
0192 <span class="keyword">switch</span> close_button
0193     <span class="keyword">case</span> <span class="string">'Yes'</span>
0194         delete(hObject)
0195         close all hidden
0196     <span class="keyword">otherwise</span>
0197         <span class="keyword">return</span>
0198 <span class="keyword">end</span>
0199 <span class="comment">% [EOF] figure1_CloseRequestFcn</span>
0200 
0201 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0202 <span class="comment">% MENU BAR CALLBACKS %</span>
0203 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0204 
0205 <span class="comment">% --------------------------------------------------------------------</span>
0206 <a name="_sub5" href="#_subfunctions" class="code">function menuFile_Callback(hObject, eventdata, handles)</a>
0207 <span class="comment">% Empty</span>
0208 
0209 <span class="comment">% --------------------------------------------------------------------</span>
0210 <a name="_sub6" href="#_subfunctions" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a>
0211 <span class="comment">% Empty</span>
0212 
0213 <span class="comment">% --------------------------------------------------------------------</span>
0214 <a name="_sub7" href="#_subfunctions" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a>
0215 <a href="#_sub45" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>(hObject, eventdata, handles)
0216 <span class="comment">% [EOF] menuOpenASCII_Callback</span>
0217 
0218 <span class="comment">% --------------------------------------------------------------------</span>
0219 <a name="_sub8" href="#_subfunctions" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a>
0220 
0221 <span class="comment">% Get the Application data:</span>
0222 <span class="comment">% -------------------------</span>
0223 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0224 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0225 
0226 <span class="comment">% Ask the user to select files:</span>
0227 <span class="comment">% -----------------------------</span>
0228 <span class="comment">% current_file = fullfile(guiparams.data_folder,guiparams.data_files{1});</span>
0229 <span class="comment">% current_file = fullfile(guiprefs.mat_path,guiprefs.mat_file);</span>
0230 <span class="keyword">if</span> iscell(guiprefs.mat_file)
0231     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file{1});
0232 <span class="keyword">else</span>
0233     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file);
0234 <span class="keyword">end</span>
0235 [filename,pathname] = <span class="keyword">...</span>
0236     uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-files (*.mat)'</span>}, <span class="keyword">...</span>
0237     <span class="string">'Select MAT File'</span>, <span class="keyword">...</span>
0238     uifile, <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
0239 
0240 <span class="keyword">if</span> ischar(filename) <span class="comment">% Single MAT file loaded</span>
0241     <span class="comment">% Load the data:</span>
0242     <span class="comment">% --------------</span>
0243     vars = load(fullfile(pathname,filename));
0244     
0245     <span class="comment">% Make sure the selected file is a valid file:</span>
0246     <span class="comment">% --------------------------------------------</span>
0247     varnames = fieldnames(vars);
0248     <span class="keyword">if</span> isequal(sort(varnames),{<span class="string">'A'</span> <span class="string">'Map'</span> <span class="string">'V'</span> <span class="string">'z'</span>}')
0249         guiparams.mat_path = pathname;
0250         guiparams.mat_file = filename;
0251         guiparams.z = vars.z;
0252         guiparams.A = vars.A;
0253         guiparams.V = vars.V;
0254         
0255         <span class="comment">% Update the preferences:</span>
0256         <span class="comment">% -----------------------</span>
0257         guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0258         guiprefs.mat_path = pathname;
0259         guiprefs.mat_file = filename;
0260         setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0261         <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0262                      
0263         <span class="comment">% Re-store the Application Data:</span>
0264         <span class="comment">% ------------------------------</span>
0265         setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0266         
0267         <span class="comment">% Update the GUI:</span>
0268         <span class="comment">% ---------------</span>
0269         <a href="#_sub89" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
0270     <span class="keyword">else</span> <span class="comment">% Not a valid file</span>
0271         errordlg(<span class="string">'The selected file is not a valid ADCP data MAT file.'</span>, <span class="keyword">...</span>
0272             <span class="string">'Invalid File...'</span>)
0273     <span class="keyword">end</span>
0274     
0275 <span class="keyword">elseif</span> iscell(filename) <span class="comment">% Multiple MAT files loaded</span>
0276     <span class="comment">% Set the filenames</span>
0277     <span class="comment">% -----------------</span>
0278     guiparams.mat_path = pathname;
0279     guiparams.mat_file = filename;
0280     
0281     <span class="comment">% Push status to log window</span>
0282     <span class="comment">% -------------------------</span>
0283     log_text = {<span class="keyword">...</span>
0284         <span class="string">'Loading previously processed MAT files.'</span>;<span class="keyword">...</span>
0285         <span class="string">'Directory:'</span>};
0286     log_text = vertcat(log_text, pathname, {<span class="string">'Files:'</span>}, filename');
0287     statusLogging(handles.LogWindow,log_text)
0288     
0289     <span class="comment">% Update the Application Data:</span>
0290     <span class="comment">% ------------------------------</span>
0291     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0292     
0293     <span class="comment">% Update the persistent preferences:</span>
0294     <span class="comment">% ----------------------------------</span>
0295     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0296     guiprefs.mat_path = pathname;
0297     guiprefs.mat_file = filename;
0298     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0299     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0300         
0301     <span class="comment">% Update the GUI:</span>
0302     <span class="comment">% ---------------</span>
0303     <a href="#_sub89" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'multiplematfiles'</span>)
0304 <span class="keyword">end</span>
0305 
0306 <span class="comment">% [EOF] menuOpenMAT_Callback</span>
0307 
0308 <span class="comment">% --------------------------------------------------------------------</span>
0309 <a name="_sub9" href="#_subfunctions" class="code">function menuSave_Callback(hObject, eventdata, handles)</a>
0310 <span class="comment">% Empty</span>
0311 
0312 <span class="comment">% --------------------------------------------------------------------</span>
0313 <a name="_sub10" href="#_subfunctions" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a>
0314 <a href="#_sub46" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>(hObject, eventdata, handles)
0315 <span class="comment">% [EOF] menuSaveMAT_Callback</span>
0316 
0317 <span class="comment">% --------------------------------------------------------------------</span>
0318 <a name="_sub11" href="#_subfunctions" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a>
0319 <a href="#_sub54" class="code" title="subfunction SaveTecplotFile_Callback(hObject, eventdata, handles)">SaveTecplotFile_Callback</a>(handles,eventdata,handles)
0320 <span class="comment">% [EOF] menuSaveTecplot_Callback</span>
0321 
0322 <span class="comment">% --------------------------------------------------------------------</span>
0323 <a name="_sub12" href="#_subfunctions" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a>
0324 <a href="#_sub55" class="code" title="subfunction SaveGoogleEarthFile_Callback(hObject, eventdata, handles)">SaveGoogleEarthFile_Callback</a>(handles,eventdata,handles)
0325 <span class="comment">% [EOF] menuSaveKMZFile_Callback</span>
0326 
0327 <span class="comment">% --------------------------------------------------------------------</span>
0328 <a name="_sub13" href="#_subfunctions" class="code">function menuExport_Callback(hObject, eventdata, handles)</a>
0329 <span class="comment">% Empty</span>
0330 
0331 <span class="comment">% --------------------------------------------------------------------</span>
0332 <a name="_sub14" href="#_subfunctions" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a>
0333 <span class="comment">% Empty</span>
0334 
0335 <span class="comment">% --------------------------------------------------------------------</span>
0336 <a name="_sub15" href="#_subfunctions" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a>
0337 
0338 <span class="comment">% Get the Application Data:</span>
0339 <span class="comment">% -------------------------</span>
0340 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0341 
0342 <span class="comment">% Update the Application Data:</span>
0343 <span class="comment">% ----------------------------</span>
0344 guiparams.print        = true;
0345 guiparams.presentation = false;
0346 
0347 <span class="comment">% Re-store the Application data:</span>
0348 <span class="comment">% ------------------------------</span>
0349 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0350 
0351 <span class="comment">% Update the GUI:</span>
0352 <span class="comment">% ---------------</span>
0353 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0354 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
0355 
0356 <span class="comment">% [EOF] menuPrintFormat_Callback</span>
0357 
0358 
0359 <span class="comment">% --------------------------------------------------------------------</span>
0360 <a name="_sub16" href="#_subfunctions" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a>
0361 
0362 <span class="comment">% Get the Application Data:</span>
0363 <span class="comment">% -------------------------</span>
0364 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0365 
0366 <span class="comment">% Update the Application Data:</span>
0367 <span class="comment">% ----------------------------</span>
0368 guiparams.print        = false;
0369 guiparams.presentation = true;
0370 
0371 <span class="comment">% Re-store the Application data:</span>
0372 <span class="comment">% ------------------------------</span>
0373 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0374 
0375 <span class="comment">% Update the GUI:</span>
0376 <span class="comment">% ---------------</span>
0377 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0378 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
0379 
0380 <span class="comment">% [EOF] menuPresentationFormat_Callback</span>
0381 
0382 <span class="comment">% --------------------------------------------------------------------</span>
0383 <a name="_sub17" href="#_subfunctions" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a>
0384 <span class="comment">% Get the Application data:</span>
0385 <span class="comment">% -------------------------</span>
0386 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0387 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0388 
0389 <span class="comment">% Find what plots exist already</span>
0390 fig_handles = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0391 fig_names   = get(fig_handles,<span class="string">'name'</span>);
0392 
0393 <span class="comment">% Remove the VMT GUI as a valid figure in the list</span>
0394 [~, idx] = ismember(get(handles.figure1,<span class="string">'Name'</span>), fig_names);
0395 <span class="keyword">if</span> ~isempty(idx)
0396     fig_names(idx) = [];
0397 <span class="keyword">end</span>
0398 
0399 <span class="keyword">if</span> guiparams.presentation
0400     figure_style = <span class="string">'presentation'</span>;
0401 <span class="keyword">else</span>
0402     figure_style = <span class="string">'print'</span>;
0403 <span class="keyword">end</span>
0404 
0405 [selected_figures] = <a href="#_sub99" class="code" title="subfunction [selected_figures] = openFiguresDialog(figure_names,hf)">openFiguresDialog</a>(fig_names,handles.figure1);
0406 
0407 <span class="keyword">if</span> isempty(selected_figures) <span class="comment">% User pressed cancel</span>
0408     <span class="keyword">return</span>
0409 <span class="keyword">else</span>
0410     <span class="keyword">for</span> i = 1:length(selected_figures)
0411         <a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>(guiprefs.mat_path,selected_figures(i),figure_style)
0412     <span class="keyword">end</span>
0413 <span class="keyword">end</span>
0414 
0415 
0416 <span class="comment">% [EOF] menuExportFigures_Callback</span>
0417 
0418 <span class="comment">% --------------------------------------------------------------------</span>
0419 <a name="_sub18" href="#_subfunctions" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a>
0420 <span class="comment">% Get the Application data:</span>
0421 <span class="comment">% -------------------------</span>
0422 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0423 beam_angle = guiparams.beam_angle; 
0424 magnetic_variation = guiparams.magnetic_variation; 
0425 wse = guiparams.wse;
0426 output_auxilliary_data = guiparams.output_auxiliary_data; 
0427 
0428 <span class="comment">% Open dialog and allow user to select settings</span>
0429 <span class="comment">% ---------------------------------------------</span>
0430 [guiparams.beam_angle,<span class="keyword">...</span>
0431     guiparams.magnetic_variation,<span class="keyword">...</span>
0432     guiparams.wse,<span class="keyword">...</span>
0433     guiparams.output_auxilliary_data] = <span class="keyword">...</span>
0434     <a href="#_sub97" class="code" title="subfunction [beam_angle,magnetic_variation,wse,output_auxilliary_data] = exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxilliary_data,hf)">exportSettingsDialog</a>(beam_angle,magnetic_variation,wse,output_auxilliary_data,handles.figure1);
0435 
0436 <span class="comment">% Re-store the Application data:</span>
0437 <span class="comment">% ------------------------------</span>
0438 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0439 
0440 <span class="comment">% [EOF] menuExportSettings_Callback</span>
0441 
0442 <span class="comment">% --------------------------------------------------------------------</span>
0443 <a name="_sub19" href="#_subfunctions" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
0444 <a href="#_sub56" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>(hObject, eventdata, handles);
0445 <span class="comment">% [EOF] menuExportMultibeamBathymetry_Callback</span>
0446 
0447 
0448 <span class="comment">% --------------------------------------------------------------------</span>
0449 <a name="_sub20" href="#_subfunctions" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a>
0450 
0451 <span class="comment">% Get the Application Data:</span>
0452 <span class="comment">% -------------------------</span>
0453 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0454 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0455 PVdata    = guiparams.iric_anv_planview_data;
0456 iric_path = guiprefs.iric_path;
0457 iric_file = guiprefs.iric_file;
0458 
0459 <span class="comment">% Is there any planview data?</span>
0460 <span class="keyword">if</span> isempty(PVdata)
0461     <span class="comment">% Nothing to do, warn user</span>
0462     log_text = {<span class="string">'No planview plot data to export. User must Plot Plan View first.'</span>};
0463     warndlg(log_text{:},<span class="string">'Nothing to export'</span>)
0464 <span class="keyword">else</span>
0465     <span class="comment">% Save the planview data as output and to an *.anv file with spacing</span>
0466     <span class="comment">% and smoothing (for iRiC)</span>
0467     log_text = {<span class="string">'Exporting iRic formated ANV vector file...'</span>};
0468     [iric_file,iric_path] = uiputfile(<span class="string">'*.anv'</span>,<span class="string">'Save *.anv file'</span>,<span class="keyword">...</span>
0469         fullfile(iric_path,iric_file));
0470     
0471     <span class="keyword">if</span> ischar(iric_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0472         outfile = fullfile(iric_path,iric_file);
0473         log_text = vertcat(log_text,{outfile});
0474         ofid   = fopen(outfile, <span class="string">'wt'</span>);
0475         outcount = fprintf(ofid,<span class="keyword">...</span>
0476             <span class="string">'%8.2f  %8.2f  %5.2f  %3.3f  %3.3f\n'</span>,PVdata.outmat);
0477         fclose(ofid);
0478     <span class="keyword">else</span>
0479         <span class="comment">% Return default iric_path and iric_file</span>
0480         iric_path = guiprefs.iric_path;
0481         iric_file = guiprefs.iric_file;
0482     <span class="keyword">end</span>
0483 <span class="keyword">end</span>
0484 
0485 <span class="comment">% Push messages to Log Window:</span>
0486 <span class="comment">% ----------------------------</span>
0487 statusLogging(handles.LogWindow, log_text)
0488 
0489 <span class="comment">% Store the persistent preferences:</span>
0490 <span class="comment">% ---------------------------------</span>
0491 guiprefs.iric_file = iric_file;
0492 guiprefs.iric_path = iric_path;
0493 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0494 <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'iric'</span>)
0495 
0496 <span class="comment">% [EOF] menuSaveANVFile_Callback</span>
0497 
0498 <span class="comment">% --------------------------------------------------------------------</span>
0499 <a name="_sub21" href="#_subfunctions" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a>
0500 <span class="comment">% Get the Application Data:</span>
0501 <span class="comment">% -------------------------</span>
0502 guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0503 guiprefs    = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0504 excel_path  = guiprefs.excel_path;
0505 excel_file  = guiprefs.excel_file;
0506 
0507 <span class="comment">% Push messages to Log Window:</span>
0508 <span class="comment">% ----------------------------</span>
0509 log_text = {<span class="string">'Exporting Excel File (reprocessing dataset; this will create new plots)'</span>};
0510 statusLogging(handles.LogWindow, log_text)
0511 
0512 <span class="comment">% If there are multiple MAT files loaded, go ahead and export just the DAV</span>
0513 <span class="comment">% data.</span>
0514 <span class="keyword">if</span> iscell(guiparams.mat_file)
0515     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0516     <a href="#_sub51" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0517     <span class="comment">% Refresh the Application Data:</span>
0518     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0519     z           = guiparams.z;
0520     A           = guiparams.A;
0521     V           = guiparams.V;
0522     Map         = guiparams.Map;
0523     wse         = guiparams.wse;
0524     PVdata      = guiparams.iric_anv_planview_data;
0525     log_text = {<span class="string">'Writing data to Excel file...'</span>;<span class="keyword">...</span>
0526         <span class="string">'Multiple transected loaded. Will export Planview Data Only!'</span>};
0527     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
0528         fullfile(excel_path,excel_file));
0529     
0530     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0531         outfile = fullfile(excel_path,excel_file);
0532         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0533         
0534     <span class="keyword">else</span>
0535         <span class="comment">% Return default excel_path and excel_file</span>
0536         excel_path = guiprefs.excel_path;
0537         excel_file = guiprefs.excel_file;
0538         outfile = fullfile(excel_path,excel_file);
0539         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0540     <span class="keyword">end</span>
0541     
0542     <span class="comment">% Delete the old file if it exists</span>
0543     <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
0544         log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
0545             [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
0546             <span class="string">'already exists. Overwriting file...'</span>});
0547         delete(outfile)
0548     <span class="keyword">end</span>
0549     
0550     <span class="comment">% Save DAV data to an Excel File</span>
0551     hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
0552     vmin = num2str(guiparams.depth_range_min);
0553     vmax = num2str(guiparams.depth_range_max);
0554     pvheaders = {<span class="keyword">...</span>
0555         <span class="string">'UTM_East'</span> <span class="string">'UTM_North'</span> <span class="string">'Elev_m'</span><span class="keyword">...</span>
0556         [<span class="string">'EastDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0557         [<span class="string">'NorthDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]};
0558     PVdata.outmat(4:5) = PVdata.outmat(4:5).*100; <span class="comment">% velocities in cm/s</span>
0559     pvdata = num2cell(PVdata.outmat');
0560     pvout = vertcat(pvheaders,pvdata);
0561     xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
0562     waitbar(4/5,hwait)
0563     
0564     <span class="comment">% Push messages to Log Window:</span>
0565     <span class="comment">% ----------------------------</span>
0566     statusLogging(handles.LogWindow, log_text)
0567 <span class="keyword">else</span>
0568     
0569     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0570     <a href="#_sub51" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0571     <a href="#_sub52" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
0572     <span class="comment">% Refresh the Application Data:</span>
0573     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0574     z           = guiparams.z;
0575     A           = guiparams.A;
0576     V           = guiparams.V;
0577     Map         = guiparams.Map;
0578     wse         = guiparams.wse;
0579     PVdata      = guiparams.iric_anv_planview_data;
0580     
0581     
0582     log_text = {<span class="string">'Writing data to Excel file...'</span>};
0583     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
0584         fullfile(excel_path,excel_file));
0585     
0586     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0587         outfile = fullfile(excel_path,excel_file);
0588         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0589         
0590         <span class="comment">% Delete the old file if it exists</span>
0591         <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
0592             log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
0593                 [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
0594                 <span class="string">'already exists. Overwriting file...'</span>});
0595             delete(outfile)
0596         <span class="keyword">end</span>
0597         
0598         <span class="comment">% Push messages to Log Window:</span>
0599         <span class="comment">% ----------------------------</span>
0600         statusLogging(handles.LogWindow, log_text)
0601         
0602         <span class="comment">% Save MCS Summary to an Excel File</span>
0603         hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
0604         xlswrite(outfile,{<span class="string">'Files:'</span>},<span class="string">'VMTSummary'</span>,<span class="string">'H4'</span>); waitbar(1/5,hwait)
0605         sout = guiparams.data_files';
0606         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'I4'</span>); waitbar(2/5,hwait)
0607         sout = {<span class="keyword">...</span>
0608             <span class="string">'VMT: Summary of Mean Cross Section'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0609             <span class="string">'VMT '</span> guiparams.vmt_version <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0610             <span class="string">'Date Processed: '</span> datestr(now) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0611             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0612             <span class="string">'Mean Cross Section (MCS) Properties'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0613             <span class="string">'Horz. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.horizontal_grid_node_spacing;<span class="keyword">...</span>
0614             <span class="string">'Vert. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> single(guiparams.A(1).Sup.binSize_cm)/100;<span class="keyword">...</span>
0615             <span class="string">'Endpoints:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">'UTM_East'</span>    <span class="string">'UTM_North'</span>;<span class="keyword">...</span>
0616             <span class="string">'Left Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xLeftBank V.yLeftBank;<span class="keyword">...</span>
0617             <span class="string">'Right Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xRightBank V.yRightBank;<span class="keyword">...</span>
0618             <span class="string">'Total Length in meters'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.dl;<span class="keyword">...</span>
0619             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0620             <span class="string">'Mean Flow Direction (deg)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.mfd;<span class="keyword">...</span>
0621             <span class="string">'in geographic coordinates'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0622             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0623             <span class="string">'Slope'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.m;<span class="keyword">...</span>
0624             <span class="string">'Intercept'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.b;<span class="keyword">...</span>
0625             <span class="string">'Theta (deg)'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.theta};
0626         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'A1'</span>); waitbar(3/5,hwait)
0627         
0628         <span class="comment">% Save DAV data to an Excel File</span>
0629         vmin = num2str(guiparams.depth_range_min);
0630         vmax = num2str(guiparams.depth_range_max);
0631         pvheaders = {<span class="keyword">...</span>
0632             <span class="string">'UTM_East'</span> <span class="string">'UTM_North'</span> <span class="string">'Elev_m'</span><span class="keyword">...</span>
0633             [<span class="string">'EastDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0634             [<span class="string">'NorthDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]};
0635         pvdata = num2cell(PVdata.outmat');
0636         pvout = vertcat(pvheaders,pvdata);
0637         xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
0638         waitbar(4/5,hwait)
0639         
0640         <span class="comment">% Save MCS data to an Excel File</span>
0641         mcsheaders = {<span class="keyword">...</span>
0642             <span class="string">'UTM_East'</span> <span class="keyword">...</span>
0643             <span class="string">'UTM_North'</span><span class="keyword">...</span>
0644             <span class="string">'Distance from Left Bank, in meters'</span><span class="keyword">...</span>
0645             <span class="string">'Elevation, in meters'</span><span class="keyword">...</span>
0646             <span class="string">'Bed Elevation, in meters'</span><span class="keyword">...</span>
0647             <span class="string">'East Velocity, in cm/s'</span><span class="keyword">...</span>
0648             <span class="string">'North Velocity, in cm/s'</span><span class="keyword">...</span>
0649             <span class="string">'Vertical Velocity, in cm/s'</span><span class="keyword">...</span>
0650             <span class="string">'Velocity Magnitude, in cm/s'</span><span class="keyword">...</span>
0651             <span class="string">'Velocity Direction, in degrees (geographic coordinates)'</span><span class="keyword">...</span>
0652             <span class="string">'Streamwise Velocity, in cm/s'</span><span class="keyword">...</span>
0653             <span class="string">'Transverse Velocity, in cm/s'</span><span class="keyword">...</span>
0654             <span class="string">'Primary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
0655             <span class="string">'Secondary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
0656             <span class="string">'Primary Velocity (roz), in cm/s'</span><span class="keyword">...</span>
0657             <span class="string">'Secondary Velocity (roz), in cm/s'</span>};
0658         
0659         mcsdata = [<span class="keyword">...</span>
0660             V.mcsX(:)<span class="keyword">...</span>
0661             V.mcsY(:)<span class="keyword">...</span>
0662             V.mcsDist(:)<span class="keyword">...</span>
0663             (wse - V.mcsDepth(:))<span class="keyword">...</span>
0664             repmat((wse - V.mcsBed(:)),size(V.mcsX,1),1)<span class="keyword">...</span>
0665             V.mcsEast(:)<span class="keyword">...</span>
0666             V.mcsNorth(:)<span class="keyword">...</span>
0667             V.mcsVert(:)<span class="keyword">...</span>
0668             V.mcsMag(:)<span class="keyword">...</span>
0669             V.mcsDir(:)<span class="keyword">...</span>
0670             V.u(:)<span class="keyword">...</span>
0671             V.v(:)<span class="keyword">...</span>
0672             V.vp(:)<span class="keyword">...</span>
0673             V.vs(:)<span class="keyword">...</span>
0674             V.Roz.up(:)<span class="keyword">...</span>
0675             V.Roz.us(:)];
0676         mcsdata(isnan(mcsdata)) = -9999;
0677         
0678         mcsout = vertcat(mcsheaders,num2cell(mcsdata));
0679         xlswrite(outfile,mcsout,<span class="string">'MeanCrossSection'</span>);
0680         waitbar(1,hwait)
0681         delete(hwait)
0682         
0683     <span class="keyword">else</span>
0684         <span class="comment">% Return default excel_path and excel_file</span>
0685         excel_path = guiprefs.excel_path;
0686         excel_file = guiprefs.excel_file;
0687         outfile = fullfile(excel_path,excel_file);
0688         log_text = {<span class="string">'User aborted Excel export...'</span>};
0689     <span class="keyword">end</span>
0690     
0691     
0692     
0693 <span class="keyword">end</span>
0694 
0695 <span class="comment">% Push messages to Log Window:</span>
0696 <span class="comment">% ----------------------------</span>
0697 statusLogging(handles.LogWindow, log_text)
0698 
0699 <span class="comment">% Store the persistent preferences:</span>
0700 <span class="comment">% ---------------------------------</span>
0701 guiprefs.excel_file = excel_file;
0702 guiprefs.excel_path = excel_path;
0703 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0704 <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'excel'</span>)
0705 
0706 <span class="comment">% [EOF] menuSaveExcel_Callback</span>
0707 
0708 <span class="comment">% --------------------------------------------------------------------</span>
0709 <a name="_sub22" href="#_subfunctions" class="code">function menuParameters_Callback(hObject, eventdata, handles)</a>
0710 <span class="comment">% Empty</span>
0711 
0712 <span class="comment">% --------------------------------------------------------------------</span>
0713 <a name="_sub23" href="#_subfunctions" class="code">function menuProcessingParameters_Callback(hObject, eventdata, handles)</a>
0714 <span class="comment">% Empty</span>
0715 
0716 <span class="comment">% --------------------------------------------------------------------</span>
0717 <a name="_sub24" href="#_subfunctions" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a>
0718 <span class="comment">% Turn ON or OFF Unit Discharge Correction</span>
0719 
0720 <span class="comment">% Get the Application Data:</span>
0721 <span class="comment">% -------------------------</span>
0722 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0723 
0724 <span class="comment">% Update the GUI &amp; Application Data:</span>
0725 <span class="comment">% ----------------------------------</span>
0726 status = get(handles.menuUnitDischargeCorrection,<span class="string">'Checked'</span>);
0727 <span class="keyword">switch</span> status
0728     <span class="keyword">case</span> <span class="string">'on'</span> <span class="comment">% Turn it off</span>
0729         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0730         guiparams.unit_discharge_correction = false;
0731     <span class="keyword">case</span> <span class="string">'off'</span> <span class="comment">% Turn it on</span>
0732         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0733         guiparams.unit_discharge_correction = true;
0734 <span class="keyword">end</span>
0735 
0736 <span class="comment">% Re-store the Application data:</span>
0737 <span class="comment">% ------------------------------</span>
0738 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0739 
0740 
0741 <span class="comment">%  [EOF] menuUnitDischargeCorrection_Callback</span>
0742 
0743 <span class="comment">% --------------------------------------------------------------------</span>
0744 <a name="_sub25" href="#_subfunctions" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a>
0745 <span class="comment">% Empty</span>
0746 
0747 <span class="comment">% --------------------------------------------------------------------</span>
0748 <a name="_sub26" href="#_subfunctions" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a>
0749 <span class="comment">% Empty</span>
0750 
0751 <span class="comment">% --------------------------------------------------------------------</span>
0752 <a name="_sub27" href="#_subfunctions" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a>
0753 <span class="comment">% Set the Plotting Parameter Units to &quot;metric&quot;</span>
0754 
0755 <span class="comment">% Get the Application Data:</span>
0756 <span class="comment">% -------------------------</span>
0757 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0758 
0759 <span class="comment">% Update the Application Data:</span>
0760 <span class="comment">% ----------------------------</span>
0761 guiparams.english_units = false;
0762 
0763 <span class="comment">% Re-store the Application data:</span>
0764 <span class="comment">% ------------------------------</span>
0765 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0766 
0767 <span class="comment">% Update the GUI:</span>
0768 <span class="comment">% ---------------</span>
0769 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0770 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
0771 
0772 <span class="comment">% [EOF] menuMetric_Callback</span>
0773 
0774 
0775 <span class="comment">% --------------------------------------------------------------------</span>
0776 <a name="_sub28" href="#_subfunctions" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a>
0777 <span class="comment">% Set the Plotting Parameter Units to &quot;english&quot;</span>
0778 
0779 <span class="comment">% Get the Application Data:</span>
0780 <span class="comment">% -------------------------</span>
0781 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0782 
0783 <span class="comment">% Update the Application Data:</span>
0784 <span class="comment">% ----------------------------</span>
0785 guiparams.english_units = true;
0786 
0787 <span class="comment">% Re-store the Application data:</span>
0788 <span class="comment">% ------------------------------</span>
0789 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0790 
0791 <span class="comment">% Update the GUI:</span>
0792 <span class="comment">% ---------------</span>
0793 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0794 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
0795 
0796 <span class="comment">% [EOF] menuEnglish_Callback</span>
0797 
0798 
0799 <span class="comment">% --------------------------------------------------------------------</span>
0800 <a name="_sub29" href="#_subfunctions" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
0801 <span class="comment">% Empty</span>
0802 
0803 <span class="comment">% --------------------------------------------------------------------</span>
0804 <a name="_sub30" href="#_subfunctions" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a>
0805 <span class="comment">% Set cross-section endpoints automatically</span>
0806 
0807 <span class="comment">% Get the Application Data:</span>
0808 <span class="comment">% -------------------------</span>
0809 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0810 
0811 <span class="comment">% Update the Application Data:</span>
0812 <span class="comment">% ----------------------------</span>
0813 guiparams.set_cross_section_endpoints = false;
0814 
0815 <span class="comment">% Re-store the Application data:</span>
0816 <span class="comment">% ------------------------------</span>
0817 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0818 
0819 <span class="comment">% Update the GUI:</span>
0820 <span class="comment">% ---------------</span>
0821 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0822 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0823 
0824 <span class="comment">% [EOF] menuCrossSectionEndpointAutomatic_Callback</span>
0825 
0826 
0827 <span class="comment">% --------------------------------------------------------------------</span>
0828 <a name="_sub31" href="#_subfunctions" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a>
0829 <span class="comment">% Set cross-section endpoints manually</span>
0830 
0831 <span class="comment">% Get the Application Data:</span>
0832 <span class="comment">% -------------------------</span>
0833 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0834 
0835 <span class="comment">% Update the Application Data:</span>
0836 <span class="comment">% ----------------------------</span>
0837 guiparams.set_cross_section_endpoints = true;
0838 
0839 <span class="comment">% Re-store the Application data:</span>
0840 <span class="comment">% ------------------------------</span>
0841 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0842 
0843 <span class="comment">% Update the GUI:</span>
0844 <span class="comment">% ---------------</span>
0845 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0846 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0847 
0848 <span class="comment">% [EOF] menuCrossSectionEndpointManual_Callback</span>
0849 
0850 
0851 
0852 
0853 <span class="comment">% --------------------------------------------------------------------</span>
0854 <a name="_sub32" href="#_subfunctions" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a>
0855 <span class="comment">% Empty</span>
0856 
0857 <span class="comment">% --------------------------------------------------------------------</span>
0858 <a name="_sub33" href="#_subfunctions" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a>
0859 
0860 <span class="comment">% Get the Application Data:</span>
0861 <span class="comment">% -------------------------</span>
0862 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0863 
0864 <span class="comment">% Update the Application Data:</span>
0865 <span class="comment">% ----------------------------</span>
0866 guiparams.print        = true;
0867 guiparams.presentation = false;
0868 
0869 <span class="comment">% Re-store the Application data:</span>
0870 <span class="comment">% ------------------------------</span>
0871 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0872 
0873 <span class="comment">% Update the GUI:</span>
0874 <span class="comment">% ---------------</span>
0875 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0876 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0877 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0878 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
0879 
0880 <span class="comment">% Modify the existing figures</span>
0881 <span class="comment">% ---------------------------</span>
0882 <span class="comment">% Find what plots exist already</span>
0883 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0884 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0885 
0886 <span class="comment">% Defaults for Print Stlye Figure</span>
0887 BkgdColor   = <span class="string">'white'</span>;
0888 AxColor     = <span class="string">'black'</span>;
0889 FigColor    = <span class="string">'white'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
0890 FntSize     = 14;
0891 
0892 <span class="comment">% Loop through valid figures and adjust</span>
0893 <span class="comment">% -------------------------------------</span>
0894 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0895     
0896     <span class="keyword">for</span> i = 1:length(valid_names)
0897         <span class="keyword">switch</span> valid_names{i}
0898             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
0899                 <span class="comment">% Focus the figure</span>
0900                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0901                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0902                     figure(hff)
0903                     
0904                     <span class="comment">% Make the changes to figure</span>
0905                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
0906                     set(gca,<span class="string">'FontSize'</span>,FntSize)
0907                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
0908                     set(gca,<span class="string">'Color'</span>,FigColor)
0909                     set(gca,<span class="string">'XColor'</span>,AxColor)
0910                     set(gca,<span class="string">'YColor'</span>,AxColor)
0911                     set(gca,<span class="string">'ZColor'</span>,AxColor)
0912                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
0913                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0914                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0915                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0916                 <span class="keyword">end</span>
0917             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
0918                 <span class="comment">% Focus the figure</span>
0919                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0920                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0921                     figure(hff)
0922                     
0923                     <span class="comment">% Make the changes to figure</span>
0924                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
0925                     set(gca,<span class="string">'FontSize'</span>,FntSize)
0926                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
0927                     set(gca,<span class="string">'Color'</span>,FigColor)
0928                     set(gca,<span class="string">'XColor'</span>,AxColor)
0929                     set(gca,<span class="string">'YColor'</span>,AxColor)
0930                     set(gca,<span class="string">'ZColor'</span>,AxColor)
0931                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
0932                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0933                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0934                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0935                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
0936                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
0937                 <span class="keyword">end</span>
0938             <span class="keyword">otherwise</span>
0939         <span class="keyword">end</span>
0940     <span class="keyword">end</span>
0941     
0942     
0943 <span class="keyword">end</span>
0944 
0945 
0946 <span class="comment">%[EOF] menuStylePrint_Callback</span>
0947 
0948 
0949 <span class="comment">% --------------------------------------------------------------------</span>
0950 <a name="_sub34" href="#_subfunctions" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a>
0951 <span class="comment">% Get the Application Data:</span>
0952 <span class="comment">% -------------------------</span>
0953 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0954 
0955 <span class="comment">% Update the Application Data:</span>
0956 <span class="comment">% ----------------------------</span>
0957 guiparams.print        = false;
0958 guiparams.presentation = true;
0959 
0960 <span class="comment">% Re-store the Application data:</span>
0961 <span class="comment">% ------------------------------</span>
0962 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0963 
0964 <span class="comment">% Update the GUI:</span>
0965 <span class="comment">% ---------------</span>
0966 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0967 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0968 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0969 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
0970 
0971 <span class="comment">% Modify the existing figures</span>
0972 <span class="comment">% ---------------------------</span>
0973 <span class="comment">% Find what plots exist already</span>
0974 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0975 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0976 
0977 <span class="comment">% Defaults for Presentation Stlye Figure</span>
0978 <span class="comment">% --------------------------------------</span>
0979 BkgdColor   = <span class="string">'black'</span>;
0980 AxColor     = <span class="string">'white'</span>;
0981 FigColor    = <span class="string">'black'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
0982 FntSize     = 14;
0983 
0984 <span class="comment">% Loop through valid figures and adjust</span>
0985 <span class="comment">% -------------------------------------</span>
0986 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0987     
0988     <span class="keyword">for</span> i = 1:length(valid_names)
0989         <span class="keyword">switch</span> valid_names{i}
0990             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
0991                 <span class="comment">% Focus the figure</span>
0992                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0993                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0994                     figure(hff)
0995                     
0996                     <span class="comment">% Make the changes to figure</span>
0997                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
0998                     set(gca,<span class="string">'FontSize'</span>,FntSize)
0999                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1000                     set(gca,<span class="string">'Color'</span>,FigColor)
1001                     set(gca,<span class="string">'XColor'</span>,AxColor)
1002                     set(gca,<span class="string">'YColor'</span>,AxColor)
1003                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1004                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1005                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1006                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1007                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1008                 <span class="keyword">end</span>
1009             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
1010                 <span class="comment">% Focus the figure</span>
1011                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
1012                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1013                     figure(hff)
1014                     
1015                     <span class="comment">% Make the changes to figure</span>
1016                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1017                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1018                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1019                     set(gca,<span class="string">'Color'</span>,[0.3 0.3 0.3]) <span class="comment">%FigColor)</span>
1020                     set(gca,<span class="string">'XColor'</span>,AxColor)
1021                     set(gca,<span class="string">'YColor'</span>,AxColor)
1022                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1023                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1024                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1025                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1026                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1027                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
1028                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
1029                 <span class="keyword">end</span>
1030             <span class="keyword">otherwise</span>
1031         <span class="keyword">end</span>
1032     <span class="keyword">end</span>
1033     
1034     
1035 <span class="keyword">end</span>
1036 
1037 <span class="comment">% [EOF] menuStylePresentation_Callback</span>
1038 
1039 <span class="comment">% --------------------------------------------------------------------</span>
1040 <a name="_sub35" href="#_subfunctions" class="code">function menuKMZExport_Callback(hObject, eventdata, handles)</a>
1041 
1042 <span class="comment">% Get the Application data:</span>
1043 <span class="comment">% -------------------------</span>
1044 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1045 
1046 <span class="comment">% Initialize the answer:</span>
1047 <span class="comment">% ----------------------</span>
1048 numstr = {num2str(guiparams.vertical_offset)};
1049 answer = NaN;
1050 <span class="keyword">while</span> isnan(answer)
1051     answer = inputdlg(<span class="string">'Vertical Offset (m)'</span>,<span class="string">'KMZ Export'</span>,1,numstr);
1052     
1053     <span class="keyword">if</span> isempty(answer) <span class="comment">% User hits &quot;Cancel&quot;</span>
1054         <span class="keyword">return</span>
1055     <span class="keyword">end</span>
1056     
1057     answer = str2double(answer); <span class="comment">% A non-numeric char will be NaN</span>
1058     <span class="comment">% A numeric char will be a double</span>
1059 <span class="keyword">end</span>
1060 
1061 <span class="comment">% Re-store the Application data:</span>
1062 <span class="comment">% ------------------------------</span>
1063 guiparams.vertical_offset = answer;
1064 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1065 
1066 <span class="comment">% [EOF] menuKMZExport_Callback</span>
1067 
1068 <span class="comment">% --------------------------------------------------------------------</span>
1069 <a name="_sub36" href="#_subfunctions" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a>
1070 <span class="comment">% Not implemented</span>
1071 
1072 <span class="comment">% --------------------------------------------------------------------</span>
1073 <a name="_sub37" href="#_subfunctions" class="code">function menuTools_Callback(hObject, eventdata, handles)</a>
1074 <span class="comment">% Empty</span>
1075 
1076 <span class="comment">% --------------------------------------------------------------------</span>
1077 <a name="_sub38" href="#_subfunctions" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a>
1078 ASCII2GIS_GUI
1079 <span class="comment">% [EOF] menuASCII2GIS_Callback</span>
1080 
1081 <span class="comment">% --------------------------------------------------------------------</span>
1082 <a name="_sub39" href="#_subfunctions" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a>
1083 
1084 <span class="comment">% Get the Application preferences:</span>
1085 <span class="comment">% --------------------------------</span>
1086 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1087 
1088 inpath = guiprefs.kmz_path;
1089 <span class="keyword">if</span> iscell(guiprefs.kmz_file)
1090     infile = guiprefs.kmz_file{1};
1091 <span class="keyword">else</span>
1092     infile = guiprefs.kmz_file;
1093 <span class="keyword">end</span>
1094 [log_text,outpath,outfile] = ASCII2KML(inpath,infile);
1095 
1096 guiprefs.kmz_path = outpath;
1097 guiprefs.kmz_file = outfile;
1098 
1099 <span class="comment">% Update persistent preferences</span>
1100 <span class="comment">% -----------------------------</span>
1101 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1102 
1103 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1104 
1105 <span class="comment">% --------------------------------------------------------------------</span>
1106 <a name="_sub40" href="#_subfunctions" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a>
1107 <span class="comment">% Empty</span>
1108 
1109 <span class="comment">% --------------------------------------------------------------------</span>
1110 <a name="_sub41" href="#_subfunctions" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a>
1111 <span class="keyword">try</span>
1112     web(<span class="string">'http://code.google.com/p/velocity-mapping-tool/wiki/UserGuide?tm=6'</span>)
1113 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
1114     <span class="keyword">if</span> isdeployed
1115         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1116             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1117         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1118             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1119             errLogFileName},<span class="keyword">...</span>
1120             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1121             <span class="string">'error'</span>);
1122         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1123         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1124         fclose(fid);
1125         rethrow(err)
1126     <span class="keyword">else</span>
1127         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1128             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1129             <span class="string">'error'</span>);
1130         rethrow(err);
1131     <span class="keyword">end</span>
1132 <span class="keyword">end</span>
1133 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1134 
1135 <span class="comment">% --------------------------------------------------------------------</span>
1136 <a name="_sub42" href="#_subfunctions" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a>
1137 <span class="comment">% Get the Application data:</span>
1138 <span class="comment">% -------------------------</span>
1139 <span class="comment">% guiparams = getappdata(handles.figure1,'guiparams'); %#ok&lt;NASGU&gt;</span>
1140 
1141 <span class="keyword">try</span>
1142     <span class="comment">% Construct a URL to a local file which can be interpreted by any</span>
1143     <span class="comment">% web-browser</span>
1144     rootpath = strrep(pwd,filesep,<span class="string">'/'</span>);
1145     webaddress = [<span class="string">'file:///'</span> rootpath <span class="string">'/doc/index.html'</span>];
1146     system([<span class="string">'start '</span> webaddress]);
1147 <span class="comment">%     [stat,h,url] = web(webaddress) % Produced with m2html (FEX)</span>
1148 <span class="keyword">catch</span> err 
1149     <span class="keyword">if</span> isdeployed
1150         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1151             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1152         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1153             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1154             errLogFileName},<span class="keyword">...</span>
1155             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1156             <span class="string">'error'</span>);
1157         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1158         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1159         fclose(fid);
1160         rethrow(err)
1161     <span class="keyword">else</span>
1162         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1163             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1164             <span class="string">'error'</span>);
1165         rethrow(err);
1166     <span class="keyword">end</span>
1167 <span class="keyword">end</span>
1168 
1169 <span class="comment">% [EOF] menuFunctionLibrary_Callback</span>
1170 
1171 <span class="comment">% --------------------------------------------------------------------</span>
1172 <a name="_sub43" href="#_subfunctions" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a>
1173 
1174 <span class="comment">% Get the Application data:</span>
1175 <span class="comment">% -------------------------</span>
1176 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1177 
1178 <span class="comment">% Check version tag against the web, and display a message</span>
1179 <span class="keyword">try</span>
1180     current_vmt_version = urlread(<span class="string">'http://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt'</span>);
1181     <span class="comment">%     current_vmt_version = urlread('http://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt');</span>
1182 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
1183     <span class="keyword">if</span> isdeployed
1184         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1185             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1186         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1187             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1188             errLogFileName},<span class="keyword">...</span>
1189             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1190             <span class="string">'error'</span>);
1191         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1192         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1193         fclose(fid);
1194         rethrow(err)
1195     <span class="keyword">else</span>
1196         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1197             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1198             <span class="string">'error'</span>);
1199         rethrow(err);
1200     <span class="keyword">end</span>
1201 <span class="keyword">end</span>
1202 
1203 <span class="keyword">if</span> strcmpi(guiparams.vmt_version,current_vmt_version)
1204     h = msgbox(<span class="string">'VMT is currently up to date, no updates available.'</span>,<span class="string">'Check for updates'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1205 <span class="keyword">else</span>
1206     h = msgbox(<span class="string">'VMT is out of date. Please visit the VMT homepage.'</span>,<span class="string">'Check for updates'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1207 <span class="keyword">end</span>
1208 <span class="comment">% [EOF] menuCheckForUpdates_Callback</span>
1209 
1210 <span class="comment">% --------------------------------------------------------------------</span>
1211 <a name="_sub44" href="#_subfunctions" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a>
1212 
1213 <span class="comment">% Get the Application data:</span>
1214 <span class="comment">% -------------------------</span>
1215 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1216 messagestr = <span class="keyword">...</span>
1217     {<span class="string">'The Velocity Mapping Toolbox'</span>;<span class="keyword">...</span>
1218     [<span class="string">'   Version: '</span> guiparams.vmt_version];<span class="keyword">...</span>
1219     <span class="string">''</span>;<span class="keyword">...</span>
1220     <span class="string">''</span>;<span class="keyword">...</span>
1221     <span class="string">'With collaborations from:'</span>;<span class="keyword">...</span>
1222     <span class="string">'   U.S. Geological Survey'</span>;<span class="keyword">...</span>
1223     <span class="string">'   University of Illinois'</span>;<span class="keyword">...</span>
1224     <span class="string">'   University of Hull'</span>;<span class="keyword">...</span>
1225     <span class="string">''</span>;<span class="keyword">...</span>
1226     <span class="string">''</span>;<span class="keyword">...</span>
1227     <span class="string">'Citation: '</span>;<span class="keyword">...</span>
1228     <span class="string">'   Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L.,'</span>;<span class="keyword">...</span>
1229     <span class="string">'   Rhoads, B. L., Oberg, K. A., Best, J. L., Mueller, D. S.,'</span>;<span class="keyword">...</span>
1230     <span class="string">'   Johnson, K. K. and Riley, J. D. (2013), Velocity Mapping'</span>;<span class="keyword">...</span>
1231     <span class="string">'   Toolbox (VMT): a processing and visualization suite for'</span>;<span class="keyword">...</span>
1232     <span class="string">'   moving-vessel ADCP measurements. Earth Surf. Process.'</span>;<span class="keyword">...</span>
1233     <span class="string">'   Landforms.doi: 10.1002/esp.3367'</span>};
1234 h = msgbox(messagestr,<span class="string">'About VMT'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1235 <span class="comment">% [EOF] menuAbout_Callback</span>
1236 
1237 
1238 
1239 
1240 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
1241 <span class="comment">% TOOLBAR CALLBACKS %</span>
1242 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
1243 
1244 <span class="comment">% --------------------------------------------------------------------</span>
1245 <a name="_sub45" href="#_subfunctions" class="code">function loadDataCallback(hObject, eventdata, handles)</a>
1246 <span class="comment">% Read Files into Data Structure using tfile.</span>
1247 
1248 <span class="comment">% Get the Application data:</span>
1249 <span class="comment">% -------------------------</span>
1250 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1251 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1252 
1253 <span class="comment">% Ask the user to select files:</span>
1254 <span class="comment">% -----------------------------</span>
1255 current_file = fullfile(guiprefs.ascii_path,guiprefs.ascii_file{1});
1256 [filename,pathname] = uigetfile({<span class="string">'*_ASC.TXT'</span>,<span class="string">'ASCII (*_ASC.TXT)'</span>}, <span class="keyword">...</span>
1257     <span class="string">'Select the ASCII Output Files'</span>, <span class="keyword">...</span>
1258     current_file, <span class="keyword">...</span>
1259     <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
1260 
1261 <span class="keyword">if</span> ischar(pathname) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
1262     guiparams.data_folder = pathname;
1263     <span class="keyword">if</span> ischar(filename)
1264         filename = {filename};
1265     <span class="keyword">end</span>
1266     guiparams.data_files = filename;
1267     guiparams.mat_file = <span class="string">''</span>;
1268     
1269     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1270     
1271    
1272     
1273     <span class="comment">% Update the preferences:</span>
1274     <span class="comment">% -----------------------</span>
1275     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1276     guiprefs.ascii_path = pathname;
1277     guiprefs.ascii_file = filename;
1278     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1279     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'ascii'</span>)
1280     
1281     <span class="comment">% Push messages to Log Window:</span>
1282     <span class="comment">% ----------------------------</span>
1283     log_text = {<span class="keyword">...</span>
1284         <span class="string">''</span>;<span class="keyword">...</span>
1285         [<span class="string">'%--- '</span> datestr(now) <span class="string">' ---%'</span>];<span class="keyword">...</span>
1286         <span class="string">'Current Project Directory:'</span>;<span class="keyword">...</span>
1287         guiparams.data_folder;
1288         <span class="string">'Loading the following files into memory:'</span>;<span class="keyword">...</span>
1289         char(filename)};
1290     statusLogging(handles.LogWindow, log_text)
1291     
1292     <span class="comment">% Read the file(s)</span>
1293     <span class="comment">% ----------------</span>
1294     [~,~,savefile,A,z] = <span class="keyword">...</span>
1295         <a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>(guiparams.data_folder,guiparams.data_files);
1296     guiparams.savefile = savefile;
1297     guiparams.A        = A;
1298     guiparams.z        = z;
1299     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1300 <span class="comment">%</span>
1301 <span class="comment">%     % Preprocess the data:</span>
1302 <span class="comment">%     % --------------------</span>
1303 <span class="comment">%     A = VMT_PreProcess(z,A);</span>
1304 <span class="comment">%</span>
1305 <span class="comment">%     % Push messages to Log Window:</span>
1306 <span class="comment">%     % ----------------------------</span>
1307 <span class="comment">%     log_text = {...</span>
1308 <span class="comment">%         '   Preprocessing complete.';...</span>
1309 <span class="comment">%         '   Begin Data Processing...'};</span>
1310 <span class="comment">%     statusLogging(handles.LogWindow, log_text)</span>
1311 <span class="comment">%</span>
1312 <span class="comment">%     A(1).hgns = guiparams.horizontal_grid_node_spacing;</span>
1313 <span class="comment">%     A(1).wse  = guiparams.wse;  %Set the WSE to entered value</span>
1314 <span class="comment">%     [A,V,processing_log_text] = VMT_ProcessTransects(z,A,...</span>
1315 <span class="comment">%         guiparams.set_cross_section_endpoints,...</span>
1316 <span class="comment">%         guiparams.unit_discharge_correction);</span>
1317 <span class="comment">%</span>
1318 <span class="comment">%     % Push messages to Log Window:</span>
1319 <span class="comment">%     % ----------------------------</span>
1320 <span class="comment">%     statusLogging(handles.LogWindow, processing_log_text)</span>
1321 <span class="comment">%</span>
1322 <span class="comment">%     % Store the data:</span>
1323 <span class="comment">%     % ---------------</span>
1324 <span class="comment">%     guiparams.z = z;</span>
1325 <span class="comment">%     guiparams.A = A;</span>
1326 <span class="comment">%     guiparams.V = V;</span>
1327 <span class="comment">%     setappdata(handles.figure1,'guiparams',guiparams)</span>
1328     
1329       
1330     <span class="comment">% Update the GUI:</span>
1331     <span class="comment">% ---------------</span>
1332     <a href="#_sub89" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
1333 <span class="keyword">end</span>
1334 <span class="comment">% [EOF] loadDataCallback</span>
1335 
1336 
1337 
1338 <span class="comment">% --------------------------------------------------------------------</span>
1339 <a name="_sub46" href="#_subfunctions" class="code">function saveDataCallback(hObject, eventdata, handles)</a>
1340 <span class="comment">% SaveMATFile_Callback(handles.SaveMATFile,eventdata,handles)</span>
1341 
1342 <span class="comment">% Get the Application data:</span>
1343 <span class="comment">% -------------------------</span>
1344 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1345 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1346 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1347 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1348 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
1349 
1350 [the_file,the_path] = <span class="keyword">...</span>
1351     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
1352     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
1353     fullfile(guiparams.mat_path,guiparams.savefile));
1354 
1355 <span class="comment">% Save the processed data to a MAT file:</span>
1356 <span class="comment">% --------------------------------------</span>
1357 <span class="keyword">if</span> ischar(the_file)
1358     guiparams.mat_path = the_path;
1359     guiparams.mat_file = the_file;
1360     guiparams.savefile = the_file;
1361     
1362     <span class="comment">% Re-store the Application data:</span>
1363     <span class="comment">% ------------------------------</span>
1364     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1365     
1366     <span class="comment">% Update the preferences:</span>
1367     <span class="comment">% -----------------------</span>
1368     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1369     guiprefs.mat_path = the_path;
1370     guiprefs.mat_file = the_file;
1371     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1372     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
1373     
1374     [pathstr,filename,extension] = fileparts([guiparams.mat_path guiparams.savefile]);
1375     savefile = fullfile(pathstr,[filename extension]);
1376     <span class="comment">%h = msgbox(['Saving processed data in MAT File ''' filename extension ''''], ...</span>
1377     <span class="comment">%    'Saving Processed Data File...'); %#ok&lt;NASGU&gt;</span>
1378     log_text = {<span class="keyword">...</span>
1379         <span class="string">'Saving Processed Data File...'</span>;<span class="keyword">...</span>
1380         savefile};
1381     statusLogging(handles.LogWindow,log_text)
1382     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
1383 <span class="keyword">end</span>
1384 
1385 <span class="comment">% [EOF] saveDataCallback</span>
1386 
1387 
1388 <span class="comment">% --------------------------------------------------------------------</span>
1389 <a name="_sub47" href="#_subfunctions" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a>
1390 
1391 <span class="comment">% Get the Application data:</span>
1392 <span class="comment">% -------------------------</span>
1393 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1394 z   = guiparams.z;
1395 A   = guiparams.A;
1396 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
1397 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
1398 
1399 <span class="comment">% Compute multibeam bathymetry:</span>
1400 <span class="comment">% -----------------------------</span>
1401 msgbox(<span class="string">'Processing Bathymetry...Please Be Patient'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
1402 <span class="comment">%A = VMT_MBBathy(z,A,savefile,handles.beam_angle,handles.MagneticVariation,handles.WSE);</span>
1403 <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>(z,A,savefile, <span class="keyword">...</span>
1404     guiparams.beam_angle, <span class="keyword">...</span>
1405     guiparams.magnetic_variation, <span class="keyword">...</span>
1406     guiparams.wse, <span class="keyword">...</span>
1407     guiparams.output_auxiliary_data);
1408 
1409 msgbox(<span class="string">'Bathymetry Output Complete'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
1410 
1411 <span class="comment">% [EOF] saveBathymetryCallback</span>
1412 
1413 <span class="comment">% --------------------------------------------------------------------</span>
1414 <a name="_sub48" href="#_subfunctions" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a>
1415 
1416 <span class="comment">% Get the Application data:</span>
1417 <span class="comment">% -------------------------</span>
1418 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1419 
1420 [guiparams.english_units,guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
1421     guiparams.presentation,guiparams.print] = <span class="keyword">...</span>
1422     plotParametersDialog(guiparams.english_units, <span class="keyword">...</span>
1423     guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
1424     guiparams.presentation,guiparams.print,<span class="keyword">...</span>
1425     handles.figure1);
1426 
1427 <span class="comment">% Update the GUI:</span>
1428 <span class="comment">% ---------------</span>
1429 <span class="keyword">if</span> guiparams.english_units
1430     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1431     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1432 <span class="keyword">else</span>
1433     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1434     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1435 <span class="keyword">end</span>
1436 
1437 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
1438     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1439     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1440 <span class="keyword">else</span>
1441     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1442     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1443 <span class="keyword">end</span>
1444 
1445 <span class="keyword">if</span> guiparams.presentation
1446     <a href="#_sub34" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
1447 <span class="comment">%     set(handles.menuStylePrint,           'Checked','off')</span>
1448 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','on')</span>
1449 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','off')</span>
1450 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','on')</span>
1451 <span class="keyword">else</span>
1452     <a href="#_sub33" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
1453 <span class="comment">%     set(handles.menuStylePrint,           'Checked','on')</span>
1454 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','off')</span>
1455 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','on')</span>
1456 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','off')</span>
1457 <span class="keyword">end</span>
1458 
1459 <span class="comment">% Re-store the Application data:</span>
1460 <span class="comment">% ------------------------------</span>
1461 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1462 
1463 <span class="comment">% [EOF] plottingParametersCallback</span>
1464 
1465 
1466 <span class="comment">% --------------------------------------------------------------------</span>
1467 <a name="_sub49" href="#_subfunctions" class="code">function processingParametersCallback(hObject, eventdata, handles)</a>
1468 
1469 <span class="comment">% Get the Application data:</span>
1470 <span class="comment">% -------------------------</span>
1471 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1472 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1473 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1474 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1475 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
1476 
1477 <span class="comment">% [EOF] processingParametersCallback</span>
1478 
1479 
1480 <span class="comment">% --------------------------------------------------------------------</span>
1481 <a name="_sub50" href="#_subfunctions" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a>
1482 <span class="comment">% Plot 1</span>
1483 
1484 <span class="comment">% Get the Application data:</span>
1485 <span class="comment">% -------------------------</span>
1486 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1487 z = guiparams.z;
1488 A = guiparams.A;
1489 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
1490 <span class="comment">% Map = guiparams.Map;</span>
1491 setends = guiparams.set_cross_section_endpoints;
1492 
1493 <span class="comment">% Preprocess the data:</span>
1494 <span class="comment">% --------------------</span>
1495 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
1496 
1497 <span class="comment">% Push messages to Log Window:</span>
1498 <span class="comment">% ----------------------------</span>
1499 log_text = {<span class="keyword">...</span>
1500     <span class="string">'   Preprocessing complete.'</span>;<span class="keyword">...</span>
1501     <span class="string">'   Begin Data Processing...'</span>};
1502 statusLogging(handles.LogWindow, log_text)
1503 
1504 <span class="comment">% Process the transects:</span>
1505 <span class="comment">% ----------------------</span>
1506 A(1).hgns = guiparams.horizontal_grid_node_spacing;
1507 A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
1508 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
1509     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction);
1510 
1511 <span class="comment">% Compute the smoothed variables</span>
1512 <span class="comment">% ------------------------------</span>
1513 <span class="comment">% This is required so that the V struc is complete at any point during</span>
1514 <span class="comment">% runtime.</span>
1515 V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
1516     <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
1517     guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
1518     guiparams.vertical_smoothing_window);
1519 
1520 <span class="comment">% Push messages to Log Window:</span>
1521 <span class="comment">% ----------------------------</span>
1522 statusLogging(handles.LogWindow, processing_log_text)
1523 
1524 <span class="comment">% Store the data:</span>
1525 <span class="comment">% ---------------</span>
1526 guiparams.z = z;
1527 guiparams.A = A;
1528 guiparams.V = V;
1529 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1530 
1531 <span class="comment">% Push messages to Log Window:</span>
1532 <span class="comment">% ----------------------------</span>
1533 log_text = {<span class="string">'Plotting Shiptracks (reprocessing)'</span>};
1534 statusLogging(handles.LogWindow, log_text)
1535 
1536 <span class="comment">% Create or replot the Shiptracks</span>
1537 <span class="comment">% -------------------------------</span>
1538 <span class="comment">% Grab the axes to the plot</span>
1539 <span class="comment">% axes(handles.Plot1Shiptracks);</span>
1540 <a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>(A,V,z,setends,handles.Plot1Shiptracks); <span class="comment">% PLOT 1</span>
1541 
1542 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
1543 <span class="comment">% New plot display window</span>
1544 <span class="comment">% h = VMT_CreatePlotDisplay('shiptracks');</span>
1545 <span class="comment">% h = figure(1); clf</span>
1546 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
1547 
1548 <span class="comment">% [EOF] shiptracksPlotCallback</span>
1549 
1550 
1551 <span class="comment">% --------------------------------------------------------------------</span>
1552 <a name="_sub51" href="#_subfunctions" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a>
1553 <span class="comment">% Plot 2</span>
1554 
1555 <span class="comment">% Get the Application data:</span>
1556 <span class="comment">% -------------------------</span>
1557 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1558 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1559 
1560 <span class="keyword">if</span> iscell(guiparams.mat_file) <span class="comment">% Multiple MAT files loaded</span>
1561     <span class="comment">% Push messages to Log Window:</span>
1562     <span class="comment">% ----------------------------</span>
1563     log_text = {<span class="string">'Plotting Multiple Transects (Planview)'</span>};
1564     statusLogging(handles.LogWindow, log_text)
1565     
1566        
1567     <span class="comment">% Push plotting parameters to log window:</span>
1568     <span class="comment">% ---------------------------------------</span>
1569     log_text = {<span class="keyword">...</span>
1570         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
1571         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
1572         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
1573         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
1574         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
1575         };
1576     statusLogging(handles.LogWindow, log_text)
1577     
1578     <span class="comment">% Plot the data:</span>
1579     <span class="comment">% --------------</span>
1580     z = [];
1581     A = [];
1582     V = [];
1583     Map = [];
1584     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
1585     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
1586         depth_range, <span class="keyword">...</span>
1587         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
1588         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
1589         guiparams.smoothing_window_size, <span class="keyword">...</span>
1590         guiparams.display_shoreline, <span class="keyword">...</span>
1591         guiparams.english_units, <span class="keyword">...</span>
1592         guiparams.mat_file, <span class="keyword">...</span>
1593         guiparams.mat_path); <span class="comment">% PLOT2</span>
1594     statusLogging(handles.LogWindow, log_text)
1595     
1596     <span class="comment">% Plot a Shoreline Map:</span>
1597     <span class="comment">% ---------------------</span>
1598     <span class="keyword">if</span> guiparams.display_shoreline
1599         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
1600             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
1601             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
1602             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
1603         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
1604             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
1605             Map.UTMe   = mapdata(:,1);
1606             Map.UTMn   = mapdata(:,2);
1607             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
1608             <span class="comment">%Map.UTMzone = zone;</span>
1609         <span class="keyword">else</span>
1610             Map = [];
1611         <span class="keyword">end</span>
1612         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
1613         log_text = {<span class="keyword">...</span>
1614             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
1615             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
1616             };
1617         statusLogging(handles.LogWindow, log_text)
1618     <span class="keyword">else</span>
1619         Map = [];
1620     <span class="keyword">end</span>
1621     
1622 <span class="keyword">else</span>
1623     z = guiparams.z;
1624     A = guiparams.A;
1625     <span class="comment">% V = guiparams.V;</span>
1626     Map = guiparams.Map;
1627     
1628     <span class="comment">% Push messages to Log Window:</span>
1629     <span class="comment">% ----------------------------</span>
1630     log_text = {<span class="string">'Plotting Depth Averaged Vectors (reprocessing)'</span>};
1631     statusLogging(handles.LogWindow, log_text)
1632     
1633         
1634     <span class="comment">% Preprocess the data:</span>
1635     <span class="comment">% --------------------</span>
1636     A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
1637     
1638     <span class="comment">% Process the transects:</span>
1639     <span class="comment">% ----------------------</span>
1640     A(1).hgns = guiparams.horizontal_grid_node_spacing;
1641     A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
1642     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
1643         guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction);
1644     
1645     <span class="comment">% Compute the smoothed variables</span>
1646     <span class="comment">% ------------------------------</span>
1647     <span class="comment">% This is required so that the V struc is complete at any point during</span>
1648     <span class="comment">% runtime.</span>
1649     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
1650         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
1651         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
1652         guiparams.vertical_smoothing_window);
1653     
1654     <span class="comment">% Push messages to Log Window:</span>
1655     <span class="comment">% ----------------------------</span>
1656     statusLogging(handles.LogWindow, processing_log_text)
1657     
1658     <span class="comment">% Plot the cross section:</span>
1659     <span class="comment">% -----------------------</span>
1660     log_text = {<span class="keyword">...</span>
1661         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
1662         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
1663         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
1664         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
1665         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
1666         };
1667     statusLogging(handles.LogWindow, log_text)
1668     
1669     <span class="comment">% Plot the data:</span>
1670     <span class="comment">% --------------</span>
1671     <span class="comment">%msgbox('Plotting Plan View','VMT Status','help','replace');</span>
1672     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
1673     
1674     
1675     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
1676         depth_range, <span class="keyword">...</span>
1677         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
1678         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
1679         guiparams.smoothing_window_size, <span class="keyword">...</span>
1680         guiparams.display_shoreline, <span class="keyword">...</span>
1681         guiparams.english_units, <span class="keyword">...</span>
1682         guiparams.mat_file, <span class="keyword">...</span>
1683         guiparams.mat_path); <span class="comment">% PLOT2</span>
1684     statusLogging(handles.LogWindow, log_text)
1685     
1686     <span class="comment">% Plot a Shoreline Map:</span>
1687     <span class="comment">% ---------------------</span>
1688     <span class="keyword">if</span> guiparams.display_shoreline
1689         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
1690             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
1691             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
1692             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
1693         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
1694             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
1695             Map.UTMe   = mapdata(:,1);
1696             Map.UTMn   = mapdata(:,2);
1697             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
1698             <span class="comment">%Map.UTMzone = zone;</span>
1699         <span class="keyword">else</span>
1700             Map = [];
1701         <span class="keyword">end</span>
1702         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
1703         log_text = {<span class="keyword">...</span>
1704             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
1705             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
1706             };
1707         statusLogging(handles.LogWindow, log_text)
1708     <span class="keyword">else</span>
1709         Map = [];
1710     <span class="keyword">end</span>
1711     
1712 <span class="keyword">end</span>
1713 
1714 <span class="keyword">if</span> guiparams.add_background
1715     [guiprefs,log_text] = <a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>(guiprefs);
1716     statusLogging(handles.LogWindow, log_text)
1717 <span class="keyword">end</span>
1718 
1719 <span class="comment">% Update guiparams</span>
1720 <span class="comment">% ----------------</span>
1721 guiparams.z   = z;
1722 guiparams.A   = A;
1723 guiparams.V   = V;
1724 guiparams.Map = Map;
1725 guiparams.iric_anv_planview_data = PVdata;
1726 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams);
1727 
1728 <span class="comment">% Update preferences</span>
1729 <span class="comment">% ------------------</span>
1730 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1731 <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'shoreline'</span>)
1732 <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'aerial'</span>)
1733 
1734 <span class="comment">% Force plot to be formated properly</span>
1735 <span class="comment">% ----------------------------------</span>
1736 <span class="keyword">if</span> guiparams.presentation
1737     <a href="#_sub34" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
1738 <span class="keyword">else</span>
1739     <a href="#_sub33" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
1740 <span class="keyword">end</span>
1741 
1742 <span class="comment">% Start the Graphics Control Gui</span>
1743 <span class="comment">% ------------------------------</span>
1744 VMT_GraphicsControl
1745 
1746 <span class="comment">% [EOF] planviewPlotCallback</span>
1747 
1748 
1749 <span class="comment">% --------------------------------------------------------------------</span>
1750 <a name="_sub52" href="#_subfunctions" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a>
1751 <span class="comment">% Plot 3</span>
1752 
1753 <span class="comment">% Get the Application data:</span>
1754 <span class="comment">% -------------------------</span>
1755 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1756 z = guiparams.z;
1757 A = guiparams.A;
1758 <span class="comment">% V = guiparams.V;</span>
1759 <span class="comment">% Map = guiparams.Map;</span>
1760 
1761 <span class="comment">% Preprocess the data:</span>
1762 <span class="comment">% --------------------</span>
1763 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
1764 
1765 <span class="comment">% Push messages to Log Window:</span>
1766 <span class="comment">% ----------------------------</span>
1767 log_text = {<span class="string">'Plotting Cross Section (reprocessing)'</span>};
1768 statusLogging(handles.LogWindow, log_text)
1769 
1770 <span class="comment">% Process the transects:</span>
1771 <span class="comment">% ----------------------</span>
1772 A(1).hgns = guiparams.horizontal_grid_node_spacing;
1773 A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
1774 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
1775     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction);
1776 
1777 <span class="comment">% Push messages to Log Window:</span>
1778 <span class="comment">% ----------------------------</span>
1779 statusLogging(handles.LogWindow, processing_log_text)
1780 
1781 <span class="comment">% Plot the cross section:</span>
1782 <span class="comment">% -----------------------</span>
1783 log_text = {<span class="keyword">...</span>
1784     <span class="string">'Cross Section Plotting Parameters'</span>;<span class="keyword">...</span>
1785     sprintf(<span class="string">'   Contour variable: %s'</span>          ,guiparams.contours(guiparams.idx_contour).string);<span class="keyword">...</span>
1786     sprintf(<span class="string">'   Vertical exaggeration: %d'</span>     ,guiparams.vertical_exaggeration);<span class="keyword">...</span>
1787     sprintf(<span class="string">'   Vector scale: %3.1f'</span>           ,guiparams.vector_scale_cross_section);<span class="keyword">...</span>
1788     sprintf(<span class="string">'   Horizontal vector spacing: %d'</span> ,guiparams.horizontal_vector_spacing);<span class="keyword">...</span>
1789     sprintf(<span class="string">'   Vertical vector spacing: %d'</span>   ,guiparams.vertical_vector_spacing);<span class="keyword">...</span>
1790     sprintf(<span class="string">'   Horizontal smooting window: %d'</span>,guiparams.horizontal_smoothing_window);<span class="keyword">...</span>
1791     sprintf(<span class="string">'   Vertical smoothing window: %d'</span> ,guiparams.vertical_smoothing_window);<span class="keyword">...</span>
1792     };
1793 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
1794     log_text = vertcat(log_text, {<span class="keyword">...</span>
1795         sprintf(<span class="string">'   Vector variable: %s'</span>,guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).string);<span class="keyword">...</span>
1796         sprintf(<span class="string">'   Inc. vertical component?: %d'</span>,guiparams.include_vertical_velocity)<span class="keyword">...</span>
1797         });
1798 <span class="keyword">end</span>
1799 <span class="comment">% Push messages to Log Window:</span>
1800 <span class="comment">% ----------------------------</span>
1801 statusLogging(handles.LogWindow, log_text)
1802 
1803 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
1804     <span class="comment">%msgbox('Plotting Cross Section','VMT Status','help','replace')</span>
1805 <span class="comment">%     V = VMT_SmoothVar(V, ...</span>
1806 <span class="comment">%         ...guiparams.contour, ...</span>
1807 <span class="comment">%         guiparams.horizontal_smoothing_window, ...</span>
1808 <span class="comment">%         guiparams.vertical_smoothing_window);</span>
1809     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
1810         <span class="keyword">...</span><span class="comment">guiparams.secondary_flow_vector_variable, ...</span>
1811         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
1812         guiparams.vertical_smoothing_window);
1813     [~,A,V,plot_cont_log_text] = <a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,varargin)">VMT_PlotXSContQuiver</a>(z,A,V, <span class="keyword">...</span>
1814         guiparams.contour, <span class="keyword">...</span>
1815         guiparams.vector_scale_cross_section, <span class="keyword">...</span>
1816         guiparams.vertical_exaggeration, <span class="keyword">...</span>
1817         guiparams.horizontal_vector_spacing, <span class="keyword">...</span>
1818         guiparams.vertical_vector_spacing, <span class="keyword">...</span>
1819         guiparams.secondary_flow_vector_variable, <span class="keyword">...</span>
1820         guiparams.include_vertical_velocity, <span class="keyword">...</span>
1821         guiparams.english_units); <span class="comment">%#ok&lt;ASGLU&gt; % PLOT3</span>
1822     
1823 <span class="keyword">elseif</span> ~guiparams.plot_secondary_flow_vectors
1824     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
1825         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
1826         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
1827         guiparams.vertical_smoothing_window);
1828     
1829     [~,A,V,zmin,zmax,plot_cont_log_text] = <a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english)">VMT_PlotXSCont</a>(z,A,V, <span class="keyword">...</span>
1830         guiparams.contour, <span class="keyword">...</span>
1831         guiparams.vertical_exaggeration, <span class="keyword">...</span>
1832         guiparams.english_units);  <span class="comment">%#ok&lt;ASGLU&gt;</span>
1833     
1834     guiparams.zmin = zmin;
1835     guiparams.zmax = zmax;
1836     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1837 <span class="keyword">end</span>
1838 
1839 <span class="comment">% Force plot to be formated properly</span>
1840 <span class="comment">% ----------------------------------</span>
1841 <span class="keyword">if</span> guiparams.presentation
1842     <a href="#_sub34" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
1843 <span class="keyword">else</span>
1844     <a href="#_sub33" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
1845 <span class="keyword">end</span>
1846 
1847 <span class="comment">% Re-store the Application data:</span>
1848 <span class="comment">% ------------------------------</span>
1849 guiparams.V = V;
1850 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1851 
1852 <span class="comment">% Start the Graphics Control Gui</span>
1853 <span class="comment">% ------------------------------</span>
1854 VMT_GraphicsControl
1855 
1856 <span class="comment">% Push messages to Log Window:</span>
1857 <span class="comment">% ----------------------------</span>
1858 statusLogging(handles.LogWindow, plot_cont_log_text)
1859 <span class="comment">% msgbox('Plotting Complete','VMT Status','help','replace')</span>
1860 
1861 <span class="comment">% [EOF] crosssectionPlotCallback</span>
1862 
1863 
1864 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
1865 <span class="comment">% DATA EXPORT CALLBACKS %</span>
1866 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
1867 
1868 <span class="comment">% --------------------------------------------------------------------</span>
1869 <a name="_sub53" href="#_subfunctions" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a>
1870 <span class="comment">% saveDataCallback(hObject, eventdata, handles)</span>
1871 
1872 <span class="comment">% Get the Application data:</span>
1873 <span class="comment">% -------------------------</span>
1874 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1875 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1876 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1877 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1878 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
1879 
1880 [the_file,the_path] = <span class="keyword">...</span>
1881     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
1882     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
1883     fullfile(guiparams.mat_path,guiparams.savefile));
1884 
1885 <span class="comment">% Save the processed data to a MAT file:</span>
1886 <span class="comment">% --------------------------------------</span>
1887 <span class="keyword">if</span> ischar(the_file)
1888     guiparams.mat_path = the_path;
1889     guiparams.mat_file = the_file;
1890     guiparams.savefile = the_file;
1891     
1892     <span class="comment">% Re-store the Application data:</span>
1893     <span class="comment">% ------------------------------</span>
1894     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1895     
1896     <span class="comment">% Update the preferences:</span>
1897     <span class="comment">% -----------------------</span>
1898     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1899     guiprefs.mat_path = the_path;
1900     guiprefs.mat_file = the_file;
1901     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1902     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
1903     
1904     [~,filename,extension] = fileparts(guiparams.savefile);
1905     savefile = [filename extension];
1906     h = msgbox([<span class="string">'Saving processed data in MAT File '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
1907         <span class="string">'Saving Processed Data File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1908     disp(<span class="string">'Saving Processed Data File...'</span>)
1909     disp(savefile)
1910     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
1911 <span class="keyword">end</span>
1912 
1913 <span class="comment">% [EOF] SaveMATFile_Callback</span>
1914 
1915 
1916 <span class="comment">% --------------------------------------------------------------------</span>
1917 <a name="_sub54" href="#_subfunctions" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a>
1918 
1919 <span class="comment">% Get the Application data:</span>
1920 <span class="comment">% -------------------------</span>
1921 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1922 <span class="comment">% z   = guiparams.z;</span>
1923 <span class="comment">% A   = guiparams.A;</span>
1924 V   = guiparams.V;
1925 <span class="comment">% Map = guiparams.Map;</span>
1926 
1927 [the_file,the_path] = <span class="keyword">...</span>
1928     uiputfile({<span class="string">'*.dat'</span>,<span class="string">'Tecplot Files (*.dat)'</span>}, <span class="keyword">...</span>
1929     <span class="string">'Save Tecplot File'</span>, <span class="keyword">...</span>
1930     fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
1931 
1932 <span class="comment">% Output the data (no smoothing) to Tecplot:</span>
1933 <span class="comment">% ------------------------------------------</span>
1934 <span class="keyword">if</span> ischar(the_file)
1935     guiparams.tecplot_path = the_path;
1936     guiparams.tecplot_file = the_file;
1937     
1938     <span class="comment">% Re-store the Application data:</span>
1939     <span class="comment">% ------------------------------</span>
1940     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1941     
1942     <span class="comment">% Update the preferences:</span>
1943     <span class="comment">% -----------------------</span>
1944     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1945     guiprefs.tecplot_path = the_path;
1946     guiprefs.tecplot_file = the_file;
1947     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1948     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'tecplot'</span>)
1949     
1950     <span class="comment">% Push to log window</span>
1951     <span class="comment">% ------------------</span>
1952     log_text = {<span class="keyword">...</span>
1953         <span class="string">'Exporting Data to Tecplot (*.dat) File...'</span>;<span class="keyword">...</span>
1954         <span class="string">'Directory:'</span>;<span class="keyword">...</span>
1955         the_path;<span class="keyword">...</span>
1956         [<span class="string">'Filename: '</span> the_file]};
1957     statusLogging(handles.LogWindow,log_text)
1958         
1959     <span class="keyword">if</span> isempty(V)
1960         A = guiparams.A;
1961         A(1).hgns = guiparams.horizontal_grid_node_spacing;
1962         A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
1963         [~,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
1964             guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
1965             guiparams.unit_discharge_correction);
1966     <span class="keyword">end</span>
1967     <a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
1968     
1969     <span class="comment">% Push to log window</span>
1970     <span class="comment">% ------------------</span>
1971     log_text = {<span class="string">'Exporting XS Bathy Data to Tecplot (*.dat) File...'</span>};
1972     statusLogging(handles.LogWindow,log_text)
1973     
1974     <a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
1975     
1976     <span class="comment">% Push to log window</span>
1977     <span class="comment">% ------------------</span>
1978     log_text = {<span class="string">'Tecplot Export Complete'</span>};
1979     statusLogging(handles.LogWindow,log_text)
1980    
1981 <span class="keyword">end</span>
1982 
1983 <span class="comment">% [EOF] SaveTechplotFile_Callback</span>
1984 
1985 
1986 <span class="comment">% --------------------------------------------------------------------</span>
1987 <a name="_sub55" href="#_subfunctions" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a>
1988 
1989 <span class="comment">% Get the Application data:</span>
1990 <span class="comment">% -------------------------</span>
1991 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1992 <span class="comment">% z   = guiparams.z;</span>
1993 A   = guiparams.A;
1994 V   = guiparams.V;
1995 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
1996 
1997 [the_file,the_path] = <span class="keyword">...</span>
1998     uiputfile({<span class="string">'*.kmz'</span>,<span class="string">'Google Earth Files (*.kmz)'</span>}, <span class="keyword">...</span>
1999     <span class="string">'Save Google Earth File'</span>, <span class="keyword">...</span>
2000     fullfile(guiparams.kmz_path,guiparams.kmz_file));
2001 
2002 <span class="comment">% Save the processed data to a Google Earth (KMZ) file:</span>
2003 <span class="comment">% -----------------------------------------------------</span>
2004 <span class="keyword">if</span> ischar(the_file)
2005     guiparams.kmz_path = the_path;
2006     guiparams.kmz_file = the_file;
2007     
2008     <span class="comment">% Re-store the Application data:</span>
2009     <span class="comment">% ------------------------------</span>
2010     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2011     
2012     <span class="comment">% Update the preferences:</span>
2013     <span class="comment">% -----------------------</span>
2014     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2015     guiprefs.kmz_path = the_path;
2016     guiprefs.kmz_file = the_file;
2017     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2018     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'kmz'</span>)
2019     
2020     <span class="comment">%     if guiparams.display_shoreline</span>
2021     <span class="comment">%         VMT_Shoreline2GE_3D(A,Map, ...</span>
2022     <span class="comment">%                             guiparams.vertical_exaggeration, ...</span>
2023     <span class="comment">%                             guiparams.vertical_offset);</span>
2024     <span class="comment">%     end</span>
2025     <span class="keyword">if</span> isempty(V)
2026         A = guiparams.A;
2027         A(1).hgns = guiparams.horizontal_grid_node_spacing;
2028         A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2029         [~,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2030             guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2031             guiparams.unit_discharge_correction);
2032     <span class="keyword">end</span>
2033     <a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>(A,V,[], <span class="keyword">...</span>
2034         fullfile(guiparams.kmz_path,guiparams.kmz_file), <span class="keyword">...</span>
2035         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2036         guiparams.vertical_offset);
2037 <span class="keyword">end</span>
2038 
2039 <span class="comment">% [EOF] SaveGoogleEarthFile_Callback</span>
2040 
2041 
2042 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2043 <span class="comment">% DATA EXPORT/BATHYMETRY CALLBACKS %</span>
2044 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2045 
2046 <span class="comment">% --------------------------------------------------------------------</span>
2047 <a name="_sub56" href="#_subfunctions" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
2048 
2049 <span class="comment">% Get the Application data:</span>
2050 <span class="comment">% -------------------------</span>
2051 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2052 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2053 
2054 [the_file,the_path] = <span class="keyword">...</span>
2055     uiputfile({<span class="string">'*.csv'</span>,<span class="string">'Multibeam Bathymetry Files (*.csv)'</span>}, <span class="keyword">...</span>
2056     <span class="string">'Export Multibeam Bathymetry'</span>, <span class="keyword">...</span>
2057     fullfile(guiprefs.multibeambathymetry_path, <span class="keyword">...</span>
2058     guiprefs.multibeambathymetry_file));
2059 
2060 <span class="keyword">if</span> ischar(the_file)
2061     guiparams.multibeambathymetry_path = the_path;
2062     guiparams.multibeambathymetry_file = the_file;
2063     
2064     <span class="comment">% Re-store the Application data:</span>
2065     <span class="comment">% ------------------------------</span>
2066     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2067     
2068     <span class="comment">% Update the preferences:</span>
2069     <span class="comment">% -----------------------</span>
2070     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2071     guiprefs.multibeambathymetry_path = the_path;
2072     guiprefs.multibeambathymetry_file = the_file;
2073     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2074     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'multibeambathymetry'</span>)
2075     
2076     <span class="keyword">if</span> guiparams.output_auxiliary_data
2077     <span class="keyword">end</span>
2078     
2079     <span class="comment">%msgbox('Processing Bathymetry...Please Be Patient','VMT Status','help','replace')</span>
2080     
2081     savefile = fullfile(guiparams.multibeambathymetry_path, <span class="keyword">...</span>
2082         guiparams.multibeambathymetry_file);
2083     
2084     log_text = {<span class="string">'Multibeam bathymetry file saved to:'</span>;<span class="keyword">...</span>
2085         [<span class="string">'   '</span> savefile]};
2086     statusLogging(handles.LogWindow,log_text)
2087     
2088     <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>(guiparams.z, <span class="keyword">...</span>
2089         guiparams.A, <span class="keyword">...</span>
2090         savefile, <span class="keyword">...</span>
2091         guiparams.beam_angle, <span class="keyword">...</span>
2092         guiparams.magnetic_variation, <span class="keyword">...</span>
2093         guiparams.wse, <span class="keyword">...</span>
2094         guiparams.output_auxiliary_data);
2095     
2096     <span class="comment">%msgbox('Bathymetry Output Complete','VMT Status','help','replace')</span>
2097     
2098 <span class="keyword">end</span>
2099 
2100 <span class="comment">% [EOF] ExportMultibeamBathymetry_Callback</span>
2101 
2102 
2103 <span class="comment">% --------------------------------------------------------------------</span>
2104 <a name="_sub57" href="#_subfunctions" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a>
2105 <span class="comment">% Get the beam angle</span>
2106 
2107 <span class="comment">% Get the Application data:</span>
2108 <span class="comment">% -------------------------</span>
2109 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2110 
2111 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2112 <span class="comment">% ----------------------------------------------------------------</span>
2113 new_beam_angle = str2double(get(hObject,<span class="string">'String'</span>));
2114 is_a_number = ~isnan(new_beam_angle);
2115 is_positive = new_beam_angle&gt;=0;
2116 
2117 <span class="comment">% Modify the Application data:</span>
2118 <span class="comment">% ----------------------------</span>
2119 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2120     guiparams.beam_angle = new_beam_angle;
2121     
2122     <span class="comment">% Re-store the Application data:</span>
2123     <span class="comment">% ------------------------------</span>
2124     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2125     
2126 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2127     set(hObject,<span class="string">'String'</span>,guiparams.beam_angle)
2128 <span class="keyword">end</span>
2129 
2130 <span class="comment">% [EOF] BeamAngle_Callback</span>
2131 
2132 
2133 <span class="comment">% --------------------------------------------------------------------</span>
2134 <a name="_sub58" href="#_subfunctions" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a>
2135 <span class="comment">% Get the Magnetic Variation</span>
2136 
2137 <span class="comment">% Get the Application data:</span>
2138 <span class="comment">% -------------------------</span>
2139 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2140 
2141 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2142 <span class="comment">% ----------------------------------------------------------------</span>
2143 new_magnetic_variation = str2double(get(hObject,<span class="string">'String'</span>));
2144 is_a_number = ~isnan(new_magnetic_variation);
2145 is_positive = new_magnetic_variation&gt;=0;
2146 
2147 <span class="comment">% Modify the Application data:</span>
2148 <span class="comment">% ----------------------------</span>
2149 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2150     guiparams.magnetic_variation = new_magnetic_variation;
2151     
2152     <span class="comment">% Re-store the Application data:</span>
2153     <span class="comment">% ------------------------------</span>
2154     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2155     
2156 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2157     set(hObject,<span class="string">'String'</span>,guiparams.magnetic_variation)
2158 <span class="keyword">end</span>
2159 
2160 <span class="comment">% [EOF] MagneticVariation_Callback</span>
2161 
2162 
2163 <span class="comment">% --------------------------------------------------------------------</span>
2164 <a name="_sub59" href="#_subfunctions" class="code">function WSE_Callback(hObject, eventdata, handles)</a>
2165 
2166 <span class="comment">% Get the Application data:</span>
2167 <span class="comment">% -------------------------</span>
2168 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2169 
2170 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2171 <span class="comment">% ----------------------------------------------------------------</span>
2172 new_wse = str2double(get(hObject,<span class="string">'String'</span>));
2173 is_a_number = ~isnan(new_wse);
2174 is_positive = new_wse&gt;=0;
2175 
2176 <span class="comment">% Modify the Application data:</span>
2177 <span class="comment">% ----------------------------</span>
2178 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2179     guiparams.wse = new_wse;
2180     
2181     <span class="comment">% Re-store the Application data:</span>
2182     <span class="comment">% ------------------------------</span>
2183     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2184     
2185 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2186     set(hObject,<span class="string">'String'</span>,guiparams.wse)
2187 <span class="keyword">end</span>
2188 
2189 <span class="comment">% [EOF] WSE_Callback</span>
2190 
2191 
2192 <span class="comment">% --------------------------------------------------------------------</span>
2193 <a name="_sub60" href="#_subfunctions" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a>
2194 <span class="comment">% Bathymetry Auxillary Data</span>
2195 
2196 <span class="comment">% Get the Application data:</span>
2197 <span class="comment">% -------------------------</span>
2198 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2199 
2200 <span class="comment">% Modify the Application data:</span>
2201 <span class="comment">% ----------------------------</span>
2202 guiparams.output_auxiliary_data = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2203 
2204 <span class="comment">% Re-store the Application data:</span>
2205 <span class="comment">% ------------------------------</span>
2206 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2207 
2208 <span class="comment">% [EOF] OutputAuxiliaryData_Callback</span>
2209 
2210 
2211 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2212 <span class="comment">% PLOTTING/PLAN VIEW PLOT CALLBACKS %</span>
2213 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2214 
2215 <span class="comment">% --------------------------------------------------------------------</span>
2216 <a name="_sub61" href="#_subfunctions" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a>
2217 
2218 <span class="comment">% Get the Application data:</span>
2219 <span class="comment">% -------------------------</span>
2220 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2221 
2222 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2223 <span class="comment">% ----------------------------------------------------------------</span>
2224 new_depth_range_min = str2double(get(hObject,<span class="string">'String'</span>));
2225 is_a_number = ~isnan(new_depth_range_min);
2226 is_positive = new_depth_range_min&gt;=0;
2227 
2228 <span class="comment">% Modify the Application data:</span>
2229 <span class="comment">% ----------------------------</span>
2230 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2231     guiparams.depth_range_min = new_depth_range_min;
2232     
2233     <span class="comment">% Re-store the Application data:</span>
2234     <span class="comment">% ------------------------------</span>
2235     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2236     
2237 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2238     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_min)
2239 <span class="keyword">end</span>
2240 
2241 <span class="comment">% [EOF] DepthRangeMin_Callback</span>
2242 
2243 
2244 <span class="comment">% --------------------------------------------------------------------</span>
2245 <a name="_sub62" href="#_subfunctions" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a>
2246 
2247 <span class="comment">% Get the Application data:</span>
2248 <span class="comment">% -------------------------</span>
2249 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2250 
2251 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2252 <span class="comment">% ----------------------------------------------------------------</span>
2253 new_depth_range_max = str2double(get(hObject,<span class="string">'String'</span>));
2254 is_a_number = ~isnan(new_depth_range_max);
2255 is_positive = new_depth_range_max&gt;=0;
2256 
2257 <span class="comment">% Modify the Application data:</span>
2258 <span class="comment">% ----------------------------</span>
2259 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2260     guiparams.depth_range_max = new_depth_range_max;
2261     
2262     <span class="comment">% Re-store the Application data:</span>
2263     <span class="comment">% ------------------------------</span>
2264     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2265     
2266 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2267     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_max)
2268 <span class="keyword">end</span>
2269 
2270 <span class="comment">% [EOF] DepthMax_Callback</span>
2271 
2272 
2273 <span class="comment">% --------------------------------------------------------------------</span>
2274 <a name="_sub63" href="#_subfunctions" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a>
2275 <span class="comment">% Set quiver scale (contour)</span>
2276 
2277 <span class="comment">% Get the Application data:</span>
2278 <span class="comment">% -------------------------</span>
2279 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2280 
2281 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2282 <span class="comment">% ----------------------------------------------------------------</span>
2283 new_vector_scale_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
2284 is_a_number = ~isnan(new_vector_scale_plan_view);
2285 is_positive = new_vector_scale_plan_view&gt;=0;
2286 
2287 <span class="comment">% Modify the Application data:</span>
2288 <span class="comment">% ----------------------------</span>
2289 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2290     guiparams.vector_scale_plan_view = round(new_vector_scale_plan_view);
2291     
2292     <span class="comment">% Re-store the Application data:</span>
2293     <span class="comment">% ------------------------------</span>
2294     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2295     
2296 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2297     set(hObject,<span class="string">'String'</span>,guiparams.vector_scale_plan_view)
2298 <span class="keyword">end</span>
2299 
2300 <span class="comment">% [EOF] VectorScalePlanView_Callback</span>
2301 
2302 
2303 <span class="comment">% --------------------------------------------------------------------</span>
2304 <a name="_sub64" href="#_subfunctions" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a>
2305 <span class="comment">% Set quiver spacing (contour, horizontal)</span>
2306 
2307 <span class="comment">% Get the Application data:</span>
2308 <span class="comment">% -------------------------</span>
2309 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2310 
2311 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2312 <span class="comment">% ----------------------------------------------------------------</span>
2313 new_vector_spacing_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
2314 is_a_number = ~isnan(new_vector_spacing_plan_view);
2315 is_positive = new_vector_spacing_plan_view&gt;=0;
2316 
2317 <span class="comment">% Modify the Application data:</span>
2318 <span class="comment">% ----------------------------</span>
2319 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2320     guiparams.vector_spacing_plan_view = round(new_vector_spacing_plan_view);
2321     
2322     <span class="comment">% Re-store the Application data:</span>
2323     <span class="comment">% ------------------------------</span>
2324     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2325     
2326 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2327     set(hObject,<span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
2328 <span class="keyword">end</span>
2329 
2330 <span class="comment">% [EOF] VectorSpacingPlanview_Callback</span>
2331 
2332 
2333 <span class="comment">% --------------------------------------------------------------------</span>
2334 <a name="_sub65" href="#_subfunctions" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a>
2335 <span class="comment">% Plan View smoothing window size</span>
2336 
2337 <span class="comment">% Get the Application data:</span>
2338 <span class="comment">% -------------------------</span>
2339 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2340 
2341 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2342 <span class="comment">% ----------------------------------------------------------------</span>
2343 new_smoothing_window_size = str2double(get(hObject,<span class="string">'String'</span>));
2344 is_a_number = ~isnan(new_smoothing_window_size);
2345 is_positive = new_smoothing_window_size&gt;=0;
2346 
2347 <span class="comment">% Modify the Application data:</span>
2348 <span class="comment">% ----------------------------</span>
2349 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2350     guiparams.smoothing_window_size = round(new_smoothing_window_size);
2351     
2352     <span class="comment">% Re-store the Application data:</span>
2353     <span class="comment">% ------------------------------</span>
2354     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2355     
2356 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2357     set(hObject,<span class="string">'String'</span>,guiparams.smoothing_window_size)
2358 <span class="keyword">end</span>
2359 
2360 <span class="comment">% [EOF] SmoothingWindowSize_Callback</span>
2361 
2362 
2363 <span class="comment">% --------------------------------------------------------------------</span>
2364 <a name="_sub66" href="#_subfunctions" class="code">function DisplayShoreline_Callback(hObject, eventdata, handles)</a>
2365 
2366 <span class="comment">% Get the Application data:</span>
2367 <span class="comment">% -------------------------</span>
2368 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2369 
2370 <span class="comment">% Modify the Application data:</span>
2371 <span class="comment">% ----------------------------</span>
2372 guiparams.display_shoreline = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2373 
2374 <span class="comment">% Re-store the Application data:</span>
2375 <span class="comment">% ------------------------------</span>
2376 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2377 
2378 <span class="comment">% [EOF] DisplayShoreline_Callback</span>
2379 
2380 
2381 <span class="comment">% --------------------------------------------------------------------</span>
2382 <a name="_sub67" href="#_subfunctions" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a>
2383 
2384 <span class="comment">% Get the Application data:</span>
2385 <span class="comment">% -------------------------</span>
2386 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2387 
2388 <span class="comment">% Modify the Application data:</span>
2389 <span class="comment">% ----------------------------</span>
2390 guiparams.add_background = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2391 
2392 <span class="comment">% Re-store the Application data:</span>
2393 <span class="comment">% ------------------------------</span>
2394 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2395 
2396 <span class="comment">% [EOF] AddBackground_Callback</span>
2397 
2398 
2399 <span class="comment">% --------------------------------------------------------------------</span>
2400 <a name="_sub68" href="#_subfunctions" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a>
2401 <a href="#_sub51" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
2402 <span class="comment">% [EOF] PlotPlanView_Callback</span>
2403 
2404 
2405 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2406 <span class="comment">% PLOTTING/SHIP TRACKS PLOT CALLBACKS %</span>
2407 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2408 
2409 <span class="comment">% --------------------------------------------------------------------</span>
2410 <a name="_sub69" href="#_subfunctions" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a>
2411 <span class="comment">% Set the horizontal grid node spacing</span>
2412 
2413 <span class="comment">% Get the Application data:</span>
2414 <span class="comment">% -------------------------</span>
2415 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2416 
2417 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2418 <span class="comment">% ----------------------------------------------------------------</span>
2419 new_horizontal_grid_node_spacing = str2double(get(hObject,<span class="string">'String'</span>));
2420 is_a_number = ~isnan(new_horizontal_grid_node_spacing);
2421 is_positive = new_horizontal_grid_node_spacing&gt;=0;
2422 
2423 <span class="comment">% Modify the Application data:</span>
2424 <span class="comment">% ----------------------------</span>
2425 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2426     guiparams.horizontal_grid_node_spacing = round(new_horizontal_grid_node_spacing);
2427     
2428     <span class="comment">% Re-store the Application data:</span>
2429     <span class="comment">% ------------------------------</span>
2430     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2431     
2432 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2433     set(hObject,<span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
2434 <span class="keyword">end</span>
2435 
2436 <span class="comment">% [EOF] HorizontalGridNodeSpacing_Callback</span>
2437 
2438 
2439 <span class="comment">% --------------------------------------------------------------------</span>
2440 <a name="_sub70" href="#_subfunctions" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
2441 <span class="comment">% Set the cross section endpoints manually</span>
2442 
2443 <span class="comment">% Get the Application data:</span>
2444 <span class="comment">% -------------------------</span>
2445 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2446 
2447 <span class="comment">% Modify the Application data:</span>
2448 <span class="comment">% ----------------------------</span>
2449 guiparams.set_cross_section_endpoints = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2450 
2451 <span class="comment">% Re-store the Application data:</span>
2452 <span class="comment">% ------------------------------</span>
2453 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2454 
2455 <span class="comment">% [EOF] SetCrossSectionEndpoints_Callback</span>
2456 
2457 
2458 <span class="comment">% --------------------------------------------------------------------</span>
2459 <a name="_sub71" href="#_subfunctions" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a>
2460 <a href="#_sub50" class="code" title="subfunction shiptracksPlotCallback(hObject, eventdata, handles)">shiptracksPlotCallback</a>(hObject, eventdata, handles)
2461 <span class="comment">% [EOF] PlotShiptracks_Callback</span>
2462 
2463 
2464 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2465 <span class="comment">% PLOTTING/CROSS SECTION PLOT CALLBACKS %</span>
2466 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2467 
2468 <span class="comment">% --------------------------------------------------------------------</span>
2469 <a name="_sub72" href="#_subfunctions" class="code">function Contour_Callback(hObject, eventdata, handles)</a>
2470 
2471 <span class="comment">% Get the Application data:</span>
2472 <span class="comment">% -------------------------</span>
2473 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2474 
2475 <span class="comment">% Modify the Application data:</span>
2476 <span class="comment">% ----------------------------</span>
2477 idx_variable = get(hObject,<span class="string">'Value'</span>);
2478 guiparams.idx_contour = idx_variable;
2479 guiparams.contour = guiparams.contours(idx_variable).variable;
2480 
2481 <span class="comment">% Re-store the Application data:</span>
2482 <span class="comment">% ------------------------------</span>
2483 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2484 
2485 <span class="comment">% [EOF] Contour_Callback</span>
2486 
2487 
2488 <span class="comment">% --------------------------------------------------------------------</span>
2489 <a name="_sub73" href="#_subfunctions" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a>
2490 <span class="comment">% Set vertical exaggeration</span>
2491 
2492 <span class="comment">% Get the Application data:</span>
2493 <span class="comment">% -------------------------</span>
2494 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2495 
2496 <span class="comment">% Modify the Application data:</span>
2497 <span class="comment">% ----------------------------</span>
2498 guiparams.vertical_exaggeration = str2double(get(hObject,<span class="string">'String'</span>));
2499 
2500 <span class="comment">% Re-store the Application data:</span>
2501 <span class="comment">% ------------------------------</span>
2502 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2503 
2504 <span class="comment">% Update the GUI:</span>
2505 <span class="comment">% ---------------</span>
2506 <span class="comment">% updateGUI(handles,guiparams)</span>
2507 
2508 <span class="comment">% [EOF] VerticalExaggeration_Callback</span>
2509 
2510 
2511 <span class="comment">% --------------------------------------------------------------------</span>
2512 <a name="_sub74" href="#_subfunctions" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a>
2513 
2514 <span class="comment">% Get the Application data:</span>
2515 <span class="comment">% -------------------------</span>
2516 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2517 
2518 <span class="comment">% Modify the Application data:</span>
2519 <span class="comment">% ----------------------------</span>
2520 guiparams.vector_scale_cross_section = str2double(get(hObject,<span class="string">'String'</span>));
2521 
2522 <span class="comment">% Re-store the Application data:</span>
2523 <span class="comment">% ------------------------------</span>
2524 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2525 
2526 <span class="comment">% Update the GUI:</span>
2527 <span class="comment">% ---------------</span>
2528 <span class="comment">% updateGUI(handles,guiparams)</span>
2529 
2530 <span class="comment">% [EOF] VectorScaleCrossSection_Callback</span>
2531 
2532 
2533 <span class="comment">% --------------------------------------------------------------------</span>
2534 <a name="_sub75" href="#_subfunctions" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a>
2535 
2536 <span class="comment">% Get the Application data:</span>
2537 <span class="comment">% -------------------------</span>
2538 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2539 
2540 <span class="comment">% Modify the Application data:</span>
2541 <span class="comment">% ----------------------------</span>
2542 guiparams.horizontal_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
2543 
2544 <span class="comment">% Re-store the Application data:</span>
2545 <span class="comment">% ------------------------------</span>
2546 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2547 
2548 <span class="comment">% Update the GUI:</span>
2549 <span class="comment">% ---------------</span>
2550 <span class="comment">% updateGUI(handles,guiparams)</span>
2551 
2552 <span class="comment">% [EOF] HorizontalVectorSpacing_Callback</span>
2553 
2554 
2555 <span class="comment">% --------------------------------------------------------------------</span>
2556 <a name="_sub76" href="#_subfunctions" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a>
2557 <span class="comment">% Get the vertical quiver spacing for contour plots</span>
2558 
2559 <span class="comment">% Get the Application data:</span>
2560 <span class="comment">% -------------------------</span>
2561 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2562 
2563 <span class="comment">% Modify the Application data:</span>
2564 <span class="comment">% ----------------------------</span>
2565 guiparams.vertical_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
2566 
2567 <span class="comment">% Re-store the Application data:</span>
2568 <span class="comment">% ------------------------------</span>
2569 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2570 
2571 <span class="comment">% Update the GUI:</span>
2572 <span class="comment">% ---------------</span>
2573 <span class="comment">% updateGUI(handles,guiparams)</span>
2574 
2575 <span class="comment">% [EOF] VerticalVectorSpacing_Callback</span>
2576 
2577 
2578 <span class="comment">% --------------------------------------------------------------------</span>
2579 <a name="_sub77" href="#_subfunctions" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
2580 <span class="comment">% Horizontal Smoothing</span>
2581 
2582 <span class="comment">% Get the Application data:</span>
2583 <span class="comment">% -------------------------</span>
2584 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2585 
2586 <span class="comment">% Modify the Application data:</span>
2587 <span class="comment">% ----------------------------</span>
2588 guiparams.horizontal_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
2589 
2590 <span class="comment">% Re-store the Application data:</span>
2591 <span class="comment">% ------------------------------</span>
2592 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2593 
2594 <span class="comment">% Update the GUI:</span>
2595 <span class="comment">% ---------------</span>
2596 <span class="comment">% updateGUI(handles,guiparams)</span>
2597 
2598 <span class="comment">% [EOF] HorizontalSmoothingWindow_Callback</span>
2599 
2600 
2601 <span class="comment">% --------------------------------------------------------------------</span>
2602 <a name="_sub78" href="#_subfunctions" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
2603 <span class="comment">% Vertical Smoothing</span>
2604 
2605 <span class="comment">% Get the Application data:</span>
2606 <span class="comment">% -------------------------</span>
2607 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2608 
2609 <span class="comment">% Modify the Application data:</span>
2610 <span class="comment">% ----------------------------</span>
2611 guiparams.vertical_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
2612 
2613 <span class="comment">% Re-store the Application data:</span>
2614 <span class="comment">% ------------------------------</span>
2615 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2616 
2617 <span class="comment">% Update the GUI:</span>
2618 <span class="comment">% ---------------</span>
2619 <span class="comment">% updateGUI(handles,guiparams)</span>
2620 
2621 <span class="comment">% [EOF] VerticalSmoothingWindow_Callback</span>
2622 
2623 
2624 <span class="comment">% --------------------------------------------------------------------</span>
2625 <a name="_sub79" href="#_subfunctions" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a>
2626 
2627 <span class="comment">% Get the Application data:</span>
2628 <span class="comment">% -------------------------</span>
2629 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2630 
2631 <span class="comment">% Modify the Application data:</span>
2632 <span class="comment">% ----------------------------</span>
2633 guiparams.plot_secondary_flow_vectors = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2634 
2635 <span class="comment">% Re-store the Application data:</span>
2636 <span class="comment">% ------------------------------</span>
2637 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2638 
2639 <span class="comment">% [EOF] PlotSecondaryFlowVectors_Callback</span>
2640 
2641 
2642 <span class="comment">% --------------------------------------------------------------------</span>
2643 <a name="_sub80" href="#_subfunctions" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a>
2644 
2645 <span class="comment">% Get the Application data:</span>
2646 <span class="comment">% -------------------------</span>
2647 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2648 
2649 <span class="comment">% Modify the Application data:</span>
2650 <span class="comment">% ----------------------------</span>
2651 idx_variable = get(hObject,<span class="string">'Value'</span>);
2652 guiparams.idx_secondary_flow_vector_variable = idx_variable;
2653 guiparams.secondary_flow_vector_variable = guiparams.secondary_flows(idx_variable).variable;
2654 
2655 <span class="comment">% Re-store the Application data:</span>
2656 <span class="comment">% ------------------------------</span>
2657 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2658 
2659 <span class="comment">% [EOF] SecondaryFlowVectorVariable_Callback</span>
2660 
2661 
2662 <span class="comment">% --------------------------------------------------------------------</span>
2663 <a name="_sub81" href="#_subfunctions" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a>
2664 
2665 <span class="comment">% Get the Application data:</span>
2666 <span class="comment">% -------------------------</span>
2667 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2668 
2669 <span class="comment">% Modify the Application data:</span>
2670 <span class="comment">% ----------------------------</span>
2671 guiparams.include_vertical_velocity = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2672 
2673 <span class="comment">% Re-store the Application data:</span>
2674 <span class="comment">% ------------------------------</span>
2675 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2676 
2677 <span class="comment">% [EOF] IncludeVerticalVelocity_Callback</span>
2678 
2679 
2680 <span class="comment">% --------------------------------------------------------------------</span>
2681 <a name="_sub82" href="#_subfunctions" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a>
2682 <a href="#_sub52" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
2683 <span class="comment">% [EOF] PlotCrossSection_Callback</span>
2684 
2685 
2686 <span class="comment">% --------------------------------------------------------------------</span>
2687 <a name="_sub83" href="#_subfunctions" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a>
2688 set(handles.LogWindow,<span class="string">'string'</span>,<span class="string">''</span>)
2689 <span class="comment">% [EOF] ClearLog_Callback</span>
2690 
2691 <span class="comment">% --------------------------------------------------------------------</span>
2692 <a name="_sub84" href="#_subfunctions" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a>
2693 
2694 <span class="comment">% Get the Application data:</span>
2695 <span class="comment">% -------------------------</span>
2696 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2697 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2698 <span class="comment">% z   = guiparams.z;   %#ok&lt;NASGU&gt;</span>
2699 <span class="comment">% A   = guiparams.A;   %#ok&lt;NASGU&gt;</span>
2700 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
2701 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
2702 
2703 [the_file,the_path] = <span class="keyword">...</span>
2704     uiputfile({<span class="string">'*.txt'</span>,<span class="string">'TXT-Files (*.txt)'</span>}, <span class="keyword">...</span>
2705     <span class="string">'Choose where to save the log file'</span>, <span class="keyword">...</span>
2706     fullfile(guiprefs.log_path,guiprefs.log_file));
2707 
2708 <span class="comment">% Save the log to a TXT file:</span>
2709 <span class="comment">% ---------------------------</span>
2710 <span class="keyword">if</span> ischar(the_file)
2711     guiparams.log_path = the_path;
2712     guiparams.log_file = the_file;
2713     <span class="comment">%guiparams.savefile = the_file;</span>
2714     
2715     <span class="comment">% Re-store the Application data:</span>
2716     <span class="comment">% ------------------------------</span>
2717     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2718     
2719     <span class="comment">% Update the preferences:</span>
2720     <span class="comment">% -----------------------</span>
2721     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2722     guiprefs.log_path = the_path;
2723     guiprefs.log_file = the_file;
2724     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2725     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'log'</span>)
2726     
2727     [~,filename,extension] = fileparts(the_file);
2728     savefile = [the_path filename extension];
2729     h = msgbox([<span class="string">'Saving log to: '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
2730         <span class="string">'Saving Log File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2731     
2732     logfile = get(handles.LogWindow,<span class="string">'string'</span>);
2733     [nrows,~]= size(logfile);
2734     fid = fopen(savefile, <span class="string">'w'</span>);
2735     <span class="keyword">for</span> row=1:nrows
2736         fprintf(fid, <span class="string">'%s \n'</span>, logfile{row,:});
2737     <span class="keyword">end</span>
2738     fclose(fid);
2739 <span class="keyword">end</span>
2740 <span class="comment">% [EOF] SaveLog_Callback</span>
2741 
2742 <span class="comment">%%%%%%%%%%%%%%%%</span>
2743 <span class="comment">% SUBFUNCTIONS %</span>
2744 <span class="comment">%%%%%%%%%%%%%%%%</span>
2745 
2746 <span class="comment">% --------------------------------------------------------------------</span>
2747 <a name="_sub85" href="#_subfunctions" class="code">function handles = buildToolbar(handles)</a>
2748 
2749 icons = <a href="#_sub101" class="code" title="subfunction icons = getIcons">getIcons</a>;
2750 ht = uitoolbar(<span class="string">'Parent'</span>,handles.figure1);
2751 
2752 <span class="comment">% Load data</span>
2753 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_open.png');</span>
2754 <span class="comment">% icon = double(icon)/(2^16-1);</span>
2755 <span class="comment">% icon(icon==0) = NaN;</span>
2756 handles.toolbarLoadData = <span class="keyword">...</span>
2757     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
2758     <span class="string">'CData'</span>,        icons(1).data, <span class="keyword">...</span>
2759     <span class="string">'TooltipString'</span>,<span class="string">'Open ASCII File'</span>);
2760 
2761 <span class="comment">% Save data</span>
2762 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_save.png');</span>
2763 <span class="comment">% icon = double(icon)/(2^16-1);</span>
2764 <span class="comment">% icon(icon==0) = NaN;</span>
2765 handles.toolbarSaveMatFile = <span class="keyword">...</span>
2766     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
2767     <span class="string">'CData'</span>,        icons(2).data, <span class="keyword">...</span>
2768     <span class="string">'TooltipString'</span>,<span class="string">'Save MAT File'</span>, <span class="keyword">...</span>
2769     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
2770 
2771 
2772 <span class="comment">% Save bathymetry</span>
2773 <span class="comment">%icon = ones(16,16,3);</span>
2774 handles.toolbarSaveBathymetry = <span class="keyword">...</span>
2775     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
2776     <span class="string">'CData'</span>,        icons(5).data, <span class="keyword">...</span>
2777     <span class="string">'TooltipString'</span>,<span class="string">'Export Bathymetry'</span>);
2778 
2779 <span class="comment">% Save figures</span>
2780 <span class="comment">% icon = ones(16,16,3);</span>
2781 handles.toolbarSaveFigures = <span class="keyword">...</span>
2782     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
2783     <span class="string">'CData'</span>,        icons(6).data, <span class="keyword">...</span>
2784     <span class="string">'TooltipString'</span>,<span class="string">'Export Figures'</span>);
2785 
2786 <span class="comment">% Save Excel File</span>
2787 <span class="comment">% icon = ones(16,16,3);</span>
2788 handles.toolbarSaveExcel = <span class="keyword">...</span>
2789     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
2790     <span class="string">'CData'</span>,        icons(7).data, <span class="keyword">...</span>
2791     <span class="string">'TooltipString'</span>,<span class="string">'Export Excel File'</span>);
2792 
2793 
2794 <span class="comment">% Plotting parameters</span>
2795 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\PlotGeneralElement.gif');</span>
2796 <span class="comment">% icon = ind2rgb(icon,map);</span>
2797 handles.toolbarPlottingParameters = <span class="keyword">...</span>
2798     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
2799     <span class="string">'CData'</span>,        icons(3).data, <span class="keyword">...</span>
2800     <span class="string">'TooltipString'</span>,<span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
2801     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
2802 
2803 <span class="comment">% Processing parameters</span>
2804 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
2805 <span class="comment">% icon = ind2rgb(icon,map);</span>
2806 handles.toolbarProcessingParameters = <span class="keyword">...</span>
2807     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
2808     <span class="string">'CData'</span>,        icons(4).data, <span class="keyword">...</span>
2809     <span class="string">'TooltipString'</span>,<span class="string">'Processing Parameters'</span>);
2810 
2811 <span class="comment">% % Plot 1: Shiptracks</span>
2812 <span class="comment">% handles.shiptracksPlot = ...</span>
2813 <span class="comment">%     uipushtool('Parent',       ht, ...</span>
2814 <span class="comment">%                'CData',        icon, ...</span>
2815 <span class="comment">%                'TooltipString','Shiptracks plot', ...</span>
2816 <span class="comment">%                'Separator',    'on');</span>
2817 <span class="comment">%</span>
2818 <span class="comment">% % Plot 2: Plan view</span>
2819 <span class="comment">% handles.planviewPlot = ...</span>
2820 <span class="comment">%     uipushtool('Parent',       ht, ...</span>
2821 <span class="comment">%                'CData',        icon, ...</span>
2822 <span class="comment">%                'TooltipString','Plan view plot');</span>
2823 <span class="comment">%</span>
2824 <span class="comment">% % Plot 3: Cross section</span>
2825 <span class="comment">% handles.crosssectionPlot = ...</span>
2826 <span class="comment">%     uipushtool('Parent',       ht, ...</span>
2827 <span class="comment">%                'CData',        icon, ...</span>
2828 <span class="comment">%                'TooltipString','Cross section plot');</span>
2829 
2830 set(handles.toolbarLoadData,            <span class="string">'ClickedCallback'</span>,{@<a href="#_sub45" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>,handles})
2831 set(handles.toolbarSaveMatFile,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub46" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>,handles})
2832 set(handles.toolbarSaveBathymetry,      <span class="string">'ClickedCallback'</span>,{@<a href="#_sub56" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>,handles})
2833 set(handles.toolbarSaveFigures,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub17" class="code" title="subfunction menuExportFigures_Callback(hObject, eventdata, handles)">menuExportFigures_Callback</a>,handles})
2834 set(handles.toolbarSaveExcel,           <span class="string">'ClickedCallback'</span>,{@<a href="#_sub21" class="code" title="subfunction menuSaveExcel_Callback(hObject, eventdata, handles)">menuSaveExcel_Callback</a>,handles})
2835 set(handles.toolbarPlottingParameters,  <span class="string">'ClickedCallback'</span>,{@<a href="#_sub48" class="code" title="subfunction plottingParametersCallback(hObject, eventdata, handles)">plottingParametersCallback</a>,handles})
2836 set(handles.toolbarProcessingParameters,<span class="string">'ClickedCallback'</span>,{@<a href="#_sub49" class="code" title="subfunction processingParametersCallback(hObject, eventdata, handles)">processingParametersCallback</a>,handles})
2837 <span class="comment">% set(handles.shiptracksPlot,      'ClickedCallback',{@shiptracksPlotCallback,handles})</span>
2838 <span class="comment">% set(handles.planviewPlot,        'ClickedCallback',{@planviewPlotCallback,handles})</span>
2839 <span class="comment">% set(handles.crosssectionPlot,    'ClickedCallback',{@crosssectionPlotCallback,handles})</span>
2840 
2841 <span class="comment">% [EOF] buildtoolbar</span>
2842 
2843 
2844 <span class="comment">% --------------------------------------------------------------------</span>
2845 <a name="_sub86" href="#_subfunctions" class="code">function load_prefs(hfigure)</a>
2846 <span class="comment">% Load the GUI preferences.  Also, initialize preferences if they don't</span>
2847 <span class="comment">% already exist.</span>
2848 
2849 <span class="comment">% Preferences:</span>
2850 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
2851 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
2852 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
2853 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
2854 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
2855 <span class="comment">% 'log'                  Path and filename of last Log file</span>
2856 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
2857 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
2858 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
2859 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
2860 
2861 <span class="comment">% Originals</span>
2862 <span class="comment">% prefs = {'ascii2gispath' 'ascii2kmlpath' 'asciipath'   'doqqpath' ...</span>
2863 <span class="comment">%          'endspath'      'logpath'       'matpath'     'savedpath' ...</span>
2864 <span class="comment">%          'shorepath'     'stapath'       'ysidatapath' 'ysidatapath'};</span>
2865 
2866 <span class="comment">% ASCII</span>
2867 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>)
2868     ascii = getpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>);
2869     <span class="keyword">if</span> exist(ascii.path,<span class="string">'dir'</span>)
2870         guiprefs.ascii_path = ascii.path;
2871     <span class="keyword">else</span>
2872         guiprefs.ascii_path = pwd;
2873     <span class="keyword">end</span>
2874     does_exist = false(1,length(ascii.file));
2875     <span class="keyword">for</span> k = 1:length(ascii.file) <span class="comment">% Check each file one-by-one</span>
2876         does_exist(k) = exist(fullfile(ascii.path,ascii.file{k}),<span class="string">'file'</span>);
2877     <span class="keyword">end</span>
2878     <span class="keyword">if</span> any(does_exist)
2879         guiprefs.ascii_file = ascii.file(does_exist);
2880     <span class="keyword">else</span>
2881         guiprefs.ascii_file = {<span class="string">''</span>};
2882     <span class="keyword">end</span>
2883 <span class="keyword">else</span> <span class="comment">% Initialize ASCII</span>
2884     guiprefs.ascii_path = pwd;
2885     guiprefs.ascii_file = {<span class="string">''</span>};
2886     
2887     ascii.path = pwd;
2888     ascii.file = {<span class="string">''</span>};
2889     setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
2890 <span class="keyword">end</span>
2891 
2892 <span class="comment">% MAT</span>
2893 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>)
2894     mat = getpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>);
2895     <span class="keyword">if</span> exist(mat.path,<span class="string">'dir'</span>)
2896         guiprefs.mat_path = mat.path;
2897     <span class="keyword">else</span>
2898         guiprefs.mat_path = pwd;
2899     <span class="keyword">end</span>
2900     
2901     <span class="keyword">if</span> iscell(mat.file)
2902         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file{1}),<span class="string">'file'</span>)
2903             guiprefs.mat_file = mat.file;
2904         <span class="keyword">else</span>
2905             guiprefs.mat_file = <span class="string">''</span>;
2906         <span class="keyword">end</span>
2907     <span class="keyword">else</span>
2908         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file),<span class="string">'file'</span>)
2909             guiprefs.mat_file = mat.file;
2910         <span class="keyword">else</span>
2911             guiprefs.mat_file = <span class="string">''</span>;
2912         <span class="keyword">end</span>
2913     <span class="keyword">end</span>
2914 <span class="keyword">else</span> <span class="comment">% Initialize MAT</span>
2915     guiprefs.mat_path = pwd;
2916     guiprefs.mat_file = <span class="string">''</span>;
2917     
2918     mat.path = pwd;
2919     mat.file = <span class="string">''</span>;
2920     setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
2921 <span class="keyword">end</span>
2922 
2923 <span class="comment">% TECPLOT</span>
2924 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>)
2925     tecplot = getpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>);
2926     <span class="keyword">if</span> exist(tecplot.path,<span class="string">'dir'</span>)
2927         guiprefs.tecplot_path = tecplot.path;
2928     <span class="keyword">else</span>
2929         guiprefs.tecplot_path = pwd;
2930     <span class="keyword">end</span>
2931     <span class="keyword">if</span> exist(fullfile(tecplot.path,tecplot.file),<span class="string">'file'</span>)
2932         guiprefs.tecplot_file = tecplot.file;
2933     <span class="keyword">else</span>
2934         guiprefs.tecplot_file = <span class="string">''</span>;
2935     <span class="keyword">end</span>
2936 <span class="keyword">else</span> <span class="comment">% Initialize TECPLOT</span>
2937     guiprefs.tecplot_path = pwd;
2938     guiprefs.tecplot_file = <span class="string">''</span>;
2939     
2940     tecplot.path = pwd;
2941     tecplot.file = <span class="string">''</span>;
2942     setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
2943 <span class="keyword">end</span>
2944 
2945 <span class="comment">% KMZ</span>
2946 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>)
2947     kmz = getpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>);
2948     <span class="keyword">if</span> exist(kmz.path,<span class="string">'dir'</span>)
2949         guiprefs.kmz_path = kmz.path;
2950     <span class="keyword">else</span>
2951         guiprefs.kmz_path = pwd;
2952     <span class="keyword">end</span>
2953     <span class="keyword">if</span> exist(fullfile(kmz.path,kmz.file),<span class="string">'file'</span>)
2954         guiprefs.kmz_file = kmz.file;
2955     <span class="keyword">else</span>
2956         guiprefs.kmz_file = <span class="string">''</span>;
2957     <span class="keyword">end</span>
2958 <span class="keyword">else</span> <span class="comment">% Initialize KMZ</span>
2959     guiprefs.kmz_path = pwd;
2960     guiprefs.kmz_file = <span class="string">''</span>;
2961     
2962     kmz.path = pwd;
2963     kmz.file = <span class="string">''</span>;
2964     setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
2965 <span class="keyword">end</span>
2966 
2967 <span class="comment">% MULTIBEAM BATHYMETRY</span>
2968 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>)
2969     multibeambathymetry = getpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>);
2970     <span class="keyword">if</span> exist(multibeambathymetry.path,<span class="string">'dir'</span>)
2971         guiprefs.multibeambathymetry_path = multibeambathymetry.path;
2972     <span class="keyword">else</span>
2973         guiprefs.multibeambathymetry_path = pwd;
2974     <span class="keyword">end</span>
2975     <span class="keyword">if</span> exist(fullfile(multibeambathymetry.path,multibeambathymetry.file),<span class="string">'file'</span>)
2976         guiprefs.multibeambathymetry_file = multibeambathymetry.file;
2977     <span class="keyword">else</span>
2978         guiprefs.multibeambathymetry_file = <span class="string">''</span>;
2979     <span class="keyword">end</span>
2980 <span class="keyword">else</span> <span class="comment">% Initialize MULTIBEAM BATHYMETRY</span>
2981     guiprefs.multibeambathymetry_path = pwd;
2982     guiprefs.multibeambathymetry_file = <span class="string">''</span>;
2983     
2984     multibeambathymetry.path = pwd;
2985     multibeambathymetry.file = <span class="string">''</span>;
2986     setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
2987 <span class="keyword">end</span>
2988 
2989 <span class="comment">% Log</span>
2990 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'log'</span>)
2991     log = getpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>);
2992     <span class="keyword">if</span> exist(log.path,<span class="string">'dir'</span>)
2993         guiprefs.log_path = log.path;
2994     <span class="keyword">else</span>
2995         guiprefs.log_path = pwd;
2996     <span class="keyword">end</span>
2997     <span class="keyword">if</span> exist(fullfile(log.path,log.file),<span class="string">'file'</span>)
2998         guiprefs.log_file = log.file;
2999     <span class="keyword">else</span>
3000         guiprefs.log_file = <span class="string">''</span>;
3001     <span class="keyword">end</span>
3002 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
3003     guiprefs.log_path = pwd;
3004     guiprefs.log_file = <span class="string">''</span>;
3005     
3006     log.path = pwd;
3007     log.file = <span class="string">''</span>;
3008     setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
3009 <span class="keyword">end</span>
3010 
3011 <span class="comment">% iRic</span>
3012 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>)
3013     iric = getpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>);
3014     <span class="keyword">if</span> exist(iric.path,<span class="string">'dir'</span>)
3015         guiprefs.iric_path = iric.path;
3016     <span class="keyword">else</span>
3017         guiprefs.iric_path = pwd;
3018     <span class="keyword">end</span>
3019     <span class="keyword">if</span> exist(fullfile(iric.path,iric.file),<span class="string">'file'</span>)
3020         guiprefs.iric_file = iric.file;
3021     <span class="keyword">else</span>
3022         guiprefs.iric_file = <span class="string">''</span>;
3023     <span class="keyword">end</span>
3024 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
3025     guiprefs.iric_path = pwd;
3026     guiprefs.iric_file = <span class="string">''</span>;
3027     
3028     iric.path = pwd;
3029     iric.file = <span class="string">''</span>;
3030     setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
3031 <span class="keyword">end</span>
3032 
3033 <span class="comment">% excel</span>
3034 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>)
3035     excel = getpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>);
3036     <span class="keyword">if</span> exist(excel.path,<span class="string">'dir'</span>)
3037         guiprefs.excel_path = excel.path;
3038     <span class="keyword">else</span>
3039         guiprefs.excel_path = pwd;
3040     <span class="keyword">end</span>
3041     <span class="keyword">if</span> exist(fullfile(excel.path,excel.file),<span class="string">'file'</span>)
3042         guiprefs.excel_file = excel.file;
3043     <span class="keyword">else</span>
3044         guiprefs.excel_file = <span class="string">''</span>;
3045     <span class="keyword">end</span>
3046 <span class="keyword">else</span> <span class="comment">% Initialize pref</span>
3047     guiprefs.excel_path = pwd;
3048     guiprefs.excel_file = <span class="string">''</span>;
3049     
3050     excel.path = pwd;
3051     excel.file = <span class="string">''</span>;
3052     setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
3053 <span class="keyword">end</span>
3054 
3055 <span class="comment">% aerial</span>
3056 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>)
3057     aerial = getpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>);
3058     <span class="keyword">if</span> exist(aerial.path,<span class="string">'dir'</span>)
3059         guiprefs.aerial_path = aerial.path;
3060     <span class="keyword">else</span>
3061         guiprefs.aerial_path = pwd;
3062     <span class="keyword">end</span>
3063     does_exist = false(1,length(aerial.file));
3064     <span class="keyword">if</span> iscell(aerial.file)
3065     <span class="keyword">for</span> k = 1:numel(aerial.file) <span class="comment">% Check each file one-by-one</span>
3066         does_exist(k) = exist(fullfile(aerial.path,aerial.file{k}),<span class="string">'file'</span>);
3067     <span class="keyword">end</span>
3068     <span class="keyword">else</span>
3069         does_exist = exist(fullfile(aerial.path,aerial.file),<span class="string">'file'</span>);
3070     <span class="keyword">end</span>
3071     <span class="keyword">if</span> any(does_exist)
3072         guiprefs.aerial_file = aerial.file;
3073     <span class="keyword">else</span>
3074         guiprefs.aerial_file = {<span class="string">''</span>};
3075     <span class="keyword">end</span>
3076 <span class="keyword">else</span> <span class="comment">% Initialize aerial</span>
3077     guiprefs.aerial_path = pwd;
3078     guiprefs.aerial_file = {<span class="string">''</span>};
3079     
3080     aerial.path = pwd;
3081     aerial.file = {<span class="string">''</span>};
3082     setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
3083 <span class="keyword">end</span>
3084 
3085 <span class="comment">% shoreline</span>
3086 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>)
3087     shoreline = getpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>);
3088     <span class="keyword">if</span> exist(shoreline.path,<span class="string">'dir'</span>)
3089         guiprefs.shoreline_path = shoreline.path;
3090     <span class="keyword">else</span>
3091         guiprefs.shoreline_path = pwd;
3092     <span class="keyword">end</span>
3093     
3094     <span class="keyword">if</span> iscell(shoreline.file)
3095         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file{1}),<span class="string">'file'</span>)
3096             guiprefs.shoreline_file = shoreline.file;
3097         <span class="keyword">else</span>
3098             guiprefs.shoreline_file = <span class="string">''</span>;
3099         <span class="keyword">end</span>
3100     <span class="keyword">else</span>
3101         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file),<span class="string">'file'</span>)
3102             guiprefs.shoreline_file = shoreline.file;
3103         <span class="keyword">else</span>
3104             guiprefs.shoreline_file = <span class="string">''</span>;
3105         <span class="keyword">end</span>
3106     <span class="keyword">end</span>
3107 <span class="keyword">else</span> <span class="comment">% Initialize shoreline</span>
3108     guiprefs.shoreline_path = pwd;
3109     guiprefs.shoreline_file = <span class="string">''</span>;
3110     
3111     shoreline.path = pwd;
3112     shoreline.file = <span class="string">''</span>;
3113     setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
3114 <span class="keyword">end</span>
3115 <span class="comment">% guiprefs.presentation = true;</span>
3116 <span class="comment">% guiprefs.print        = false;</span>
3117 
3118 <span class="comment">% for k = 1:length(prefs)</span>
3119 <span class="comment">%     newpref = '';</span>
3120 <span class="comment">%     if ispref('VMT',prefs{k})</span>
3121 <span class="comment">%         stored_newpref = getpref('VMT',prefs{k});</span>
3122 <span class="comment">%         if exist(stored_newpref,'dir')</span>
3123 <span class="comment">%             newpref = stored_newpref;</span>
3124 <span class="comment">%         else</span>
3125 <span class="comment">%             setpref('VMT',prefs{k},newpref)</span>
3126 <span class="comment">%         end</span>
3127 <span class="comment">%     end</span>
3128 <span class="comment">%     guiprefs.(prefs{k}) = newpref;</span>
3129 <span class="comment">% end</span>
3130 
3131 setappdata(hfigure,<span class="string">'guiprefs'</span>,guiprefs)
3132 
3133 <span class="comment">% [EOF] load_prefs</span>
3134 
3135 
3136 <span class="comment">% --------------------------------------------------------------------</span>
3137 <a name="_sub87" href="#_subfunctions" class="code">function store_prefs(hfigure,pref)</a>
3138 <span class="comment">% Store preferences in the Application data and in the persistent</span>
3139 <span class="comment">% preferences data.</span>
3140 
3141 <span class="comment">% Preferences:</span>
3142 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
3143 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
3144 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
3145 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
3146 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
3147 <span class="comment">% 'log'                  Path and filename of last Log file</span>
3148 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
3149 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
3150 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
3151 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
3152 
3153 guiprefs = getappdata(hfigure,<span class="string">'guiprefs'</span>);
3154 
3155 <span class="keyword">switch</span> pref
3156     <span class="keyword">case</span> <span class="string">'ascii'</span>
3157         ascii.path = guiprefs.ascii_path;
3158         ascii.file = guiprefs.ascii_file;
3159         setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
3160     <span class="keyword">case</span> <span class="string">'mat'</span>
3161         mat.path = guiprefs.mat_path;
3162         mat.file = guiprefs.mat_file;
3163         setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
3164     <span class="keyword">case</span> <span class="string">'tecplot'</span>
3165         tecplot.path = guiprefs.tecplot_path;
3166         tecplot.file = guiprefs.tecplot_file;
3167         setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
3168     <span class="keyword">case</span> <span class="string">'kmz'</span>
3169         kmz.path = guiprefs.kmz_path;
3170         kmz.file = guiprefs.kmz_file;
3171         setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
3172     <span class="keyword">case</span> <span class="string">'multibeambathymetry'</span>
3173         multibeambathymetry.path = guiprefs.multibeambathymetry_path;
3174         multibeambathymetry.file = guiprefs.multibeambathymetry_file;
3175         setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
3176     <span class="keyword">case</span> <span class="string">'log'</span>
3177         log.path = guiprefs.log_path;
3178         log.file = guiprefs.log_file;
3179         setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
3180     <span class="keyword">case</span> <span class="string">'iric'</span>
3181         iric.path = guiprefs.iric_path;
3182         iric.file = guiprefs.iric_file;
3183         setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
3184     <span class="keyword">case</span> <span class="string">'excel'</span>
3185         excel.path = guiprefs.excel_path;
3186         excel.file = guiprefs.excel_file;
3187         setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
3188     <span class="keyword">case</span> <span class="string">'aerial'</span>
3189         aerial.path = guiprefs.aerial_path;
3190         aerial.file = guiprefs.aerial_file;
3191         setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
3192     <span class="keyword">case</span> <span class="string">'shoreline'</span>
3193         shoreline.path = guiprefs.shoreline_path;
3194         shoreline.file = guiprefs.shoreline_file;
3195         setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
3196     <span class="keyword">otherwise</span>
3197 <span class="keyword">end</span>
3198 
3199 <span class="comment">% if ismember(pref,prefs)</span>
3200 <span class="comment">%     setpref('VMT',pref,value)</span>
3201 <span class="comment">%</span>
3202 <span class="comment">%     guiprefs = getappdata(hfigure,'guiprefs');</span>
3203 <span class="comment">%     guiprefs.(pref) = value;</span>
3204 <span class="comment">%     setappdata(hfigure,'guiprefs',guiprefs)</span>
3205 <span class="comment">% end</span>
3206 
3207 <span class="comment">% [EOF] store_prefs</span>
3208 
3209 
3210 <span class="comment">% --------------------------------------------------------------------</span>
3211 <a name="_sub88" href="#_subfunctions" class="code">function initGUI(handles)</a>
3212 <span class="comment">% Initialize the UI controls in the GUI.</span>
3213 
3214 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3215 
3216 <span class="comment">% Set the name and version</span>
3217 set(handles.figure1,<span class="string">'Name'</span>,[<span class="string">'Velocity Mapping Toolbox (VMT) '</span> guiparams.vmt_version], <span class="keyword">...</span>
3218     <span class="string">'DockControls'</span>,<span class="string">'off'</span>)
3219 <span class="comment">%set(handles.VMTversion,             'String',guiparams.vmt_version)</span>
3220 
3221 <span class="comment">% Set the PLOT 1 axis labels</span>
3222 axes(handles.Plot1Shiptracks);
3223 set(handles.Plot1Shiptracks,<span class="string">'DataAspectRatio'</span>,[1 1 1],<span class="string">'PlotBoxAspectRatio'</span>,[1 1 1])
3224 xlabel(<span class="string">'UTM Easting (m)'</span>)
3225 ylabel(<span class="string">'UTM Northing (m)'</span>)
3226 box on
3227 grid on
3228 <span class="comment">% ticks_format('%6.0f','%8.0f'); %formats the ticks for UTM</span>
3229 
3230 <span class="comment">%%%%%%%%%%%%</span>
3231 <span class="comment">% MENU BAR %</span>
3232 <span class="comment">%%%%%%%%%%%%</span>
3233 <span class="keyword">if</span> guiparams.english_units
3234     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3235     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
3236 <span class="keyword">else</span>
3237     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3238     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
3239 <span class="keyword">end</span>
3240 
3241 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
3242     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
3243     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3244 <span class="keyword">else</span>
3245     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
3246     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3247 <span class="keyword">end</span>
3248 
3249 
3250 <span class="keyword">if</span> guiparams.print
3251     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3252     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
3253     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3254     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3255 <span class="keyword">elseif</span> guiparams.presentation
3256     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3257     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
3258     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3259     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3260 <span class="keyword">else</span>
3261 <span class="keyword">end</span>
3262 
3263 
3264 <span class="comment">%%%%%%%%%%%%%%%</span>
3265 <span class="comment">% DATA EXPORT %</span>
3266 <span class="comment">%%%%%%%%%%%%%%%</span>
3267 <span class="comment">% BathymetryPanel</span>
3268 <span class="comment">% set(handles.BeamAngle,                  'String',guiparams.beam_angle)</span>
3269 <span class="comment">% set(handles.MagneticVariation,          'String',guiparams.magnetic_variation)</span>
3270 <span class="comment">% set(handles.WSE,                        'String',guiparams.wse)</span>
3271 <span class="comment">% set(handles.OutputAuxiliaryData,        'Value', guiparams.output_auxiliary_data)</span>
3272 
3273 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
3274 <span class="comment">% PLOTTING/PLAN VIEW %</span>
3275 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
3276 <span class="comment">% PlanViewPanel</span>
3277 set(handles.DepthRangeMin,              <span class="string">'String'</span>,guiparams.depth_range_min)
3278 set(handles.DepthRangeMax,              <span class="string">'String'</span>,guiparams.depth_range_max)
3279 set(handles.VectorScalePlanView,        <span class="string">'String'</span>,guiparams.vector_scale_plan_view)
3280 set(handles.VectorSpacingPlanview,      <span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
3281 set(handles.SmoothingWindowSize,        <span class="string">'String'</span>,guiparams.smoothing_window_size)
3282 set(handles.DisplayShoreline,           <span class="string">'Value'</span>, guiparams.display_shoreline)
3283 set(handles.AddBackground,              <span class="string">'Value'</span>, guiparams.add_background)
3284 
3285 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
3286 <span class="comment">% PLOTTING/SHIP TRACKS %</span>
3287 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
3288 <span class="comment">% ShiptracksPanel</span>
3289 set(handles.HorizontalGridNodeSpacing,  <span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
3290 <span class="comment">%set(handles.SetCrossSectionEndpoints,   'Value', guiparams.set_cross_section_endpoints)</span>
3291 
3292 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3293 <span class="comment">% PLOTTING/CROSS SECTIONS %</span>
3294 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3295 <span class="comment">% CrossSectionsPanel</span>
3296 set(handles.Contour,                    <span class="string">'String'</span>,{guiparams.contours.string}, <span class="keyword">...</span>
3297     <span class="string">'Value'</span>, guiparams.idx_contour)
3298 set(handles.VerticalExaggeration,       <span class="string">'String'</span>,guiparams.vertical_exaggeration)
3299 set(handles.VectorScaleCrossSection,    <span class="string">'String'</span>,guiparams.vector_scale_cross_section)
3300 set(handles.HorizontalVectorSpacing,    <span class="string">'String'</span>,guiparams.horizontal_vector_spacing)
3301 set(handles.VerticalVectorSpacing,      <span class="string">'String'</span>,guiparams.vertical_vector_spacing)
3302 set(handles.HorizontalSmoothingWindow,  <span class="string">'String'</span>,guiparams.horizontal_smoothing_window)
3303 set(handles.VerticalSmoothingWindow,    <span class="string">'String'</span>,guiparams.vertical_smoothing_window)
3304 set(handles.PlotSecondaryFlowVectors,   <span class="string">'Value'</span>, guiparams.plot_secondary_flow_vectors)
3305 set(handles.SecondaryFlowVectorVariable,<span class="string">'String'</span>,{guiparams.secondary_flows.string}, <span class="keyword">...</span>
3306     <span class="string">'Value'</span>, guiparams.idx_secondary_flow_vector_variable)
3307 set(handles.IncludeVerticalVelocity,    <span class="string">'Value'</span>, guiparams.include_vertical_velocity)
3308 
3309 <span class="comment">% set(handles.EnglishUnits,               'Value',guiparams.english_units)</span>
3310 
3311 <span class="comment">% [EOF] initGUI</span>
3312 
3313 
3314 <span class="comment">% --------------------------------------------------------------------</span>
3315 <a name="_sub89" href="#_subfunctions" class="code">function set_enable(handles,enable_state)</a>
3316 
3317 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3318 
3319 <span class="keyword">switch</span> enable_state
3320     <span class="keyword">case</span> <span class="string">'init'</span>
3321         set([handles.menuFile
3322             handles.menuOpen
3323             handles.menuOpenASCII
3324             handles.menuOpenMAT
3325             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3326         
3327         set([handles.toolbarLoadData
3328             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3329         set([handles.toolbarSaveMatFile
3330             handles.toolbarSaveBathymetry
3331             handles.toolbarSaveFigures
3332             handles.toolbarSaveExcel
3333             handles.toolbarPlottingParameters
3334             handles.toolbarProcessingParameters
3335             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3336         
3337         set([handles.DepthRangeMin
3338             handles.DepthRangeMax
3339             handles.VectorScalePlanView
3340             handles.VectorSpacingPlanview
3341             handles.SmoothingWindowSize
3342             handles.DisplayShoreline
3343             handles.AddBackground
3344             handles.PlotPlanView
3345             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3346         
3347         set([handles.HorizontalGridNodeSpacing
3348             handles.PlotShiptracks
3349             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3350         
3351         set([handles.Contour
3352             handles.VerticalExaggeration
3353             handles.VectorScaleCrossSection
3354             handles.HorizontalVectorSpacing
3355             handles.VerticalVectorSpacing
3356             handles.HorizontalSmoothingWindow
3357             handles.VerticalSmoothingWindow
3358             handles.PlotSecondaryFlowVectors
3359             handles.SecondaryFlowVectorVariable
3360             handles.IncludeVerticalVelocity
3361             handles.PlotCrossSection
3362             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3363         
3364     <span class="keyword">case</span> <span class="string">'fileloaded'</span>
3365         set([handles.menuFile
3366             handles.menuOpen
3367             handles.menuOpenASCII
3368             handles.menuOpenMAT
3369             handles.menuSaveMAT
3370             handles.menuSaveTecplot
3371             handles.menuSaveKMZFile
3372             handles.menuParameters
3373             handles.menuPlottingParameters
3374             handles.menuMetric
3375             handles.menuEnglish
3376             handles.menuBathymetryExportSettings
3377             handles.menuExportMultibeamBathymetry
3378             handles.menuKMZExport
3379             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3380         
3381         set([handles.toolbarLoadData
3382             handles.toolbarSaveMatFile
3383             handles.toolbarSaveBathymetry
3384             handles.toolbarSaveExcel
3385             handles.toolbarSaveFigures
3386             handles.toolbarPlottingParameters
3387             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3388         set([handles.toolbarProcessingParameters
3389             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3390         
3391            
3392         set([handles.DepthRangeMin
3393             handles.DepthRangeMax
3394             handles.VectorScalePlanView
3395             handles.VectorSpacingPlanview
3396             handles.SmoothingWindowSize
3397             handles.DisplayShoreline
3398             handles.PlotPlanView
3399             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3400         <span class="keyword">if</span> guiparams.has_mapping_toolbox
3401             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3402         <span class="keyword">else</span>
3403             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3404         <span class="keyword">end</span>
3405         
3406         set([handles.HorizontalGridNodeSpacing
3407             handles.PlotShiptracks
3408             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3409         
3410         set([handles.Contour
3411             handles.VerticalExaggeration
3412             handles.VectorScaleCrossSection
3413             handles.HorizontalVectorSpacing
3414             handles.VerticalVectorSpacing
3415             handles.HorizontalSmoothingWindow
3416             handles.VerticalSmoothingWindow
3417             handles.PlotSecondaryFlowVectors
3418             handles.SecondaryFlowVectorVariable
3419             handles.IncludeVerticalVelocity
3420             handles.PlotCrossSection
3421             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3422     <span class="keyword">case</span> <span class="string">'multiplematfiles'</span>
3423         set([handles.menuFile
3424             handles.menuOpen
3425             handles.menuOpenASCII
3426             handles.menuOpenMAT
3427             handles.menuParameters
3428             handles.menuPlottingParameters
3429             handles.menuMetric
3430             handles.menuEnglish
3431             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3432         set([handles.menuSaveMAT
3433             handles.menuBathymetryExportSettings
3434             handles.menuExportMultibeamBathymetry
3435             handles.menuKMZExport
3436             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3437         
3438         set([handles.toolbarLoadData
3439             handles.toolbarSaveFigures
3440             handles.toolbarPlottingParameters
3441             handles.toolbarSaveExcel
3442             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3443         set([handles.toolbarProcessingParameters
3444             handles.toolbarSaveMatFile
3445             handles.toolbarSaveBathymetry
3446             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3447         
3448         set([handles.DepthRangeMin
3449             handles.DepthRangeMax
3450             handles.VectorScalePlanView
3451             handles.VectorSpacingPlanview
3452             handles.SmoothingWindowSize
3453             handles.DisplayShoreline
3454             handles.PlotPlanView
3455             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3456         <span class="keyword">if</span> guiparams.has_mapping_toolbox
3457             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3458         <span class="keyword">else</span>
3459             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3460         <span class="keyword">end</span>
3461         
3462         set([handles.HorizontalGridNodeSpacing
3463             handles.PlotShiptracks
3464             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3465         
3466         set([handles.Contour
3467             handles.VerticalExaggeration
3468             handles.VectorScaleCrossSection
3469             handles.HorizontalVectorSpacing
3470             handles.VerticalVectorSpacing
3471             handles.HorizontalSmoothingWindow
3472             handles.VerticalSmoothingWindow
3473             handles.PlotSecondaryFlowVectors
3474             handles.SecondaryFlowVectorVariable
3475             handles.IncludeVerticalVelocity
3476             handles.PlotCrossSection
3477             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3478     <span class="keyword">otherwise</span>
3479 <span class="keyword">end</span>
3480 
3481 <span class="comment">% [EOF] set_enable</span>
3482 
3483 <span class="comment">%% Compute the longitudinal dispersion coefficient</span>
3484 
3485 <span class="comment">%% --- Executes on button press in zerosecq_chkbox.</span>
3486 <span class="comment">%function zerosecq_chkbox_Callback(hObject, eventdata, handles)</span>
3487 <span class="comment">% hObject    handle to zerosecq_chkbox (see GCBO)</span>
3488 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
3489 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
3490 
3491 <span class="comment">% Hint: get(hObject,'Value') returns toggle state of zerosecq_chkbox</span>
3492 
3493 
3494 <span class="comment">% --------------------------------------------------------------------</span>
3495 <a name="_sub90" href="#_subfunctions" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] = </a><span class="keyword">...</span>
3496     plotParametersDialog(english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style,hf)
3497 
3498 w = 500;
3499 h = 110;
3500 dx = 10;
3501 dy = 35;
3502 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
3503 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
3504     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
3505     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
3506     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
3507     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
3508     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
3509     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
3510     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3511     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
3512     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
3513     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
3514 dialog_params.english_units               = english_units;
3515 dialog_params.set_cross_section_endpoints = set_cross_section_endpoints;
3516 dialog_params.presentation                = plot_presentation_style; <span class="comment">%presentation;</span>
3517 dialog_params.print                       = plot_print_style; <span class="comment">%print;</span>
3518 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3519 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
3520 
3521 <span class="comment">% Build the graphics:</span>
3522 <span class="comment">% -------------------</span>
3523 handles.UnitsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
3524     <span class="string">'Title'</span>, <span class="string">'Units'</span>, <span class="keyword">...</span>
3525     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3526     <span class="string">'Position'</span>,[dx dy (w-3*dx)/3 h-dx-dy+10]);
3527 handles.UnitsMetric = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3528     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
3529     <span class="string">'String'</span>,<span class="string">'Metric'</span>, <span class="keyword">...</span>
3530     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3531     <span class="string">'Position'</span>,[15 35 100 22]);
3532 handles.UnitsEnglish = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3533     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
3534     <span class="string">'String'</span>,<span class="string">'English'</span>, <span class="keyword">...</span>
3535     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3536     <span class="string">'Position'</span>,[15 10 100 22]);
3537 
3538 handles.EndpointsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
3539     <span class="string">'Title'</span>, <span class="string">'Cross-Section Endpoints'</span>, <span class="keyword">...</span>
3540     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3541     <span class="string">'Position'</span>,[(w+dx)/3 dy (w-3*dx)/3 h-dx-dy+10]);
3542 handles.EndpointsAutomatic = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3543     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
3544     <span class="string">'String'</span>,<span class="string">'Automatic'</span>, <span class="keyword">...</span>
3545     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3546     <span class="string">'Position'</span>,[15 35 100 22]);
3547 handles.EndpointsManual = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3548     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
3549     <span class="string">'String'</span>,<span class="string">'Set Manually'</span>, <span class="keyword">...</span>
3550     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3551     <span class="string">'Position'</span>,[15 10 100 22]);
3552 
3553 handles.StylePanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
3554     <span class="string">'Title'</span>, <span class="string">'Plot Style'</span>, <span class="keyword">...</span>
3555     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3556     <span class="string">'Position'</span>,[w-w/3 dy (w-3*dx)/3 h-dx-dy+10]);
3557 handles.StylePresentation = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3558     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
3559     <span class="string">'String'</span>,<span class="string">'Presentation'</span>, <span class="keyword">...</span>
3560     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3561     <span class="string">'Position'</span>,[15 35 100 22]);
3562 handles.StylePrint = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3563     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
3564     <span class="string">'String'</span>,<span class="string">'Print'</span>, <span class="keyword">...</span>
3565     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3566     <span class="string">'Position'</span>,[15 10 100 22]);
3567 
3568 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
3569     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
3570     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
3571     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
3572     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
3573 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
3574     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
3575     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
3576     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
3577     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
3578 
3579 <span class="comment">% Update the UI controls:</span>
3580 <span class="comment">% -----------------------</span>
3581 <span class="keyword">if</span> dialog_params.english_units
3582     set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
3583     set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
3584 <span class="keyword">else</span>
3585     set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
3586     set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
3587 <span class="keyword">end</span>
3588 <span class="keyword">if</span> dialog_params.set_cross_section_endpoints
3589     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
3590     set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
3591 <span class="keyword">else</span>
3592     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
3593     set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
3594 <span class="keyword">end</span>
3595 <span class="keyword">if</span> dialog_params.presentation
3596     set(handles.StylePresentation, <span class="string">'Value'</span>,1)
3597     set(handles.StylePrint,        <span class="string">'Value'</span>,0)
3598 <span class="keyword">else</span>
3599     set(handles.StylePresentation, <span class="string">'Value'</span>,0)
3600     set(handles.StylePrint,        <span class="string">'Value'</span>,1)
3601 <span class="keyword">end</span>
3602 
3603 <span class="comment">% Set the callbacks:</span>
3604 <span class="comment">% ------------------</span>
3605 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub96" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
3606 set(handles.UnitsMetric,       <span class="string">'Callback'</span>,       {@<a href="#_sub91" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'metric'</span>})
3607 set(handles.UnitsEnglish,      <span class="string">'Callback'</span>,       {@<a href="#_sub91" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'english'</span>})
3608 set(handles.EndpointsAutomatic,<span class="string">'Callback'</span>,       {@<a href="#_sub92" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'auto'</span>})
3609 set(handles.EndpointsManual,   <span class="string">'Callback'</span>,       {@<a href="#_sub92" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'manual'</span>})
3610 set(handles.StylePresentation, <span class="string">'Callback'</span>,       {@<a href="#_sub93" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'presentation'</span>})
3611 set(handles.StylePrint,        <span class="string">'Callback'</span>,       {@<a href="#_sub93" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'print'</span>})
3612 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub94" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
3613 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub95" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
3614 
3615 <span class="comment">% Position the dialog and make it visible:</span>
3616 <span class="comment">% ----------------------------------------</span>
3617 fpos = get(hf,<span class="string">'Position'</span>);
3618 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
3619 movegui(handles.Figure,dpos)
3620 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
3621 
3622 <span class="comment">% Hold the dialog open:</span>
3623 <span class="comment">% ---------------------</span>
3624 waitfor(handles.OK)
3625 
3626 <span class="comment">% Return the outputs and close the dialog:</span>
3627 <span class="comment">% ----------------------------------------</span>
3628 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3629 english_units = dialog_params.english_units;
3630 set_cross_section_endpoints = dialog_params.set_cross_section_endpoints;
3631 plot_presentation_style =  dialog_params.presentation;
3632 plot_print_style =  dialog_params.print;
3633 
3634 delete(handles.Figure)
3635 
3636 <span class="comment">% [EOF] plotParametersDialog</span>
3637 
3638 
3639 <span class="comment">% --------------------------------------------------------------------</span>
3640 <a name="_sub91" href="#_subfunctions" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a>
3641 
3642 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3643 <span class="keyword">switch</span> the_units
3644     <span class="keyword">case</span> <span class="string">'metric'</span>
3645         dialog_params.english_units = false;
3646         
3647         set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
3648         set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
3649     <span class="keyword">case</span> <span class="string">'english'</span>
3650         dialog_params.english_units = true;
3651         
3652         set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
3653         set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
3654     <span class="keyword">otherwise</span>
3655 <span class="keyword">end</span>
3656 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3657 
3658 <span class="comment">% [EOF] dialogUnits</span>
3659 
3660 <span class="comment">% --------------------------------------------------------------------</span>
3661 <a name="_sub92" href="#_subfunctions" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a>
3662 
3663 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3664 <span class="keyword">switch</span> the_endpoints
3665     <span class="keyword">case</span> <span class="string">'auto'</span>
3666         dialog_params.set_cross_section_endpoints = false;
3667         
3668         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
3669         set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
3670     <span class="keyword">case</span> <span class="string">'manual'</span>
3671         dialog_params.set_cross_section_endpoints = true;
3672         
3673         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
3674         set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
3675     <span class="keyword">otherwise</span>
3676 <span class="keyword">end</span>
3677 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3678 
3679 <span class="comment">% [EOF] dialogEnpoints</span>
3680 
3681 <a name="_sub93" href="#_subfunctions" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a>
3682 
3683 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3684 <span class="keyword">switch</span> the_style
3685     <span class="keyword">case</span> <span class="string">'presentation'</span>
3686         dialog_params.presentation  = true;
3687         dialog_params.print         = false;
3688         
3689         set(handles.StylePresentation,<span class="string">'Value'</span>,1)
3690         set(handles.StylePrint,       <span class="string">'Value'</span>,0)
3691     <span class="keyword">case</span> <span class="string">'print'</span>
3692         dialog_params.presentation  = false;
3693         dialog_params.print         = true;
3694         
3695         set(handles.StylePresentation,<span class="string">'Value'</span>,0)
3696         set(handles.StylePrint,       <span class="string">'Value'</span>,1)
3697     <span class="keyword">otherwise</span>
3698 <span class="keyword">end</span>
3699 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3700 
3701 <span class="comment">% [EOF] dialogEnpoints</span>
3702 
3703 <span class="comment">% --------------------------------------------------------------------</span>
3704 <a name="_sub94" href="#_subfunctions" class="code">function dialogOK(hObject,eventdata,h_OK)</a>
3705 
3706 delete(h_OK)
3707 
3708 <span class="comment">% [EOF] dialogOK</span>
3709 
3710 <span class="comment">% --------------------------------------------------------------------</span>
3711 <a name="_sub95" href="#_subfunctions" class="code">function dialogCancel(hObject,eventdata,handles)</a>
3712 <span class="comment">% Return the original inputs</span>
3713 dialog_params = getappdata(handles.Figure,<span class="string">'original_dialog_params'</span>);
3714 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3715 delete(handles.OK)
3716 
3717 <span class="comment">% [EOF] dialogCancel</span>
3718 
3719 <span class="comment">% --------------------------------------------------------------------</span>
3720 <a name="_sub96" href="#_subfunctions" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a>
3721 
3722 delete(h_OK)
3723 
3724 <span class="comment">% [EOF] dialogCloseReq</span>
3725 
3726 <a name="_sub97" href="#_subfunctions" class="code">function [beam_angle,magnetic_variation,wse,output_auxilliary_data] = exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxilliary_data,hf)</a>
3727 w = 230;
3728 h = 200;
3729 dx = 10;
3730 dy = 35;
3731 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
3732 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Export Settings'</span>, <span class="keyword">...</span>
3733     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
3734     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
3735     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
3736     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
3737     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
3738     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
3739     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3740     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
3741     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
3742     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
3743 dialog_params.beam_angle             = beam_angle;
3744 dialog_params.magnetic_variation     = magnetic_variation;
3745 dialog_params.wse                    = wse;
3746 dialog_params.output_auxilliary_data = output_auxilliary_data;
3747 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3748 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
3749 
3750 <span class="comment">% Build the graphics:</span>
3751 <span class="comment">% -------------------</span>
3752 ph = 150;
3753 handles.BathymetryPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
3754     <span class="string">'Title'</span>, <span class="string">'Bathymetry'</span>, <span class="keyword">...</span>
3755     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3756     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
3757 handles.BeamAngleText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
3758     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
3759     <span class="string">'String'</span>,<span class="string">'Beam Angle (deg)'</span>, <span class="keyword">...</span>
3760     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
3761     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
3762     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3763     <span class="string">'Position'</span>,[dx+5 h-ph+60-4 100 22]);
3764 handles.BeamAngle = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
3765     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
3766     <span class="keyword">...</span><span class="comment">'String','Beam Angle (deg)', ...</span>
3767     <span class="string">'String'</span>,beam_angle,<span class="keyword">...</span>
3768     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
3769     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3770     <span class="string">'Position'</span>,[w-dx-80 h-ph+60 50 22]);
3771 handles.MagneticVariationText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
3772     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
3773     <span class="string">'String'</span>,<span class="string">'Magnetic Variation'</span>, <span class="keyword">...</span>
3774     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
3775     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
3776     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3777     <span class="string">'Position'</span>,[dx+5 h-ph+30-4 100 22]);
3778 handles.MagneticVariation = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
3779     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
3780     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
3781     <span class="string">'String'</span>,magnetic_variation,<span class="keyword">...</span>
3782     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
3783     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3784     <span class="string">'Position'</span>,[w-dx-80 h-ph+30 50 22]);
3785 handles.WSEText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
3786     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
3787     <span class="string">'String'</span>,<span class="string">'WSE (m)'</span>, <span class="keyword">...</span>
3788     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
3789     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
3790     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3791     <span class="string">'Position'</span>,[dx+5 h-ph-4 100 22]);
3792 handles.WSE = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
3793     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
3794     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
3795     <span class="string">'String'</span>,wse,<span class="keyword">...</span>
3796     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
3797     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3798     <span class="string">'Position'</span>,[w-dx-80 h-ph 50 22]);
3799 handles.OutputAuxilliaryData = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3800     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
3801     <span class="string">'String'</span>,<span class="string">'Output Auxilliary Data'</span>, <span class="keyword">...</span>
3802     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3803     <span class="string">'Position'</span>,[dx+5 20 w-2*dx-30 22]);
3804 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
3805     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
3806     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
3807     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
3808     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
3809 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
3810     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
3811     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
3812     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
3813     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
3814 
3815 <span class="comment">% Update the UI controls:</span>
3816 <span class="comment">% -----------------------</span>
3817 set(handles.BeamAngle,                <span class="string">'String'</span>,dialog_params.beam_angle)
3818 set(handles.MagneticVariation,        <span class="string">'String'</span>,dialog_params.magnetic_variation)
3819 set(handles.WSE,                      <span class="string">'String'</span>,dialog_params.wse)
3820 set(handles.OutputAuxilliaryData,     <span class="string">'Value'</span>,dialog_params.output_auxilliary_data)
3821 
3822 <span class="comment">% Set the callbacks:</span>
3823 <span class="comment">% ------------------</span>
3824 set(handles.Figure,                      <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub96" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
3825 set(handles.BeamAngle,                   <span class="string">'Callback'</span>,       {@<a href="#_sub98" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
3826 set(handles.MagneticVariation,           <span class="string">'Callback'</span>,       {@<a href="#_sub98" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
3827 set(handles.WSE,                         <span class="string">'Callback'</span>,       {@<a href="#_sub98" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
3828 set(handles.OutputAuxilliaryData,        <span class="string">'Callback'</span>,       {@<a href="#_sub98" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
3829 set(handles.OK,                          <span class="string">'Callback'</span>,       {@<a href="#_sub94" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,      handles.OK})
3830 set(handles.Cancel,                      <span class="string">'Callback'</span>,       {@<a href="#_sub95" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,  handles})
3831 
3832 <span class="comment">% Position the dialog and make it visible:</span>
3833 <span class="comment">% ----------------------------------------</span>
3834 fpos = get(hf,<span class="string">'Position'</span>);
3835 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
3836 movegui(handles.Figure,dpos)
3837 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
3838 
3839 <span class="comment">% Hold the dialog open:</span>
3840 <span class="comment">% ---------------------</span>
3841 waitfor(handles.OK)
3842 
3843 <span class="comment">% Return the outputs and close the dialog:</span>
3844 <span class="comment">% ----------------------------------------</span>
3845 dialog_params           = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3846 beam_angle              = dialog_params.beam_angle;
3847 magnetic_variation      = dialog_params.magnetic_variation;
3848 wse                     = str2num(dialog_params.wse);
3849 output_auxilliary_data  = dialog_params.output_auxilliary_data;
3850 
3851 delete(handles.Figure)
3852 
3853 <span class="comment">% [EOF] exportSettingsDialog</span>
3854 
3855 <span class="comment">% --------------------------------------------------------------------</span>
3856 <a name="_sub98" href="#_subfunctions" class="code">function dialogExportSettings(hObject,eventdata,handles)</a>
3857 
3858 <span class="comment">% Grab the current data</span>
3859 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3860 
3861 <span class="comment">% Set it according to the dialog box values</span>
3862 dialog_params.beam_angle                = get(handles.BeamAngle,<span class="string">'String'</span>);
3863 dialog_params.magnetic_variation        = get(handles.MagneticVariation,<span class="string">'String'</span>);
3864 dialog_params.wse                       = get(handles.WSE,<span class="string">'String'</span>);
3865 dialog_params.output_auxilliary_data    = get(handles.OutputAuxilliaryData,<span class="string">'Value'</span>);
3866 
3867 <span class="comment">% Re-store the application data</span>
3868 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3869 
3870 <span class="comment">% [EOF] dialogExportSettings</span>
3871 
3872 <a name="_sub99" href="#_subfunctions" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a>
3873 
3874 w = 230;
3875 h = 200;
3876 dx = 10;
3877 dy = 35;
3878 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
3879 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Select open figures to export'</span>, <span class="keyword">...</span>
3880     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
3881     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
3882     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
3883     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
3884     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
3885     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
3886     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3887     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
3888     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
3889     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
3890 dialog_params.figure_names               = figure_names;
3891 dialog_params.selected_figures           = <span class="string">''</span>;
3892 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3893 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
3894 
3895 <span class="comment">% Build the graphics:</span>
3896 <span class="comment">% -------------------</span>
3897 handles.ListboxPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
3898     <span class="string">'Title'</span>, <span class="string">'Figures'</span>, <span class="keyword">...</span>
3899     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3900     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
3901 handles.Figures = uicontrol(<span class="string">'Style'</span>,<span class="string">'listbox'</span>, <span class="keyword">...</span>
3902     <span class="string">'Parent'</span>,handles.ListboxPanel, <span class="keyword">...</span>
3903     <span class="string">'BackGroundColor'</span>,<span class="string">'white'</span>,<span class="keyword">...</span>
3904     <span class="string">'String'</span>,figure_names, <span class="keyword">...</span>
3905     <span class="string">'Min'</span>, 0,<span class="keyword">...</span>
3906     <span class="string">'Max'</span>, 2,<span class="keyword">...</span>
3907     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3908     <span class="string">'Position'</span>,[15 35 (w-5*dx) 100]);
3909 
3910 
3911 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
3912     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
3913     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
3914     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
3915     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
3916 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
3917     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
3918     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
3919     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
3920     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
3921 
3922 <span class="comment">% Update the UI controls:</span>
3923 <span class="comment">% -----------------------</span>
3924 
3925 
3926 <span class="comment">% Set the callbacks:</span>
3927 <span class="comment">% ------------------</span>
3928 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub96" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
3929 set(handles.Figures,           <span class="string">'Callback'</span>,       {@<a href="#_sub100" class="code" title="subfunction dialogSelectFigures(hObject,eventdata,handles)">dialogSelectFigures</a>    handles})
3930 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub94" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
3931 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub95" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
3932 
3933 <span class="comment">% Position the dialog and make it visible:</span>
3934 <span class="comment">% ----------------------------------------</span>
3935 fpos = get(hf,<span class="string">'Position'</span>);
3936 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
3937 movegui(handles.Figure,dpos)
3938 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
3939 
3940 <span class="comment">% Hold the dialog open:</span>
3941 <span class="comment">% ---------------------</span>
3942 waitfor(handles.OK)
3943 
3944 <span class="comment">% Return the outputs and close the dialog:</span>
3945 <span class="comment">% ----------------------------------------</span>
3946 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3947 selected_figures = dialog_params.selected_figures;
3948 
3949 delete(handles.Figure)
3950 
3951 <span class="comment">% [EOF] openFiguresDialog</span>
3952 
3953 <span class="comment">% --------------------------------------------------------------------</span>
3954 <a name="_sub100" href="#_subfunctions" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a>
3955 
3956 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3957 
3958 idx_selected = get(handles.Figures,<span class="string">'Value'</span>);
3959 fig_names    = get(handles.Figures,<span class="string">'String'</span>);
3960 selected     = fig_names(idx_selected);
3961 dialog_params.selected_figures = selected;
3962 
3963 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3964 
3965 
3966 
3967 <span class="comment">% --------------------------------------------------------------------</span>
3968 <a name="_sub101" href="#_subfunctions" class="code">function icons = getIcons</a>
3969 
3970 <span class="comment">% Load data</span>
3971 idx = 1;
3972 icons(idx).data(:,:,1) = <span class="keyword">...</span>
3973     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
3974     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   129   120   135   188   NaN   NaN   NaN
3975     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN    96   189   NaN   NaN   130   NaN    95   NaN
3976     NaN   NaN   206   206   206   206   NaN   NaN   NaN   NaN   NaN   NaN   NaN    84    79   NaN
3977     NaN   206   255   255   255   255   198   197   NaN   NaN   NaN   NaN    83    79    76   NaN
3978     198   255   255   255   255   255   255   198   198   198   198   198   198   212   212   NaN
3979     198   255   255   255   255   255   255   255   255   255   255   255   198   157   197   NaN
3980     198   255   226   198   198   198   198   198   198   198   198   198   198   198   177   NaN
3981     198   255   198   218   255   255   255   255   255   255   255   255   255   255   161   NaN
3982     198   253   198   247   255   255   255   255   255   255   255   255   255   251   155   NaN
3983     198   226   201   255   255   255   255   255   255   255   255   255   231   206   165   NaN
3984     198   207   215   255   255   255   255   255   255   255   255   255   239   198   159   NaN
3985     198   198   240   255   255   255   255   255   255   255   255   255   222   157   159   NaN
3986     198   199   255   255   255   255   255   255   255   255   255   255   191   165   159   NaN
3987     NaN   165   165   165   165   165   165   165   165   165   165   165   165   159   159   NaN
3988     NaN   NaN   159   159   159   159   159   159   159   159   159   159   159   159   NaN   NaN]/255;
3989 
3990 icons(idx).data(:,:,2) = <span class="keyword">...</span>
3991     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
3992     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   145   137   149   195   NaN   NaN   NaN
3993     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   116   196   NaN   NaN   145   NaN   116   NaN
3994     NaN   NaN   162   162   162   162   NaN   NaN   NaN   NaN   NaN   NaN   NaN   107   105   NaN
3995     NaN   162   255   255   255   255   154   197   NaN   NaN   NaN   NaN   106   104   103   NaN
3996     154   255   255   255   255   255   255   154   154   154   154   154   154   208   208   NaN
3997     154   243   243   243   243   243   243   255   255   255   255   255   154   123   197   NaN
3998     154   235   193   154   154   154   154   154   154   154   154   154   154   154   137   NaN
3999     154   215   154   191   255   255   251   255   255   255   255   255   231   255   126   NaN
4000     154   213   154   240   255   255   255   255   255   255   255   255   199   249   123   NaN
4001     154   179   160   255   247   247   247   247   247   247   247   247   190   188   115   NaN
4002     154   162   184   255   235   235   235   235   235   235   235   231   186   154   169   NaN
4003     154   154   228   255   227   227   227   227   227   227   227   223   178   123   169   NaN
4004     154   156   255   215   215   215   215   215   215   215   215   215   153   115   169   NaN
4005     NaN   115   115   115   115   115   115   115   115   115   115   115   115   169   169   NaN
4006     NaN   NaN   169   169   169   169   169   169   169   169   169   169   169   169   NaN   NaN]/255;
4007 
4008 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4009     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
4010     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   166   161   170   202   NaN   NaN   NaN
4011     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   149   205   NaN   NaN   166   NaN   148   NaN
4012     NaN   NaN    34    34    34    34   NaN   NaN   NaN   NaN   NaN   NaN   NaN   141   144   NaN
4013     NaN    34   255   255   255   255    25   197   NaN   NaN   NaN   NaN   142   145   147   NaN
4014     25   255   156   156   156   156   255    25    25    25    25    25    25   200   200   NaN
4015     25   156   140   140   140   140   140   255   255   255   255   255    25    26   197   NaN
4016     25   132    80    25    25    25    25    25    25    25    25    25    25    25    25   NaN
4017     25   132    25   108   255   255   247   255   255   255   255   255   132   255    25   NaN
4018     25   112    25   137   156   156   156   156   156   156   156   156    91   150    25   NaN
4019     25    67    33   165   148   148   148   148   148   148   148   148    83    92    13   NaN
4020     25    38    64   156   132   132   132   132   132   132   132   132    67    25   176   NaN
4021     25    26   122   156   124   124   124   124   124   124   124   124    67    26   176   NaN
4022     25    28   156   108   108   108   108   108   108   108   108   108    41    13   176   NaN
4023     NaN    13    13    13    13    13    13    13    13    13    13    13    13   176   176   NaN
4024     NaN   NaN   176   176   176   176   176   176   176   176   176   176   176   176   NaN   NaN]/255;
4025 
4026 <span class="comment">% Save data</span>
4027 idx = idx+1;
4028 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4029     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
4030     NaN    0.6902    0.6902    0.6902    0.6902    0.6902    0.6274    0.6274    0.5647    0.5647    0.5647    0.5019    0.5019    0.4392    0.2510       NaN
4031     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.3137    0.3765    0.2510    0.4670
4032     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.2510    0.1882    0.2510    0.4670
4033     NaN    0.6274    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.1882    0.5019    0.2510    0.4670
4034     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.1882    0.4392    0.2510    0.4670
4035     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.1255    0.3765    0.2510    0.4670
4036     NaN    0.5647    0.7529    0.3765    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.7529    0.0627    0.3765    0.2510    0.4670
4037     NaN    0.5647    0.7529    0.6902    0.3765    0.3137    0.3137    0.2510    0.1882    0.1882    0.1255    0.0627    0.3765    0.3137    0.2510    0.4670
4038     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5019    0.5019    0.5019    0.4392    0.4392    0.3765    0.3137    0.3137    0.2510    0.4670
4039     NaN    0.5019    0.6902    0.6274    0.5647    0.3137    0.3137    0.3137    0.3137    0.3137    0.3765    0.3137    0.3137    0.2510    0.2510    0.4670
4040     NaN    0.4392    0.6274    0.5647    0.5019    0.3137       NaN    0.1882    0.8157    0.8157    0.3765    0.2510    0.2510    0.2510    0.2510    0.4670
4041     NaN    0.4392    0.6274    0.5019    0.5019    0.3137    0.1882    0.4392    0.8784    0.8784    0.4392    0.1882    0.2510    0.1882    0.2510    0.4670
4042     NaN    0.4392    0.5647    0.5019    0.1255    0.1255    0.6902    0.6902    0.7529    0.7529    0.3137    0.1882    0.1882    0.1882    0.2510    0.4670
4043     NaN    0.7333    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.4670
4044     NaN       NaN    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670];
4045 
4046 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4047     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
4048     NaN    0.7216    0.7216    0.6902    0.6902    0.6588    0.6274    0.5961    0.5647    0.5647    0.5333    0.5019    0.4706    0.4706    0.2196       NaN
4049     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.3451    0.3451    0.2196    0.5378
4050     NaN    0.6902    0.7529    0.5333    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.3137    0.1882    0.2196    0.5378
4051     NaN    0.6588    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.3137    0.4706    0.2196    0.5378
4052     NaN    0.6274    0.7529    0.4706    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.2824    0.4392    0.2196    0.5378
4053     NaN    0.5961    0.7529    0.4392    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.2510    0.4078    0.2196    0.5378
4054     NaN    0.5647    0.7529    0.4078    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.7843    0.2196    0.3765    0.2196    0.5378
4055     NaN    0.5333    0.7216    0.7216    0.3765    0.3765    0.3451    0.3137    0.3137    0.2824    0.2510    0.2196    0.3765    0.3451    0.2196    0.5378
4056     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5333    0.5019    0.4706    0.4392    0.4078    0.3765    0.3451    0.3137    0.2196    0.5378
4057     NaN    0.4706    0.6588    0.6274    0.5647    0.3451    0.3451    0.3451    0.3451    0.3765    0.4078    0.3451    0.3137    0.2824    0.2196    0.5378
4058     NaN    0.4706    0.6274    0.5647    0.5333    0.3451       NaN    0.2510    0.8470    0.8784    0.4706    0.2824    0.2824    0.2510    0.2196    0.5378
4059     NaN    0.4392    0.5961    0.5333    0.5019    0.3451    0.2510    0.4706    0.8784    0.9098    0.5019    0.2510    0.2510    0.2510    0.2196    0.5378
4060     NaN    0.4078    0.5647    0.5019    0.2824    0.1882    0.7216    0.7216    0.7529    0.7843    0.3137    0.2510    0.2510    0.2196    0.2196    0.5378
4061     NaN    0.7176    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.5378
4062     NaN       NaN    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378];
4063 
4064 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4065     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
4066     NaN    0.9412    0.9412    0.9412    0.9412    0.9412    0.9412    0.8784    0.8784    0.8784    0.8784    0.8784    0.8157    0.8157    0.4392       NaN
4067     NaN    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.7529    0.6902    0.4392    0.5997
4068     NaN    0.9412    1.0000    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.7529    0.3765    0.4392    0.5997
4069     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.6902    0.8784    0.4392    0.5997
4070     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.6902    0.8157    0.4392    0.5997
4071     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.6274    0.8157    0.4392    0.5997
4072     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.8784    0.6274    0.7529    0.4392    0.5997
4073     NaN    0.8784    1.0000    1.0000    0.8157    0.7529    0.7529    0.7529    0.6902    0.6902    0.6274    0.6274    0.7529    0.7529    0.4392    0.5997
4074     NaN    0.8784    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8784    0.8157    0.8157    0.7529    0.7529    0.6902    0.4392    0.5997
4075     NaN    0.8157    1.0000    1.0000    0.9412    0.4392    0.4392    0.4392    0.4392    0.4392    0.5019    0.7529    0.6902    0.6902    0.4392    0.5997
4076     NaN    0.8157    1.0000    0.9412    0.9412    0.4392       NaN    0.2510    0.9412    0.9412    0.5019    0.6902    0.6902    0.6274    0.4392    0.5997
4077     NaN    0.8157    1.0000    0.9412    0.8784    0.4392    0.2510    0.5647    0.9412    0.9412    0.5647    0.6274    0.6274    0.6274    0.4392    0.5997
4078     NaN    0.8157    0.9412    0.8784    0.6902    0.2510    0.7529    0.7529    0.8157    0.8157    0.3137    0.6274    0.6274    0.6274    0.4392    0.5997
4079     NaN    0.8275    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.5997
4080     NaN       NaN    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997];
4081 
4082 <span class="comment">% Plotting parameters</span>
4083 idx = idx+1;
4084 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4085     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
4086     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4087     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4088     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
4089     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
4090     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
4091     0   101   239   255   224   109   255   255   255   247    79   254   254   123    36   165
4092     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
4093     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
4094     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
4095     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
4096     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
4097     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
4098     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4099     0     0     0     1     0     0     0     0     0     0     0     0     0     0     0   165
4100     255   165   165   165   172   165   165   165   165   165   165   165   165   165   165   165]/255;
4101 
4102 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4103     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
4104     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0     0
4105     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4106     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
4107     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
4108     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
4109     0   101   239   255   224   109   255   255   255   247    79   254   254   123     0   165
4110     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
4111     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
4112     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
4113     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
4114     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
4115     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
4116     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4117     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   165
4118     0   165   165   165   153   165   165   165   165   165   165   165   165   165   165   165]/255;
4119 
4120 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4121     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
4122     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4123     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4124     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4125     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4126     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4127     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4128     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4129     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4130     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4131     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4132     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4133     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4134     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4135     0    24    39     0     0     0     0     0     0     0     0     0     0     0     0   145
4136     255   145   145   145   134   145   145   145   145   145   145   145   145   145   145   145]/255;
4137 
4138 <span class="comment">% Processing parameters</span>
4139 idx = idx+1;
4140 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4141     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
4142     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
4143     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4144     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4145     255     0   255   255   107   255   255   107   255   255   107   255   107   255     0   255
4146     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4147     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4148     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4149     255     0   255   255   107   255   107   255   107   255   255   107   255   255     0   255
4150     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4151     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4152     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4153     255     0   255   107   255   107   255   107   255   255   107   255   107   255     0   255
4154     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4155     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4156     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
4157 
4158 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4159     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
4160     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
4161     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4162     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4163     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
4164     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4165     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4166     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4167     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
4168     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4169     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4170     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4171     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
4172     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4173     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4174     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
4175 
4176 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4177     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
4178     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
4179     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4180     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4181     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
4182     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4183     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4184     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4185     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
4186     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4187     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4188     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4189     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
4190     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4191     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4192     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
4193 
4194 <span class="comment">% Export bathymetry dialog</span>
4195 idx = idx+1;
4196 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4197     [226    226    226    226    226    226    226    197    220    226    226    226    226    226    226    226
4198     226    226    226    226    226    227    241    144    158    241    228    228    229    228    229    226
4199     226    243    243    243    237    237    246    164    119    242    232    225    226    218    243    206
4200     179    152    153    166    148    148    177    179    63    185    141    146    154    151    179    189
4201     167    4    134    175    151    164    161    198    122    255    212    233    215    199    140    185
4202     134    50    209    241    255    255    133    118    15    20    28    94    4    0    0    89
4203     136    0    0    0    0    0    0    0    0    0    0    0    0    21    56    140
4204     208    255    226    233    255    242    215    232    251    237    226    233    207    222    156    139
4205     172    159    152    153    166    145    178    147    169    164    161    163    154    153    128    135
4206     160    164    148    139    171    150    165    154    165    185    166    173    190    190    148    162
4207     214    233    211    203    217    212    217    238    202    236    213    222    230    224    184    184
4208     219    206    174    190    219    204    201    218    183    224    219    222    217    202    176    182
4209     210    182    183    214    225    220    203    229    175    217    220    220    222    212    184    185
4210     197    175    207    224    223    220    205    231    170    221    220    220    222    217    191    187
4211     186    193    223    224    220    201    203    228    171    224    218    220    222    215    190    187
4212     189    211    220    216    204    201    214    213    187    213    216    220    220    212    193    189
4213     ]/255;
4214 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4215     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
4216     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
4217     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
4218     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
4219     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
4220     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
4221     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
4222     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
4223     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
4224     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
4225     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
4226     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
4227     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
4228     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
4229     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
4230     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
4231     ]/255;
4232 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4233     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
4234     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
4235     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
4236     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
4237     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
4238     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
4239     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
4240     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
4241     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
4242     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
4243     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
4244     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
4245     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
4246     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
4247     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
4248     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
4249     ]/255;
4250 
4251 <span class="comment">% Export Figures Dialog</span>
4252 idx = idx + 1;
4253 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4254     [NaN    NaN    10    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
4255     NaN    NaN    67    255    255    255    255    255    255    255    201    141    NaN    NaN    NaN    NaN
4256     NaN    NaN    43    255    241    240    241    246    252    255    186    220    151    NaN    NaN    NaN
4257     NaN    NaN    42    255    238    237    237    236    238    254    210    178    214    38    NaN    NaN
4258     NaN    NaN    43    255    241    241    241    241    240    244    252    255    255    79    NaN    NaN
4259     NaN    NaN    47    255    232    232    225    224    224    223    220    238    255    69    NaN    NaN
4260     NaN    NaN    55    233    114    225    230    223    221    221    215    237    255    67    NaN    NaN
4261     4    NaN    37    181    168    126    193    214    205    200    203    242    255    67    NaN    NaN
4262     41    164    134    153    144    139    131    209    238    223    242    240    255    67    NaN    NaN
4263     41    118    91    91    122    125    120    106    170    241    245    241    255    67    NaN    NaN
4264     41    113    91    89    97    108    99    89    117    205    190    230    255    67    NaN    NaN
4265     41    124    94    88    78    74    81    179    255    252    244    241    255    67    NaN    NaN
4266     13    34    76    187    88    92    222    255    255    250    250    250    255    73    NaN    NaN
4267     NaN    NaN    69    236    121    227    255    243    238    238    238    238    255    82    NaN    NaN
4268     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
4269 
4270 
4271 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4272     [NaN    NaN    10    24    24    24    24    24    24    24    22    4    NaN    NaN    NaN    NaN
4273     NaN    NaN    69    255    255    255    255    255    255    255    204    144    NaN    NaN    NaN    NaN
4274     NaN    NaN    45    255    241    240    241    246    252    255    189    222    155    NaN    NaN    NaN
4275     NaN    NaN    43    255    238    237    237    236    238    254    210    179    215    39    NaN    NaN
4276     NaN    NaN    44    255    241    241    241    241    240    244    252    255    255    80    NaN    NaN
4277     NaN    NaN    49    255    231    230    225    224    224    223    220    238    255    70    NaN    NaN
4278     NaN    NaN    56    227    136    214    227    223    221    221    215    237    255    68    NaN    NaN
4279     4    NaN    19    157    243    154    181    210    204    200    203    242    255    67    NaN    NaN
4280     51    255    231    225    219    217    172    197    232    222    242    240    255    67    NaN    NaN
4281     52    227    184    183    195    201    204    172    169    239    245    241    255    67    NaN    NaN
4282     51    218    177    177    180    187    187    177    130    202    190    230    255    67    NaN    NaN
4283     51    237    195    183    172    170    152    175    255    251    244    241    255    67    NaN    NaN
4284     15    38    72    173    183    149    211    255    255    250    250    250    255    73    NaN    NaN
4285     NaN    NaN    65    226    174    214    252    242    238    238    238    238    255    84    NaN    NaN
4286     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
4287 
4288 
4289 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4290     [NaN    NaN    9    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
4291     NaN    NaN    66    255    255    255    255    255    255    255    196    139    NaN    NaN    NaN    NaN
4292     NaN    NaN    42    255    239    238    238    244    252    255    186    216    148    NaN    NaN    NaN
4293     NaN    NaN    41    255    236    235    235    234    237    251    210    176    212    36    NaN    NaN
4294     NaN    NaN    42    255    239    239    239    239    238    241    252    255    255    78    NaN    NaN
4295     NaN    NaN    46    255    233    232    224    223    223    223    219    235    255    67    NaN    NaN
4296     NaN    NaN    53    240    101    232    230    221    219    218    213    235    255    65    NaN    NaN
4297     5    NaN    60    212    94    107    205    215    203    198    201    240    255    66    NaN    NaN
4298     34    56    40    80    70    62    94    222    241    221    240    238    255    66    NaN    NaN
4299     35    10    2    0    51    55    36    46    176    240    243    239    255    66    NaN    NaN
4300     35    11    9    7    16    34    12    6    110    204    188    228    255    66    NaN    NaN
4301     35    14    0    0    0    0    14    187    255    251    242    239    255    66    NaN    NaN
4302     12    37    84    206    0    41    234    255    255    248    248    248    255    72    NaN    NaN
4303     NaN    NaN    69    249    79    239    255    240    236    236    236    236    255    80    NaN    NaN
4304     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
4305 
4306 <span class="comment">% Export Excel File</span>
4307 idx = idx + 1;
4308 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4309     [NaN    NaN    NaN    NaN    NaN    NaN  106  252  255  255  255  255  255  255  255  255
4310    38  136  109  101   96   77   95  134  106   99   93   87   90   66  255  255
4311    52  197  232  217  210  202  191  178  170  164  160  159  155   15  255  255
4312    51  181  255  255  255  255  255  255  255  255  255  255  253    9  255  255
4313    49  174  245  153  156  175  255  255  181  153  149  205  245    0  255  255
4314    47  168  199  122  149  100  155  183   99   99   15  117  245    0  255  241
4315    45  158  255  146  146  141   87   68  120   34   86  255  238    0  252  232
4316    42  144  255  255  158  158  143   74   68  117  255  255  230    0  255  255
4317    40  134  255  255  169   15  150  111   68   81  105  167  236    0  230  217
4318    37  131  255  158   99  106   10  143  117   50   51  165  252    0  255  254
4319    35  122  208    0   22   32    8   17  110   20    0   13  212    0  255  245
4320    33  115  255  255  255  255  255  250  146  113  119  106  217    0  236  217
4321    31  109  255  254  252  251  250  255  255  255  255  255  241    0  255  251
4322    29  116  190  168  164  157  145  133  126  121  117  118  112    0  215  205
4323    20   63   47   38   36   20   38   83   64   51   52   55   64   20  255  241
4324     NaN    NaN    NaN    NaN    NaN    NaN   96  249  252  228  237  251  249  203  241  246]/255;
4325 
4326 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4327     [NaN    NaN    NaN    NaN    NaN    NaN  114  252  255  255  255  255  255  255  255  255
4328    49  180  152  145  140  118  140  173  150  139  132  126  126  106  255  255
4329    67  249  252  242  237  231  221  207  201  196  194  193  193   75  255  255
4330    66  232  255  255  255  255  255  255  255  255  255  255  255   68  255  255
4331    64  226  251  197  191  200  255  255  194  170  168  214  253   61  255  255
4332    62  220  224  183  207  173  189  202  167  175  116  172  253   58  255  246
4333    60  211  255  190  196  203  166  131  187  134  148  255  249   54  254  240
4334    57  199  255  255  198  203  202  158  132  168  255  255  245   47  255  255
4335    54  190  255  255  200  110  199  185  155  147  160  203  251   44  240  230
4336    52  187  255  204  187  194  121  204  189  139   99  179  255   39  255  254
4337    49  180  230   42   49   53   36   64  182   98   65   70  228   36  255  248
4338    47  171  255  255  255  255  255  255  186  115  124  114  235   34  243  229
4339    45  166  255  255  254  254  255  255  255  255  255  255  255   33  255  252
4340    43  176  222  206  204  200  190  180  174  171  169  169  169   32  229  220
4341    30  101   81   74   69   54   72  116   96   84   84   84   94   55  255  245
4342     NaN    NaN    NaN    NaN    NaN    NaN  105  251  253  237  242  252  251  218  246  249]/255;
4343 
4344 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4345     [ NaN    NaN    NaN    NaN    NaN    NaN  125  253  255  255  255  255  255  255  255  255
4346    34  118   92   84   79   56   83  111   88   79   73   69   74   45  255  255
4347    46  180  228  207  203  195  182  169  159  155  149  149  145    0  255  255
4348    45  163  255  255  255  255  255  255  255  255  255  255  254    0  255  255
4349    42  156  248  152  155  176  255  255  181  154  147  206  245    0  255  255
4350    40  150  202  117  136   87  154  181   90   84    8  120  243    0  255  252
4351    38  138  255  145  137  131   81   65  106   27   86  255  238    0  255  250
4352    35  122  255  255  159  152  137   75   62  121  255  255  229    0  255  255
4353    33  113  255  255  171   13  145  111   67   76   84  159  234    0  255  247
4354    30  109  255  160   89   97   10  136  111   36   33  159  251    0  255  255
4355    28   99  211    0   12   23    2   11  101    0    0   13  209    0  255  253
4356    26   92  255  255  255  255  255  250  146  111  117  104  213    0  255  245
4357    23   89  255  255  255  255  255  255  255  255  255  255  241    0  255  254
4358    22   93  180  156  151  141  129  114  105   98   93   93   83    0  255  239
4359    15   43   26   17   15    0   25   63   45   39   38   39   44    9  255  252
4360     NaN    NaN    NaN    NaN    NaN    NaN  117  253  255  249  251  255  254  239  252  254]/255;
4361 
4362 <span class="comment">% [EOF] getIcons</span>
4363 
4364 <a name="_sub102" href="#_subfunctions" class="code">function guiparams = createGUIparams</a>
4365 <span class="comment">% Creates the guiparams structure with specified defaults.</span>
4366 
4367 <span class="comment">% Organized by GUI panels</span>
4368 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
4369 <span class="comment">% SHIPTRACKS PLOT %</span>
4370 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
4371 guiparams.horizontal_grid_node_spacing       = 1.0;
4372 
4373 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
4374 <span class="comment">% CROSS SECTION PLOT %</span>
4375 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
4376 guiparams.contours                           = <span class="string">''</span>; <span class="comment">% Set below</span>
4377 guiparams.contour                            = <span class="string">''</span>; <span class="comment">% Set below</span>
4378 guiparams.idx_contour                        = 1;
4379 guiparams.vertical_exaggeration              = 10;
4380 guiparams.vector_scale_cross_section         = 0.2;
4381 guiparams.horizontal_vector_spacing          = 1;
4382 guiparams.vertical_vector_spacing            = 1;
4383 guiparams.horizontal_smoothing_window        = 1;
4384 guiparams.vertical_smoothing_window          = 1;
4385 guiparams.plot_secondary_flow_vectors        = true;
4386 guiparams.secondary_flows                    = <span class="string">''</span>; <span class="comment">% Set below</span>
4387 guiparams.secondary_flow_vector_variable     = <span class="string">''</span>; <span class="comment">% Set below</span>
4388 guiparams.idx_secondary_flow_vector_variable = 1;
4389 guiparams.include_vertical_velocity          = true;
4390 
4391 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
4392 <span class="comment">% PLAN VIEW PLOT %</span>
4393 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
4394 guiparams.depth_range_min                    = 0;
4395 guiparams.depth_range_max                    = inf;
4396 guiparams.vector_scale_plan_view             = 1;
4397 guiparams.vector_spacing_plan_view           = 1;
4398 guiparams.smoothing_window_size              = 1;
4399 guiparams.display_shoreline                  = false;
4400 guiparams.add_background                     = false;
4401 
4402 <span class="comment">%%%%%%%%%%%%%%%</span>
4403 <span class="comment">% DATA EXPORT %</span>
4404 <span class="comment">%%%%%%%%%%%%%%%</span>
4405 guiparams.beam_angle                         = 20.0;
4406 guiparams.magnetic_variation                 = 0.0;
4407 guiparams.wse                                = 0.0;
4408 guiparams.output_auxiliary_data              = false;
4409 
4410 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
4411 <span class="comment">% Contour variables %</span>
4412 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
4413 idx = 1;
4414 guiparams.contours(idx).string   = <span class="string">'Streamwise Velocity (u)'</span>;
4415 guiparams.contours(idx).variable = <span class="string">'streamwise'</span>;
4416 idx = idx + 1;
4417 guiparams.contours(idx).string   = <span class="string">'Transverse Velocity (v)'</span>;
4418 guiparams.contours(idx).variable = <span class="string">'transverse'</span>;
4419 idx = idx + 1;
4420 guiparams.contours(idx).string   = <span class="string">'Vertical Velocity (w)'</span>;
4421 guiparams.contours(idx).variable = <span class="string">'vertical'</span>;
4422 idx = idx + 1;
4423 guiparams.contours(idx).string   = <span class="string">'Velocity Magnitude'</span>;
4424 guiparams.contours(idx).variable = <span class="string">'mag'</span>;
4425 idx = idx + 1;
4426 guiparams.contours(idx).string   = <span class="string">'East Velocity (E)'</span>;
4427 guiparams.contours(idx).variable = <span class="string">'east'</span>;
4428 idx = idx + 1;
4429 guiparams.contours(idx).string   = <span class="string">'North Velocity (N)'</span>;
4430 guiparams.contours(idx).variable = <span class="string">'north'</span>;
4431 idx = idx + 1;
4432 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (zsd)'</span>;
4433 guiparams.contours(idx).variable = <span class="string">'primary_zsd'</span>;
4434 idx = idx + 1;
4435 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (zsd)'</span>;
4436 guiparams.contours(idx).variable = <span class="string">'secondary_zsd'</span>;
4437 idx = idx + 1;
4438 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (Roz)'</span>;
4439 guiparams.contours(idx).variable = <span class="string">'primary_roz'</span>;
4440 idx = idx + 1;
4441 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (Roz)'</span>;
4442 guiparams.contours(idx).variable = <span class="string">'secondary_roz'</span>;
4443 idx = idx + 1;
4444 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Downstream Comp.)'</span>;
4445 guiparams.contours(idx).variable = <span class="string">'primary_roz_x'</span>;
4446 idx = idx + 1;
4447 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Cross-Stream Comp.)'</span>;
4448 guiparams.contours(idx).variable = <span class="string">'primary_roz_y'</span>;
4449 idx = idx + 1;
4450 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Downstream Comp.)'</span>;
4451 guiparams.contours(idx).variable = <span class="string">'secondary_roz_x'</span>;
4452 idx = idx + 1;
4453 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Cross-Stream Comp.)'</span>;
4454 guiparams.contours(idx).variable = <span class="string">'secondary_roz_y'</span>;
4455 idx = idx + 1;
4456 guiparams.contours(idx).string   = <span class="string">'Backscatter'</span>;
4457 guiparams.contours(idx).variable = <span class="string">'backscatter'</span>;
4458 idx = idx + 1;
4459 guiparams.contours(idx).string   = <span class="string">'Flow Direction (deg.)'</span>;
4460 guiparams.contours(idx).variable = <span class="string">'flowangle'</span>;
4461 
4462 guiparams.contour = guiparams.contours(guiparams.idx_contour).variable;
4463 
4464 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4465 <span class="comment">% Secondary Flow Vector Variables %</span>
4466 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4467 idx = 1;
4468 guiparams.secondary_flows(idx).string   = <span class="string">'Transverse'</span>;
4469 guiparams.secondary_flows(idx).variable = <span class="string">'transverse'</span>;
4470 idx = idx + 1;
4471 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (zsd)'</span>;
4472 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_zsd'</span>;
4473 idx = idx + 1;
4474 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz)'</span>;
4475 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz'</span>;
4476 idx = idx + 1;
4477 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz, Cross-Stream Comp)'</span>;
4478 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz_y'</span>;
4479 idx = idx + 1;
4480 guiparams.secondary_flows(idx).string   = <span class="string">'Primary (Roz, Cross-Stream Comp)'</span>;
4481 guiparams.secondary_flows(idx).variable  = <span class="string">'primary_roz_y'</span>;
4482 
4483 guiparams.secondary_flow_vector_variable = <span class="keyword">...</span>
4484     guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).variable;
4485 
4486 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4487 <span class="comment">% INTERNAL SETTINGS &amp; DEFAULTS %</span>
4488 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4489 <span class="comment">% Menu bar options</span>
4490 guiparams.presentation                       = true;
4491 guiparams.print                              = false;
4492 guiparams.set_cross_section_endpoints        = false;
4493 guiparams.unit_discharge_correction          = false;
4494 guiparams.english_units                      = false;
4495 guiparams.vertical_offset                    = 0;
4496 <span class="comment">% guiparams.plot_ship_tracks                   = false;</span>
4497 <span class="comment">% guiparams.plot_planview                      = false;</span>
4498 <span class="comment">% guiparams.plot_cross_section                 = false;</span>
4499 
4500 <span class="comment">% File location defaults</span>
4501 guiparams.ascii_path                        = pwd;
4502 guiparams.ascii_file                        = <span class="string">''</span>;
4503 guiparams.mat_path                          = pwd;
4504 guiparams.mat_file                          = <span class="string">''</span>;
4505 guiparams.tecplot_path                      = pwd;
4506 guiparams.tecplot_file                      = <span class="string">''</span>;
4507 guiparams.kmz_path                          = pwd;
4508 guiparams.kmz_file                          = <span class="string">''</span>;
4509 guiparams.multibeambathymetry_path          = pwd;
4510 guiparams.multibeambathymetry_file          = <span class="string">''</span>;
4511 guiparams.log_path                          = pwd;
4512 guiparams.log_file                          = <span class="string">''</span>;
4513 <span class="comment">% Avoids problems of not finding the MCR root when running as a standalone</span>
4514 <span class="comment">% application</span>
4515 <span class="keyword">if</span> isdeployed 
4516     guiparams.has_mapping_toolbox           = true;
4517 <span class="keyword">else</span>
4518     guiparams.has_mapping_toolbox               = <span class="keyword">...</span>
4519         ~isempty(dir(fullfile(matlabroot,<span class="string">'toolbox'</span>,<span class="string">'map'</span>)));
4520 <span class="keyword">end</span>
4521 
4522 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4523 <span class="comment">% IN MEMORY DATA STORAGE %</span>
4524 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4525 guiparams.z                      = [];
4526 guiparams.A                      = [];
4527 guiparams.V                      = [];
4528 guiparams.Map                    = [];
4529 guiparams.savefile               = [];
4530 guiparams.iric_anv_planview_data = [];
4531 <span class="comment">% guiparams.zmin = []; % Don't need to store these?</span>
4532 <span class="comment">% guiparams.zmax = [];</span>
4533 <span class="comment">% guiprefs = getappdata(handles.figure1,'guiprefs');</span>
4534 guiparams.data_folder = <span class="string">''</span>;
4535 guiparams.data_files  = {<span class="string">''</span>};
4536 
4537 <span class="comment">% [EOF] createGUIparams</span>
4538 
4539 <span class="comment">% [EOF] VMT</span></pre></div>
<hr><address>Generated on Wed 31-Jul-2013 10:14:43 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>