<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of VMT</title>
  <meta name="keywords" content="VMT">
  <meta name="description" content="--- THE VELOCITY MAPPING TOOLBOX ---">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html trunk -->
<h1>VMT
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>--- THE VELOCITY MAPPING TOOLBOX ---</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function varargout = VMT(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> --- THE VELOCITY MAPPING TOOLBOX ---
 
 VMT is a Matlab-based software for processing and visualizing ADCP data
 collected along transects in rivers or other bodies of water. VMT allows
 rapid processing, visualization, and analysis of a range of ADCP datasets
 and includes utilities to export ADCP data to files compatible with
 ArcGIS, Tecplot, and Google Earth. The software can be used to explore
 patterns of three-dimensional fluid motion through several methods for
 calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et
 al., 2000). The software also includes capabilities for analyzing the
 acoustic backscatter and bathymetric data from the ADCP. A user-friendly
 graphical user interface (GUI) enhances program functionality and
 provides ready access to two- and three- dimensional plotting functions,
 allowing rapid display and interrogation of velocity, backscatter, and
 bathymetry data.
 
 CITATION: 
 Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.
 L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,
 J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and
 visualization suite for moving-vessel ADCP measurements. Earth Surf.
 Process. Landforms. doi: 10.1002/esp.3367

__________________________________________________________________________
 P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center
 (pjackson@usgs.gov)

 Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.
__________________________________________________________________________</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>	Takes the processed data structure and writes a TecPlot ASCII data file.</li><li><a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>	Takes the processed data structure and writes a TecPlot ASCII data file</li><li><a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>	Computes the multibeam bathymetry from the four beams of the ADCP</li><li><a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>	Outputs the mean cross section (3-D) from VMT to Google Earth (saved as a</li><li><a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>	Prompts the user for a geotiff DOQQ (USGS) and overlays the aerial image</li><li><a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>	This function plots a plan view of the measurement region with a vector</li><li><a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>	Plots the shiptracks, and interpolated grid in the VMT GUI axes. Also</li><li><a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>	Plots a shoreline map given the shoreline data structure 'Map' (see</li><li><a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english)">VMT_PlotXSCont</a>	Plots contours for the variable 'var' within the mean cross section given</li><li><a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,varargin)">VMT_PlotXSContQuiver</a>	This function plots the the contour plot (mean XS) for the variable 'var'</li><li><a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>	This function is a driver to preprocess the transects data.  Several</li><li><a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>	Driver program to process multiple transects at a single cross-section</li><li><a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>	Read in multiple ASCII output files from WinRiver or WinRiverII.</li><li><a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>	Saves the figures (specified by fignums) from VMT as .PNG or EPS files</li><li><a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>	This routine smooths all processed variables in V struct. By default is</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a></li><li><a href="#_sub2" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub3" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub4" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub5" class="code">function menuFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub6" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub7" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub8" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub9" class="code">function menuSave_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub10" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub11" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub12" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub13" class="code">function menuExport_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub14" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub15" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub16" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub17" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub18" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub19" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub20" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub21" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub22" class="code">function menuParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub23" class="code">function menuProcessingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub24" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub25" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub26" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub27" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub28" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub29" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub30" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub31" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub32" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub33" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub34" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub35" class="code">function menuKMZExport_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub36" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub37" class="code">function menuTools_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub38" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub39" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub40" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub41" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub42" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub43" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub44" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub45" class="code">function loadDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub46" class="code">function saveDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub47" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub48" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub49" class="code">function processingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub50" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub51" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub52" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub53" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub54" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub55" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub56" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub57" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub58" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub59" class="code">function WSE_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub60" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub61" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub62" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub63" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub64" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub65" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub66" class="code">function DisplayShoreline_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub67" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub68" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub69" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub70" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub71" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub72" class="code">function Contour_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub73" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub74" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub75" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub76" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub77" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub78" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub79" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub80" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub81" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub82" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub83" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub84" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub85" class="code">function handles = buildToolbar(handles)</a></li><li><a href="#_sub86" class="code">function load_prefs(hfigure)</a></li><li><a href="#_sub87" class="code">function store_prefs(hfigure,pref)</a></li><li><a href="#_sub88" class="code">function initGUI(handles)</a></li><li><a href="#_sub89" class="code">function set_enable(handles,enable_state)</a></li><li><a href="#_sub90" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] =</a></li><li><a href="#_sub91" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a></li><li><a href="#_sub92" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a></li><li><a href="#_sub93" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a></li><li><a href="#_sub94" class="code">function dialogOK(hObject,eventdata,h_OK)</a></li><li><a href="#_sub95" class="code">function dialogCancel(hObject,eventdata,handles)</a></li><li><a href="#_sub96" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a></li><li><a href="#_sub97" class="code">function [beam_angle,magnetic_variation,wse,output_auxilliary_data] = exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxilliary_data,hf)</a></li><li><a href="#_sub98" class="code">function dialogExportSettings(hObject,eventdata,handles)</a></li><li><a href="#_sub99" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a></li><li><a href="#_sub100" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a></li><li><a href="#_sub101" class="code">function icons = getIcons</a></li><li><a href="#_sub102" class="code">function guiparams = createGUIparams</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function varargout = VMT(varargin)</a>
0002 <span class="comment">% --- THE VELOCITY MAPPING TOOLBOX ---</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% VMT is a Matlab-based software for processing and visualizing ADCP data</span>
0005 <span class="comment">% collected along transects in rivers or other bodies of water. VMT allows</span>
0006 <span class="comment">% rapid processing, visualization, and analysis of a range of ADCP datasets</span>
0007 <span class="comment">% and includes utilities to export ADCP data to files compatible with</span>
0008 <span class="comment">% ArcGIS, Tecplot, and Google Earth. The software can be used to explore</span>
0009 <span class="comment">% patterns of three-dimensional fluid motion through several methods for</span>
0010 <span class="comment">% calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et</span>
0011 <span class="comment">% al., 2000). The software also includes capabilities for analyzing the</span>
0012 <span class="comment">% acoustic backscatter and bathymetric data from the ADCP. A user-friendly</span>
0013 <span class="comment">% graphical user interface (GUI) enhances program functionality and</span>
0014 <span class="comment">% provides ready access to two- and three- dimensional plotting functions,</span>
0015 <span class="comment">% allowing rapid display and interrogation of velocity, backscatter, and</span>
0016 <span class="comment">% bathymetry data.</span>
0017 <span class="comment">%</span>
0018 <span class="comment">% CITATION:</span>
0019 <span class="comment">% Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.</span>
0020 <span class="comment">% L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,</span>
0021 <span class="comment">% J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and</span>
0022 <span class="comment">% visualization suite for moving-vessel ADCP measurements. Earth Surf.</span>
0023 <span class="comment">% Process. Landforms. doi: 10.1002/esp.3367</span>
0024 <span class="comment">%</span>
0025 <span class="comment">%__________________________________________________________________________</span>
0026 <span class="comment">% P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center</span>
0027 <span class="comment">% (pjackson@usgs.gov)</span>
0028 <span class="comment">%</span>
0029 <span class="comment">% Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.</span>
0030 <span class="comment">%__________________________________________________________________________</span>
0031 
0032 <span class="comment">% Begin initialization code - DO NOT EDIT</span>
0033 gui_Singleton = 1;
0034 gui_State = struct(<span class="string">'gui_Name'</span>,       mfilename, <span class="keyword">...</span>
0035     <span class="string">'gui_Singleton'</span>,  gui_Singleton, <span class="keyword">...</span>
0036     <span class="string">'gui_OpeningFcn'</span>, @<a href="#_sub1" class="code" title="subfunction VMT_OpeningFcn(hObject, eventdata, handles, varargin)">VMT_OpeningFcn</a>, <span class="keyword">...</span>
0037     <span class="string">'gui_OutputFcn'</span>,  @<a href="#_sub2" class="code" title="subfunction varargout = VMT_OutputFcn(hObject, eventdata, handles)">VMT_OutputFcn</a>, <span class="keyword">...</span>
0038     <span class="string">'gui_LayoutFcn'</span>,  [] , <span class="keyword">...</span>
0039     <span class="string">'gui_Callback'</span>,   []);
0040 <span class="keyword">if</span> nargin &amp;&amp; ischar(varargin{1})
0041     gui_State.gui_Callback = str2func(varargin{1});
0042 <span class="keyword">end</span>
0043 
0044 <span class="comment">% If ERROR, write a txt file with the error dump info</span>
0045 <span class="keyword">try</span>
0046 <span class="keyword">if</span> nargout
0047     [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
0048 <span class="keyword">else</span>
0049     gui_mainfcn(gui_State, varargin{:});
0050 <span class="keyword">end</span>
0051 
0052 <span class="keyword">catch</span> err
0053     <span class="keyword">if</span> isdeployed
0054         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
0055             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
0056         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
0057             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
0058             errLogFileName},<span class="keyword">...</span>
0059             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0060             <span class="string">'error'</span>);
0061         fid = fopen(errLogFileName,<span class="string">'W'</span>);
0062         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
0063         fclose(fid);
0064         rethrow(err)
0065     <span class="keyword">else</span>
0066         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
0067             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0068             <span class="string">'error'</span>);
0069         rethrow(err);
0070     <span class="keyword">end</span>
0071 <span class="keyword">end</span>
0072 <span class="comment">% End initialization code - DO NOT EDIT</span>
0073 
0074 <span class="comment">%#ok&lt;*DEFNU,*INUSL,*INUSD&gt;</span>
0075 
0076 <span class="comment">% --- Executes just before VMT is made visible.</span>
0077 <a name="_sub1" href="#_subfunctions" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a>
0078 <span class="comment">% This function has no output args, see OutputFcn.</span>
0079 <span class="comment">% hObject    handle to figure</span>
0080 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0081 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0082 <span class="comment">% varargin   command line arguments to VMT (see VARARGIN)</span>
0083 
0084 <span class="comment">% Choose default command line output for VMT</span>
0085 handles.output = hObject;
0086 
0087 <span class="comment">% Build the GUI toolbar:</span>
0088 <span class="comment">% ----------------------</span>
0089 handles = <a href="#_sub85" class="code" title="subfunction handles = buildToolbar(handles)">buildToolbar</a>(handles);
0090 
0091 <span class="comment">% Ensure path to utils &amp; docs is available</span>
0092 <span class="comment">% ----------------------------------------</span>
0093 <span class="keyword">if</span> ~isdeployed
0094     filesep = <span class="string">'\'</span>; <span class="comment">% windows</span>
0095     utilspath = [pwd filesep <span class="string">'utils'</span>];
0096     docspath  = [pwd filesep <span class="string">'doc'</span>];
0097     toolspath = [pwd filesep <span class="string">'tools'</span>];
0098     addpath(utilspath,docspath,toolspath)
0099 <span class="keyword">end</span>
0100 
0101 <span class="comment">% Update handles structure</span>
0102 <span class="comment">% ------------------------</span>
0103 guidata(hObject, handles);
0104 
0105 <span class="comment">% Load the GUI preferences:</span>
0106 <span class="comment">% -------------------------</span>
0107 <a href="#_sub86" class="code" title="subfunction load_prefs(hfigure)">load_prefs</a>(handles.figure1)
0108 
0109 <span class="comment">% Initialize the GUI parameters:</span>
0110 <span class="comment">% ------------------------------</span>
0111 guiparams = <a href="#_sub102" class="code" title="subfunction guiparams = createGUIparams">createGUIparams</a>;
0112 guiparams.vmt_version = <span class="string">'v4.02'</span>;
0113 
0114 <span class="comment">% Draw the VMT Background</span>
0115 <span class="comment">% -----------------</span>
0116 pos = get(handles.figure1,<span class="string">'position'</span>);
0117 axes(handles.VMTBackground);
0118 <span class="keyword">if</span> ~isdeployed <span class="comment">%isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0119     X = imread(<span class="string">'VMT_Background.png'</span>);
0120     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0121 <span class="keyword">else</span>
0122     X = imread(<span class="string">'VMT_Background.png'</span>);
0123     X = imresize(X, [pos(4) pos(3)]);
0124     X = uint8(X);
0125     imshow(X,<span class="string">'Border'</span>,<span class="string">'tight'</span>)
0126 <span class="keyword">end</span>
0127 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0128 
0129 <span class="comment">% Store the application data:</span>
0130 <span class="comment">% ---------------------------</span>
0131 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0132 
0133 <span class="comment">% Initialize the GUI:</span>
0134 <span class="comment">% -------------------</span>
0135 <a href="#_sub88" class="code" title="subfunction initGUI(handles)">initGUI</a>(handles)
0136 <a href="#_sub89" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'init'</span>)
0137 <span class="comment">% set(handles.GraphicsExportPanel,'Visible','off')</span>
0138 <span class="comment">% set(handles.ProcessingPanel,'Visible','off')</span>
0139 pos = get(handles.figure1,<span class="string">'Position'</span>);
0140 <span class="comment">% pos(3) = 545;</span>
0141 set(handles.figure1,<span class="string">'Position'</span>,pos)
0142 set(handles.figure1,<span class="string">'Resize'</span>,<span class="string">'on'</span>)
0143 
0144 <span class="comment">% Allow access to the VMT Main GUI info by other sub-GUIs by pushing it to</span>
0145 <span class="comment">% the root</span>
0146 setappdata(0  , <span class="string">'hVMTgui'</span>    , gcf);
0147 
0148 <span class="comment">% UIWAIT makes VMT wait for user response (see UIRESUME)</span>
0149 <span class="comment">% uiwait(handles.figure1);</span>
0150 <span class="comment">% [EOF] VMT_OpeningFcn</span>
0151 
0152 
0153 <span class="comment">% --- Outputs from this function are returned to the command line.</span>
0154 <a name="_sub2" href="#_subfunctions" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a>
0155 <span class="comment">% varargout  cell array for returning output args (see VARARGOUT);</span>
0156 <span class="comment">% hObject    handle to figure</span>
0157 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0158 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0159 
0160 <span class="comment">% Get default command line output from handles structure</span>
0161 varargout{1} = handles.output;
0162 <span class="comment">% [EOF] VMT_OutputFcn</span>
0163 
0164 <span class="comment">% --- Executes when figure1 is resized.</span>
0165 <a name="_sub3" href="#_subfunctions" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a>
0166 
0167 <span class="comment">% Draw the VMT Background</span>
0168 <span class="comment">% -----------------</span>
0169 pos = get(handles.figure1,<span class="string">'position'</span>);
0170 axes(handles.VMTBackground);
0171 <span class="keyword">if</span> ~isdeployed <span class="comment">%isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0172     X = imread(<span class="string">'VMT_Background.png'</span>);
0173     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0174 <span class="keyword">else</span>
0175     X = imread(<span class="string">'VMT_Background.png'</span>);
0176     X = imresize(X, [pos(4) pos(3)]);
0177     X = uint8(X);
0178     imshow(X,<span class="string">'Border'</span>,<span class="string">'tight'</span>)
0179 <span class="keyword">end</span>
0180 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0181 
0182 <span class="comment">% --- Executes when user attempts to close figure1.</span>
0183 <a name="_sub4" href="#_subfunctions" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a>
0184 <span class="comment">% hObject    handle to figure1 (see GCBO)</span>
0185 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0186 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0187 
0188 <span class="comment">% Hint: delete(hObject) closes the figure</span>
0189 close_button = questdlg(<span class="keyword">...</span>
0190     <span class="string">'You are about to exit VMT. Any unsaved work will be lost. Are you sure?'</span>,<span class="keyword">...</span>
0191     <span class="string">'Exit VMT?'</span>,<span class="string">'No'</span>);
0192 <span class="keyword">switch</span> close_button
0193     <span class="keyword">case</span> <span class="string">'Yes'</span>
0194         delete(hObject)
0195         close all hidden
0196     <span class="keyword">otherwise</span>
0197         <span class="keyword">return</span>
0198 <span class="keyword">end</span>
0199 <span class="comment">% [EOF] figure1_CloseRequestFcn</span>
0200 
0201 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0202 <span class="comment">% MENU BAR CALLBACKS %</span>
0203 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0204 
0205 <span class="comment">% --------------------------------------------------------------------</span>
0206 <a name="_sub5" href="#_subfunctions" class="code">function menuFile_Callback(hObject, eventdata, handles)</a>
0207 <span class="comment">% Empty</span>
0208 
0209 <span class="comment">% --------------------------------------------------------------------</span>
0210 <a name="_sub6" href="#_subfunctions" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a>
0211 <span class="comment">% Empty</span>
0212 
0213 <span class="comment">% --------------------------------------------------------------------</span>
0214 <a name="_sub7" href="#_subfunctions" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a>
0215 <a href="#_sub45" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>(hObject, eventdata, handles)
0216 <span class="comment">% [EOF] menuOpenASCII_Callback</span>
0217 
0218 <span class="comment">% --------------------------------------------------------------------</span>
0219 <a name="_sub8" href="#_subfunctions" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a>
0220 
0221 <span class="comment">% Get the Application data:</span>
0222 <span class="comment">% -------------------------</span>
0223 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0224 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0225 
0226 <span class="comment">% Ask the user to select files:</span>
0227 <span class="comment">% -----------------------------</span>
0228 <span class="comment">% current_file = fullfile(guiparams.data_folder,guiparams.data_files{1});</span>
0229 <span class="comment">% current_file = fullfile(guiprefs.mat_path,guiprefs.mat_file);</span>
0230 <span class="keyword">if</span> iscell(guiprefs.mat_file)
0231     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file{1});
0232 <span class="keyword">else</span>
0233     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file);
0234 <span class="keyword">end</span>
0235 [filename,pathname] = <span class="keyword">...</span>
0236     uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-files (*.mat)'</span>}, <span class="keyword">...</span>
0237     <span class="string">'Select MAT File'</span>, <span class="keyword">...</span>
0238     uifile, <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
0239 
0240 <span class="keyword">if</span> ischar(filename) <span class="comment">% Single MAT file loaded</span>
0241     <span class="comment">% Load the data:</span>
0242     <span class="comment">% --------------</span>
0243     vars = load(fullfile(pathname,filename));
0244     
0245     <span class="comment">% Make sure the selected file is a valid file:</span>
0246     <span class="comment">% --------------------------------------------</span>
0247     varnames = fieldnames(vars);
0248     <span class="keyword">if</span> isequal(sort(varnames),{<span class="string">'A'</span> <span class="string">'Map'</span> <span class="string">'V'</span> <span class="string">'z'</span>}')
0249         guiparams.mat_path = pathname;
0250         guiparams.mat_file = filename;
0251         guiparams.z = vars.z;
0252         guiparams.A = vars.A;
0253         guiparams.V = vars.V;
0254         
0255         <span class="comment">% Update the preferences:</span>
0256         <span class="comment">% -----------------------</span>
0257         guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0258         guiprefs.mat_path = pathname;
0259         guiprefs.mat_file = filename;
0260         setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0261         <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0262                      
0263         <span class="comment">% Re-store the Application Data:</span>
0264         <span class="comment">% ------------------------------</span>
0265         setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0266         
0267         <span class="comment">% Update the GUI:</span>
0268         <span class="comment">% ---------------</span>
0269         <a href="#_sub89" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
0270     <span class="keyword">else</span> <span class="comment">% Not a valid file</span>
0271         errordlg(<span class="string">'The selected file is not a valid ADCP data MAT file.'</span>, <span class="keyword">...</span>
0272             <span class="string">'Invalid File...'</span>)
0273     <span class="keyword">end</span>
0274     
0275 <span class="keyword">elseif</span> iscell(filename) <span class="comment">% Multiple MAT files loaded</span>
0276     <span class="comment">% Set the filenames</span>
0277     <span class="comment">% -----------------</span>
0278     guiparams.mat_path = pathname;
0279     guiparams.mat_file = filename;
0280     
0281     <span class="comment">% Push status to log window</span>
0282     <span class="comment">% -------------------------</span>
0283     log_text = {<span class="keyword">...</span>
0284         <span class="string">'Loading previously processed MAT files.'</span>;<span class="keyword">...</span>
0285         <span class="string">'Directory:'</span>};
0286     log_text = vertcat(log_text, pathname, {<span class="string">'Files:'</span>}, filename');
0287     statusLogging(handles.LogWindow,log_text)
0288     
0289     <span class="comment">% Update the Application Data:</span>
0290     <span class="comment">% ------------------------------</span>
0291     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0292     
0293     <span class="comment">% Update the persistent preferences:</span>
0294     <span class="comment">% ----------------------------------</span>
0295     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0296     guiprefs.mat_path = pathname;
0297     guiprefs.mat_file = filename;
0298     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0299     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0300         
0301     <span class="comment">% Update the GUI:</span>
0302     <span class="comment">% ---------------</span>
0303     <a href="#_sub89" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'multiplematfiles'</span>)
0304 <span class="keyword">end</span>
0305 
0306 <span class="comment">% [EOF] menuOpenMAT_Callback</span>
0307 
0308 <span class="comment">% --------------------------------------------------------------------</span>
0309 <a name="_sub9" href="#_subfunctions" class="code">function menuSave_Callback(hObject, eventdata, handles)</a>
0310 <span class="comment">% Empty</span>
0311 
0312 <span class="comment">% --------------------------------------------------------------------</span>
0313 <a name="_sub10" href="#_subfunctions" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a>
0314 <a href="#_sub46" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>(hObject, eventdata, handles)
0315 <span class="comment">% [EOF] menuSaveMAT_Callback</span>
0316 
0317 <span class="comment">% --------------------------------------------------------------------</span>
0318 <a name="_sub11" href="#_subfunctions" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a>
0319 <a href="#_sub54" class="code" title="subfunction SaveTecplotFile_Callback(hObject, eventdata, handles)">SaveTecplotFile_Callback</a>(handles,eventdata,handles)
0320 <span class="comment">% [EOF] menuSaveTecplot_Callback</span>
0321 
0322 <span class="comment">% --------------------------------------------------------------------</span>
0323 <a name="_sub12" href="#_subfunctions" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a>
0324 <a href="#_sub55" class="code" title="subfunction SaveGoogleEarthFile_Callback(hObject, eventdata, handles)">SaveGoogleEarthFile_Callback</a>(handles,eventdata,handles)
0325 <span class="comment">% [EOF] menuSaveKMZFile_Callback</span>
0326 
0327 <span class="comment">% --------------------------------------------------------------------</span>
0328 <a name="_sub13" href="#_subfunctions" class="code">function menuExport_Callback(hObject, eventdata, handles)</a>
0329 <span class="comment">% Empty</span>
0330 
0331 <span class="comment">% --------------------------------------------------------------------</span>
0332 <a name="_sub14" href="#_subfunctions" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a>
0333 <span class="comment">% Empty</span>
0334 
0335 <span class="comment">% --------------------------------------------------------------------</span>
0336 <a name="_sub15" href="#_subfunctions" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a>
0337 
0338 <span class="comment">% Get the Application Data:</span>
0339 <span class="comment">% -------------------------</span>
0340 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0341 
0342 <span class="comment">% Update the Application Data:</span>
0343 <span class="comment">% ----------------------------</span>
0344 guiparams.print        = true;
0345 guiparams.presentation = false;
0346 
0347 <span class="comment">% Re-store the Application data:</span>
0348 <span class="comment">% ------------------------------</span>
0349 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0350 
0351 <span class="comment">% Update the GUI:</span>
0352 <span class="comment">% ---------------</span>
0353 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0354 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
0355 
0356 <span class="comment">% [EOF] menuPrintFormat_Callback</span>
0357 
0358 
0359 <span class="comment">% --------------------------------------------------------------------</span>
0360 <a name="_sub16" href="#_subfunctions" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a>
0361 
0362 <span class="comment">% Get the Application Data:</span>
0363 <span class="comment">% -------------------------</span>
0364 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0365 
0366 <span class="comment">% Update the Application Data:</span>
0367 <span class="comment">% ----------------------------</span>
0368 guiparams.print        = false;
0369 guiparams.presentation = true;
0370 
0371 <span class="comment">% Re-store the Application data:</span>
0372 <span class="comment">% ------------------------------</span>
0373 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0374 
0375 <span class="comment">% Update the GUI:</span>
0376 <span class="comment">% ---------------</span>
0377 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0378 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
0379 
0380 <span class="comment">% [EOF] menuPresentationFormat_Callback</span>
0381 
0382 <span class="comment">% --------------------------------------------------------------------</span>
0383 <a name="_sub17" href="#_subfunctions" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a>
0384 <span class="comment">% Get the Application data:</span>
0385 <span class="comment">% -------------------------</span>
0386 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0387 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0388 
0389 <span class="comment">% Find what plots exist already</span>
0390 fig_handles = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0391 fig_names   = get(fig_handles,<span class="string">'name'</span>);
0392 
0393 <span class="comment">% Remove the VMT GUI as a valid figure in the list</span>
0394 [~, idx] = ismember(get(handles.figure1,<span class="string">'Name'</span>), fig_names);
0395 <span class="keyword">if</span> ~isempty(idx)
0396     fig_names(idx) = [];
0397 <span class="keyword">end</span>
0398 
0399 <span class="keyword">if</span> guiparams.presentation
0400     figure_style = <span class="string">'presentation'</span>;
0401 <span class="keyword">else</span>
0402     figure_style = <span class="string">'print'</span>;
0403 <span class="keyword">end</span>
0404 
0405 [selected_figures] = <a href="#_sub99" class="code" title="subfunction [selected_figures] = openFiguresDialog(figure_names,hf)">openFiguresDialog</a>(fig_names,handles.figure1);
0406 
0407 <span class="keyword">if</span> isempty(selected_figures) <span class="comment">% User pressed cancel</span>
0408     <span class="keyword">return</span>
0409 <span class="keyword">else</span>
0410     <span class="keyword">for</span> i = 1:length(selected_figures)
0411         <a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>(guiprefs.mat_path,selected_figures(i),figure_style)
0412     <span class="keyword">end</span>
0413 <span class="keyword">end</span>
0414 
0415 
0416 <span class="comment">% [EOF] menuExportFigures_Callback</span>
0417 
0418 <span class="comment">% --------------------------------------------------------------------</span>
0419 <a name="_sub18" href="#_subfunctions" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a>
0420 <span class="comment">% Get the Application data:</span>
0421 <span class="comment">% -------------------------</span>
0422 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0423 beam_angle = guiparams.beam_angle; 
0424 magnetic_variation = guiparams.magnetic_variation; 
0425 wse = guiparams.wse;
0426 output_auxilliary_data = guiparams.output_auxiliary_data; 
0427 
0428 <span class="comment">% Open dialog and allow user to select settings</span>
0429 <span class="comment">% ---------------------------------------------</span>
0430 [guiparams.beam_angle,<span class="keyword">...</span>
0431     guiparams.magnetic_variation,<span class="keyword">...</span>
0432     guiparams.wse,<span class="keyword">...</span>
0433     guiparams.output_auxilliary_data] = <span class="keyword">...</span>
0434     <a href="#_sub97" class="code" title="subfunction [beam_angle,magnetic_variation,wse,output_auxilliary_data] = exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxilliary_data,hf)">exportSettingsDialog</a>(beam_angle,magnetic_variation,wse,output_auxilliary_data,handles.figure1);
0435 
0436 <span class="comment">% Re-store the Application data:</span>
0437 <span class="comment">% ------------------------------</span>
0438 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0439 
0440 <span class="comment">% [EOF] menuExportSettings_Callback</span>
0441 
0442 <span class="comment">% --------------------------------------------------------------------</span>
0443 <a name="_sub19" href="#_subfunctions" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
0444 <a href="#_sub56" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>(hObject, eventdata, handles);
0445 <span class="comment">% [EOF] menuExportMultibeamBathymetry_Callback</span>
0446 
0447 
0448 <span class="comment">% --------------------------------------------------------------------</span>
0449 <a name="_sub20" href="#_subfunctions" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a>
0450 
0451 <span class="comment">% Get the Application Data:</span>
0452 <span class="comment">% -------------------------</span>
0453 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0454 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0455 PVdata    = guiparams.iric_anv_planview_data;
0456 iric_path = guiprefs.iric_path;
0457 iric_file = guiprefs.iric_file;
0458 
0459 <span class="comment">% Is there any planview data?</span>
0460 <span class="keyword">if</span> isempty(PVdata)
0461     <span class="comment">% Nothing to do, warn user</span>
0462     log_text = {<span class="string">'No planview plot data to export. User must Plot Plan View first.'</span>};
0463     warndlg(log_text{:},<span class="string">'Nothing to export'</span>)
0464 <span class="keyword">else</span>
0465     <span class="comment">% Save the planview data as output and to an *.anv file with spacing</span>
0466     <span class="comment">% and smoothing (for iRiC)</span>
0467     log_text = {<span class="string">'Exporting iRic formated ANV vector file...'</span>};
0468     [iric_file,iric_path] = uiputfile(<span class="string">'*.anv'</span>,<span class="string">'Save *.anv file'</span>,<span class="keyword">...</span>
0469         fullfile(iric_path,iric_file));
0470     
0471     <span class="keyword">if</span> ischar(iric_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0472         outfile = fullfile(iric_path,iric_file);
0473         log_text = vertcat(log_text,{outfile});
0474         ofid   = fopen(outfile, <span class="string">'wt'</span>);
0475         outcount = fprintf(ofid,<span class="keyword">...</span>
0476             <span class="string">'%8.2f  %8.2f  %5.2f  %3.3f  %3.3f\n'</span>,PVdata.outmat);
0477         fclose(ofid);
0478     <span class="keyword">else</span>
0479         <span class="comment">% Return default iric_path and iric_file</span>
0480         iric_path = guiprefs.iric_path;
0481         iric_file = guiprefs.iric_file;
0482     <span class="keyword">end</span>
0483 <span class="keyword">end</span>
0484 
0485 <span class="comment">% Push messages to Log Window:</span>
0486 <span class="comment">% ----------------------------</span>
0487 statusLogging(handles.LogWindow, log_text)
0488 
0489 <span class="comment">% Store the persistent preferences:</span>
0490 <span class="comment">% ---------------------------------</span>
0491 guiprefs.iric_file = iric_file;
0492 guiprefs.iric_path = iric_path;
0493 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0494 <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'iric'</span>)
0495 
0496 <span class="comment">% [EOF] menuSaveANVFile_Callback</span>
0497 
0498 <span class="comment">% --------------------------------------------------------------------</span>
0499 <a name="_sub21" href="#_subfunctions" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a>
0500 <span class="comment">% Get the Application Data:</span>
0501 <span class="comment">% -------------------------</span>
0502 guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0503 guiprefs    = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0504 excel_path  = guiprefs.excel_path;
0505 excel_file  = guiprefs.excel_file;
0506 
0507 <span class="comment">% Push messages to Log Window:</span>
0508 <span class="comment">% ----------------------------</span>
0509 log_text = {<span class="string">'Exporting Excel File (reprocessing dataset; this will create new plots)'</span>};
0510 statusLogging(handles.LogWindow, log_text)
0511 
0512 <span class="comment">% If there are multiple MAT files loaded, go ahead and export just the DAV</span>
0513 <span class="comment">% data.</span>
0514 <span class="keyword">if</span> iscell(guiparams.mat_file)
0515     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0516     <a href="#_sub51" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0517     <span class="comment">% Refresh the Application Data:</span>
0518     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0519     z           = guiparams.z;
0520     A           = guiparams.A;
0521     V           = guiparams.V;
0522     Map         = guiparams.Map;
0523     wse         = guiparams.wse;
0524     PVdata      = guiparams.iric_anv_planview_data;
0525     log_text = {<span class="string">'Writing data to Excel file...'</span>;<span class="keyword">...</span>
0526         <span class="string">'Multiple transected loaded. Will export Planview Data Only!'</span>};
0527     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
0528         fullfile(excel_path,excel_file));
0529     
0530     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0531         outfile = fullfile(excel_path,excel_file);
0532         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0533         
0534     <span class="keyword">else</span>
0535         <span class="comment">% Return default excel_path and excel_file</span>
0536         excel_path = guiprefs.excel_path;
0537         excel_file = guiprefs.excel_file;
0538         outfile = fullfile(excel_path,excel_file);
0539         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0540     <span class="keyword">end</span>
0541     
0542     <span class="comment">% Delete the old file if it exists</span>
0543     <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
0544         log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
0545             [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
0546             <span class="string">'already exists. Overwriting file...'</span>});
0547         delete(outfile)
0548     <span class="keyword">end</span>
0549     
0550     <span class="comment">% Save DAV data to an Excel File</span>
0551     hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
0552     vmin = num2str(guiparams.depth_range_min);
0553     vmax = num2str(guiparams.depth_range_max);
0554     pvheaders = {<span class="keyword">...</span>
0555         <span class="string">'UTM_East'</span> <span class="string">'UTM_North'</span> <span class="string">'Elev_m'</span><span class="keyword">...</span>
0556         [<span class="string">'EastDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0557         [<span class="string">'NorthDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]};
0558     PVdata.outmat(4:5,:) = PVdata.outmat(4:5,:).*100; <span class="comment">% velocities in cm/s</span>
0559     pvdata = num2cell(PVdata.outmat');
0560     pvout = vertcat(pvheaders,pvdata);
0561     xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
0562     waitbar(4/5,hwait)
0563     
0564     <span class="comment">% Push messages to Log Window:</span>
0565     <span class="comment">% ----------------------------</span>
0566     statusLogging(handles.LogWindow, log_text)
0567 <span class="keyword">else</span>
0568     
0569     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0570     <a href="#_sub51" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0571     <a href="#_sub52" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
0572     <span class="comment">% Refresh the Application Data:</span>
0573     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0574     z           = guiparams.z;
0575     A           = guiparams.A;
0576     V           = guiparams.V;
0577     Map         = guiparams.Map;
0578     wse         = guiparams.wse;
0579     PVdata      = guiparams.iric_anv_planview_data;
0580     
0581     
0582     log_text = {<span class="string">'Writing data to Excel file...'</span>};
0583     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
0584         fullfile(excel_path,excel_file));
0585     
0586     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0587         outfile = fullfile(excel_path,excel_file);
0588         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0589         
0590         <span class="comment">% Delete the old file if it exists</span>
0591         <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
0592             log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
0593                 [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
0594                 <span class="string">'already exists. Overwriting file...'</span>});
0595             delete(outfile)
0596         <span class="keyword">end</span>
0597         
0598         <span class="comment">% Push messages to Log Window:</span>
0599         <span class="comment">% ----------------------------</span>
0600         statusLogging(handles.LogWindow, log_text)
0601         
0602         <span class="comment">% Save MCS Summary to an Excel File</span>
0603         hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
0604         xlswrite(outfile,{<span class="string">'Files:'</span>},<span class="string">'VMTSummary'</span>,<span class="string">'H4'</span>); waitbar(1/5,hwait)
0605         sout = guiparams.data_files';
0606         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'I4'</span>); waitbar(2/5,hwait)
0607         sout = {<span class="keyword">...</span>
0608             <span class="string">'VMT: Summary of Mean Cross Section'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0609             <span class="string">'VMT '</span> guiparams.vmt_version <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0610             <span class="string">'Date Processed: '</span> datestr(now) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0611             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0612             <span class="string">'Mean Cross Section (MCS) Properties'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0613             <span class="string">'Horz. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.horizontal_grid_node_spacing;<span class="keyword">...</span>
0614             <span class="string">'Vert. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> single(guiparams.A(1).Sup.binSize_cm)/100;<span class="keyword">...</span>
0615             <span class="string">'Endpoints:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">'UTM_East'</span>    <span class="string">'UTM_North'</span>;<span class="keyword">...</span>
0616             <span class="string">'Left Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xLeftBank V.yLeftBank;<span class="keyword">...</span>
0617             <span class="string">'Right Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xRightBank V.yRightBank;<span class="keyword">...</span>
0618             <span class="string">'Total Length in meters'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.dl;<span class="keyword">...</span>
0619             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0620             <span class="string">'Mean Flow Direction (deg)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.mfd;<span class="keyword">...</span>
0621             <span class="string">'in geographic coordinates'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0622             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0623             <span class="string">'Slope'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.m;<span class="keyword">...</span>
0624             <span class="string">'Intercept'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.b;<span class="keyword">...</span>
0625             <span class="string">'Theta (deg)'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.theta};
0626         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'A1'</span>); waitbar(3/5,hwait)
0627         
0628         <span class="comment">% Save DAV data to an Excel File</span>
0629         vmin = num2str(guiparams.depth_range_min);
0630         vmax = num2str(guiparams.depth_range_max);
0631         pvheaders = {<span class="keyword">...</span>
0632             <span class="string">'UTM_East'</span> <span class="string">'UTM_North'</span> <span class="string">'Elev_m'</span><span class="keyword">...</span>
0633             [<span class="string">'EastDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0634             [<span class="string">'NorthDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]};
0635         PVdata.outmat(4:5,:) = PVdata.outmat(4:5,:).*100; <span class="comment">% velocities in cm/s</span>
0636         pvdata = num2cell(PVdata.outmat');
0637         pvout = vertcat(pvheaders,pvdata);
0638         xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
0639         waitbar(4/5,hwait)
0640         
0641         <span class="comment">% Save MCS data to an Excel File</span>
0642         mcsheaders = {<span class="keyword">...</span>
0643             <span class="string">'UTM_East'</span> <span class="keyword">...</span>
0644             <span class="string">'UTM_North'</span><span class="keyword">...</span>
0645             <span class="string">'Distance from Left Bank, in meters'</span><span class="keyword">...</span>
0646             <span class="string">'Elevation, in meters'</span><span class="keyword">...</span>
0647             <span class="string">'Bed Elevation, in meters'</span><span class="keyword">...</span>
0648             <span class="string">'East Velocity, in cm/s'</span><span class="keyword">...</span>
0649             <span class="string">'North Velocity, in cm/s'</span><span class="keyword">...</span>
0650             <span class="string">'Vertical Velocity, in cm/s'</span><span class="keyword">...</span>
0651             <span class="string">'Velocity Magnitude, in cm/s'</span><span class="keyword">...</span>
0652             <span class="string">'Velocity Direction, in degrees (geographic coordinates)'</span><span class="keyword">...</span>
0653             <span class="string">'Streamwise Velocity, in cm/s'</span><span class="keyword">...</span>
0654             <span class="string">'Transverse Velocity, in cm/s'</span><span class="keyword">...</span>
0655             <span class="string">'Primary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
0656             <span class="string">'Secondary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
0657             <span class="string">'Primary Velocity (roz), in cm/s'</span><span class="keyword">...</span>
0658             <span class="string">'Secondary Velocity (roz), in cm/s'</span>};
0659         
0660         mcsdata = [<span class="keyword">...</span>
0661             V.mcsX(:)<span class="keyword">...</span>
0662             V.mcsY(:)<span class="keyword">...</span>
0663             V.mcsDist(:)<span class="keyword">...</span>
0664             (wse - V.mcsDepth(:))<span class="keyword">...</span>
0665             repmat((wse - V.mcsBed(:)),size(V.mcsX,1),1)<span class="keyword">...</span>
0666             V.mcsEast(:)<span class="keyword">...</span>
0667             V.mcsNorth(:)<span class="keyword">...</span>
0668             V.mcsVert(:)<span class="keyword">...</span>
0669             V.mcsMag(:)<span class="keyword">...</span>
0670             V.mcsDir(:)<span class="keyword">...</span>
0671             V.u(:)<span class="keyword">...</span>
0672             V.v(:)<span class="keyword">...</span>
0673             V.vp(:)<span class="keyword">...</span>
0674             V.vs(:)<span class="keyword">...</span>
0675             V.Roz.up(:)<span class="keyword">...</span>
0676             V.Roz.us(:)];
0677         mcsdata(isnan(mcsdata)) = -9999;
0678         
0679         mcsout = vertcat(mcsheaders,num2cell(mcsdata));
0680         xlswrite(outfile,mcsout,<span class="string">'MeanCrossSection'</span>);
0681         waitbar(1,hwait)
0682         delete(hwait)
0683         
0684     <span class="keyword">else</span>
0685         <span class="comment">% Return default excel_path and excel_file</span>
0686         excel_path = guiprefs.excel_path;
0687         excel_file = guiprefs.excel_file;
0688         outfile = fullfile(excel_path,excel_file);
0689         log_text = {<span class="string">'User aborted Excel export...'</span>};
0690     <span class="keyword">end</span>
0691     
0692     
0693     
0694 <span class="keyword">end</span>
0695 
0696 <span class="comment">% Push messages to Log Window:</span>
0697 <span class="comment">% ----------------------------</span>
0698 statusLogging(handles.LogWindow, log_text)
0699 
0700 <span class="comment">% Store the persistent preferences:</span>
0701 <span class="comment">% ---------------------------------</span>
0702 guiprefs.excel_file = excel_file;
0703 guiprefs.excel_path = excel_path;
0704 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0705 <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'excel'</span>)
0706 
0707 <span class="comment">% [EOF] menuSaveExcel_Callback</span>
0708 
0709 <span class="comment">% --------------------------------------------------------------------</span>
0710 <a name="_sub22" href="#_subfunctions" class="code">function menuParameters_Callback(hObject, eventdata, handles)</a>
0711 <span class="comment">% Empty</span>
0712 
0713 <span class="comment">% --------------------------------------------------------------------</span>
0714 <a name="_sub23" href="#_subfunctions" class="code">function menuProcessingParameters_Callback(hObject, eventdata, handles)</a>
0715 <span class="comment">% Empty</span>
0716 
0717 <span class="comment">% --------------------------------------------------------------------</span>
0718 <a name="_sub24" href="#_subfunctions" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a>
0719 <span class="comment">% Turn ON or OFF Unit Discharge Correction</span>
0720 
0721 <span class="comment">% Get the Application Data:</span>
0722 <span class="comment">% -------------------------</span>
0723 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0724 
0725 <span class="comment">% Update the GUI &amp; Application Data:</span>
0726 <span class="comment">% ----------------------------------</span>
0727 status = get(handles.menuUnitDischargeCorrection,<span class="string">'Checked'</span>);
0728 <span class="keyword">switch</span> status
0729     <span class="keyword">case</span> <span class="string">'on'</span> <span class="comment">% Turn it off</span>
0730         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0731         guiparams.unit_discharge_correction = false;
0732     <span class="keyword">case</span> <span class="string">'off'</span> <span class="comment">% Turn it on</span>
0733         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0734         guiparams.unit_discharge_correction = true;
0735 <span class="keyword">end</span>
0736 
0737 <span class="comment">% Re-store the Application data:</span>
0738 <span class="comment">% ------------------------------</span>
0739 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0740 
0741 
0742 <span class="comment">%  [EOF] menuUnitDischargeCorrection_Callback</span>
0743 
0744 <span class="comment">% --------------------------------------------------------------------</span>
0745 <a name="_sub25" href="#_subfunctions" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a>
0746 <span class="comment">% Empty</span>
0747 
0748 <span class="comment">% --------------------------------------------------------------------</span>
0749 <a name="_sub26" href="#_subfunctions" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a>
0750 <span class="comment">% Empty</span>
0751 
0752 <span class="comment">% --------------------------------------------------------------------</span>
0753 <a name="_sub27" href="#_subfunctions" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a>
0754 <span class="comment">% Set the Plotting Parameter Units to &quot;metric&quot;</span>
0755 
0756 <span class="comment">% Get the Application Data:</span>
0757 <span class="comment">% -------------------------</span>
0758 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0759 
0760 <span class="comment">% Update the Application Data:</span>
0761 <span class="comment">% ----------------------------</span>
0762 guiparams.english_units = false;
0763 
0764 <span class="comment">% Re-store the Application data:</span>
0765 <span class="comment">% ------------------------------</span>
0766 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0767 
0768 <span class="comment">% Update the GUI:</span>
0769 <span class="comment">% ---------------</span>
0770 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0771 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
0772 
0773 <span class="comment">% [EOF] menuMetric_Callback</span>
0774 
0775 
0776 <span class="comment">% --------------------------------------------------------------------</span>
0777 <a name="_sub28" href="#_subfunctions" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a>
0778 <span class="comment">% Set the Plotting Parameter Units to &quot;english&quot;</span>
0779 
0780 <span class="comment">% Get the Application Data:</span>
0781 <span class="comment">% -------------------------</span>
0782 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0783 
0784 <span class="comment">% Update the Application Data:</span>
0785 <span class="comment">% ----------------------------</span>
0786 guiparams.english_units = true;
0787 
0788 <span class="comment">% Re-store the Application data:</span>
0789 <span class="comment">% ------------------------------</span>
0790 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0791 
0792 <span class="comment">% Update the GUI:</span>
0793 <span class="comment">% ---------------</span>
0794 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0795 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
0796 
0797 <span class="comment">% [EOF] menuEnglish_Callback</span>
0798 
0799 
0800 <span class="comment">% --------------------------------------------------------------------</span>
0801 <a name="_sub29" href="#_subfunctions" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
0802 <span class="comment">% Empty</span>
0803 
0804 <span class="comment">% --------------------------------------------------------------------</span>
0805 <a name="_sub30" href="#_subfunctions" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a>
0806 <span class="comment">% Set cross-section endpoints automatically</span>
0807 
0808 <span class="comment">% Get the Application Data:</span>
0809 <span class="comment">% -------------------------</span>
0810 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0811 
0812 <span class="comment">% Update the Application Data:</span>
0813 <span class="comment">% ----------------------------</span>
0814 guiparams.set_cross_section_endpoints = false;
0815 
0816 <span class="comment">% Re-store the Application data:</span>
0817 <span class="comment">% ------------------------------</span>
0818 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0819 
0820 <span class="comment">% Update the GUI:</span>
0821 <span class="comment">% ---------------</span>
0822 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0823 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0824 
0825 <span class="comment">% [EOF] menuCrossSectionEndpointAutomatic_Callback</span>
0826 
0827 
0828 <span class="comment">% --------------------------------------------------------------------</span>
0829 <a name="_sub31" href="#_subfunctions" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a>
0830 <span class="comment">% Set cross-section endpoints manually</span>
0831 
0832 <span class="comment">% Get the Application Data:</span>
0833 <span class="comment">% -------------------------</span>
0834 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0835 
0836 <span class="comment">% Update the Application Data:</span>
0837 <span class="comment">% ----------------------------</span>
0838 guiparams.set_cross_section_endpoints = true;
0839 
0840 <span class="comment">% Re-store the Application data:</span>
0841 <span class="comment">% ------------------------------</span>
0842 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0843 
0844 <span class="comment">% Update the GUI:</span>
0845 <span class="comment">% ---------------</span>
0846 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0847 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0848 
0849 <span class="comment">% [EOF] menuCrossSectionEndpointManual_Callback</span>
0850 
0851 
0852 
0853 
0854 <span class="comment">% --------------------------------------------------------------------</span>
0855 <a name="_sub32" href="#_subfunctions" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a>
0856 <span class="comment">% Empty</span>
0857 
0858 <span class="comment">% --------------------------------------------------------------------</span>
0859 <a name="_sub33" href="#_subfunctions" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a>
0860 
0861 <span class="comment">% Get the Application Data:</span>
0862 <span class="comment">% -------------------------</span>
0863 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0864 
0865 <span class="comment">% Update the Application Data:</span>
0866 <span class="comment">% ----------------------------</span>
0867 guiparams.print        = true;
0868 guiparams.presentation = false;
0869 
0870 <span class="comment">% Re-store the Application data:</span>
0871 <span class="comment">% ------------------------------</span>
0872 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0873 
0874 <span class="comment">% Update the GUI:</span>
0875 <span class="comment">% ---------------</span>
0876 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0877 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0878 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0879 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
0880 
0881 <span class="comment">% Modify the existing figures</span>
0882 <span class="comment">% ---------------------------</span>
0883 <span class="comment">% Find what plots exist already</span>
0884 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0885 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0886 
0887 <span class="comment">% Defaults for Print Stlye Figure</span>
0888 BkgdColor   = <span class="string">'white'</span>;
0889 AxColor     = <span class="string">'black'</span>;
0890 FigColor    = <span class="string">'white'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
0891 FntSize     = 14;
0892 
0893 <span class="comment">% Loop through valid figures and adjust</span>
0894 <span class="comment">% -------------------------------------</span>
0895 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0896     
0897     <span class="keyword">for</span> i = 1:length(valid_names)
0898         <span class="keyword">switch</span> valid_names{i}
0899             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
0900                 <span class="comment">% Focus the figure</span>
0901                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0902                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0903                     figure(hff)
0904                     
0905                     <span class="comment">% Make the changes to figure</span>
0906                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
0907                     set(gca,<span class="string">'FontSize'</span>,FntSize)
0908                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
0909                     set(gca,<span class="string">'Color'</span>,FigColor)
0910                     set(gca,<span class="string">'XColor'</span>,AxColor)
0911                     set(gca,<span class="string">'YColor'</span>,AxColor)
0912                     set(gca,<span class="string">'ZColor'</span>,AxColor)
0913                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
0914                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0915                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0916                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0917                 <span class="keyword">end</span>
0918             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
0919                 <span class="comment">% Focus the figure</span>
0920                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0921                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0922                     figure(hff)
0923                     
0924                     <span class="comment">% Make the changes to figure</span>
0925                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
0926                     set(gca,<span class="string">'FontSize'</span>,FntSize)
0927                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
0928                     set(gca,<span class="string">'Color'</span>,FigColor)
0929                     set(gca,<span class="string">'XColor'</span>,AxColor)
0930                     set(gca,<span class="string">'YColor'</span>,AxColor)
0931                     set(gca,<span class="string">'ZColor'</span>,AxColor)
0932                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
0933                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0934                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0935                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
0936                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
0937                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
0938                 <span class="keyword">end</span>
0939             <span class="keyword">otherwise</span>
0940         <span class="keyword">end</span>
0941     <span class="keyword">end</span>
0942     
0943     
0944 <span class="keyword">end</span>
0945 
0946 
0947 <span class="comment">%[EOF] menuStylePrint_Callback</span>
0948 
0949 
0950 <span class="comment">% --------------------------------------------------------------------</span>
0951 <a name="_sub34" href="#_subfunctions" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a>
0952 <span class="comment">% Get the Application Data:</span>
0953 <span class="comment">% -------------------------</span>
0954 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0955 
0956 <span class="comment">% Update the Application Data:</span>
0957 <span class="comment">% ----------------------------</span>
0958 guiparams.print        = false;
0959 guiparams.presentation = true;
0960 
0961 <span class="comment">% Re-store the Application data:</span>
0962 <span class="comment">% ------------------------------</span>
0963 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0964 
0965 <span class="comment">% Update the GUI:</span>
0966 <span class="comment">% ---------------</span>
0967 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0968 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0969 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0970 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
0971 
0972 <span class="comment">% Modify the existing figures</span>
0973 <span class="comment">% ---------------------------</span>
0974 <span class="comment">% Find what plots exist already</span>
0975 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0976 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0977 
0978 <span class="comment">% Defaults for Presentation Stlye Figure</span>
0979 <span class="comment">% --------------------------------------</span>
0980 BkgdColor   = <span class="string">'black'</span>;
0981 AxColor     = <span class="string">'white'</span>;
0982 FigColor    = <span class="string">'black'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
0983 FntSize     = 14;
0984 
0985 <span class="comment">% Loop through valid figures and adjust</span>
0986 <span class="comment">% -------------------------------------</span>
0987 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0988     
0989     <span class="keyword">for</span> i = 1:length(valid_names)
0990         <span class="keyword">switch</span> valid_names{i}
0991             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
0992                 <span class="comment">% Focus the figure</span>
0993                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0994                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0995                     figure(hff)
0996                     
0997                     <span class="comment">% Make the changes to figure</span>
0998                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
0999                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1000                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1001                     set(gca,<span class="string">'Color'</span>,FigColor)
1002                     set(gca,<span class="string">'XColor'</span>,AxColor)
1003                     set(gca,<span class="string">'YColor'</span>,AxColor)
1004                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1005                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1006                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1007                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1008                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1009                 <span class="keyword">end</span>
1010             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
1011                 <span class="comment">% Focus the figure</span>
1012                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
1013                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1014                     figure(hff)
1015                     
1016                     <span class="comment">% Make the changes to figure</span>
1017                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1018                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1019                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1020                     set(gca,<span class="string">'Color'</span>,[0.3 0.3 0.3]) <span class="comment">%FigColor)</span>
1021                     set(gca,<span class="string">'XColor'</span>,AxColor)
1022                     set(gca,<span class="string">'YColor'</span>,AxColor)
1023                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1024                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1025                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1026                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1027                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1028                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
1029                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
1030                 <span class="keyword">end</span>
1031             <span class="keyword">otherwise</span>
1032         <span class="keyword">end</span>
1033     <span class="keyword">end</span>
1034     
1035     
1036 <span class="keyword">end</span>
1037 
1038 <span class="comment">% [EOF] menuStylePresentation_Callback</span>
1039 
1040 <span class="comment">% --------------------------------------------------------------------</span>
1041 <a name="_sub35" href="#_subfunctions" class="code">function menuKMZExport_Callback(hObject, eventdata, handles)</a>
1042 
1043 <span class="comment">% Get the Application data:</span>
1044 <span class="comment">% -------------------------</span>
1045 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1046 
1047 <span class="comment">% Initialize the answer:</span>
1048 <span class="comment">% ----------------------</span>
1049 numstr = {num2str(guiparams.vertical_offset)};
1050 answer = NaN;
1051 <span class="keyword">while</span> isnan(answer)
1052     answer = inputdlg(<span class="string">'Vertical Offset (m)'</span>,<span class="string">'KMZ Export'</span>,1,numstr);
1053     
1054     <span class="keyword">if</span> isempty(answer) <span class="comment">% User hits &quot;Cancel&quot;</span>
1055         <span class="keyword">return</span>
1056     <span class="keyword">end</span>
1057     
1058     answer = str2double(answer); <span class="comment">% A non-numeric char will be NaN</span>
1059     <span class="comment">% A numeric char will be a double</span>
1060 <span class="keyword">end</span>
1061 
1062 <span class="comment">% Re-store the Application data:</span>
1063 <span class="comment">% ------------------------------</span>
1064 guiparams.vertical_offset = answer;
1065 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1066 
1067 <span class="comment">% [EOF] menuKMZExport_Callback</span>
1068 
1069 <span class="comment">% --------------------------------------------------------------------</span>
1070 <a name="_sub36" href="#_subfunctions" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a>
1071 <span class="comment">% Not implemented</span>
1072 
1073 <span class="comment">% --------------------------------------------------------------------</span>
1074 <a name="_sub37" href="#_subfunctions" class="code">function menuTools_Callback(hObject, eventdata, handles)</a>
1075 <span class="comment">% Empty</span>
1076 
1077 <span class="comment">% --------------------------------------------------------------------</span>
1078 <a name="_sub38" href="#_subfunctions" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a>
1079 ASCII2GIS_GUI
1080 <span class="comment">% [EOF] menuASCII2GIS_Callback</span>
1081 
1082 <span class="comment">% --------------------------------------------------------------------</span>
1083 <a name="_sub39" href="#_subfunctions" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a>
1084 
1085 <span class="comment">% Get the Application preferences:</span>
1086 <span class="comment">% --------------------------------</span>
1087 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1088 
1089 inpath = guiprefs.kmz_path;
1090 <span class="keyword">if</span> iscell(guiprefs.kmz_file)
1091     infile = guiprefs.kmz_file{1};
1092 <span class="keyword">else</span>
1093     infile = guiprefs.kmz_file;
1094 <span class="keyword">end</span>
1095 [log_text,outpath,outfile] = ASCII2KML(inpath,infile);
1096 
1097 guiprefs.kmz_path = outpath;
1098 guiprefs.kmz_file = outfile;
1099 
1100 <span class="comment">% Update persistent preferences</span>
1101 <span class="comment">% -----------------------------</span>
1102 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1103 
1104 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1105 
1106 <span class="comment">% --------------------------------------------------------------------</span>
1107 <a name="_sub40" href="#_subfunctions" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a>
1108 <span class="comment">% Empty</span>
1109 
1110 <span class="comment">% --------------------------------------------------------------------</span>
1111 <a name="_sub41" href="#_subfunctions" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a>
1112 <span class="keyword">try</span>
1113     web(<span class="string">'http://code.google.com/p/velocity-mapping-tool/wiki/UserGuide?tm=6'</span>)
1114 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
1115     <span class="keyword">if</span> isdeployed
1116         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1117             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1118         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1119             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1120             errLogFileName},<span class="keyword">...</span>
1121             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1122             <span class="string">'error'</span>);
1123         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1124         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1125         fclose(fid);
1126         rethrow(err)
1127     <span class="keyword">else</span>
1128         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1129             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1130             <span class="string">'error'</span>);
1131         rethrow(err);
1132     <span class="keyword">end</span>
1133 <span class="keyword">end</span>
1134 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1135 
1136 <span class="comment">% --------------------------------------------------------------------</span>
1137 <a name="_sub42" href="#_subfunctions" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a>
1138 <span class="comment">% Get the Application data:</span>
1139 <span class="comment">% -------------------------</span>
1140 <span class="comment">% guiparams = getappdata(handles.figure1,'guiparams'); %#ok&lt;NASGU&gt;</span>
1141 
1142 <span class="keyword">try</span>
1143     <span class="comment">% Construct a URL to a local file which can be interpreted by any</span>
1144     <span class="comment">% web-browser</span>
1145     rootpath = strrep(pwd,filesep,<span class="string">'/'</span>);
1146     webaddress = [<span class="string">'file:///'</span> rootpath <span class="string">'/doc/index.html'</span>];
1147     system([<span class="string">'start '</span> webaddress]);
1148 <span class="comment">%     [stat,h,url] = web(webaddress) % Produced with m2html (FEX)</span>
1149 <span class="keyword">catch</span> err 
1150     <span class="keyword">if</span> isdeployed
1151         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1152             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1153         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1154             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1155             errLogFileName},<span class="keyword">...</span>
1156             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1157             <span class="string">'error'</span>);
1158         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1159         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1160         fclose(fid);
1161         rethrow(err)
1162     <span class="keyword">else</span>
1163         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1164             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1165             <span class="string">'error'</span>);
1166         rethrow(err);
1167     <span class="keyword">end</span>
1168 <span class="keyword">end</span>
1169 
1170 <span class="comment">% [EOF] menuFunctionLibrary_Callback</span>
1171 
1172 <span class="comment">% --------------------------------------------------------------------</span>
1173 <a name="_sub43" href="#_subfunctions" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a>
1174 
1175 <span class="comment">% Get the Application data:</span>
1176 <span class="comment">% -------------------------</span>
1177 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1178 
1179 <span class="comment">% Check version tag against the web, and display a message</span>
1180 <span class="keyword">try</span>
1181     current_vmt_version = urlread(<span class="string">'http://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt'</span>);
1182     <span class="comment">%     current_vmt_version = urlread('http://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt');</span>
1183 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
1184     <span class="keyword">if</span> isdeployed
1185         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1186             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1187         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1188             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1189             errLogFileName},<span class="keyword">...</span>
1190             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1191             <span class="string">'error'</span>);
1192         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1193         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1194         fclose(fid);
1195         rethrow(err)
1196     <span class="keyword">else</span>
1197         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1198             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1199             <span class="string">'error'</span>);
1200         rethrow(err);
1201     <span class="keyword">end</span>
1202 <span class="keyword">end</span>
1203 
1204 <span class="keyword">if</span> strcmpi(guiparams.vmt_version,current_vmt_version)
1205     h = msgbox(<span class="string">'VMT is currently up to date, no updates available.'</span>,<span class="string">'Check for updates'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1206 <span class="keyword">else</span>
1207     h = msgbox(<span class="string">'VMT is out of date. Please visit the VMT homepage.'</span>,<span class="string">'Check for updates'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1208 <span class="keyword">end</span>
1209 <span class="comment">% [EOF] menuCheckForUpdates_Callback</span>
1210 
1211 <span class="comment">% --------------------------------------------------------------------</span>
1212 <a name="_sub44" href="#_subfunctions" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a>
1213 
1214 <span class="comment">% Get the Application data:</span>
1215 <span class="comment">% -------------------------</span>
1216 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1217 messagestr = <span class="keyword">...</span>
1218     {<span class="string">'The Velocity Mapping Toolbox'</span>;<span class="keyword">...</span>
1219     [<span class="string">'   Version: '</span> guiparams.vmt_version];<span class="keyword">...</span>
1220     <span class="string">''</span>;<span class="keyword">...</span>
1221     <span class="string">''</span>;<span class="keyword">...</span>
1222     <span class="string">'With collaborations from:'</span>;<span class="keyword">...</span>
1223     <span class="string">'   U.S. Geological Survey'</span>;<span class="keyword">...</span>
1224     <span class="string">'   University of Illinois'</span>;<span class="keyword">...</span>
1225     <span class="string">'   University of Hull'</span>;<span class="keyword">...</span>
1226     <span class="string">''</span>;<span class="keyword">...</span>
1227     <span class="string">''</span>;<span class="keyword">...</span>
1228     <span class="string">'Citation: '</span>;<span class="keyword">...</span>
1229     <span class="string">'   Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L.,'</span>;<span class="keyword">...</span>
1230     <span class="string">'   Rhoads, B. L., Oberg, K. A., Best, J. L., Mueller, D. S.,'</span>;<span class="keyword">...</span>
1231     <span class="string">'   Johnson, K. K. and Riley, J. D. (2013), Velocity Mapping'</span>;<span class="keyword">...</span>
1232     <span class="string">'   Toolbox (VMT): a processing and visualization suite for'</span>;<span class="keyword">...</span>
1233     <span class="string">'   moving-vessel ADCP measurements. Earth Surf. Process.'</span>;<span class="keyword">...</span>
1234     <span class="string">'   Landforms.doi: 10.1002/esp.3367'</span>};
1235 h = msgbox(messagestr,<span class="string">'About VMT'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1236 <span class="comment">% [EOF] menuAbout_Callback</span>
1237 
1238 
1239 
1240 
1241 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
1242 <span class="comment">% TOOLBAR CALLBACKS %</span>
1243 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
1244 
1245 <span class="comment">% --------------------------------------------------------------------</span>
1246 <a name="_sub45" href="#_subfunctions" class="code">function loadDataCallback(hObject, eventdata, handles)</a>
1247 <span class="comment">% Read Files into Data Structure using tfile.</span>
1248 
1249 <span class="comment">% Get the Application data:</span>
1250 <span class="comment">% -------------------------</span>
1251 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1252 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1253 
1254 <span class="comment">% Ask the user to select files:</span>
1255 <span class="comment">% -----------------------------</span>
1256 current_file = fullfile(guiprefs.ascii_path,guiprefs.ascii_file{1});
1257 [filename,pathname] = uigetfile({<span class="string">'*_ASC.TXT'</span>,<span class="string">'ASCII (*_ASC.TXT)'</span>}, <span class="keyword">...</span>
1258     <span class="string">'Select the ASCII Output Files'</span>, <span class="keyword">...</span>
1259     current_file, <span class="keyword">...</span>
1260     <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
1261 
1262 <span class="keyword">if</span> ischar(pathname) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
1263     guiparams.data_folder = pathname;
1264     <span class="keyword">if</span> ischar(filename)
1265         filename = {filename};
1266     <span class="keyword">end</span>
1267     guiparams.data_files = filename;
1268     guiparams.mat_file = <span class="string">''</span>;
1269     
1270     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1271     
1272    
1273     
1274     <span class="comment">% Update the preferences:</span>
1275     <span class="comment">% -----------------------</span>
1276     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1277     guiprefs.ascii_path = pathname;
1278     guiprefs.ascii_file = filename;
1279     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1280     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'ascii'</span>)
1281     
1282     <span class="comment">% Push messages to Log Window:</span>
1283     <span class="comment">% ----------------------------</span>
1284     log_text = {<span class="keyword">...</span>
1285         <span class="string">''</span>;<span class="keyword">...</span>
1286         [<span class="string">'%--- '</span> datestr(now) <span class="string">' ---%'</span>];<span class="keyword">...</span>
1287         <span class="string">'Current Project Directory:'</span>;<span class="keyword">...</span>
1288         guiparams.data_folder;
1289         <span class="string">'Loading the following files into memory:'</span>;<span class="keyword">...</span>
1290         char(filename)};
1291     statusLogging(handles.LogWindow, log_text)
1292     
1293     <span class="comment">% Read the file(s)</span>
1294     <span class="comment">% ----------------</span>
1295     [~,~,savefile,A,z] = <span class="keyword">...</span>
1296         <a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>(guiparams.data_folder,guiparams.data_files);
1297     guiparams.savefile = savefile;
1298     guiparams.A        = A;
1299     guiparams.z        = z;
1300     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1301 <span class="comment">%</span>
1302 <span class="comment">%     % Preprocess the data:</span>
1303 <span class="comment">%     % --------------------</span>
1304 <span class="comment">%     A = VMT_PreProcess(z,A);</span>
1305 <span class="comment">%</span>
1306 <span class="comment">%     % Push messages to Log Window:</span>
1307 <span class="comment">%     % ----------------------------</span>
1308 <span class="comment">%     log_text = {...</span>
1309 <span class="comment">%         '   Preprocessing complete.';...</span>
1310 <span class="comment">%         '   Begin Data Processing...'};</span>
1311 <span class="comment">%     statusLogging(handles.LogWindow, log_text)</span>
1312 <span class="comment">%</span>
1313 <span class="comment">%     A(1).hgns = guiparams.horizontal_grid_node_spacing;</span>
1314 <span class="comment">%     A(1).wse  = guiparams.wse;  %Set the WSE to entered value</span>
1315 <span class="comment">%     [A,V,processing_log_text] = VMT_ProcessTransects(z,A,...</span>
1316 <span class="comment">%         guiparams.set_cross_section_endpoints,...</span>
1317 <span class="comment">%         guiparams.unit_discharge_correction);</span>
1318 <span class="comment">%</span>
1319 <span class="comment">%     % Push messages to Log Window:</span>
1320 <span class="comment">%     % ----------------------------</span>
1321 <span class="comment">%     statusLogging(handles.LogWindow, processing_log_text)</span>
1322 <span class="comment">%</span>
1323 <span class="comment">%     % Store the data:</span>
1324 <span class="comment">%     % ---------------</span>
1325 <span class="comment">%     guiparams.z = z;</span>
1326 <span class="comment">%     guiparams.A = A;</span>
1327 <span class="comment">%     guiparams.V = V;</span>
1328 <span class="comment">%     setappdata(handles.figure1,'guiparams',guiparams)</span>
1329     
1330       
1331     <span class="comment">% Update the GUI:</span>
1332     <span class="comment">% ---------------</span>
1333     <a href="#_sub89" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
1334 <span class="keyword">end</span>
1335 <span class="comment">% [EOF] loadDataCallback</span>
1336 
1337 
1338 
1339 <span class="comment">% --------------------------------------------------------------------</span>
1340 <a name="_sub46" href="#_subfunctions" class="code">function saveDataCallback(hObject, eventdata, handles)</a>
1341 <span class="comment">% SaveMATFile_Callback(handles.SaveMATFile,eventdata,handles)</span>
1342 
1343 <span class="comment">% Get the Application data:</span>
1344 <span class="comment">% -------------------------</span>
1345 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1346 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1347 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1348 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1349 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
1350 
1351 [the_file,the_path] = <span class="keyword">...</span>
1352     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
1353     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
1354     fullfile(guiparams.mat_path,guiparams.savefile));
1355 
1356 <span class="comment">% Save the processed data to a MAT file:</span>
1357 <span class="comment">% --------------------------------------</span>
1358 <span class="keyword">if</span> ischar(the_file)
1359     guiparams.mat_path = the_path;
1360     guiparams.mat_file = the_file;
1361     guiparams.savefile = the_file;
1362     
1363     <span class="comment">% Re-store the Application data:</span>
1364     <span class="comment">% ------------------------------</span>
1365     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1366     
1367     <span class="comment">% Update the preferences:</span>
1368     <span class="comment">% -----------------------</span>
1369     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1370     guiprefs.mat_path = the_path;
1371     guiprefs.mat_file = the_file;
1372     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1373     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
1374     
1375     [pathstr,filename,extension] = fileparts([guiparams.mat_path guiparams.savefile]);
1376     savefile = fullfile(pathstr,[filename extension]);
1377     <span class="comment">%h = msgbox(['Saving processed data in MAT File ''' filename extension ''''], ...</span>
1378     <span class="comment">%    'Saving Processed Data File...'); %#ok&lt;NASGU&gt;</span>
1379     log_text = {<span class="keyword">...</span>
1380         <span class="string">'Saving Processed Data File...'</span>;<span class="keyword">...</span>
1381         savefile};
1382     statusLogging(handles.LogWindow,log_text)
1383     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
1384 <span class="keyword">end</span>
1385 
1386 <span class="comment">% [EOF] saveDataCallback</span>
1387 
1388 
1389 <span class="comment">% --------------------------------------------------------------------</span>
1390 <a name="_sub47" href="#_subfunctions" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a>
1391 
1392 <span class="comment">% Get the Application data:</span>
1393 <span class="comment">% -------------------------</span>
1394 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1395 z   = guiparams.z;
1396 A   = guiparams.A;
1397 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
1398 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
1399 
1400 <span class="comment">% Compute multibeam bathymetry:</span>
1401 <span class="comment">% -----------------------------</span>
1402 msgbox(<span class="string">'Processing Bathymetry...Please Be Patient'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
1403 <span class="comment">%A = VMT_MBBathy(z,A,savefile,handles.beam_angle,handles.MagneticVariation,handles.WSE);</span>
1404 <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>(z,A,savefile, <span class="keyword">...</span>
1405     guiparams.beam_angle, <span class="keyword">...</span>
1406     guiparams.magnetic_variation, <span class="keyword">...</span>
1407     guiparams.wse, <span class="keyword">...</span>
1408     guiparams.output_auxiliary_data);
1409 
1410 msgbox(<span class="string">'Bathymetry Output Complete'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
1411 
1412 <span class="comment">% [EOF] saveBathymetryCallback</span>
1413 
1414 <span class="comment">% --------------------------------------------------------------------</span>
1415 <a name="_sub48" href="#_subfunctions" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a>
1416 
1417 <span class="comment">% Get the Application data:</span>
1418 <span class="comment">% -------------------------</span>
1419 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1420 
1421 [guiparams.english_units,guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
1422     guiparams.presentation,guiparams.print] = <span class="keyword">...</span>
1423     plotParametersDialog(guiparams.english_units, <span class="keyword">...</span>
1424     guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
1425     guiparams.presentation,guiparams.print,<span class="keyword">...</span>
1426     handles.figure1);
1427 
1428 <span class="comment">% Update the GUI:</span>
1429 <span class="comment">% ---------------</span>
1430 <span class="keyword">if</span> guiparams.english_units
1431     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1432     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1433 <span class="keyword">else</span>
1434     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1435     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1436 <span class="keyword">end</span>
1437 
1438 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
1439     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1440     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1441 <span class="keyword">else</span>
1442     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1443     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1444 <span class="keyword">end</span>
1445 
1446 <span class="keyword">if</span> guiparams.presentation
1447     <a href="#_sub34" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
1448 <span class="comment">%     set(handles.menuStylePrint,           'Checked','off')</span>
1449 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','on')</span>
1450 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','off')</span>
1451 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','on')</span>
1452 <span class="keyword">else</span>
1453     <a href="#_sub33" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
1454 <span class="comment">%     set(handles.menuStylePrint,           'Checked','on')</span>
1455 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','off')</span>
1456 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','on')</span>
1457 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','off')</span>
1458 <span class="keyword">end</span>
1459 
1460 <span class="comment">% Re-store the Application data:</span>
1461 <span class="comment">% ------------------------------</span>
1462 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1463 
1464 <span class="comment">% [EOF] plottingParametersCallback</span>
1465 
1466 
1467 <span class="comment">% --------------------------------------------------------------------</span>
1468 <a name="_sub49" href="#_subfunctions" class="code">function processingParametersCallback(hObject, eventdata, handles)</a>
1469 
1470 <span class="comment">% Get the Application data:</span>
1471 <span class="comment">% -------------------------</span>
1472 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1473 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1474 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1475 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1476 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
1477 
1478 <span class="comment">% [EOF] processingParametersCallback</span>
1479 
1480 
1481 <span class="comment">% --------------------------------------------------------------------</span>
1482 <a name="_sub50" href="#_subfunctions" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a>
1483 <span class="comment">% Plot 1</span>
1484 
1485 <span class="comment">% Get the Application data:</span>
1486 <span class="comment">% -------------------------</span>
1487 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1488 z = guiparams.z;
1489 A = guiparams.A;
1490 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
1491 <span class="comment">% Map = guiparams.Map;</span>
1492 setends = guiparams.set_cross_section_endpoints;
1493 
1494 <span class="comment">% Preprocess the data:</span>
1495 <span class="comment">% --------------------</span>
1496 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
1497 
1498 <span class="comment">% Push messages to Log Window:</span>
1499 <span class="comment">% ----------------------------</span>
1500 log_text = {<span class="keyword">...</span>
1501     <span class="string">'   Preprocessing complete.'</span>;<span class="keyword">...</span>
1502     <span class="string">'   Begin Data Processing...'</span>};
1503 statusLogging(handles.LogWindow, log_text)
1504 
1505 <span class="comment">% Process the transects:</span>
1506 <span class="comment">% ----------------------</span>
1507 A(1).hgns = guiparams.horizontal_grid_node_spacing;
1508 A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
1509 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
1510     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction);
1511 
1512 <span class="comment">% Compute the smoothed variables</span>
1513 <span class="comment">% ------------------------------</span>
1514 <span class="comment">% This is required so that the V struc is complete at any point during</span>
1515 <span class="comment">% runtime.</span>
1516 V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
1517     <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
1518     guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
1519     guiparams.vertical_smoothing_window);
1520 
1521 <span class="comment">% Push messages to Log Window:</span>
1522 <span class="comment">% ----------------------------</span>
1523 statusLogging(handles.LogWindow, processing_log_text)
1524 
1525 <span class="comment">% Store the data:</span>
1526 <span class="comment">% ---------------</span>
1527 guiparams.z = z;
1528 guiparams.A = A;
1529 guiparams.V = V;
1530 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1531 
1532 <span class="comment">% Push messages to Log Window:</span>
1533 <span class="comment">% ----------------------------</span>
1534 log_text = {<span class="string">'Plotting Shiptracks (reprocessing)'</span>};
1535 statusLogging(handles.LogWindow, log_text)
1536 
1537 <span class="comment">% Create or replot the Shiptracks</span>
1538 <span class="comment">% -------------------------------</span>
1539 <span class="comment">% Grab the axes to the plot</span>
1540 <span class="comment">% axes(handles.Plot1Shiptracks);</span>
1541 <a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>(A,V,z,setends,handles.Plot1Shiptracks); <span class="comment">% PLOT 1</span>
1542 
1543 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
1544 <span class="comment">% New plot display window</span>
1545 <span class="comment">% h = VMT_CreatePlotDisplay('shiptracks');</span>
1546 <span class="comment">% h = figure(1); clf</span>
1547 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
1548 
1549 <span class="comment">% [EOF] shiptracksPlotCallback</span>
1550 
1551 
1552 <span class="comment">% --------------------------------------------------------------------</span>
1553 <a name="_sub51" href="#_subfunctions" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a>
1554 <span class="comment">% Plot 2</span>
1555 
1556 <span class="comment">% Get the Application data:</span>
1557 <span class="comment">% -------------------------</span>
1558 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1559 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1560 
1561 <span class="keyword">if</span> iscell(guiparams.mat_file) <span class="comment">% Multiple MAT files loaded</span>
1562     <span class="comment">% Push messages to Log Window:</span>
1563     <span class="comment">% ----------------------------</span>
1564     log_text = {<span class="string">'Plotting Multiple Transects (Planview)'</span>};
1565     statusLogging(handles.LogWindow, log_text)
1566     
1567        
1568     <span class="comment">% Push plotting parameters to log window:</span>
1569     <span class="comment">% ---------------------------------------</span>
1570     log_text = {<span class="keyword">...</span>
1571         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
1572         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
1573         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
1574         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
1575         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
1576         };
1577     statusLogging(handles.LogWindow, log_text)
1578     
1579     <span class="comment">% Plot the data:</span>
1580     <span class="comment">% --------------</span>
1581     z = [];
1582     A = [];
1583     V = [];
1584     Map = [];
1585     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
1586     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
1587         depth_range, <span class="keyword">...</span>
1588         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
1589         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
1590         guiparams.smoothing_window_size, <span class="keyword">...</span>
1591         guiparams.display_shoreline, <span class="keyword">...</span>
1592         guiparams.english_units, <span class="keyword">...</span>
1593         guiparams.mat_file, <span class="keyword">...</span>
1594         guiparams.mat_path); <span class="comment">% PLOT2</span>
1595     statusLogging(handles.LogWindow, log_text)
1596     
1597     <span class="comment">% Plot a Shoreline Map:</span>
1598     <span class="comment">% ---------------------</span>
1599     <span class="keyword">if</span> guiparams.display_shoreline
1600         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
1601             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
1602             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
1603             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
1604         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
1605             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
1606             Map.UTMe   = mapdata(:,1);
1607             Map.UTMn   = mapdata(:,2);
1608             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
1609             <span class="comment">%Map.UTMzone = zone;</span>
1610         <span class="keyword">else</span>
1611             Map = [];
1612         <span class="keyword">end</span>
1613         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
1614         log_text = {<span class="keyword">...</span>
1615             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
1616             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
1617             };
1618         statusLogging(handles.LogWindow, log_text)
1619     <span class="keyword">else</span>
1620         Map = [];
1621     <span class="keyword">end</span>
1622     
1623 <span class="keyword">else</span>
1624     z = guiparams.z;
1625     A = guiparams.A;
1626     <span class="comment">% V = guiparams.V;</span>
1627     Map = guiparams.Map;
1628     
1629     <span class="comment">% Push messages to Log Window:</span>
1630     <span class="comment">% ----------------------------</span>
1631     log_text = {<span class="string">'Plotting Depth Averaged Vectors (reprocessing)'</span>};
1632     statusLogging(handles.LogWindow, log_text)
1633     
1634         
1635     <span class="comment">% Preprocess the data:</span>
1636     <span class="comment">% --------------------</span>
1637     A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
1638     
1639     <span class="comment">% Process the transects:</span>
1640     <span class="comment">% ----------------------</span>
1641     A(1).hgns = guiparams.horizontal_grid_node_spacing;
1642     A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
1643     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
1644         guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction);
1645     
1646     <span class="comment">% Compute the smoothed variables</span>
1647     <span class="comment">% ------------------------------</span>
1648     <span class="comment">% This is required so that the V struc is complete at any point during</span>
1649     <span class="comment">% runtime.</span>
1650     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
1651         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
1652         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
1653         guiparams.vertical_smoothing_window);
1654     
1655     <span class="comment">% Push messages to Log Window:</span>
1656     <span class="comment">% ----------------------------</span>
1657     statusLogging(handles.LogWindow, processing_log_text)
1658     
1659     <span class="comment">% Plot the cross section:</span>
1660     <span class="comment">% -----------------------</span>
1661     log_text = {<span class="keyword">...</span>
1662         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
1663         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
1664         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
1665         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
1666         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
1667         };
1668     statusLogging(handles.LogWindow, log_text)
1669     
1670     <span class="comment">% Plot the data:</span>
1671     <span class="comment">% --------------</span>
1672     <span class="comment">%msgbox('Plotting Plan View','VMT Status','help','replace');</span>
1673     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
1674     
1675     
1676     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
1677         depth_range, <span class="keyword">...</span>
1678         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
1679         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
1680         guiparams.smoothing_window_size, <span class="keyword">...</span>
1681         guiparams.display_shoreline, <span class="keyword">...</span>
1682         guiparams.english_units, <span class="keyword">...</span>
1683         guiparams.mat_file, <span class="keyword">...</span>
1684         guiparams.mat_path); <span class="comment">% PLOT2</span>
1685     statusLogging(handles.LogWindow, log_text)
1686     
1687     <span class="comment">% Plot a Shoreline Map:</span>
1688     <span class="comment">% ---------------------</span>
1689     <span class="keyword">if</span> guiparams.display_shoreline
1690         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
1691             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
1692             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
1693             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
1694         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
1695             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
1696             Map.UTMe   = mapdata(:,1);
1697             Map.UTMn   = mapdata(:,2);
1698             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
1699             <span class="comment">%Map.UTMzone = zone;</span>
1700         <span class="keyword">else</span>
1701             Map = [];
1702         <span class="keyword">end</span>
1703         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
1704         log_text = {<span class="keyword">...</span>
1705             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
1706             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
1707             };
1708         statusLogging(handles.LogWindow, log_text)
1709     <span class="keyword">else</span>
1710         Map = [];
1711     <span class="keyword">end</span>
1712     
1713 <span class="keyword">end</span>
1714 
1715 <span class="keyword">if</span> guiparams.add_background
1716     [guiprefs,log_text] = <a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>(guiprefs);
1717     statusLogging(handles.LogWindow, log_text)
1718 <span class="keyword">end</span>
1719 
1720 <span class="comment">% Update guiparams</span>
1721 <span class="comment">% ----------------</span>
1722 guiparams.z   = z;
1723 guiparams.A   = A;
1724 guiparams.V   = V;
1725 guiparams.Map = Map;
1726 guiparams.iric_anv_planview_data = PVdata;
1727 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams);
1728 
1729 <span class="comment">% Update preferences</span>
1730 <span class="comment">% ------------------</span>
1731 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1732 <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'shoreline'</span>)
1733 <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'aerial'</span>)
1734 
1735 <span class="comment">% Force plot to be formated properly</span>
1736 <span class="comment">% ----------------------------------</span>
1737 <span class="keyword">if</span> guiparams.presentation
1738     <a href="#_sub34" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
1739 <span class="keyword">else</span>
1740     <a href="#_sub33" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
1741 <span class="keyword">end</span>
1742 
1743 <span class="comment">% Start the Graphics Control Gui</span>
1744 <span class="comment">% ------------------------------</span>
1745 VMT_GraphicsControl
1746 
1747 <span class="comment">% [EOF] planviewPlotCallback</span>
1748 
1749 
1750 <span class="comment">% --------------------------------------------------------------------</span>
1751 <a name="_sub52" href="#_subfunctions" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a>
1752 <span class="comment">% Plot 3</span>
1753 
1754 <span class="comment">% Get the Application data:</span>
1755 <span class="comment">% -------------------------</span>
1756 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1757 z = guiparams.z;
1758 A = guiparams.A;
1759 <span class="comment">% V = guiparams.V;</span>
1760 <span class="comment">% Map = guiparams.Map;</span>
1761 
1762 <span class="comment">% Preprocess the data:</span>
1763 <span class="comment">% --------------------</span>
1764 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
1765 
1766 <span class="comment">% Push messages to Log Window:</span>
1767 <span class="comment">% ----------------------------</span>
1768 log_text = {<span class="string">'Plotting Cross Section (reprocessing)'</span>};
1769 statusLogging(handles.LogWindow, log_text)
1770 
1771 <span class="comment">% Process the transects:</span>
1772 <span class="comment">% ----------------------</span>
1773 A(1).hgns = guiparams.horizontal_grid_node_spacing;
1774 A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
1775 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
1776     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction);
1777 
1778 <span class="comment">% Push messages to Log Window:</span>
1779 <span class="comment">% ----------------------------</span>
1780 statusLogging(handles.LogWindow, processing_log_text)
1781 
1782 <span class="comment">% Plot the cross section:</span>
1783 <span class="comment">% -----------------------</span>
1784 log_text = {<span class="keyword">...</span>
1785     <span class="string">'Cross Section Plotting Parameters'</span>;<span class="keyword">...</span>
1786     sprintf(<span class="string">'   Contour variable: %s'</span>          ,guiparams.contours(guiparams.idx_contour).string);<span class="keyword">...</span>
1787     sprintf(<span class="string">'   Vertical exaggeration: %d'</span>     ,guiparams.vertical_exaggeration);<span class="keyword">...</span>
1788     sprintf(<span class="string">'   Vector scale: %3.1f'</span>           ,guiparams.vector_scale_cross_section);<span class="keyword">...</span>
1789     sprintf(<span class="string">'   Horizontal vector spacing: %d'</span> ,guiparams.horizontal_vector_spacing);<span class="keyword">...</span>
1790     sprintf(<span class="string">'   Vertical vector spacing: %d'</span>   ,guiparams.vertical_vector_spacing);<span class="keyword">...</span>
1791     sprintf(<span class="string">'   Horizontal smooting window: %d'</span>,guiparams.horizontal_smoothing_window);<span class="keyword">...</span>
1792     sprintf(<span class="string">'   Vertical smoothing window: %d'</span> ,guiparams.vertical_smoothing_window);<span class="keyword">...</span>
1793     };
1794 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
1795     log_text = vertcat(log_text, {<span class="keyword">...</span>
1796         sprintf(<span class="string">'   Vector variable: %s'</span>,guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).string);<span class="keyword">...</span>
1797         sprintf(<span class="string">'   Inc. vertical component?: %d'</span>,guiparams.include_vertical_velocity)<span class="keyword">...</span>
1798         });
1799 <span class="keyword">end</span>
1800 <span class="comment">% Push messages to Log Window:</span>
1801 <span class="comment">% ----------------------------</span>
1802 statusLogging(handles.LogWindow, log_text)
1803 
1804 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
1805     <span class="comment">%msgbox('Plotting Cross Section','VMT Status','help','replace')</span>
1806 <span class="comment">%     V = VMT_SmoothVar(V, ...</span>
1807 <span class="comment">%         ...guiparams.contour, ...</span>
1808 <span class="comment">%         guiparams.horizontal_smoothing_window, ...</span>
1809 <span class="comment">%         guiparams.vertical_smoothing_window);</span>
1810     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
1811         <span class="keyword">...</span><span class="comment">guiparams.secondary_flow_vector_variable, ...</span>
1812         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
1813         guiparams.vertical_smoothing_window);
1814     [~,A,V,plot_cont_log_text] = <a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,varargin)">VMT_PlotXSContQuiver</a>(z,A,V, <span class="keyword">...</span>
1815         guiparams.contour, <span class="keyword">...</span>
1816         guiparams.vector_scale_cross_section, <span class="keyword">...</span>
1817         guiparams.vertical_exaggeration, <span class="keyword">...</span>
1818         guiparams.horizontal_vector_spacing, <span class="keyword">...</span>
1819         guiparams.vertical_vector_spacing, <span class="keyword">...</span>
1820         guiparams.secondary_flow_vector_variable, <span class="keyword">...</span>
1821         guiparams.include_vertical_velocity, <span class="keyword">...</span>
1822         guiparams.english_units); <span class="comment">%#ok&lt;ASGLU&gt; % PLOT3</span>
1823     
1824 <span class="keyword">elseif</span> ~guiparams.plot_secondary_flow_vectors
1825     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
1826         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
1827         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
1828         guiparams.vertical_smoothing_window);
1829     
1830     [~,A,V,zmin,zmax,plot_cont_log_text] = <a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english)">VMT_PlotXSCont</a>(z,A,V, <span class="keyword">...</span>
1831         guiparams.contour, <span class="keyword">...</span>
1832         guiparams.vertical_exaggeration, <span class="keyword">...</span>
1833         guiparams.english_units);  <span class="comment">%#ok&lt;ASGLU&gt;</span>
1834     
1835     guiparams.zmin = zmin;
1836     guiparams.zmax = zmax;
1837     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1838 <span class="keyword">end</span>
1839 
1840 <span class="comment">% Force plot to be formated properly</span>
1841 <span class="comment">% ----------------------------------</span>
1842 <span class="keyword">if</span> guiparams.presentation
1843     <a href="#_sub34" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
1844 <span class="keyword">else</span>
1845     <a href="#_sub33" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
1846 <span class="keyword">end</span>
1847 
1848 <span class="comment">% Re-store the Application data:</span>
1849 <span class="comment">% ------------------------------</span>
1850 guiparams.V = V;
1851 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1852 
1853 <span class="comment">% Start the Graphics Control Gui</span>
1854 <span class="comment">% ------------------------------</span>
1855 VMT_GraphicsControl
1856 
1857 <span class="comment">% Push messages to Log Window:</span>
1858 <span class="comment">% ----------------------------</span>
1859 statusLogging(handles.LogWindow, plot_cont_log_text)
1860 <span class="comment">% msgbox('Plotting Complete','VMT Status','help','replace')</span>
1861 
1862 <span class="comment">% [EOF] crosssectionPlotCallback</span>
1863 
1864 
1865 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
1866 <span class="comment">% DATA EXPORT CALLBACKS %</span>
1867 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
1868 
1869 <span class="comment">% --------------------------------------------------------------------</span>
1870 <a name="_sub53" href="#_subfunctions" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a>
1871 <span class="comment">% saveDataCallback(hObject, eventdata, handles)</span>
1872 
1873 <span class="comment">% Get the Application data:</span>
1874 <span class="comment">% -------------------------</span>
1875 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1876 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1877 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1878 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1879 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
1880 
1881 [the_file,the_path] = <span class="keyword">...</span>
1882     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
1883     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
1884     fullfile(guiparams.mat_path,guiparams.savefile));
1885 
1886 <span class="comment">% Save the processed data to a MAT file:</span>
1887 <span class="comment">% --------------------------------------</span>
1888 <span class="keyword">if</span> ischar(the_file)
1889     guiparams.mat_path = the_path;
1890     guiparams.mat_file = the_file;
1891     guiparams.savefile = the_file;
1892     
1893     <span class="comment">% Re-store the Application data:</span>
1894     <span class="comment">% ------------------------------</span>
1895     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1896     
1897     <span class="comment">% Update the preferences:</span>
1898     <span class="comment">% -----------------------</span>
1899     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1900     guiprefs.mat_path = the_path;
1901     guiprefs.mat_file = the_file;
1902     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1903     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
1904     
1905     [~,filename,extension] = fileparts(guiparams.savefile);
1906     savefile = [filename extension];
1907     h = msgbox([<span class="string">'Saving processed data in MAT File '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
1908         <span class="string">'Saving Processed Data File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1909     disp(<span class="string">'Saving Processed Data File...'</span>)
1910     disp(savefile)
1911     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
1912 <span class="keyword">end</span>
1913 
1914 <span class="comment">% [EOF] SaveMATFile_Callback</span>
1915 
1916 
1917 <span class="comment">% --------------------------------------------------------------------</span>
1918 <a name="_sub54" href="#_subfunctions" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a>
1919 
1920 <span class="comment">% Get the Application data:</span>
1921 <span class="comment">% -------------------------</span>
1922 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1923 <span class="comment">% z   = guiparams.z;</span>
1924 <span class="comment">% A   = guiparams.A;</span>
1925 V   = guiparams.V;
1926 <span class="comment">% Map = guiparams.Map;</span>
1927 
1928 [the_file,the_path] = <span class="keyword">...</span>
1929     uiputfile({<span class="string">'*.dat'</span>,<span class="string">'Tecplot Files (*.dat)'</span>}, <span class="keyword">...</span>
1930     <span class="string">'Save Tecplot File'</span>, <span class="keyword">...</span>
1931     fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
1932 
1933 <span class="comment">% Output the data (no smoothing) to Tecplot:</span>
1934 <span class="comment">% ------------------------------------------</span>
1935 <span class="keyword">if</span> ischar(the_file)
1936     guiparams.tecplot_path = the_path;
1937     guiparams.tecplot_file = the_file;
1938     
1939     <span class="comment">% Re-store the Application data:</span>
1940     <span class="comment">% ------------------------------</span>
1941     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1942     
1943     <span class="comment">% Update the preferences:</span>
1944     <span class="comment">% -----------------------</span>
1945     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1946     guiprefs.tecplot_path = the_path;
1947     guiprefs.tecplot_file = the_file;
1948     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1949     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'tecplot'</span>)
1950     
1951     <span class="comment">% Push to log window</span>
1952     <span class="comment">% ------------------</span>
1953     log_text = {<span class="keyword">...</span>
1954         <span class="string">'Exporting Data to Tecplot (*.dat) File...'</span>;<span class="keyword">...</span>
1955         <span class="string">'Directory:'</span>;<span class="keyword">...</span>
1956         the_path;<span class="keyword">...</span>
1957         [<span class="string">'Filename: '</span> the_file]};
1958     statusLogging(handles.LogWindow,log_text)
1959         
1960     <span class="keyword">if</span> isempty(V)
1961         A = guiparams.A;
1962         A(1).hgns = guiparams.horizontal_grid_node_spacing;
1963         A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
1964         [~,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
1965             guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
1966             guiparams.unit_discharge_correction);
1967     <span class="keyword">end</span>
1968     <a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
1969     
1970     <span class="comment">% Push to log window</span>
1971     <span class="comment">% ------------------</span>
1972     log_text = {<span class="string">'Exporting XS Bathy Data to Tecplot (*.dat) File...'</span>};
1973     statusLogging(handles.LogWindow,log_text)
1974     
1975     <a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
1976     
1977     <span class="comment">% Push to log window</span>
1978     <span class="comment">% ------------------</span>
1979     log_text = {<span class="string">'Tecplot Export Complete'</span>};
1980     statusLogging(handles.LogWindow,log_text)
1981    
1982 <span class="keyword">end</span>
1983 
1984 <span class="comment">% [EOF] SaveTechplotFile_Callback</span>
1985 
1986 
1987 <span class="comment">% --------------------------------------------------------------------</span>
1988 <a name="_sub55" href="#_subfunctions" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a>
1989 
1990 <span class="comment">% Get the Application data:</span>
1991 <span class="comment">% -------------------------</span>
1992 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1993 <span class="comment">% z   = guiparams.z;</span>
1994 A   = guiparams.A;
1995 V   = guiparams.V;
1996 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
1997 
1998 [the_file,the_path] = <span class="keyword">...</span>
1999     uiputfile({<span class="string">'*.kmz'</span>,<span class="string">'Google Earth Files (*.kmz)'</span>}, <span class="keyword">...</span>
2000     <span class="string">'Save Google Earth File'</span>, <span class="keyword">...</span>
2001     fullfile(guiparams.kmz_path,guiparams.kmz_file));
2002 
2003 <span class="comment">% Save the processed data to a Google Earth (KMZ) file:</span>
2004 <span class="comment">% -----------------------------------------------------</span>
2005 <span class="keyword">if</span> ischar(the_file)
2006     guiparams.kmz_path = the_path;
2007     guiparams.kmz_file = the_file;
2008     
2009     <span class="comment">% Re-store the Application data:</span>
2010     <span class="comment">% ------------------------------</span>
2011     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2012     
2013     <span class="comment">% Update the preferences:</span>
2014     <span class="comment">% -----------------------</span>
2015     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2016     guiprefs.kmz_path = the_path;
2017     guiprefs.kmz_file = the_file;
2018     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2019     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'kmz'</span>)
2020     
2021     <span class="comment">%     if guiparams.display_shoreline</span>
2022     <span class="comment">%         VMT_Shoreline2GE_3D(A,Map, ...</span>
2023     <span class="comment">%                             guiparams.vertical_exaggeration, ...</span>
2024     <span class="comment">%                             guiparams.vertical_offset);</span>
2025     <span class="comment">%     end</span>
2026     <span class="keyword">if</span> isempty(V)
2027         A = guiparams.A;
2028         A(1).hgns = guiparams.horizontal_grid_node_spacing;
2029         A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2030         [~,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2031             guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2032             guiparams.unit_discharge_correction);
2033     <span class="keyword">end</span>
2034     <a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>(A,V,[], <span class="keyword">...</span>
2035         fullfile(guiparams.kmz_path,guiparams.kmz_file), <span class="keyword">...</span>
2036         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2037         guiparams.vertical_offset);
2038 <span class="keyword">end</span>
2039 
2040 <span class="comment">% [EOF] SaveGoogleEarthFile_Callback</span>
2041 
2042 
2043 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2044 <span class="comment">% DATA EXPORT/BATHYMETRY CALLBACKS %</span>
2045 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2046 
2047 <span class="comment">% --------------------------------------------------------------------</span>
2048 <a name="_sub56" href="#_subfunctions" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
2049 
2050 <span class="comment">% Get the Application data:</span>
2051 <span class="comment">% -------------------------</span>
2052 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2053 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2054 
2055 [the_file,the_path] = <span class="keyword">...</span>
2056     uiputfile({<span class="string">'*.csv'</span>,<span class="string">'Multibeam Bathymetry Files (*.csv)'</span>}, <span class="keyword">...</span>
2057     <span class="string">'Export Multibeam Bathymetry'</span>, <span class="keyword">...</span>
2058     fullfile(guiprefs.multibeambathymetry_path, <span class="keyword">...</span>
2059     guiprefs.multibeambathymetry_file));
2060 
2061 <span class="keyword">if</span> ischar(the_file)
2062     guiparams.multibeambathymetry_path = the_path;
2063     guiparams.multibeambathymetry_file = the_file;
2064     
2065     <span class="comment">% Re-store the Application data:</span>
2066     <span class="comment">% ------------------------------</span>
2067     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2068     
2069     <span class="comment">% Update the preferences:</span>
2070     <span class="comment">% -----------------------</span>
2071     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2072     guiprefs.multibeambathymetry_path = the_path;
2073     guiprefs.multibeambathymetry_file = the_file;
2074     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2075     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'multibeambathymetry'</span>)
2076     
2077     <span class="keyword">if</span> guiparams.output_auxiliary_data
2078     <span class="keyword">end</span>
2079     
2080     <span class="comment">%msgbox('Processing Bathymetry...Please Be Patient','VMT Status','help','replace')</span>
2081     
2082     savefile = fullfile(guiparams.multibeambathymetry_path, <span class="keyword">...</span>
2083         guiparams.multibeambathymetry_file);
2084     
2085     log_text = {<span class="string">'Multibeam bathymetry file saved to:'</span>;<span class="keyword">...</span>
2086         [<span class="string">'   '</span> savefile]};
2087     statusLogging(handles.LogWindow,log_text)
2088     
2089     <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>(guiparams.z, <span class="keyword">...</span>
2090         guiparams.A, <span class="keyword">...</span>
2091         savefile, <span class="keyword">...</span>
2092         guiparams.beam_angle, <span class="keyword">...</span>
2093         guiparams.magnetic_variation, <span class="keyword">...</span>
2094         guiparams.wse, <span class="keyword">...</span>
2095         guiparams.output_auxiliary_data);
2096     
2097     <span class="comment">%msgbox('Bathymetry Output Complete','VMT Status','help','replace')</span>
2098     
2099 <span class="keyword">end</span>
2100 
2101 <span class="comment">% [EOF] ExportMultibeamBathymetry_Callback</span>
2102 
2103 
2104 <span class="comment">% --------------------------------------------------------------------</span>
2105 <a name="_sub57" href="#_subfunctions" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a>
2106 <span class="comment">% Get the beam angle</span>
2107 
2108 <span class="comment">% Get the Application data:</span>
2109 <span class="comment">% -------------------------</span>
2110 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2111 
2112 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2113 <span class="comment">% ----------------------------------------------------------------</span>
2114 new_beam_angle = str2double(get(hObject,<span class="string">'String'</span>));
2115 is_a_number = ~isnan(new_beam_angle);
2116 is_positive = new_beam_angle&gt;=0;
2117 
2118 <span class="comment">% Modify the Application data:</span>
2119 <span class="comment">% ----------------------------</span>
2120 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2121     guiparams.beam_angle = new_beam_angle;
2122     
2123     <span class="comment">% Re-store the Application data:</span>
2124     <span class="comment">% ------------------------------</span>
2125     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2126     
2127 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2128     set(hObject,<span class="string">'String'</span>,guiparams.beam_angle)
2129 <span class="keyword">end</span>
2130 
2131 <span class="comment">% [EOF] BeamAngle_Callback</span>
2132 
2133 
2134 <span class="comment">% --------------------------------------------------------------------</span>
2135 <a name="_sub58" href="#_subfunctions" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a>
2136 <span class="comment">% Get the Magnetic Variation</span>
2137 
2138 <span class="comment">% Get the Application data:</span>
2139 <span class="comment">% -------------------------</span>
2140 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2141 
2142 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2143 <span class="comment">% ----------------------------------------------------------------</span>
2144 new_magnetic_variation = str2double(get(hObject,<span class="string">'String'</span>));
2145 is_a_number = ~isnan(new_magnetic_variation);
2146 is_positive = new_magnetic_variation&gt;=0;
2147 
2148 <span class="comment">% Modify the Application data:</span>
2149 <span class="comment">% ----------------------------</span>
2150 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2151     guiparams.magnetic_variation = new_magnetic_variation;
2152     
2153     <span class="comment">% Re-store the Application data:</span>
2154     <span class="comment">% ------------------------------</span>
2155     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2156     
2157 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2158     set(hObject,<span class="string">'String'</span>,guiparams.magnetic_variation)
2159 <span class="keyword">end</span>
2160 
2161 <span class="comment">% [EOF] MagneticVariation_Callback</span>
2162 
2163 
2164 <span class="comment">% --------------------------------------------------------------------</span>
2165 <a name="_sub59" href="#_subfunctions" class="code">function WSE_Callback(hObject, eventdata, handles)</a>
2166 
2167 <span class="comment">% Get the Application data:</span>
2168 <span class="comment">% -------------------------</span>
2169 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2170 
2171 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2172 <span class="comment">% ----------------------------------------------------------------</span>
2173 new_wse = str2double(get(hObject,<span class="string">'String'</span>));
2174 is_a_number = ~isnan(new_wse);
2175 is_positive = new_wse&gt;=0;
2176 
2177 <span class="comment">% Modify the Application data:</span>
2178 <span class="comment">% ----------------------------</span>
2179 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2180     guiparams.wse = new_wse;
2181     
2182     <span class="comment">% Re-store the Application data:</span>
2183     <span class="comment">% ------------------------------</span>
2184     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2185     
2186 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2187     set(hObject,<span class="string">'String'</span>,guiparams.wse)
2188 <span class="keyword">end</span>
2189 
2190 <span class="comment">% [EOF] WSE_Callback</span>
2191 
2192 
2193 <span class="comment">% --------------------------------------------------------------------</span>
2194 <a name="_sub60" href="#_subfunctions" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a>
2195 <span class="comment">% Bathymetry Auxillary Data</span>
2196 
2197 <span class="comment">% Get the Application data:</span>
2198 <span class="comment">% -------------------------</span>
2199 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2200 
2201 <span class="comment">% Modify the Application data:</span>
2202 <span class="comment">% ----------------------------</span>
2203 guiparams.output_auxiliary_data = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2204 
2205 <span class="comment">% Re-store the Application data:</span>
2206 <span class="comment">% ------------------------------</span>
2207 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2208 
2209 <span class="comment">% [EOF] OutputAuxiliaryData_Callback</span>
2210 
2211 
2212 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2213 <span class="comment">% PLOTTING/PLAN VIEW PLOT CALLBACKS %</span>
2214 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2215 
2216 <span class="comment">% --------------------------------------------------------------------</span>
2217 <a name="_sub61" href="#_subfunctions" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a>
2218 
2219 <span class="comment">% Get the Application data:</span>
2220 <span class="comment">% -------------------------</span>
2221 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2222 
2223 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2224 <span class="comment">% ----------------------------------------------------------------</span>
2225 new_depth_range_min = str2double(get(hObject,<span class="string">'String'</span>));
2226 is_a_number = ~isnan(new_depth_range_min);
2227 is_positive = new_depth_range_min&gt;=0;
2228 
2229 <span class="comment">% Modify the Application data:</span>
2230 <span class="comment">% ----------------------------</span>
2231 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2232     guiparams.depth_range_min = new_depth_range_min;
2233     
2234     <span class="comment">% Re-store the Application data:</span>
2235     <span class="comment">% ------------------------------</span>
2236     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2237     
2238 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2239     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_min)
2240 <span class="keyword">end</span>
2241 
2242 <span class="comment">% [EOF] DepthRangeMin_Callback</span>
2243 
2244 
2245 <span class="comment">% --------------------------------------------------------------------</span>
2246 <a name="_sub62" href="#_subfunctions" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a>
2247 
2248 <span class="comment">% Get the Application data:</span>
2249 <span class="comment">% -------------------------</span>
2250 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2251 
2252 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2253 <span class="comment">% ----------------------------------------------------------------</span>
2254 new_depth_range_max = str2double(get(hObject,<span class="string">'String'</span>));
2255 is_a_number = ~isnan(new_depth_range_max);
2256 is_positive = new_depth_range_max&gt;=0;
2257 
2258 <span class="comment">% Modify the Application data:</span>
2259 <span class="comment">% ----------------------------</span>
2260 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2261     guiparams.depth_range_max = new_depth_range_max;
2262     
2263     <span class="comment">% Re-store the Application data:</span>
2264     <span class="comment">% ------------------------------</span>
2265     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2266     
2267 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2268     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_max)
2269 <span class="keyword">end</span>
2270 
2271 <span class="comment">% [EOF] DepthMax_Callback</span>
2272 
2273 
2274 <span class="comment">% --------------------------------------------------------------------</span>
2275 <a name="_sub63" href="#_subfunctions" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a>
2276 <span class="comment">% Set quiver scale (contour)</span>
2277 
2278 <span class="comment">% Get the Application data:</span>
2279 <span class="comment">% -------------------------</span>
2280 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2281 
2282 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2283 <span class="comment">% ----------------------------------------------------------------</span>
2284 new_vector_scale_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
2285 is_a_number = ~isnan(new_vector_scale_plan_view);
2286 is_positive = new_vector_scale_plan_view&gt;=0;
2287 
2288 <span class="comment">% Modify the Application data:</span>
2289 <span class="comment">% ----------------------------</span>
2290 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2291     guiparams.vector_scale_plan_view = round(new_vector_scale_plan_view);
2292     
2293     <span class="comment">% Re-store the Application data:</span>
2294     <span class="comment">% ------------------------------</span>
2295     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2296     
2297 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2298     set(hObject,<span class="string">'String'</span>,guiparams.vector_scale_plan_view)
2299 <span class="keyword">end</span>
2300 
2301 <span class="comment">% [EOF] VectorScalePlanView_Callback</span>
2302 
2303 
2304 <span class="comment">% --------------------------------------------------------------------</span>
2305 <a name="_sub64" href="#_subfunctions" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a>
2306 <span class="comment">% Set quiver spacing (contour, horizontal)</span>
2307 
2308 <span class="comment">% Get the Application data:</span>
2309 <span class="comment">% -------------------------</span>
2310 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2311 
2312 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2313 <span class="comment">% ----------------------------------------------------------------</span>
2314 new_vector_spacing_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
2315 is_a_number = ~isnan(new_vector_spacing_plan_view);
2316 is_positive = new_vector_spacing_plan_view&gt;=0;
2317 
2318 <span class="comment">% Modify the Application data:</span>
2319 <span class="comment">% ----------------------------</span>
2320 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2321     guiparams.vector_spacing_plan_view = round(new_vector_spacing_plan_view);
2322     
2323     <span class="comment">% Re-store the Application data:</span>
2324     <span class="comment">% ------------------------------</span>
2325     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2326     
2327 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2328     set(hObject,<span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
2329 <span class="keyword">end</span>
2330 
2331 <span class="comment">% [EOF] VectorSpacingPlanview_Callback</span>
2332 
2333 
2334 <span class="comment">% --------------------------------------------------------------------</span>
2335 <a name="_sub65" href="#_subfunctions" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a>
2336 <span class="comment">% Plan View smoothing window size</span>
2337 
2338 <span class="comment">% Get the Application data:</span>
2339 <span class="comment">% -------------------------</span>
2340 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2341 
2342 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2343 <span class="comment">% ----------------------------------------------------------------</span>
2344 new_smoothing_window_size = str2double(get(hObject,<span class="string">'String'</span>));
2345 is_a_number = ~isnan(new_smoothing_window_size);
2346 is_positive = new_smoothing_window_size&gt;=0;
2347 
2348 <span class="comment">% Modify the Application data:</span>
2349 <span class="comment">% ----------------------------</span>
2350 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2351     guiparams.smoothing_window_size = round(new_smoothing_window_size);
2352     
2353     <span class="comment">% Re-store the Application data:</span>
2354     <span class="comment">% ------------------------------</span>
2355     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2356     
2357 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2358     set(hObject,<span class="string">'String'</span>,guiparams.smoothing_window_size)
2359 <span class="keyword">end</span>
2360 
2361 <span class="comment">% [EOF] SmoothingWindowSize_Callback</span>
2362 
2363 
2364 <span class="comment">% --------------------------------------------------------------------</span>
2365 <a name="_sub66" href="#_subfunctions" class="code">function DisplayShoreline_Callback(hObject, eventdata, handles)</a>
2366 
2367 <span class="comment">% Get the Application data:</span>
2368 <span class="comment">% -------------------------</span>
2369 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2370 
2371 <span class="comment">% Modify the Application data:</span>
2372 <span class="comment">% ----------------------------</span>
2373 guiparams.display_shoreline = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2374 
2375 <span class="comment">% Re-store the Application data:</span>
2376 <span class="comment">% ------------------------------</span>
2377 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2378 
2379 <span class="comment">% [EOF] DisplayShoreline_Callback</span>
2380 
2381 
2382 <span class="comment">% --------------------------------------------------------------------</span>
2383 <a name="_sub67" href="#_subfunctions" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a>
2384 
2385 <span class="comment">% Get the Application data:</span>
2386 <span class="comment">% -------------------------</span>
2387 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2388 
2389 <span class="comment">% Modify the Application data:</span>
2390 <span class="comment">% ----------------------------</span>
2391 guiparams.add_background = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2392 
2393 <span class="comment">% Re-store the Application data:</span>
2394 <span class="comment">% ------------------------------</span>
2395 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2396 
2397 <span class="comment">% [EOF] AddBackground_Callback</span>
2398 
2399 
2400 <span class="comment">% --------------------------------------------------------------------</span>
2401 <a name="_sub68" href="#_subfunctions" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a>
2402 <a href="#_sub51" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
2403 <span class="comment">% [EOF] PlotPlanView_Callback</span>
2404 
2405 
2406 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2407 <span class="comment">% PLOTTING/SHIP TRACKS PLOT CALLBACKS %</span>
2408 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2409 
2410 <span class="comment">% --------------------------------------------------------------------</span>
2411 <a name="_sub69" href="#_subfunctions" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a>
2412 <span class="comment">% Set the horizontal grid node spacing</span>
2413 
2414 <span class="comment">% Get the Application data:</span>
2415 <span class="comment">% -------------------------</span>
2416 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2417 
2418 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2419 <span class="comment">% ----------------------------------------------------------------</span>
2420 new_horizontal_grid_node_spacing = str2double(get(hObject,<span class="string">'String'</span>));
2421 is_a_number = ~isnan(new_horizontal_grid_node_spacing);
2422 is_positive = new_horizontal_grid_node_spacing&gt;=0;
2423 
2424 <span class="comment">% Modify the Application data:</span>
2425 <span class="comment">% ----------------------------</span>
2426 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2427     guiparams.horizontal_grid_node_spacing = round(new_horizontal_grid_node_spacing);
2428     
2429     <span class="comment">% Re-store the Application data:</span>
2430     <span class="comment">% ------------------------------</span>
2431     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2432     
2433 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2434     set(hObject,<span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
2435 <span class="keyword">end</span>
2436 
2437 <span class="comment">% [EOF] HorizontalGridNodeSpacing_Callback</span>
2438 
2439 
2440 <span class="comment">% --------------------------------------------------------------------</span>
2441 <a name="_sub70" href="#_subfunctions" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
2442 <span class="comment">% Set the cross section endpoints manually</span>
2443 
2444 <span class="comment">% Get the Application data:</span>
2445 <span class="comment">% -------------------------</span>
2446 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2447 
2448 <span class="comment">% Modify the Application data:</span>
2449 <span class="comment">% ----------------------------</span>
2450 guiparams.set_cross_section_endpoints = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2451 
2452 <span class="comment">% Re-store the Application data:</span>
2453 <span class="comment">% ------------------------------</span>
2454 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2455 
2456 <span class="comment">% [EOF] SetCrossSectionEndpoints_Callback</span>
2457 
2458 
2459 <span class="comment">% --------------------------------------------------------------------</span>
2460 <a name="_sub71" href="#_subfunctions" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a>
2461 <a href="#_sub50" class="code" title="subfunction shiptracksPlotCallback(hObject, eventdata, handles)">shiptracksPlotCallback</a>(hObject, eventdata, handles)
2462 <span class="comment">% [EOF] PlotShiptracks_Callback</span>
2463 
2464 
2465 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2466 <span class="comment">% PLOTTING/CROSS SECTION PLOT CALLBACKS %</span>
2467 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2468 
2469 <span class="comment">% --------------------------------------------------------------------</span>
2470 <a name="_sub72" href="#_subfunctions" class="code">function Contour_Callback(hObject, eventdata, handles)</a>
2471 
2472 <span class="comment">% Get the Application data:</span>
2473 <span class="comment">% -------------------------</span>
2474 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2475 
2476 <span class="comment">% Modify the Application data:</span>
2477 <span class="comment">% ----------------------------</span>
2478 idx_variable = get(hObject,<span class="string">'Value'</span>);
2479 guiparams.idx_contour = idx_variable;
2480 guiparams.contour = guiparams.contours(idx_variable).variable;
2481 
2482 <span class="comment">% Re-store the Application data:</span>
2483 <span class="comment">% ------------------------------</span>
2484 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2485 
2486 <span class="comment">% [EOF] Contour_Callback</span>
2487 
2488 
2489 <span class="comment">% --------------------------------------------------------------------</span>
2490 <a name="_sub73" href="#_subfunctions" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a>
2491 <span class="comment">% Set vertical exaggeration</span>
2492 
2493 <span class="comment">% Get the Application data:</span>
2494 <span class="comment">% -------------------------</span>
2495 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2496 
2497 <span class="comment">% Modify the Application data:</span>
2498 <span class="comment">% ----------------------------</span>
2499 guiparams.vertical_exaggeration = str2double(get(hObject,<span class="string">'String'</span>));
2500 
2501 <span class="comment">% Re-store the Application data:</span>
2502 <span class="comment">% ------------------------------</span>
2503 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2504 
2505 <span class="comment">% Update the GUI:</span>
2506 <span class="comment">% ---------------</span>
2507 <span class="comment">% updateGUI(handles,guiparams)</span>
2508 
2509 <span class="comment">% [EOF] VerticalExaggeration_Callback</span>
2510 
2511 
2512 <span class="comment">% --------------------------------------------------------------------</span>
2513 <a name="_sub74" href="#_subfunctions" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a>
2514 
2515 <span class="comment">% Get the Application data:</span>
2516 <span class="comment">% -------------------------</span>
2517 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2518 
2519 <span class="comment">% Modify the Application data:</span>
2520 <span class="comment">% ----------------------------</span>
2521 guiparams.vector_scale_cross_section = str2double(get(hObject,<span class="string">'String'</span>));
2522 
2523 <span class="comment">% Re-store the Application data:</span>
2524 <span class="comment">% ------------------------------</span>
2525 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2526 
2527 <span class="comment">% Update the GUI:</span>
2528 <span class="comment">% ---------------</span>
2529 <span class="comment">% updateGUI(handles,guiparams)</span>
2530 
2531 <span class="comment">% [EOF] VectorScaleCrossSection_Callback</span>
2532 
2533 
2534 <span class="comment">% --------------------------------------------------------------------</span>
2535 <a name="_sub75" href="#_subfunctions" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a>
2536 
2537 <span class="comment">% Get the Application data:</span>
2538 <span class="comment">% -------------------------</span>
2539 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2540 
2541 <span class="comment">% Modify the Application data:</span>
2542 <span class="comment">% ----------------------------</span>
2543 guiparams.horizontal_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
2544 
2545 <span class="comment">% Re-store the Application data:</span>
2546 <span class="comment">% ------------------------------</span>
2547 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2548 
2549 <span class="comment">% Update the GUI:</span>
2550 <span class="comment">% ---------------</span>
2551 <span class="comment">% updateGUI(handles,guiparams)</span>
2552 
2553 <span class="comment">% [EOF] HorizontalVectorSpacing_Callback</span>
2554 
2555 
2556 <span class="comment">% --------------------------------------------------------------------</span>
2557 <a name="_sub76" href="#_subfunctions" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a>
2558 <span class="comment">% Get the vertical quiver spacing for contour plots</span>
2559 
2560 <span class="comment">% Get the Application data:</span>
2561 <span class="comment">% -------------------------</span>
2562 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2563 
2564 <span class="comment">% Modify the Application data:</span>
2565 <span class="comment">% ----------------------------</span>
2566 guiparams.vertical_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
2567 
2568 <span class="comment">% Re-store the Application data:</span>
2569 <span class="comment">% ------------------------------</span>
2570 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2571 
2572 <span class="comment">% Update the GUI:</span>
2573 <span class="comment">% ---------------</span>
2574 <span class="comment">% updateGUI(handles,guiparams)</span>
2575 
2576 <span class="comment">% [EOF] VerticalVectorSpacing_Callback</span>
2577 
2578 
2579 <span class="comment">% --------------------------------------------------------------------</span>
2580 <a name="_sub77" href="#_subfunctions" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
2581 <span class="comment">% Horizontal Smoothing</span>
2582 
2583 <span class="comment">% Get the Application data:</span>
2584 <span class="comment">% -------------------------</span>
2585 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2586 
2587 <span class="comment">% Modify the Application data:</span>
2588 <span class="comment">% ----------------------------</span>
2589 guiparams.horizontal_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
2590 
2591 <span class="comment">% Re-store the Application data:</span>
2592 <span class="comment">% ------------------------------</span>
2593 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2594 
2595 <span class="comment">% Update the GUI:</span>
2596 <span class="comment">% ---------------</span>
2597 <span class="comment">% updateGUI(handles,guiparams)</span>
2598 
2599 <span class="comment">% [EOF] HorizontalSmoothingWindow_Callback</span>
2600 
2601 
2602 <span class="comment">% --------------------------------------------------------------------</span>
2603 <a name="_sub78" href="#_subfunctions" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
2604 <span class="comment">% Vertical Smoothing</span>
2605 
2606 <span class="comment">% Get the Application data:</span>
2607 <span class="comment">% -------------------------</span>
2608 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2609 
2610 <span class="comment">% Modify the Application data:</span>
2611 <span class="comment">% ----------------------------</span>
2612 guiparams.vertical_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
2613 
2614 <span class="comment">% Re-store the Application data:</span>
2615 <span class="comment">% ------------------------------</span>
2616 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2617 
2618 <span class="comment">% Update the GUI:</span>
2619 <span class="comment">% ---------------</span>
2620 <span class="comment">% updateGUI(handles,guiparams)</span>
2621 
2622 <span class="comment">% [EOF] VerticalSmoothingWindow_Callback</span>
2623 
2624 
2625 <span class="comment">% --------------------------------------------------------------------</span>
2626 <a name="_sub79" href="#_subfunctions" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a>
2627 
2628 <span class="comment">% Get the Application data:</span>
2629 <span class="comment">% -------------------------</span>
2630 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2631 
2632 <span class="comment">% Modify the Application data:</span>
2633 <span class="comment">% ----------------------------</span>
2634 guiparams.plot_secondary_flow_vectors = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2635 
2636 <span class="comment">% Re-store the Application data:</span>
2637 <span class="comment">% ------------------------------</span>
2638 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2639 
2640 <span class="comment">% [EOF] PlotSecondaryFlowVectors_Callback</span>
2641 
2642 
2643 <span class="comment">% --------------------------------------------------------------------</span>
2644 <a name="_sub80" href="#_subfunctions" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a>
2645 
2646 <span class="comment">% Get the Application data:</span>
2647 <span class="comment">% -------------------------</span>
2648 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2649 
2650 <span class="comment">% Modify the Application data:</span>
2651 <span class="comment">% ----------------------------</span>
2652 idx_variable = get(hObject,<span class="string">'Value'</span>);
2653 guiparams.idx_secondary_flow_vector_variable = idx_variable;
2654 guiparams.secondary_flow_vector_variable = guiparams.secondary_flows(idx_variable).variable;
2655 
2656 <span class="comment">% Re-store the Application data:</span>
2657 <span class="comment">% ------------------------------</span>
2658 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2659 
2660 <span class="comment">% [EOF] SecondaryFlowVectorVariable_Callback</span>
2661 
2662 
2663 <span class="comment">% --------------------------------------------------------------------</span>
2664 <a name="_sub81" href="#_subfunctions" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a>
2665 
2666 <span class="comment">% Get the Application data:</span>
2667 <span class="comment">% -------------------------</span>
2668 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2669 
2670 <span class="comment">% Modify the Application data:</span>
2671 <span class="comment">% ----------------------------</span>
2672 guiparams.include_vertical_velocity = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2673 
2674 <span class="comment">% Re-store the Application data:</span>
2675 <span class="comment">% ------------------------------</span>
2676 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2677 
2678 <span class="comment">% [EOF] IncludeVerticalVelocity_Callback</span>
2679 
2680 
2681 <span class="comment">% --------------------------------------------------------------------</span>
2682 <a name="_sub82" href="#_subfunctions" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a>
2683 <a href="#_sub52" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
2684 <span class="comment">% [EOF] PlotCrossSection_Callback</span>
2685 
2686 
2687 <span class="comment">% --------------------------------------------------------------------</span>
2688 <a name="_sub83" href="#_subfunctions" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a>
2689 set(handles.LogWindow,<span class="string">'string'</span>,<span class="string">''</span>)
2690 <span class="comment">% [EOF] ClearLog_Callback</span>
2691 
2692 <span class="comment">% --------------------------------------------------------------------</span>
2693 <a name="_sub84" href="#_subfunctions" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a>
2694 
2695 <span class="comment">% Get the Application data:</span>
2696 <span class="comment">% -------------------------</span>
2697 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2698 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2699 <span class="comment">% z   = guiparams.z;   %#ok&lt;NASGU&gt;</span>
2700 <span class="comment">% A   = guiparams.A;   %#ok&lt;NASGU&gt;</span>
2701 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
2702 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
2703 
2704 [the_file,the_path] = <span class="keyword">...</span>
2705     uiputfile({<span class="string">'*.txt'</span>,<span class="string">'TXT-Files (*.txt)'</span>}, <span class="keyword">...</span>
2706     <span class="string">'Choose where to save the log file'</span>, <span class="keyword">...</span>
2707     fullfile(guiprefs.log_path,guiprefs.log_file));
2708 
2709 <span class="comment">% Save the log to a TXT file:</span>
2710 <span class="comment">% ---------------------------</span>
2711 <span class="keyword">if</span> ischar(the_file)
2712     guiparams.log_path = the_path;
2713     guiparams.log_file = the_file;
2714     <span class="comment">%guiparams.savefile = the_file;</span>
2715     
2716     <span class="comment">% Re-store the Application data:</span>
2717     <span class="comment">% ------------------------------</span>
2718     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2719     
2720     <span class="comment">% Update the preferences:</span>
2721     <span class="comment">% -----------------------</span>
2722     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2723     guiprefs.log_path = the_path;
2724     guiprefs.log_file = the_file;
2725     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2726     <a href="#_sub87" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'log'</span>)
2727     
2728     [~,filename,extension] = fileparts(the_file);
2729     savefile = [the_path filename extension];
2730     h = msgbox([<span class="string">'Saving log to: '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
2731         <span class="string">'Saving Log File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2732     
2733     logfile = get(handles.LogWindow,<span class="string">'string'</span>);
2734     [nrows,~]= size(logfile);
2735     fid = fopen(savefile, <span class="string">'w'</span>);
2736     <span class="keyword">for</span> row=1:nrows
2737         fprintf(fid, <span class="string">'%s \n'</span>, logfile{row,:});
2738     <span class="keyword">end</span>
2739     fclose(fid);
2740 <span class="keyword">end</span>
2741 <span class="comment">% [EOF] SaveLog_Callback</span>
2742 
2743 <span class="comment">%%%%%%%%%%%%%%%%</span>
2744 <span class="comment">% SUBFUNCTIONS %</span>
2745 <span class="comment">%%%%%%%%%%%%%%%%</span>
2746 
2747 <span class="comment">% --------------------------------------------------------------------</span>
2748 <a name="_sub85" href="#_subfunctions" class="code">function handles = buildToolbar(handles)</a>
2749 
2750 icons = <a href="#_sub101" class="code" title="subfunction icons = getIcons">getIcons</a>;
2751 ht = uitoolbar(<span class="string">'Parent'</span>,handles.figure1);
2752 
2753 <span class="comment">% Load data</span>
2754 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_open.png');</span>
2755 <span class="comment">% icon = double(icon)/(2^16-1);</span>
2756 <span class="comment">% icon(icon==0) = NaN;</span>
2757 handles.toolbarLoadData = <span class="keyword">...</span>
2758     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
2759     <span class="string">'CData'</span>,        icons(1).data, <span class="keyword">...</span>
2760     <span class="string">'TooltipString'</span>,<span class="string">'Open ASCII File'</span>);
2761 
2762 <span class="comment">% Save data</span>
2763 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_save.png');</span>
2764 <span class="comment">% icon = double(icon)/(2^16-1);</span>
2765 <span class="comment">% icon(icon==0) = NaN;</span>
2766 handles.toolbarSaveMatFile = <span class="keyword">...</span>
2767     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
2768     <span class="string">'CData'</span>,        icons(2).data, <span class="keyword">...</span>
2769     <span class="string">'TooltipString'</span>,<span class="string">'Save MAT File'</span>, <span class="keyword">...</span>
2770     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
2771 
2772 
2773 <span class="comment">% Save bathymetry</span>
2774 <span class="comment">%icon = ones(16,16,3);</span>
2775 handles.toolbarSaveBathymetry = <span class="keyword">...</span>
2776     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
2777     <span class="string">'CData'</span>,        icons(5).data, <span class="keyword">...</span>
2778     <span class="string">'TooltipString'</span>,<span class="string">'Export Bathymetry'</span>);
2779 
2780 <span class="comment">% Save figures</span>
2781 <span class="comment">% icon = ones(16,16,3);</span>
2782 handles.toolbarSaveFigures = <span class="keyword">...</span>
2783     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
2784     <span class="string">'CData'</span>,        icons(6).data, <span class="keyword">...</span>
2785     <span class="string">'TooltipString'</span>,<span class="string">'Export Figures'</span>);
2786 
2787 <span class="comment">% Save Excel File</span>
2788 <span class="comment">% icon = ones(16,16,3);</span>
2789 handles.toolbarSaveExcel = <span class="keyword">...</span>
2790     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
2791     <span class="string">'CData'</span>,        icons(7).data, <span class="keyword">...</span>
2792     <span class="string">'TooltipString'</span>,<span class="string">'Export Excel File'</span>);
2793 
2794 
2795 <span class="comment">% Plotting parameters</span>
2796 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\PlotGeneralElement.gif');</span>
2797 <span class="comment">% icon = ind2rgb(icon,map);</span>
2798 handles.toolbarPlottingParameters = <span class="keyword">...</span>
2799     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
2800     <span class="string">'CData'</span>,        icons(3).data, <span class="keyword">...</span>
2801     <span class="string">'TooltipString'</span>,<span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
2802     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
2803 
2804 <span class="comment">% Processing parameters</span>
2805 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
2806 <span class="comment">% icon = ind2rgb(icon,map);</span>
2807 handles.toolbarProcessingParameters = <span class="keyword">...</span>
2808     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
2809     <span class="string">'CData'</span>,        icons(4).data, <span class="keyword">...</span>
2810     <span class="string">'TooltipString'</span>,<span class="string">'Processing Parameters'</span>);
2811 
2812 <span class="comment">% % Plot 1: Shiptracks</span>
2813 <span class="comment">% handles.shiptracksPlot = ...</span>
2814 <span class="comment">%     uipushtool('Parent',       ht, ...</span>
2815 <span class="comment">%                'CData',        icon, ...</span>
2816 <span class="comment">%                'TooltipString','Shiptracks plot', ...</span>
2817 <span class="comment">%                'Separator',    'on');</span>
2818 <span class="comment">%</span>
2819 <span class="comment">% % Plot 2: Plan view</span>
2820 <span class="comment">% handles.planviewPlot = ...</span>
2821 <span class="comment">%     uipushtool('Parent',       ht, ...</span>
2822 <span class="comment">%                'CData',        icon, ...</span>
2823 <span class="comment">%                'TooltipString','Plan view plot');</span>
2824 <span class="comment">%</span>
2825 <span class="comment">% % Plot 3: Cross section</span>
2826 <span class="comment">% handles.crosssectionPlot = ...</span>
2827 <span class="comment">%     uipushtool('Parent',       ht, ...</span>
2828 <span class="comment">%                'CData',        icon, ...</span>
2829 <span class="comment">%                'TooltipString','Cross section plot');</span>
2830 
2831 set(handles.toolbarLoadData,            <span class="string">'ClickedCallback'</span>,{@<a href="#_sub45" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>,handles})
2832 set(handles.toolbarSaveMatFile,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub46" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>,handles})
2833 set(handles.toolbarSaveBathymetry,      <span class="string">'ClickedCallback'</span>,{@<a href="#_sub56" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>,handles})
2834 set(handles.toolbarSaveFigures,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub17" class="code" title="subfunction menuExportFigures_Callback(hObject, eventdata, handles)">menuExportFigures_Callback</a>,handles})
2835 set(handles.toolbarSaveExcel,           <span class="string">'ClickedCallback'</span>,{@<a href="#_sub21" class="code" title="subfunction menuSaveExcel_Callback(hObject, eventdata, handles)">menuSaveExcel_Callback</a>,handles})
2836 set(handles.toolbarPlottingParameters,  <span class="string">'ClickedCallback'</span>,{@<a href="#_sub48" class="code" title="subfunction plottingParametersCallback(hObject, eventdata, handles)">plottingParametersCallback</a>,handles})
2837 set(handles.toolbarProcessingParameters,<span class="string">'ClickedCallback'</span>,{@<a href="#_sub49" class="code" title="subfunction processingParametersCallback(hObject, eventdata, handles)">processingParametersCallback</a>,handles})
2838 <span class="comment">% set(handles.shiptracksPlot,      'ClickedCallback',{@shiptracksPlotCallback,handles})</span>
2839 <span class="comment">% set(handles.planviewPlot,        'ClickedCallback',{@planviewPlotCallback,handles})</span>
2840 <span class="comment">% set(handles.crosssectionPlot,    'ClickedCallback',{@crosssectionPlotCallback,handles})</span>
2841 
2842 <span class="comment">% [EOF] buildtoolbar</span>
2843 
2844 
2845 <span class="comment">% --------------------------------------------------------------------</span>
2846 <a name="_sub86" href="#_subfunctions" class="code">function load_prefs(hfigure)</a>
2847 <span class="comment">% Load the GUI preferences.  Also, initialize preferences if they don't</span>
2848 <span class="comment">% already exist.</span>
2849 
2850 <span class="comment">% Preferences:</span>
2851 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
2852 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
2853 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
2854 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
2855 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
2856 <span class="comment">% 'log'                  Path and filename of last Log file</span>
2857 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
2858 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
2859 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
2860 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
2861 
2862 <span class="comment">% Originals</span>
2863 <span class="comment">% prefs = {'ascii2gispath' 'ascii2kmlpath' 'asciipath'   'doqqpath' ...</span>
2864 <span class="comment">%          'endspath'      'logpath'       'matpath'     'savedpath' ...</span>
2865 <span class="comment">%          'shorepath'     'stapath'       'ysidatapath' 'ysidatapath'};</span>
2866 
2867 <span class="comment">% ASCII</span>
2868 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>)
2869     ascii = getpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>);
2870     <span class="keyword">if</span> exist(ascii.path,<span class="string">'dir'</span>)
2871         guiprefs.ascii_path = ascii.path;
2872     <span class="keyword">else</span>
2873         guiprefs.ascii_path = pwd;
2874     <span class="keyword">end</span>
2875     does_exist = false(1,length(ascii.file));
2876     <span class="keyword">for</span> k = 1:length(ascii.file) <span class="comment">% Check each file one-by-one</span>
2877         does_exist(k) = exist(fullfile(ascii.path,ascii.file{k}),<span class="string">'file'</span>);
2878     <span class="keyword">end</span>
2879     <span class="keyword">if</span> any(does_exist)
2880         guiprefs.ascii_file = ascii.file(does_exist);
2881     <span class="keyword">else</span>
2882         guiprefs.ascii_file = {<span class="string">''</span>};
2883     <span class="keyword">end</span>
2884 <span class="keyword">else</span> <span class="comment">% Initialize ASCII</span>
2885     guiprefs.ascii_path = pwd;
2886     guiprefs.ascii_file = {<span class="string">''</span>};
2887     
2888     ascii.path = pwd;
2889     ascii.file = {<span class="string">''</span>};
2890     setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
2891 <span class="keyword">end</span>
2892 
2893 <span class="comment">% MAT</span>
2894 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>)
2895     mat = getpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>);
2896     <span class="keyword">if</span> exist(mat.path,<span class="string">'dir'</span>)
2897         guiprefs.mat_path = mat.path;
2898     <span class="keyword">else</span>
2899         guiprefs.mat_path = pwd;
2900     <span class="keyword">end</span>
2901     
2902     <span class="keyword">if</span> iscell(mat.file)
2903         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file{1}),<span class="string">'file'</span>)
2904             guiprefs.mat_file = mat.file;
2905         <span class="keyword">else</span>
2906             guiprefs.mat_file = <span class="string">''</span>;
2907         <span class="keyword">end</span>
2908     <span class="keyword">else</span>
2909         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file),<span class="string">'file'</span>)
2910             guiprefs.mat_file = mat.file;
2911         <span class="keyword">else</span>
2912             guiprefs.mat_file = <span class="string">''</span>;
2913         <span class="keyword">end</span>
2914     <span class="keyword">end</span>
2915 <span class="keyword">else</span> <span class="comment">% Initialize MAT</span>
2916     guiprefs.mat_path = pwd;
2917     guiprefs.mat_file = <span class="string">''</span>;
2918     
2919     mat.path = pwd;
2920     mat.file = <span class="string">''</span>;
2921     setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
2922 <span class="keyword">end</span>
2923 
2924 <span class="comment">% TECPLOT</span>
2925 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>)
2926     tecplot = getpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>);
2927     <span class="keyword">if</span> exist(tecplot.path,<span class="string">'dir'</span>)
2928         guiprefs.tecplot_path = tecplot.path;
2929     <span class="keyword">else</span>
2930         guiprefs.tecplot_path = pwd;
2931     <span class="keyword">end</span>
2932     <span class="keyword">if</span> exist(fullfile(tecplot.path,tecplot.file),<span class="string">'file'</span>)
2933         guiprefs.tecplot_file = tecplot.file;
2934     <span class="keyword">else</span>
2935         guiprefs.tecplot_file = <span class="string">''</span>;
2936     <span class="keyword">end</span>
2937 <span class="keyword">else</span> <span class="comment">% Initialize TECPLOT</span>
2938     guiprefs.tecplot_path = pwd;
2939     guiprefs.tecplot_file = <span class="string">''</span>;
2940     
2941     tecplot.path = pwd;
2942     tecplot.file = <span class="string">''</span>;
2943     setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
2944 <span class="keyword">end</span>
2945 
2946 <span class="comment">% KMZ</span>
2947 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>)
2948     kmz = getpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>);
2949     <span class="keyword">if</span> exist(kmz.path,<span class="string">'dir'</span>)
2950         guiprefs.kmz_path = kmz.path;
2951     <span class="keyword">else</span>
2952         guiprefs.kmz_path = pwd;
2953     <span class="keyword">end</span>
2954     <span class="keyword">if</span> exist(fullfile(kmz.path,kmz.file),<span class="string">'file'</span>)
2955         guiprefs.kmz_file = kmz.file;
2956     <span class="keyword">else</span>
2957         guiprefs.kmz_file = <span class="string">''</span>;
2958     <span class="keyword">end</span>
2959 <span class="keyword">else</span> <span class="comment">% Initialize KMZ</span>
2960     guiprefs.kmz_path = pwd;
2961     guiprefs.kmz_file = <span class="string">''</span>;
2962     
2963     kmz.path = pwd;
2964     kmz.file = <span class="string">''</span>;
2965     setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
2966 <span class="keyword">end</span>
2967 
2968 <span class="comment">% MULTIBEAM BATHYMETRY</span>
2969 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>)
2970     multibeambathymetry = getpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>);
2971     <span class="keyword">if</span> exist(multibeambathymetry.path,<span class="string">'dir'</span>)
2972         guiprefs.multibeambathymetry_path = multibeambathymetry.path;
2973     <span class="keyword">else</span>
2974         guiprefs.multibeambathymetry_path = pwd;
2975     <span class="keyword">end</span>
2976     <span class="keyword">if</span> exist(fullfile(multibeambathymetry.path,multibeambathymetry.file),<span class="string">'file'</span>)
2977         guiprefs.multibeambathymetry_file = multibeambathymetry.file;
2978     <span class="keyword">else</span>
2979         guiprefs.multibeambathymetry_file = <span class="string">''</span>;
2980     <span class="keyword">end</span>
2981 <span class="keyword">else</span> <span class="comment">% Initialize MULTIBEAM BATHYMETRY</span>
2982     guiprefs.multibeambathymetry_path = pwd;
2983     guiprefs.multibeambathymetry_file = <span class="string">''</span>;
2984     
2985     multibeambathymetry.path = pwd;
2986     multibeambathymetry.file = <span class="string">''</span>;
2987     setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
2988 <span class="keyword">end</span>
2989 
2990 <span class="comment">% Log</span>
2991 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'log'</span>)
2992     log = getpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>);
2993     <span class="keyword">if</span> exist(log.path,<span class="string">'dir'</span>)
2994         guiprefs.log_path = log.path;
2995     <span class="keyword">else</span>
2996         guiprefs.log_path = pwd;
2997     <span class="keyword">end</span>
2998     <span class="keyword">if</span> exist(fullfile(log.path,log.file),<span class="string">'file'</span>)
2999         guiprefs.log_file = log.file;
3000     <span class="keyword">else</span>
3001         guiprefs.log_file = <span class="string">''</span>;
3002     <span class="keyword">end</span>
3003 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
3004     guiprefs.log_path = pwd;
3005     guiprefs.log_file = <span class="string">''</span>;
3006     
3007     log.path = pwd;
3008     log.file = <span class="string">''</span>;
3009     setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
3010 <span class="keyword">end</span>
3011 
3012 <span class="comment">% iRic</span>
3013 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>)
3014     iric = getpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>);
3015     <span class="keyword">if</span> exist(iric.path,<span class="string">'dir'</span>)
3016         guiprefs.iric_path = iric.path;
3017     <span class="keyword">else</span>
3018         guiprefs.iric_path = pwd;
3019     <span class="keyword">end</span>
3020     <span class="keyword">if</span> exist(fullfile(iric.path,iric.file),<span class="string">'file'</span>)
3021         guiprefs.iric_file = iric.file;
3022     <span class="keyword">else</span>
3023         guiprefs.iric_file = <span class="string">''</span>;
3024     <span class="keyword">end</span>
3025 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
3026     guiprefs.iric_path = pwd;
3027     guiprefs.iric_file = <span class="string">''</span>;
3028     
3029     iric.path = pwd;
3030     iric.file = <span class="string">''</span>;
3031     setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
3032 <span class="keyword">end</span>
3033 
3034 <span class="comment">% excel</span>
3035 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>)
3036     excel = getpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>);
3037     <span class="keyword">if</span> exist(excel.path,<span class="string">'dir'</span>)
3038         guiprefs.excel_path = excel.path;
3039     <span class="keyword">else</span>
3040         guiprefs.excel_path = pwd;
3041     <span class="keyword">end</span>
3042     <span class="keyword">if</span> exist(fullfile(excel.path,excel.file),<span class="string">'file'</span>)
3043         guiprefs.excel_file = excel.file;
3044     <span class="keyword">else</span>
3045         guiprefs.excel_file = <span class="string">''</span>;
3046     <span class="keyword">end</span>
3047 <span class="keyword">else</span> <span class="comment">% Initialize pref</span>
3048     guiprefs.excel_path = pwd;
3049     guiprefs.excel_file = <span class="string">''</span>;
3050     
3051     excel.path = pwd;
3052     excel.file = <span class="string">''</span>;
3053     setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
3054 <span class="keyword">end</span>
3055 
3056 <span class="comment">% aerial</span>
3057 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>)
3058     aerial = getpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>);
3059     <span class="keyword">if</span> exist(aerial.path,<span class="string">'dir'</span>)
3060         guiprefs.aerial_path = aerial.path;
3061     <span class="keyword">else</span>
3062         guiprefs.aerial_path = pwd;
3063     <span class="keyword">end</span>
3064     does_exist = false(1,length(aerial.file));
3065     <span class="keyword">if</span> iscell(aerial.file)
3066     <span class="keyword">for</span> k = 1:numel(aerial.file) <span class="comment">% Check each file one-by-one</span>
3067         does_exist(k) = exist(fullfile(aerial.path,aerial.file{k}),<span class="string">'file'</span>);
3068     <span class="keyword">end</span>
3069     <span class="keyword">else</span>
3070         does_exist = exist(fullfile(aerial.path,aerial.file),<span class="string">'file'</span>);
3071     <span class="keyword">end</span>
3072     <span class="keyword">if</span> any(does_exist)
3073         guiprefs.aerial_file = aerial.file;
3074     <span class="keyword">else</span>
3075         guiprefs.aerial_file = {<span class="string">''</span>};
3076     <span class="keyword">end</span>
3077 <span class="keyword">else</span> <span class="comment">% Initialize aerial</span>
3078     guiprefs.aerial_path = pwd;
3079     guiprefs.aerial_file = {<span class="string">''</span>};
3080     
3081     aerial.path = pwd;
3082     aerial.file = {<span class="string">''</span>};
3083     setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
3084 <span class="keyword">end</span>
3085 
3086 <span class="comment">% shoreline</span>
3087 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>)
3088     shoreline = getpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>);
3089     <span class="keyword">if</span> exist(shoreline.path,<span class="string">'dir'</span>)
3090         guiprefs.shoreline_path = shoreline.path;
3091     <span class="keyword">else</span>
3092         guiprefs.shoreline_path = pwd;
3093     <span class="keyword">end</span>
3094     
3095     <span class="keyword">if</span> iscell(shoreline.file)
3096         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file{1}),<span class="string">'file'</span>)
3097             guiprefs.shoreline_file = shoreline.file;
3098         <span class="keyword">else</span>
3099             guiprefs.shoreline_file = <span class="string">''</span>;
3100         <span class="keyword">end</span>
3101     <span class="keyword">else</span>
3102         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file),<span class="string">'file'</span>)
3103             guiprefs.shoreline_file = shoreline.file;
3104         <span class="keyword">else</span>
3105             guiprefs.shoreline_file = <span class="string">''</span>;
3106         <span class="keyword">end</span>
3107     <span class="keyword">end</span>
3108 <span class="keyword">else</span> <span class="comment">% Initialize shoreline</span>
3109     guiprefs.shoreline_path = pwd;
3110     guiprefs.shoreline_file = <span class="string">''</span>;
3111     
3112     shoreline.path = pwd;
3113     shoreline.file = <span class="string">''</span>;
3114     setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
3115 <span class="keyword">end</span>
3116 <span class="comment">% guiprefs.presentation = true;</span>
3117 <span class="comment">% guiprefs.print        = false;</span>
3118 
3119 <span class="comment">% for k = 1:length(prefs)</span>
3120 <span class="comment">%     newpref = '';</span>
3121 <span class="comment">%     if ispref('VMT',prefs{k})</span>
3122 <span class="comment">%         stored_newpref = getpref('VMT',prefs{k});</span>
3123 <span class="comment">%         if exist(stored_newpref,'dir')</span>
3124 <span class="comment">%             newpref = stored_newpref;</span>
3125 <span class="comment">%         else</span>
3126 <span class="comment">%             setpref('VMT',prefs{k},newpref)</span>
3127 <span class="comment">%         end</span>
3128 <span class="comment">%     end</span>
3129 <span class="comment">%     guiprefs.(prefs{k}) = newpref;</span>
3130 <span class="comment">% end</span>
3131 
3132 setappdata(hfigure,<span class="string">'guiprefs'</span>,guiprefs)
3133 
3134 <span class="comment">% [EOF] load_prefs</span>
3135 
3136 
3137 <span class="comment">% --------------------------------------------------------------------</span>
3138 <a name="_sub87" href="#_subfunctions" class="code">function store_prefs(hfigure,pref)</a>
3139 <span class="comment">% Store preferences in the Application data and in the persistent</span>
3140 <span class="comment">% preferences data.</span>
3141 
3142 <span class="comment">% Preferences:</span>
3143 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
3144 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
3145 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
3146 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
3147 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
3148 <span class="comment">% 'log'                  Path and filename of last Log file</span>
3149 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
3150 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
3151 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
3152 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
3153 
3154 guiprefs = getappdata(hfigure,<span class="string">'guiprefs'</span>);
3155 
3156 <span class="keyword">switch</span> pref
3157     <span class="keyword">case</span> <span class="string">'ascii'</span>
3158         ascii.path = guiprefs.ascii_path;
3159         ascii.file = guiprefs.ascii_file;
3160         setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
3161     <span class="keyword">case</span> <span class="string">'mat'</span>
3162         mat.path = guiprefs.mat_path;
3163         mat.file = guiprefs.mat_file;
3164         setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
3165     <span class="keyword">case</span> <span class="string">'tecplot'</span>
3166         tecplot.path = guiprefs.tecplot_path;
3167         tecplot.file = guiprefs.tecplot_file;
3168         setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
3169     <span class="keyword">case</span> <span class="string">'kmz'</span>
3170         kmz.path = guiprefs.kmz_path;
3171         kmz.file = guiprefs.kmz_file;
3172         setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
3173     <span class="keyword">case</span> <span class="string">'multibeambathymetry'</span>
3174         multibeambathymetry.path = guiprefs.multibeambathymetry_path;
3175         multibeambathymetry.file = guiprefs.multibeambathymetry_file;
3176         setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
3177     <span class="keyword">case</span> <span class="string">'log'</span>
3178         log.path = guiprefs.log_path;
3179         log.file = guiprefs.log_file;
3180         setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
3181     <span class="keyword">case</span> <span class="string">'iric'</span>
3182         iric.path = guiprefs.iric_path;
3183         iric.file = guiprefs.iric_file;
3184         setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
3185     <span class="keyword">case</span> <span class="string">'excel'</span>
3186         excel.path = guiprefs.excel_path;
3187         excel.file = guiprefs.excel_file;
3188         setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
3189     <span class="keyword">case</span> <span class="string">'aerial'</span>
3190         aerial.path = guiprefs.aerial_path;
3191         aerial.file = guiprefs.aerial_file;
3192         setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
3193     <span class="keyword">case</span> <span class="string">'shoreline'</span>
3194         shoreline.path = guiprefs.shoreline_path;
3195         shoreline.file = guiprefs.shoreline_file;
3196         setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
3197     <span class="keyword">otherwise</span>
3198 <span class="keyword">end</span>
3199 
3200 <span class="comment">% if ismember(pref,prefs)</span>
3201 <span class="comment">%     setpref('VMT',pref,value)</span>
3202 <span class="comment">%</span>
3203 <span class="comment">%     guiprefs = getappdata(hfigure,'guiprefs');</span>
3204 <span class="comment">%     guiprefs.(pref) = value;</span>
3205 <span class="comment">%     setappdata(hfigure,'guiprefs',guiprefs)</span>
3206 <span class="comment">% end</span>
3207 
3208 <span class="comment">% [EOF] store_prefs</span>
3209 
3210 
3211 <span class="comment">% --------------------------------------------------------------------</span>
3212 <a name="_sub88" href="#_subfunctions" class="code">function initGUI(handles)</a>
3213 <span class="comment">% Initialize the UI controls in the GUI.</span>
3214 
3215 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3216 
3217 <span class="comment">% Set the name and version</span>
3218 set(handles.figure1,<span class="string">'Name'</span>,[<span class="string">'Velocity Mapping Toolbox (VMT) '</span> guiparams.vmt_version], <span class="keyword">...</span>
3219     <span class="string">'DockControls'</span>,<span class="string">'off'</span>)
3220 <span class="comment">%set(handles.VMTversion,             'String',guiparams.vmt_version)</span>
3221 
3222 <span class="comment">% Set the PLOT 1 axis labels</span>
3223 axes(handles.Plot1Shiptracks);
3224 set(handles.Plot1Shiptracks,<span class="string">'DataAspectRatio'</span>,[1 1 1],<span class="string">'PlotBoxAspectRatio'</span>,[1 1 1])
3225 xlabel(<span class="string">'UTM Easting (m)'</span>)
3226 ylabel(<span class="string">'UTM Northing (m)'</span>)
3227 box on
3228 grid on
3229 <span class="comment">% ticks_format('%6.0f','%8.0f'); %formats the ticks for UTM</span>
3230 
3231 <span class="comment">%%%%%%%%%%%%</span>
3232 <span class="comment">% MENU BAR %</span>
3233 <span class="comment">%%%%%%%%%%%%</span>
3234 <span class="keyword">if</span> guiparams.english_units
3235     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3236     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
3237 <span class="keyword">else</span>
3238     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3239     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
3240 <span class="keyword">end</span>
3241 
3242 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
3243     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
3244     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3245 <span class="keyword">else</span>
3246     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
3247     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3248 <span class="keyword">end</span>
3249 
3250 
3251 <span class="keyword">if</span> guiparams.print
3252     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3253     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
3254     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3255     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3256 <span class="keyword">elseif</span> guiparams.presentation
3257     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3258     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
3259     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3260     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3261 <span class="keyword">else</span>
3262 <span class="keyword">end</span>
3263 
3264 
3265 <span class="comment">%%%%%%%%%%%%%%%</span>
3266 <span class="comment">% DATA EXPORT %</span>
3267 <span class="comment">%%%%%%%%%%%%%%%</span>
3268 <span class="comment">% BathymetryPanel</span>
3269 <span class="comment">% set(handles.BeamAngle,                  'String',guiparams.beam_angle)</span>
3270 <span class="comment">% set(handles.MagneticVariation,          'String',guiparams.magnetic_variation)</span>
3271 <span class="comment">% set(handles.WSE,                        'String',guiparams.wse)</span>
3272 <span class="comment">% set(handles.OutputAuxiliaryData,        'Value', guiparams.output_auxiliary_data)</span>
3273 
3274 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
3275 <span class="comment">% PLOTTING/PLAN VIEW %</span>
3276 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
3277 <span class="comment">% PlanViewPanel</span>
3278 set(handles.DepthRangeMin,              <span class="string">'String'</span>,guiparams.depth_range_min)
3279 set(handles.DepthRangeMax,              <span class="string">'String'</span>,guiparams.depth_range_max)
3280 set(handles.VectorScalePlanView,        <span class="string">'String'</span>,guiparams.vector_scale_plan_view)
3281 set(handles.VectorSpacingPlanview,      <span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
3282 set(handles.SmoothingWindowSize,        <span class="string">'String'</span>,guiparams.smoothing_window_size)
3283 set(handles.DisplayShoreline,           <span class="string">'Value'</span>, guiparams.display_shoreline)
3284 set(handles.AddBackground,              <span class="string">'Value'</span>, guiparams.add_background)
3285 
3286 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
3287 <span class="comment">% PLOTTING/SHIP TRACKS %</span>
3288 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
3289 <span class="comment">% ShiptracksPanel</span>
3290 set(handles.HorizontalGridNodeSpacing,  <span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
3291 <span class="comment">%set(handles.SetCrossSectionEndpoints,   'Value', guiparams.set_cross_section_endpoints)</span>
3292 
3293 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3294 <span class="comment">% PLOTTING/CROSS SECTIONS %</span>
3295 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3296 <span class="comment">% CrossSectionsPanel</span>
3297 set(handles.Contour,                    <span class="string">'String'</span>,{guiparams.contours.string}, <span class="keyword">...</span>
3298     <span class="string">'Value'</span>, guiparams.idx_contour)
3299 set(handles.VerticalExaggeration,       <span class="string">'String'</span>,guiparams.vertical_exaggeration)
3300 set(handles.VectorScaleCrossSection,    <span class="string">'String'</span>,guiparams.vector_scale_cross_section)
3301 set(handles.HorizontalVectorSpacing,    <span class="string">'String'</span>,guiparams.horizontal_vector_spacing)
3302 set(handles.VerticalVectorSpacing,      <span class="string">'String'</span>,guiparams.vertical_vector_spacing)
3303 set(handles.HorizontalSmoothingWindow,  <span class="string">'String'</span>,guiparams.horizontal_smoothing_window)
3304 set(handles.VerticalSmoothingWindow,    <span class="string">'String'</span>,guiparams.vertical_smoothing_window)
3305 set(handles.PlotSecondaryFlowVectors,   <span class="string">'Value'</span>, guiparams.plot_secondary_flow_vectors)
3306 set(handles.SecondaryFlowVectorVariable,<span class="string">'String'</span>,{guiparams.secondary_flows.string}, <span class="keyword">...</span>
3307     <span class="string">'Value'</span>, guiparams.idx_secondary_flow_vector_variable)
3308 set(handles.IncludeVerticalVelocity,    <span class="string">'Value'</span>, guiparams.include_vertical_velocity)
3309 
3310 <span class="comment">% set(handles.EnglishUnits,               'Value',guiparams.english_units)</span>
3311 
3312 <span class="comment">% [EOF] initGUI</span>
3313 
3314 
3315 <span class="comment">% --------------------------------------------------------------------</span>
3316 <a name="_sub89" href="#_subfunctions" class="code">function set_enable(handles,enable_state)</a>
3317 
3318 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3319 
3320 <span class="keyword">switch</span> enable_state
3321     <span class="keyword">case</span> <span class="string">'init'</span>
3322         set([handles.menuFile
3323             handles.menuOpen
3324             handles.menuOpenASCII
3325             handles.menuOpenMAT
3326             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3327         
3328         set([handles.toolbarLoadData
3329             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3330         set([handles.toolbarSaveMatFile
3331             handles.toolbarSaveBathymetry
3332             handles.toolbarSaveFigures
3333             handles.toolbarSaveExcel
3334             handles.toolbarPlottingParameters
3335             handles.toolbarProcessingParameters
3336             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3337         
3338         set([handles.DepthRangeMin
3339             handles.DepthRangeMax
3340             handles.VectorScalePlanView
3341             handles.VectorSpacingPlanview
3342             handles.SmoothingWindowSize
3343             handles.DisplayShoreline
3344             handles.AddBackground
3345             handles.PlotPlanView
3346             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3347         
3348         set([handles.HorizontalGridNodeSpacing
3349             handles.PlotShiptracks
3350             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3351         
3352         set([handles.Contour
3353             handles.VerticalExaggeration
3354             handles.VectorScaleCrossSection
3355             handles.HorizontalVectorSpacing
3356             handles.VerticalVectorSpacing
3357             handles.HorizontalSmoothingWindow
3358             handles.VerticalSmoothingWindow
3359             handles.PlotSecondaryFlowVectors
3360             handles.SecondaryFlowVectorVariable
3361             handles.IncludeVerticalVelocity
3362             handles.PlotCrossSection
3363             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3364         
3365     <span class="keyword">case</span> <span class="string">'fileloaded'</span>
3366         set([handles.menuFile
3367             handles.menuOpen
3368             handles.menuOpenASCII
3369             handles.menuOpenMAT
3370             handles.menuSaveMAT
3371             handles.menuSaveTecplot
3372             handles.menuSaveKMZFile
3373             handles.menuParameters
3374             handles.menuPlottingParameters
3375             handles.menuMetric
3376             handles.menuEnglish
3377             handles.menuBathymetryExportSettings
3378             handles.menuExportMultibeamBathymetry
3379             handles.menuKMZExport
3380             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3381         
3382         set([handles.toolbarLoadData
3383             handles.toolbarSaveMatFile
3384             handles.toolbarSaveBathymetry
3385             handles.toolbarSaveExcel
3386             handles.toolbarSaveFigures
3387             handles.toolbarPlottingParameters
3388             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3389         set([handles.toolbarProcessingParameters
3390             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3391         
3392            
3393         set([handles.DepthRangeMin
3394             handles.DepthRangeMax
3395             handles.VectorScalePlanView
3396             handles.VectorSpacingPlanview
3397             handles.SmoothingWindowSize
3398             handles.DisplayShoreline
3399             handles.PlotPlanView
3400             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3401         <span class="keyword">if</span> guiparams.has_mapping_toolbox
3402             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3403         <span class="keyword">else</span>
3404             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3405         <span class="keyword">end</span>
3406         
3407         set([handles.HorizontalGridNodeSpacing
3408             handles.PlotShiptracks
3409             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3410         
3411         set([handles.Contour
3412             handles.VerticalExaggeration
3413             handles.VectorScaleCrossSection
3414             handles.HorizontalVectorSpacing
3415             handles.VerticalVectorSpacing
3416             handles.HorizontalSmoothingWindow
3417             handles.VerticalSmoothingWindow
3418             handles.PlotSecondaryFlowVectors
3419             handles.SecondaryFlowVectorVariable
3420             handles.IncludeVerticalVelocity
3421             handles.PlotCrossSection
3422             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3423     <span class="keyword">case</span> <span class="string">'multiplematfiles'</span>
3424         set([handles.menuFile
3425             handles.menuOpen
3426             handles.menuOpenASCII
3427             handles.menuOpenMAT
3428             handles.menuParameters
3429             handles.menuPlottingParameters
3430             handles.menuMetric
3431             handles.menuEnglish
3432             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3433         set([handles.menuSaveMAT
3434             handles.menuBathymetryExportSettings
3435             handles.menuExportMultibeamBathymetry
3436             handles.menuKMZExport
3437             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3438         
3439         set([handles.toolbarLoadData
3440             handles.toolbarSaveFigures
3441             handles.toolbarPlottingParameters
3442             handles.toolbarSaveExcel
3443             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3444         set([handles.toolbarProcessingParameters
3445             handles.toolbarSaveMatFile
3446             handles.toolbarSaveBathymetry
3447             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3448         
3449         set([handles.DepthRangeMin
3450             handles.DepthRangeMax
3451             handles.VectorScalePlanView
3452             handles.VectorSpacingPlanview
3453             handles.SmoothingWindowSize
3454             handles.DisplayShoreline
3455             handles.PlotPlanView
3456             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3457         <span class="keyword">if</span> guiparams.has_mapping_toolbox
3458             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3459         <span class="keyword">else</span>
3460             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3461         <span class="keyword">end</span>
3462         
3463         set([handles.HorizontalGridNodeSpacing
3464             handles.PlotShiptracks
3465             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3466         
3467         set([handles.Contour
3468             handles.VerticalExaggeration
3469             handles.VectorScaleCrossSection
3470             handles.HorizontalVectorSpacing
3471             handles.VerticalVectorSpacing
3472             handles.HorizontalSmoothingWindow
3473             handles.VerticalSmoothingWindow
3474             handles.PlotSecondaryFlowVectors
3475             handles.SecondaryFlowVectorVariable
3476             handles.IncludeVerticalVelocity
3477             handles.PlotCrossSection
3478             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3479     <span class="keyword">otherwise</span>
3480 <span class="keyword">end</span>
3481 
3482 <span class="comment">% [EOF] set_enable</span>
3483 
3484 <span class="comment">%% Compute the longitudinal dispersion coefficient</span>
3485 
3486 <span class="comment">%% --- Executes on button press in zerosecq_chkbox.</span>
3487 <span class="comment">%function zerosecq_chkbox_Callback(hObject, eventdata, handles)</span>
3488 <span class="comment">% hObject    handle to zerosecq_chkbox (see GCBO)</span>
3489 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
3490 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
3491 
3492 <span class="comment">% Hint: get(hObject,'Value') returns toggle state of zerosecq_chkbox</span>
3493 
3494 
3495 <span class="comment">% --------------------------------------------------------------------</span>
3496 <a name="_sub90" href="#_subfunctions" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] = </a><span class="keyword">...</span>
3497     plotParametersDialog(english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style,hf)
3498 
3499 w = 500;
3500 h = 110;
3501 dx = 10;
3502 dy = 35;
3503 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
3504 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
3505     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
3506     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
3507     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
3508     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
3509     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
3510     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
3511     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3512     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
3513     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
3514     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
3515 dialog_params.english_units               = english_units;
3516 dialog_params.set_cross_section_endpoints = set_cross_section_endpoints;
3517 dialog_params.presentation                = plot_presentation_style; <span class="comment">%presentation;</span>
3518 dialog_params.print                       = plot_print_style; <span class="comment">%print;</span>
3519 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3520 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
3521 
3522 <span class="comment">% Build the graphics:</span>
3523 <span class="comment">% -------------------</span>
3524 handles.UnitsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
3525     <span class="string">'Title'</span>, <span class="string">'Units'</span>, <span class="keyword">...</span>
3526     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3527     <span class="string">'Position'</span>,[dx dy (w-3*dx)/3 h-dx-dy+10]);
3528 handles.UnitsMetric = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3529     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
3530     <span class="string">'String'</span>,<span class="string">'Metric'</span>, <span class="keyword">...</span>
3531     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3532     <span class="string">'Position'</span>,[15 35 100 22]);
3533 handles.UnitsEnglish = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3534     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
3535     <span class="string">'String'</span>,<span class="string">'English'</span>, <span class="keyword">...</span>
3536     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3537     <span class="string">'Position'</span>,[15 10 100 22]);
3538 
3539 handles.EndpointsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
3540     <span class="string">'Title'</span>, <span class="string">'Cross-Section Endpoints'</span>, <span class="keyword">...</span>
3541     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3542     <span class="string">'Position'</span>,[(w+dx)/3 dy (w-3*dx)/3 h-dx-dy+10]);
3543 handles.EndpointsAutomatic = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3544     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
3545     <span class="string">'String'</span>,<span class="string">'Automatic'</span>, <span class="keyword">...</span>
3546     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3547     <span class="string">'Position'</span>,[15 35 100 22]);
3548 handles.EndpointsManual = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3549     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
3550     <span class="string">'String'</span>,<span class="string">'Set Manually'</span>, <span class="keyword">...</span>
3551     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3552     <span class="string">'Position'</span>,[15 10 100 22]);
3553 
3554 handles.StylePanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
3555     <span class="string">'Title'</span>, <span class="string">'Plot Style'</span>, <span class="keyword">...</span>
3556     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3557     <span class="string">'Position'</span>,[w-w/3 dy (w-3*dx)/3 h-dx-dy+10]);
3558 handles.StylePresentation = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3559     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
3560     <span class="string">'String'</span>,<span class="string">'Presentation'</span>, <span class="keyword">...</span>
3561     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3562     <span class="string">'Position'</span>,[15 35 100 22]);
3563 handles.StylePrint = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3564     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
3565     <span class="string">'String'</span>,<span class="string">'Print'</span>, <span class="keyword">...</span>
3566     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3567     <span class="string">'Position'</span>,[15 10 100 22]);
3568 
3569 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
3570     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
3571     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
3572     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
3573     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
3574 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
3575     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
3576     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
3577     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
3578     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
3579 
3580 <span class="comment">% Update the UI controls:</span>
3581 <span class="comment">% -----------------------</span>
3582 <span class="keyword">if</span> dialog_params.english_units
3583     set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
3584     set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
3585 <span class="keyword">else</span>
3586     set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
3587     set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
3588 <span class="keyword">end</span>
3589 <span class="keyword">if</span> dialog_params.set_cross_section_endpoints
3590     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
3591     set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
3592 <span class="keyword">else</span>
3593     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
3594     set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
3595 <span class="keyword">end</span>
3596 <span class="keyword">if</span> dialog_params.presentation
3597     set(handles.StylePresentation, <span class="string">'Value'</span>,1)
3598     set(handles.StylePrint,        <span class="string">'Value'</span>,0)
3599 <span class="keyword">else</span>
3600     set(handles.StylePresentation, <span class="string">'Value'</span>,0)
3601     set(handles.StylePrint,        <span class="string">'Value'</span>,1)
3602 <span class="keyword">end</span>
3603 
3604 <span class="comment">% Set the callbacks:</span>
3605 <span class="comment">% ------------------</span>
3606 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub96" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
3607 set(handles.UnitsMetric,       <span class="string">'Callback'</span>,       {@<a href="#_sub91" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'metric'</span>})
3608 set(handles.UnitsEnglish,      <span class="string">'Callback'</span>,       {@<a href="#_sub91" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'english'</span>})
3609 set(handles.EndpointsAutomatic,<span class="string">'Callback'</span>,       {@<a href="#_sub92" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'auto'</span>})
3610 set(handles.EndpointsManual,   <span class="string">'Callback'</span>,       {@<a href="#_sub92" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'manual'</span>})
3611 set(handles.StylePresentation, <span class="string">'Callback'</span>,       {@<a href="#_sub93" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'presentation'</span>})
3612 set(handles.StylePrint,        <span class="string">'Callback'</span>,       {@<a href="#_sub93" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'print'</span>})
3613 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub94" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
3614 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub95" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
3615 
3616 <span class="comment">% Position the dialog and make it visible:</span>
3617 <span class="comment">% ----------------------------------------</span>
3618 fpos = get(hf,<span class="string">'Position'</span>);
3619 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
3620 movegui(handles.Figure,dpos)
3621 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
3622 
3623 <span class="comment">% Hold the dialog open:</span>
3624 <span class="comment">% ---------------------</span>
3625 waitfor(handles.OK)
3626 
3627 <span class="comment">% Return the outputs and close the dialog:</span>
3628 <span class="comment">% ----------------------------------------</span>
3629 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3630 english_units = dialog_params.english_units;
3631 set_cross_section_endpoints = dialog_params.set_cross_section_endpoints;
3632 plot_presentation_style =  dialog_params.presentation;
3633 plot_print_style =  dialog_params.print;
3634 
3635 delete(handles.Figure)
3636 
3637 <span class="comment">% [EOF] plotParametersDialog</span>
3638 
3639 
3640 <span class="comment">% --------------------------------------------------------------------</span>
3641 <a name="_sub91" href="#_subfunctions" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a>
3642 
3643 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3644 <span class="keyword">switch</span> the_units
3645     <span class="keyword">case</span> <span class="string">'metric'</span>
3646         dialog_params.english_units = false;
3647         
3648         set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
3649         set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
3650     <span class="keyword">case</span> <span class="string">'english'</span>
3651         dialog_params.english_units = true;
3652         
3653         set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
3654         set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
3655     <span class="keyword">otherwise</span>
3656 <span class="keyword">end</span>
3657 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3658 
3659 <span class="comment">% [EOF] dialogUnits</span>
3660 
3661 <span class="comment">% --------------------------------------------------------------------</span>
3662 <a name="_sub92" href="#_subfunctions" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a>
3663 
3664 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3665 <span class="keyword">switch</span> the_endpoints
3666     <span class="keyword">case</span> <span class="string">'auto'</span>
3667         dialog_params.set_cross_section_endpoints = false;
3668         
3669         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
3670         set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
3671     <span class="keyword">case</span> <span class="string">'manual'</span>
3672         dialog_params.set_cross_section_endpoints = true;
3673         
3674         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
3675         set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
3676     <span class="keyword">otherwise</span>
3677 <span class="keyword">end</span>
3678 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3679 
3680 <span class="comment">% [EOF] dialogEnpoints</span>
3681 
3682 <a name="_sub93" href="#_subfunctions" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a>
3683 
3684 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3685 <span class="keyword">switch</span> the_style
3686     <span class="keyword">case</span> <span class="string">'presentation'</span>
3687         dialog_params.presentation  = true;
3688         dialog_params.print         = false;
3689         
3690         set(handles.StylePresentation,<span class="string">'Value'</span>,1)
3691         set(handles.StylePrint,       <span class="string">'Value'</span>,0)
3692     <span class="keyword">case</span> <span class="string">'print'</span>
3693         dialog_params.presentation  = false;
3694         dialog_params.print         = true;
3695         
3696         set(handles.StylePresentation,<span class="string">'Value'</span>,0)
3697         set(handles.StylePrint,       <span class="string">'Value'</span>,1)
3698     <span class="keyword">otherwise</span>
3699 <span class="keyword">end</span>
3700 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3701 
3702 <span class="comment">% [EOF] dialogEnpoints</span>
3703 
3704 <span class="comment">% --------------------------------------------------------------------</span>
3705 <a name="_sub94" href="#_subfunctions" class="code">function dialogOK(hObject,eventdata,h_OK)</a>
3706 
3707 delete(h_OK)
3708 
3709 <span class="comment">% [EOF] dialogOK</span>
3710 
3711 <span class="comment">% --------------------------------------------------------------------</span>
3712 <a name="_sub95" href="#_subfunctions" class="code">function dialogCancel(hObject,eventdata,handles)</a>
3713 <span class="comment">% Return the original inputs</span>
3714 dialog_params = getappdata(handles.Figure,<span class="string">'original_dialog_params'</span>);
3715 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3716 delete(handles.OK)
3717 
3718 <span class="comment">% [EOF] dialogCancel</span>
3719 
3720 <span class="comment">% --------------------------------------------------------------------</span>
3721 <a name="_sub96" href="#_subfunctions" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a>
3722 
3723 delete(h_OK)
3724 
3725 <span class="comment">% [EOF] dialogCloseReq</span>
3726 
3727 <a name="_sub97" href="#_subfunctions" class="code">function [beam_angle,magnetic_variation,wse,output_auxilliary_data] = exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxilliary_data,hf)</a>
3728 w = 230;
3729 h = 200;
3730 dx = 10;
3731 dy = 35;
3732 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
3733 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Export Settings'</span>, <span class="keyword">...</span>
3734     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
3735     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
3736     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
3737     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
3738     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
3739     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
3740     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3741     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
3742     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
3743     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
3744 dialog_params.beam_angle             = beam_angle;
3745 dialog_params.magnetic_variation     = magnetic_variation;
3746 dialog_params.wse                    = wse;
3747 dialog_params.output_auxilliary_data = output_auxilliary_data;
3748 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3749 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
3750 
3751 <span class="comment">% Build the graphics:</span>
3752 <span class="comment">% -------------------</span>
3753 ph = 150;
3754 handles.BathymetryPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
3755     <span class="string">'Title'</span>, <span class="string">'Bathymetry'</span>, <span class="keyword">...</span>
3756     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3757     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
3758 handles.BeamAngleText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
3759     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
3760     <span class="string">'String'</span>,<span class="string">'Beam Angle (deg)'</span>, <span class="keyword">...</span>
3761     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
3762     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
3763     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3764     <span class="string">'Position'</span>,[dx+5 h-ph+60-4 100 22]);
3765 handles.BeamAngle = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
3766     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
3767     <span class="keyword">...</span><span class="comment">'String','Beam Angle (deg)', ...</span>
3768     <span class="string">'String'</span>,beam_angle,<span class="keyword">...</span>
3769     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
3770     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3771     <span class="string">'Position'</span>,[w-dx-80 h-ph+60 50 22]);
3772 handles.MagneticVariationText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
3773     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
3774     <span class="string">'String'</span>,<span class="string">'Magnetic Variation'</span>, <span class="keyword">...</span>
3775     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
3776     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
3777     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3778     <span class="string">'Position'</span>,[dx+5 h-ph+30-4 100 22]);
3779 handles.MagneticVariation = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
3780     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
3781     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
3782     <span class="string">'String'</span>,magnetic_variation,<span class="keyword">...</span>
3783     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
3784     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3785     <span class="string">'Position'</span>,[w-dx-80 h-ph+30 50 22]);
3786 handles.WSEText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
3787     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
3788     <span class="string">'String'</span>,<span class="string">'WSE (m)'</span>, <span class="keyword">...</span>
3789     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
3790     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
3791     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3792     <span class="string">'Position'</span>,[dx+5 h-ph-4 100 22]);
3793 handles.WSE = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
3794     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
3795     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
3796     <span class="string">'String'</span>,wse,<span class="keyword">...</span>
3797     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
3798     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3799     <span class="string">'Position'</span>,[w-dx-80 h-ph 50 22]);
3800 handles.OutputAuxilliaryData = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3801     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
3802     <span class="string">'String'</span>,<span class="string">'Output Auxilliary Data'</span>, <span class="keyword">...</span>
3803     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3804     <span class="string">'Position'</span>,[dx+5 20 w-2*dx-30 22]);
3805 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
3806     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
3807     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
3808     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
3809     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
3810 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
3811     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
3812     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
3813     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
3814     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
3815 
3816 <span class="comment">% Update the UI controls:</span>
3817 <span class="comment">% -----------------------</span>
3818 set(handles.BeamAngle,                <span class="string">'String'</span>,dialog_params.beam_angle)
3819 set(handles.MagneticVariation,        <span class="string">'String'</span>,dialog_params.magnetic_variation)
3820 set(handles.WSE,                      <span class="string">'String'</span>,dialog_params.wse)
3821 set(handles.OutputAuxilliaryData,     <span class="string">'Value'</span>,dialog_params.output_auxilliary_data)
3822 
3823 <span class="comment">% Set the callbacks:</span>
3824 <span class="comment">% ------------------</span>
3825 set(handles.Figure,                      <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub96" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
3826 set(handles.BeamAngle,                   <span class="string">'Callback'</span>,       {@<a href="#_sub98" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
3827 set(handles.MagneticVariation,           <span class="string">'Callback'</span>,       {@<a href="#_sub98" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
3828 set(handles.WSE,                         <span class="string">'Callback'</span>,       {@<a href="#_sub98" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
3829 set(handles.OutputAuxilliaryData,        <span class="string">'Callback'</span>,       {@<a href="#_sub98" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
3830 set(handles.OK,                          <span class="string">'Callback'</span>,       {@<a href="#_sub94" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,      handles.OK})
3831 set(handles.Cancel,                      <span class="string">'Callback'</span>,       {@<a href="#_sub95" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,  handles})
3832 
3833 <span class="comment">% Position the dialog and make it visible:</span>
3834 <span class="comment">% ----------------------------------------</span>
3835 fpos = get(hf,<span class="string">'Position'</span>);
3836 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
3837 movegui(handles.Figure,dpos)
3838 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
3839 
3840 <span class="comment">% Hold the dialog open:</span>
3841 <span class="comment">% ---------------------</span>
3842 waitfor(handles.OK)
3843 
3844 <span class="comment">% Return the outputs and close the dialog:</span>
3845 <span class="comment">% ----------------------------------------</span>
3846 dialog_params           = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3847 beam_angle              = dialog_params.beam_angle;
3848 magnetic_variation      = dialog_params.magnetic_variation;
3849 wse                     = str2num(dialog_params.wse);
3850 output_auxilliary_data  = dialog_params.output_auxilliary_data;
3851 
3852 delete(handles.Figure)
3853 
3854 <span class="comment">% [EOF] exportSettingsDialog</span>
3855 
3856 <span class="comment">% --------------------------------------------------------------------</span>
3857 <a name="_sub98" href="#_subfunctions" class="code">function dialogExportSettings(hObject,eventdata,handles)</a>
3858 
3859 <span class="comment">% Grab the current data</span>
3860 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3861 
3862 <span class="comment">% Set it according to the dialog box values</span>
3863 dialog_params.beam_angle                = get(handles.BeamAngle,<span class="string">'String'</span>);
3864 dialog_params.magnetic_variation        = get(handles.MagneticVariation,<span class="string">'String'</span>);
3865 dialog_params.wse                       = get(handles.WSE,<span class="string">'String'</span>);
3866 dialog_params.output_auxilliary_data    = get(handles.OutputAuxilliaryData,<span class="string">'Value'</span>);
3867 
3868 <span class="comment">% Re-store the application data</span>
3869 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3870 
3871 <span class="comment">% [EOF] dialogExportSettings</span>
3872 
3873 <a name="_sub99" href="#_subfunctions" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a>
3874 
3875 w = 230;
3876 h = 200;
3877 dx = 10;
3878 dy = 35;
3879 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
3880 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Select open figures to export'</span>, <span class="keyword">...</span>
3881     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
3882     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
3883     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
3884     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
3885     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
3886     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
3887     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3888     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
3889     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
3890     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
3891 dialog_params.figure_names               = figure_names;
3892 dialog_params.selected_figures           = <span class="string">''</span>;
3893 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3894 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
3895 
3896 <span class="comment">% Build the graphics:</span>
3897 <span class="comment">% -------------------</span>
3898 handles.ListboxPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
3899     <span class="string">'Title'</span>, <span class="string">'Figures'</span>, <span class="keyword">...</span>
3900     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3901     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
3902 handles.Figures = uicontrol(<span class="string">'Style'</span>,<span class="string">'listbox'</span>, <span class="keyword">...</span>
3903     <span class="string">'Parent'</span>,handles.ListboxPanel, <span class="keyword">...</span>
3904     <span class="string">'BackGroundColor'</span>,<span class="string">'white'</span>,<span class="keyword">...</span>
3905     <span class="string">'String'</span>,figure_names, <span class="keyword">...</span>
3906     <span class="string">'Min'</span>, 0,<span class="keyword">...</span>
3907     <span class="string">'Max'</span>, 2,<span class="keyword">...</span>
3908     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3909     <span class="string">'Position'</span>,[15 35 (w-5*dx) 100]);
3910 
3911 
3912 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
3913     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
3914     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
3915     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
3916     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
3917 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
3918     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
3919     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
3920     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
3921     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
3922 
3923 <span class="comment">% Update the UI controls:</span>
3924 <span class="comment">% -----------------------</span>
3925 
3926 
3927 <span class="comment">% Set the callbacks:</span>
3928 <span class="comment">% ------------------</span>
3929 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub96" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
3930 set(handles.Figures,           <span class="string">'Callback'</span>,       {@<a href="#_sub100" class="code" title="subfunction dialogSelectFigures(hObject,eventdata,handles)">dialogSelectFigures</a>    handles})
3931 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub94" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
3932 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub95" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
3933 
3934 <span class="comment">% Position the dialog and make it visible:</span>
3935 <span class="comment">% ----------------------------------------</span>
3936 fpos = get(hf,<span class="string">'Position'</span>);
3937 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
3938 movegui(handles.Figure,dpos)
3939 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
3940 
3941 <span class="comment">% Hold the dialog open:</span>
3942 <span class="comment">% ---------------------</span>
3943 waitfor(handles.OK)
3944 
3945 <span class="comment">% Return the outputs and close the dialog:</span>
3946 <span class="comment">% ----------------------------------------</span>
3947 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3948 selected_figures = dialog_params.selected_figures;
3949 
3950 delete(handles.Figure)
3951 
3952 <span class="comment">% [EOF] openFiguresDialog</span>
3953 
3954 <span class="comment">% --------------------------------------------------------------------</span>
3955 <a name="_sub100" href="#_subfunctions" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a>
3956 
3957 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
3958 
3959 idx_selected = get(handles.Figures,<span class="string">'Value'</span>);
3960 fig_names    = get(handles.Figures,<span class="string">'String'</span>);
3961 selected     = fig_names(idx_selected);
3962 dialog_params.selected_figures = selected;
3963 
3964 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3965 
3966 
3967 
3968 <span class="comment">% --------------------------------------------------------------------</span>
3969 <a name="_sub101" href="#_subfunctions" class="code">function icons = getIcons</a>
3970 
3971 <span class="comment">% Load data</span>
3972 idx = 1;
3973 icons(idx).data(:,:,1) = <span class="keyword">...</span>
3974     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
3975     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   129   120   135   188   NaN   NaN   NaN
3976     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN    96   189   NaN   NaN   130   NaN    95   NaN
3977     NaN   NaN   206   206   206   206   NaN   NaN   NaN   NaN   NaN   NaN   NaN    84    79   NaN
3978     NaN   206   255   255   255   255   198   197   NaN   NaN   NaN   NaN    83    79    76   NaN
3979     198   255   255   255   255   255   255   198   198   198   198   198   198   212   212   NaN
3980     198   255   255   255   255   255   255   255   255   255   255   255   198   157   197   NaN
3981     198   255   226   198   198   198   198   198   198   198   198   198   198   198   177   NaN
3982     198   255   198   218   255   255   255   255   255   255   255   255   255   255   161   NaN
3983     198   253   198   247   255   255   255   255   255   255   255   255   255   251   155   NaN
3984     198   226   201   255   255   255   255   255   255   255   255   255   231   206   165   NaN
3985     198   207   215   255   255   255   255   255   255   255   255   255   239   198   159   NaN
3986     198   198   240   255   255   255   255   255   255   255   255   255   222   157   159   NaN
3987     198   199   255   255   255   255   255   255   255   255   255   255   191   165   159   NaN
3988     NaN   165   165   165   165   165   165   165   165   165   165   165   165   159   159   NaN
3989     NaN   NaN   159   159   159   159   159   159   159   159   159   159   159   159   NaN   NaN]/255;
3990 
3991 icons(idx).data(:,:,2) = <span class="keyword">...</span>
3992     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
3993     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   145   137   149   195   NaN   NaN   NaN
3994     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   116   196   NaN   NaN   145   NaN   116   NaN
3995     NaN   NaN   162   162   162   162   NaN   NaN   NaN   NaN   NaN   NaN   NaN   107   105   NaN
3996     NaN   162   255   255   255   255   154   197   NaN   NaN   NaN   NaN   106   104   103   NaN
3997     154   255   255   255   255   255   255   154   154   154   154   154   154   208   208   NaN
3998     154   243   243   243   243   243   243   255   255   255   255   255   154   123   197   NaN
3999     154   235   193   154   154   154   154   154   154   154   154   154   154   154   137   NaN
4000     154   215   154   191   255   255   251   255   255   255   255   255   231   255   126   NaN
4001     154   213   154   240   255   255   255   255   255   255   255   255   199   249   123   NaN
4002     154   179   160   255   247   247   247   247   247   247   247   247   190   188   115   NaN
4003     154   162   184   255   235   235   235   235   235   235   235   231   186   154   169   NaN
4004     154   154   228   255   227   227   227   227   227   227   227   223   178   123   169   NaN
4005     154   156   255   215   215   215   215   215   215   215   215   215   153   115   169   NaN
4006     NaN   115   115   115   115   115   115   115   115   115   115   115   115   169   169   NaN
4007     NaN   NaN   169   169   169   169   169   169   169   169   169   169   169   169   NaN   NaN]/255;
4008 
4009 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4010     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
4011     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   166   161   170   202   NaN   NaN   NaN
4012     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   149   205   NaN   NaN   166   NaN   148   NaN
4013     NaN   NaN    34    34    34    34   NaN   NaN   NaN   NaN   NaN   NaN   NaN   141   144   NaN
4014     NaN    34   255   255   255   255    25   197   NaN   NaN   NaN   NaN   142   145   147   NaN
4015     25   255   156   156   156   156   255    25    25    25    25    25    25   200   200   NaN
4016     25   156   140   140   140   140   140   255   255   255   255   255    25    26   197   NaN
4017     25   132    80    25    25    25    25    25    25    25    25    25    25    25    25   NaN
4018     25   132    25   108   255   255   247   255   255   255   255   255   132   255    25   NaN
4019     25   112    25   137   156   156   156   156   156   156   156   156    91   150    25   NaN
4020     25    67    33   165   148   148   148   148   148   148   148   148    83    92    13   NaN
4021     25    38    64   156   132   132   132   132   132   132   132   132    67    25   176   NaN
4022     25    26   122   156   124   124   124   124   124   124   124   124    67    26   176   NaN
4023     25    28   156   108   108   108   108   108   108   108   108   108    41    13   176   NaN
4024     NaN    13    13    13    13    13    13    13    13    13    13    13    13   176   176   NaN
4025     NaN   NaN   176   176   176   176   176   176   176   176   176   176   176   176   NaN   NaN]/255;
4026 
4027 <span class="comment">% Save data</span>
4028 idx = idx+1;
4029 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4030     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
4031     NaN    0.6902    0.6902    0.6902    0.6902    0.6902    0.6274    0.6274    0.5647    0.5647    0.5647    0.5019    0.5019    0.4392    0.2510       NaN
4032     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.3137    0.3765    0.2510    0.4670
4033     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.2510    0.1882    0.2510    0.4670
4034     NaN    0.6274    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.1882    0.5019    0.2510    0.4670
4035     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.1882    0.4392    0.2510    0.4670
4036     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.1255    0.3765    0.2510    0.4670
4037     NaN    0.5647    0.7529    0.3765    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.7529    0.0627    0.3765    0.2510    0.4670
4038     NaN    0.5647    0.7529    0.6902    0.3765    0.3137    0.3137    0.2510    0.1882    0.1882    0.1255    0.0627    0.3765    0.3137    0.2510    0.4670
4039     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5019    0.5019    0.5019    0.4392    0.4392    0.3765    0.3137    0.3137    0.2510    0.4670
4040     NaN    0.5019    0.6902    0.6274    0.5647    0.3137    0.3137    0.3137    0.3137    0.3137    0.3765    0.3137    0.3137    0.2510    0.2510    0.4670
4041     NaN    0.4392    0.6274    0.5647    0.5019    0.3137       NaN    0.1882    0.8157    0.8157    0.3765    0.2510    0.2510    0.2510    0.2510    0.4670
4042     NaN    0.4392    0.6274    0.5019    0.5019    0.3137    0.1882    0.4392    0.8784    0.8784    0.4392    0.1882    0.2510    0.1882    0.2510    0.4670
4043     NaN    0.4392    0.5647    0.5019    0.1255    0.1255    0.6902    0.6902    0.7529    0.7529    0.3137    0.1882    0.1882    0.1882    0.2510    0.4670
4044     NaN    0.7333    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.4670
4045     NaN       NaN    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670];
4046 
4047 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4048     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
4049     NaN    0.7216    0.7216    0.6902    0.6902    0.6588    0.6274    0.5961    0.5647    0.5647    0.5333    0.5019    0.4706    0.4706    0.2196       NaN
4050     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.3451    0.3451    0.2196    0.5378
4051     NaN    0.6902    0.7529    0.5333    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.3137    0.1882    0.2196    0.5378
4052     NaN    0.6588    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.3137    0.4706    0.2196    0.5378
4053     NaN    0.6274    0.7529    0.4706    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.2824    0.4392    0.2196    0.5378
4054     NaN    0.5961    0.7529    0.4392    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.2510    0.4078    0.2196    0.5378
4055     NaN    0.5647    0.7529    0.4078    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.7843    0.2196    0.3765    0.2196    0.5378
4056     NaN    0.5333    0.7216    0.7216    0.3765    0.3765    0.3451    0.3137    0.3137    0.2824    0.2510    0.2196    0.3765    0.3451    0.2196    0.5378
4057     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5333    0.5019    0.4706    0.4392    0.4078    0.3765    0.3451    0.3137    0.2196    0.5378
4058     NaN    0.4706    0.6588    0.6274    0.5647    0.3451    0.3451    0.3451    0.3451    0.3765    0.4078    0.3451    0.3137    0.2824    0.2196    0.5378
4059     NaN    0.4706    0.6274    0.5647    0.5333    0.3451       NaN    0.2510    0.8470    0.8784    0.4706    0.2824    0.2824    0.2510    0.2196    0.5378
4060     NaN    0.4392    0.5961    0.5333    0.5019    0.3451    0.2510    0.4706    0.8784    0.9098    0.5019    0.2510    0.2510    0.2510    0.2196    0.5378
4061     NaN    0.4078    0.5647    0.5019    0.2824    0.1882    0.7216    0.7216    0.7529    0.7843    0.3137    0.2510    0.2510    0.2196    0.2196    0.5378
4062     NaN    0.7176    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.5378
4063     NaN       NaN    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378];
4064 
4065 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4066     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
4067     NaN    0.9412    0.9412    0.9412    0.9412    0.9412    0.9412    0.8784    0.8784    0.8784    0.8784    0.8784    0.8157    0.8157    0.4392       NaN
4068     NaN    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.7529    0.6902    0.4392    0.5997
4069     NaN    0.9412    1.0000    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.7529    0.3765    0.4392    0.5997
4070     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.6902    0.8784    0.4392    0.5997
4071     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.6902    0.8157    0.4392    0.5997
4072     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.6274    0.8157    0.4392    0.5997
4073     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.8784    0.6274    0.7529    0.4392    0.5997
4074     NaN    0.8784    1.0000    1.0000    0.8157    0.7529    0.7529    0.7529    0.6902    0.6902    0.6274    0.6274    0.7529    0.7529    0.4392    0.5997
4075     NaN    0.8784    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8784    0.8157    0.8157    0.7529    0.7529    0.6902    0.4392    0.5997
4076     NaN    0.8157    1.0000    1.0000    0.9412    0.4392    0.4392    0.4392    0.4392    0.4392    0.5019    0.7529    0.6902    0.6902    0.4392    0.5997
4077     NaN    0.8157    1.0000    0.9412    0.9412    0.4392       NaN    0.2510    0.9412    0.9412    0.5019    0.6902    0.6902    0.6274    0.4392    0.5997
4078     NaN    0.8157    1.0000    0.9412    0.8784    0.4392    0.2510    0.5647    0.9412    0.9412    0.5647    0.6274    0.6274    0.6274    0.4392    0.5997
4079     NaN    0.8157    0.9412    0.8784    0.6902    0.2510    0.7529    0.7529    0.8157    0.8157    0.3137    0.6274    0.6274    0.6274    0.4392    0.5997
4080     NaN    0.8275    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.5997
4081     NaN       NaN    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997];
4082 
4083 <span class="comment">% Plotting parameters</span>
4084 idx = idx+1;
4085 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4086     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
4087     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4088     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4089     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
4090     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
4091     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
4092     0   101   239   255   224   109   255   255   255   247    79   254   254   123    36   165
4093     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
4094     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
4095     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
4096     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
4097     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
4098     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
4099     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4100     0     0     0     1     0     0     0     0     0     0     0     0     0     0     0   165
4101     255   165   165   165   172   165   165   165   165   165   165   165   165   165   165   165]/255;
4102 
4103 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4104     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
4105     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0     0
4106     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4107     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
4108     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
4109     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
4110     0   101   239   255   224   109   255   255   255   247    79   254   254   123     0   165
4111     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
4112     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
4113     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
4114     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
4115     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
4116     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
4117     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4118     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   165
4119     0   165   165   165   153   165   165   165   165   165   165   165   165   165   165   165]/255;
4120 
4121 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4122     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
4123     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4124     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4125     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4126     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4127     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4128     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4129     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4130     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4131     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4132     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4133     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4134     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4135     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4136     0    24    39     0     0     0     0     0     0     0     0     0     0     0     0   145
4137     255   145   145   145   134   145   145   145   145   145   145   145   145   145   145   145]/255;
4138 
4139 <span class="comment">% Processing parameters</span>
4140 idx = idx+1;
4141 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4142     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
4143     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
4144     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4145     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4146     255     0   255   255   107   255   255   107   255   255   107   255   107   255     0   255
4147     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4148     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4149     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4150     255     0   255   255   107   255   107   255   107   255   255   107   255   255     0   255
4151     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4152     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4153     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4154     255     0   255   107   255   107   255   107   255   255   107   255   107   255     0   255
4155     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4156     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4157     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
4158 
4159 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4160     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
4161     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
4162     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4163     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4164     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
4165     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4166     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4167     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4168     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
4169     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4170     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4171     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4172     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
4173     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4174     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4175     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
4176 
4177 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4178     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
4179     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
4180     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4181     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4182     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
4183     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4184     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4185     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4186     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
4187     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4188     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4189     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4190     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
4191     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4192     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4193     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
4194 
4195 <span class="comment">% Export bathymetry dialog</span>
4196 idx = idx+1;
4197 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4198     [226    226    226    226    226    226    226    197    220    226    226    226    226    226    226    226
4199     226    226    226    226    226    227    241    144    158    241    228    228    229    228    229    226
4200     226    243    243    243    237    237    246    164    119    242    232    225    226    218    243    206
4201     179    152    153    166    148    148    177    179    63    185    141    146    154    151    179    189
4202     167    4    134    175    151    164    161    198    122    255    212    233    215    199    140    185
4203     134    50    209    241    255    255    133    118    15    20    28    94    4    0    0    89
4204     136    0    0    0    0    0    0    0    0    0    0    0    0    21    56    140
4205     208    255    226    233    255    242    215    232    251    237    226    233    207    222    156    139
4206     172    159    152    153    166    145    178    147    169    164    161    163    154    153    128    135
4207     160    164    148    139    171    150    165    154    165    185    166    173    190    190    148    162
4208     214    233    211    203    217    212    217    238    202    236    213    222    230    224    184    184
4209     219    206    174    190    219    204    201    218    183    224    219    222    217    202    176    182
4210     210    182    183    214    225    220    203    229    175    217    220    220    222    212    184    185
4211     197    175    207    224    223    220    205    231    170    221    220    220    222    217    191    187
4212     186    193    223    224    220    201    203    228    171    224    218    220    222    215    190    187
4213     189    211    220    216    204    201    214    213    187    213    216    220    220    212    193    189
4214     ]/255;
4215 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4216     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
4217     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
4218     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
4219     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
4220     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
4221     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
4222     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
4223     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
4224     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
4225     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
4226     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
4227     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
4228     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
4229     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
4230     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
4231     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
4232     ]/255;
4233 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4234     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
4235     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
4236     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
4237     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
4238     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
4239     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
4240     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
4241     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
4242     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
4243     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
4244     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
4245     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
4246     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
4247     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
4248     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
4249     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
4250     ]/255;
4251 
4252 <span class="comment">% Export Figures Dialog</span>
4253 idx = idx + 1;
4254 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4255     [NaN    NaN    10    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
4256     NaN    NaN    67    255    255    255    255    255    255    255    201    141    NaN    NaN    NaN    NaN
4257     NaN    NaN    43    255    241    240    241    246    252    255    186    220    151    NaN    NaN    NaN
4258     NaN    NaN    42    255    238    237    237    236    238    254    210    178    214    38    NaN    NaN
4259     NaN    NaN    43    255    241    241    241    241    240    244    252    255    255    79    NaN    NaN
4260     NaN    NaN    47    255    232    232    225    224    224    223    220    238    255    69    NaN    NaN
4261     NaN    NaN    55    233    114    225    230    223    221    221    215    237    255    67    NaN    NaN
4262     4    NaN    37    181    168    126    193    214    205    200    203    242    255    67    NaN    NaN
4263     41    164    134    153    144    139    131    209    238    223    242    240    255    67    NaN    NaN
4264     41    118    91    91    122    125    120    106    170    241    245    241    255    67    NaN    NaN
4265     41    113    91    89    97    108    99    89    117    205    190    230    255    67    NaN    NaN
4266     41    124    94    88    78    74    81    179    255    252    244    241    255    67    NaN    NaN
4267     13    34    76    187    88    92    222    255    255    250    250    250    255    73    NaN    NaN
4268     NaN    NaN    69    236    121    227    255    243    238    238    238    238    255    82    NaN    NaN
4269     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
4270 
4271 
4272 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4273     [NaN    NaN    10    24    24    24    24    24    24    24    22    4    NaN    NaN    NaN    NaN
4274     NaN    NaN    69    255    255    255    255    255    255    255    204    144    NaN    NaN    NaN    NaN
4275     NaN    NaN    45    255    241    240    241    246    252    255    189    222    155    NaN    NaN    NaN
4276     NaN    NaN    43    255    238    237    237    236    238    254    210    179    215    39    NaN    NaN
4277     NaN    NaN    44    255    241    241    241    241    240    244    252    255    255    80    NaN    NaN
4278     NaN    NaN    49    255    231    230    225    224    224    223    220    238    255    70    NaN    NaN
4279     NaN    NaN    56    227    136    214    227    223    221    221    215    237    255    68    NaN    NaN
4280     4    NaN    19    157    243    154    181    210    204    200    203    242    255    67    NaN    NaN
4281     51    255    231    225    219    217    172    197    232    222    242    240    255    67    NaN    NaN
4282     52    227    184    183    195    201    204    172    169    239    245    241    255    67    NaN    NaN
4283     51    218    177    177    180    187    187    177    130    202    190    230    255    67    NaN    NaN
4284     51    237    195    183    172    170    152    175    255    251    244    241    255    67    NaN    NaN
4285     15    38    72    173    183    149    211    255    255    250    250    250    255    73    NaN    NaN
4286     NaN    NaN    65    226    174    214    252    242    238    238    238    238    255    84    NaN    NaN
4287     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
4288 
4289 
4290 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4291     [NaN    NaN    9    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
4292     NaN    NaN    66    255    255    255    255    255    255    255    196    139    NaN    NaN    NaN    NaN
4293     NaN    NaN    42    255    239    238    238    244    252    255    186    216    148    NaN    NaN    NaN
4294     NaN    NaN    41    255    236    235    235    234    237    251    210    176    212    36    NaN    NaN
4295     NaN    NaN    42    255    239    239    239    239    238    241    252    255    255    78    NaN    NaN
4296     NaN    NaN    46    255    233    232    224    223    223    223    219    235    255    67    NaN    NaN
4297     NaN    NaN    53    240    101    232    230    221    219    218    213    235    255    65    NaN    NaN
4298     5    NaN    60    212    94    107    205    215    203    198    201    240    255    66    NaN    NaN
4299     34    56    40    80    70    62    94    222    241    221    240    238    255    66    NaN    NaN
4300     35    10    2    0    51    55    36    46    176    240    243    239    255    66    NaN    NaN
4301     35    11    9    7    16    34    12    6    110    204    188    228    255    66    NaN    NaN
4302     35    14    0    0    0    0    14    187    255    251    242    239    255    66    NaN    NaN
4303     12    37    84    206    0    41    234    255    255    248    248    248    255    72    NaN    NaN
4304     NaN    NaN    69    249    79    239    255    240    236    236    236    236    255    80    NaN    NaN
4305     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
4306 
4307 <span class="comment">% Export Excel File</span>
4308 idx = idx + 1;
4309 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4310     [NaN    NaN    NaN    NaN    NaN    NaN  106  252  255  255  255  255  255  255  255  255
4311    38  136  109  101   96   77   95  134  106   99   93   87   90   66  255  255
4312    52  197  232  217  210  202  191  178  170  164  160  159  155   15  255  255
4313    51  181  255  255  255  255  255  255  255  255  255  255  253    9  255  255
4314    49  174  245  153  156  175  255  255  181  153  149  205  245    0  255  255
4315    47  168  199  122  149  100  155  183   99   99   15  117  245    0  255  241
4316    45  158  255  146  146  141   87   68  120   34   86  255  238    0  252  232
4317    42  144  255  255  158  158  143   74   68  117  255  255  230    0  255  255
4318    40  134  255  255  169   15  150  111   68   81  105  167  236    0  230  217
4319    37  131  255  158   99  106   10  143  117   50   51  165  252    0  255  254
4320    35  122  208    0   22   32    8   17  110   20    0   13  212    0  255  245
4321    33  115  255  255  255  255  255  250  146  113  119  106  217    0  236  217
4322    31  109  255  254  252  251  250  255  255  255  255  255  241    0  255  251
4323    29  116  190  168  164  157  145  133  126  121  117  118  112    0  215  205
4324    20   63   47   38   36   20   38   83   64   51   52   55   64   20  255  241
4325     NaN    NaN    NaN    NaN    NaN    NaN   96  249  252  228  237  251  249  203  241  246]/255;
4326 
4327 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4328     [NaN    NaN    NaN    NaN    NaN    NaN  114  252  255  255  255  255  255  255  255  255
4329    49  180  152  145  140  118  140  173  150  139  132  126  126  106  255  255
4330    67  249  252  242  237  231  221  207  201  196  194  193  193   75  255  255
4331    66  232  255  255  255  255  255  255  255  255  255  255  255   68  255  255
4332    64  226  251  197  191  200  255  255  194  170  168  214  253   61  255  255
4333    62  220  224  183  207  173  189  202  167  175  116  172  253   58  255  246
4334    60  211  255  190  196  203  166  131  187  134  148  255  249   54  254  240
4335    57  199  255  255  198  203  202  158  132  168  255  255  245   47  255  255
4336    54  190  255  255  200  110  199  185  155  147  160  203  251   44  240  230
4337    52  187  255  204  187  194  121  204  189  139   99  179  255   39  255  254
4338    49  180  230   42   49   53   36   64  182   98   65   70  228   36  255  248
4339    47  171  255  255  255  255  255  255  186  115  124  114  235   34  243  229
4340    45  166  255  255  254  254  255  255  255  255  255  255  255   33  255  252
4341    43  176  222  206  204  200  190  180  174  171  169  169  169   32  229  220
4342    30  101   81   74   69   54   72  116   96   84   84   84   94   55  255  245
4343     NaN    NaN    NaN    NaN    NaN    NaN  105  251  253  237  242  252  251  218  246  249]/255;
4344 
4345 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4346     [ NaN    NaN    NaN    NaN    NaN    NaN  125  253  255  255  255  255  255  255  255  255
4347    34  118   92   84   79   56   83  111   88   79   73   69   74   45  255  255
4348    46  180  228  207  203  195  182  169  159  155  149  149  145    0  255  255
4349    45  163  255  255  255  255  255  255  255  255  255  255  254    0  255  255
4350    42  156  248  152  155  176  255  255  181  154  147  206  245    0  255  255
4351    40  150  202  117  136   87  154  181   90   84    8  120  243    0  255  252
4352    38  138  255  145  137  131   81   65  106   27   86  255  238    0  255  250
4353    35  122  255  255  159  152  137   75   62  121  255  255  229    0  255  255
4354    33  113  255  255  171   13  145  111   67   76   84  159  234    0  255  247
4355    30  109  255  160   89   97   10  136  111   36   33  159  251    0  255  255
4356    28   99  211    0   12   23    2   11  101    0    0   13  209    0  255  253
4357    26   92  255  255  255  255  255  250  146  111  117  104  213    0  255  245
4358    23   89  255  255  255  255  255  255  255  255  255  255  241    0  255  254
4359    22   93  180  156  151  141  129  114  105   98   93   93   83    0  255  239
4360    15   43   26   17   15    0   25   63   45   39   38   39   44    9  255  252
4361     NaN    NaN    NaN    NaN    NaN    NaN  117  253  255  249  251  255  254  239  252  254]/255;
4362 
4363 <span class="comment">% [EOF] getIcons</span>
4364 
4365 <a name="_sub102" href="#_subfunctions" class="code">function guiparams = createGUIparams</a>
4366 <span class="comment">% Creates the guiparams structure with specified defaults.</span>
4367 
4368 <span class="comment">% Organized by GUI panels</span>
4369 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
4370 <span class="comment">% SHIPTRACKS PLOT %</span>
4371 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
4372 guiparams.horizontal_grid_node_spacing       = 1.0;
4373 
4374 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
4375 <span class="comment">% CROSS SECTION PLOT %</span>
4376 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
4377 guiparams.contours                           = <span class="string">''</span>; <span class="comment">% Set below</span>
4378 guiparams.contour                            = <span class="string">''</span>; <span class="comment">% Set below</span>
4379 guiparams.idx_contour                        = 1;
4380 guiparams.vertical_exaggeration              = 10;
4381 guiparams.vector_scale_cross_section         = 0.2;
4382 guiparams.horizontal_vector_spacing          = 1;
4383 guiparams.vertical_vector_spacing            = 1;
4384 guiparams.horizontal_smoothing_window        = 1;
4385 guiparams.vertical_smoothing_window          = 1;
4386 guiparams.plot_secondary_flow_vectors        = true;
4387 guiparams.secondary_flows                    = <span class="string">''</span>; <span class="comment">% Set below</span>
4388 guiparams.secondary_flow_vector_variable     = <span class="string">''</span>; <span class="comment">% Set below</span>
4389 guiparams.idx_secondary_flow_vector_variable = 1;
4390 guiparams.include_vertical_velocity          = true;
4391 
4392 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
4393 <span class="comment">% PLAN VIEW PLOT %</span>
4394 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
4395 guiparams.depth_range_min                    = 0;
4396 guiparams.depth_range_max                    = inf;
4397 guiparams.vector_scale_plan_view             = 1;
4398 guiparams.vector_spacing_plan_view           = 1;
4399 guiparams.smoothing_window_size              = 1;
4400 guiparams.display_shoreline                  = false;
4401 guiparams.add_background                     = false;
4402 
4403 <span class="comment">%%%%%%%%%%%%%%%</span>
4404 <span class="comment">% DATA EXPORT %</span>
4405 <span class="comment">%%%%%%%%%%%%%%%</span>
4406 guiparams.beam_angle                         = 20.0;
4407 guiparams.magnetic_variation                 = 0.0;
4408 guiparams.wse                                = 0.0;
4409 guiparams.output_auxiliary_data              = false;
4410 
4411 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
4412 <span class="comment">% Contour variables %</span>
4413 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
4414 idx = 1;
4415 guiparams.contours(idx).string   = <span class="string">'Streamwise Velocity (u)'</span>;
4416 guiparams.contours(idx).variable = <span class="string">'streamwise'</span>;
4417 idx = idx + 1;
4418 guiparams.contours(idx).string   = <span class="string">'Transverse Velocity (v)'</span>;
4419 guiparams.contours(idx).variable = <span class="string">'transverse'</span>;
4420 idx = idx + 1;
4421 guiparams.contours(idx).string   = <span class="string">'Vertical Velocity (w)'</span>;
4422 guiparams.contours(idx).variable = <span class="string">'vertical'</span>;
4423 idx = idx + 1;
4424 guiparams.contours(idx).string   = <span class="string">'Velocity Magnitude'</span>;
4425 guiparams.contours(idx).variable = <span class="string">'mag'</span>;
4426 idx = idx + 1;
4427 guiparams.contours(idx).string   = <span class="string">'East Velocity (E)'</span>;
4428 guiparams.contours(idx).variable = <span class="string">'east'</span>;
4429 idx = idx + 1;
4430 guiparams.contours(idx).string   = <span class="string">'North Velocity (N)'</span>;
4431 guiparams.contours(idx).variable = <span class="string">'north'</span>;
4432 idx = idx + 1;
4433 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (zsd)'</span>;
4434 guiparams.contours(idx).variable = <span class="string">'primary_zsd'</span>;
4435 idx = idx + 1;
4436 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (zsd)'</span>;
4437 guiparams.contours(idx).variable = <span class="string">'secondary_zsd'</span>;
4438 idx = idx + 1;
4439 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (Roz)'</span>;
4440 guiparams.contours(idx).variable = <span class="string">'primary_roz'</span>;
4441 idx = idx + 1;
4442 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (Roz)'</span>;
4443 guiparams.contours(idx).variable = <span class="string">'secondary_roz'</span>;
4444 idx = idx + 1;
4445 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Downstream Comp.)'</span>;
4446 guiparams.contours(idx).variable = <span class="string">'primary_roz_x'</span>;
4447 idx = idx + 1;
4448 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Cross-Stream Comp.)'</span>;
4449 guiparams.contours(idx).variable = <span class="string">'primary_roz_y'</span>;
4450 idx = idx + 1;
4451 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Downstream Comp.)'</span>;
4452 guiparams.contours(idx).variable = <span class="string">'secondary_roz_x'</span>;
4453 idx = idx + 1;
4454 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Cross-Stream Comp.)'</span>;
4455 guiparams.contours(idx).variable = <span class="string">'secondary_roz_y'</span>;
4456 idx = idx + 1;
4457 guiparams.contours(idx).string   = <span class="string">'Backscatter'</span>;
4458 guiparams.contours(idx).variable = <span class="string">'backscatter'</span>;
4459 idx = idx + 1;
4460 guiparams.contours(idx).string   = <span class="string">'Flow Direction (deg.)'</span>;
4461 guiparams.contours(idx).variable = <span class="string">'flowangle'</span>;
4462 
4463 guiparams.contour = guiparams.contours(guiparams.idx_contour).variable;
4464 
4465 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4466 <span class="comment">% Secondary Flow Vector Variables %</span>
4467 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4468 idx = 1;
4469 guiparams.secondary_flows(idx).string   = <span class="string">'Transverse'</span>;
4470 guiparams.secondary_flows(idx).variable = <span class="string">'transverse'</span>;
4471 idx = idx + 1;
4472 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (zsd)'</span>;
4473 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_zsd'</span>;
4474 idx = idx + 1;
4475 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz)'</span>;
4476 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz'</span>;
4477 idx = idx + 1;
4478 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz, Cross-Stream Comp)'</span>;
4479 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz_y'</span>;
4480 idx = idx + 1;
4481 guiparams.secondary_flows(idx).string   = <span class="string">'Primary (Roz, Cross-Stream Comp)'</span>;
4482 guiparams.secondary_flows(idx).variable  = <span class="string">'primary_roz_y'</span>;
4483 
4484 guiparams.secondary_flow_vector_variable = <span class="keyword">...</span>
4485     guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).variable;
4486 
4487 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4488 <span class="comment">% INTERNAL SETTINGS &amp; DEFAULTS %</span>
4489 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4490 <span class="comment">% Menu bar options</span>
4491 guiparams.presentation                       = true;
4492 guiparams.print                              = false;
4493 guiparams.set_cross_section_endpoints        = false;
4494 guiparams.unit_discharge_correction          = false;
4495 guiparams.english_units                      = false;
4496 guiparams.vertical_offset                    = 0;
4497 <span class="comment">% guiparams.plot_ship_tracks                   = false;</span>
4498 <span class="comment">% guiparams.plot_planview                      = false;</span>
4499 <span class="comment">% guiparams.plot_cross_section                 = false;</span>
4500 
4501 <span class="comment">% File location defaults</span>
4502 guiparams.ascii_path                        = pwd;
4503 guiparams.ascii_file                        = <span class="string">''</span>;
4504 guiparams.mat_path                          = pwd;
4505 guiparams.mat_file                          = <span class="string">''</span>;
4506 guiparams.tecplot_path                      = pwd;
4507 guiparams.tecplot_file                      = <span class="string">''</span>;
4508 guiparams.kmz_path                          = pwd;
4509 guiparams.kmz_file                          = <span class="string">''</span>;
4510 guiparams.multibeambathymetry_path          = pwd;
4511 guiparams.multibeambathymetry_file          = <span class="string">''</span>;
4512 guiparams.log_path                          = pwd;
4513 guiparams.log_file                          = <span class="string">''</span>;
4514 <span class="comment">% Avoids problems of not finding the MCR root when running as a standalone</span>
4515 <span class="comment">% application</span>
4516 <span class="keyword">if</span> isdeployed 
4517     guiparams.has_mapping_toolbox           = true;
4518 <span class="keyword">else</span>
4519     guiparams.has_mapping_toolbox               = <span class="keyword">...</span>
4520         ~isempty(dir(fullfile(matlabroot,<span class="string">'toolbox'</span>,<span class="string">'map'</span>)));
4521 <span class="keyword">end</span>
4522 
4523 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4524 <span class="comment">% IN MEMORY DATA STORAGE %</span>
4525 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4526 guiparams.z                      = [];
4527 guiparams.A                      = [];
4528 guiparams.V                      = [];
4529 guiparams.Map                    = [];
4530 guiparams.savefile               = [];
4531 guiparams.iric_anv_planview_data = [];
4532 <span class="comment">% guiparams.zmin = []; % Don't need to store these?</span>
4533 <span class="comment">% guiparams.zmax = [];</span>
4534 <span class="comment">% guiprefs = getappdata(handles.figure1,'guiprefs');</span>
4535 guiparams.data_folder = <span class="string">''</span>;
4536 guiparams.data_files  = {<span class="string">''</span>};
4537 
4538 <span class="comment">% [EOF] createGUIparams</span>
4539 
4540 <span class="comment">% [EOF] VMT</span></pre></div>
<hr><address>Generated on Wed 31-Jul-2013 10:28:59 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>