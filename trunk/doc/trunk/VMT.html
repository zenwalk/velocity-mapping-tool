<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of VMT</title>
  <meta name="keywords" content="VMT">
  <meta name="description" content="--- THE VELOCITY MAPPING TOOLBOX ---">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html trunk -->
<h1>VMT
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>--- THE VELOCITY MAPPING TOOLBOX ---</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function varargout = VMT(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> --- THE VELOCITY MAPPING TOOLBOX ---
 
 VMT is a Matlab-based software for processing and visualizing ADCP data
 collected along transects in rivers or other bodies of water. VMT allows
 rapid processing, visualization, and analysis of a range of ADCP datasets
 and includes utilities to export ADCP data to files compatible with
 ArcGIS, Tecplot, and Google Earth. The software can be used to explore
 patterns of three-dimensional fluid motion through several methods for
 calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et
 al., 2000). The software also includes capabilities for analyzing the
 acoustic backscatter and bathymetric data from the ADCP. A user-friendly
 graphical user interface (GUI) enhances program functionality and
 provides ready access to two- and three- dimensional plotting functions,
 allowing rapid display and interrogation of velocity, backscatter, and
 bathymetry data.
 
 CITATION: 
 Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.
 L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,
 J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and
 visualization suite for moving-vessel ADCP measurements. Earth Surf.
 Process. Landforms. doi: 10.1002/esp.3367

__________________________________________________________________________
 P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center
 (pjackson@usgs.gov)

 Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.
__________________________________________________________________________</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>	Takes the processed data structure and writes a TecPlot ASCII data file.</li><li><a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>	Takes the processed data structure and writes a TecPlot ASCII data file</li><li><a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>	Computes the layer averaged mean of y over the depth range.</li><li><a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>	Computes the multibeam bathymetry from the four beams of the ADCP</li><li><a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>	Outputs the mean cross section (3-D) from VMT to Google Earth (saved as a</li><li><a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>	Prompts the user for a geotiff DOQQ (USGS) and overlays the aerial image</li><li><a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>	This function plots a plan view of the measurement region with a vector</li><li><a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>	Plots the shiptracks, and interpolated grid in the VMT GUI axes. Also</li><li><a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>	Plots a shoreline map given the shoreline data structure 'Map' (see</li><li><a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english)">VMT_PlotXSCont</a>	Plots contours for the variable 'var' within the mean cross section given</li><li><a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,varargin)">VMT_PlotXSContQuiver</a>	This function plots the the contour plot (mean XS) for the variable 'var'</li><li><a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>	This function is a driver to preprocess the transects data.  Several</li><li><a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>	Driver program to process multiple transects at a single cross-section</li><li><a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>	Read in multiple ASCII output files from WinRiver or WinRiverII.</li><li><a href="VMT_ReadFiles_SonTek.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles_SonTek(zPathName,zFileName)">VMT_ReadFiles_SonTek</a>	Read in multiple MAT output files from SonTek RSL v1.5-3.60.</li><li><a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>	Saves the figures (specified by fignums) from VMT as .PNG or EPS files</li><li><a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>	This routine smooths all processed variables in V struct. By default is</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a></li><li><a href="#_sub2" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub3" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub4" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub5" class="code">function menuFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub6" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub7" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub8" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub9" class="code">function menuSave_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub10" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub11" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub12" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub13" class="code">function menuExport_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub14" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub15" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub16" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub17" class="code">function menuGraphicsRenderer_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub18" class="code">function menuOpenGL_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub19" class="code">function menuPainters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub20" class="code">function menuZbuffer_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub21" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub22" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub23" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub24" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub25" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub26" class="code">function menuParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub27" class="code">function menuProcessingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub28" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub29" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub30" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub31" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub32" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub33" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub34" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub35" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub36" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub37" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub38" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub39" class="code">function menuKMZVerticalOffset_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub40" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub41" class="code">function menuTools_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub42" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub43" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub44" class="code">function menuOpenBatchMode_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub45" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub46" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub47" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub48" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub49" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub50" class="code">function loadDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub51" class="code">function saveDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub52" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub53" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub54" class="code">function processingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub55" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub56" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub57" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub58" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub59" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub60" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub61" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub62" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub63" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub64" class="code">function WSE_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub65" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub66" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub67" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub68" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub69" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub70" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub71" class="code">function DisplayShoreline_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub72" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub73" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub74" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub75" class="code">function VerticalGridNodeSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub76" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub77" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub78" class="code">function Contour_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub79" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub80" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub81" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub82" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub83" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub84" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub85" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub86" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub87" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub88" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub89" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub90" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub91" class="code">function handles = buildToolbar(handles)</a></li><li><a href="#_sub92" class="code">function load_prefs(hfigure)</a></li><li><a href="#_sub93" class="code">function store_prefs(hfigure,pref)</a></li><li><a href="#_sub94" class="code">function initGUI(handles)</a></li><li><a href="#_sub95" class="code">function set_enable(handles,enable_state)</a></li><li><a href="#_sub96" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] =</a></li><li><a href="#_sub97" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a></li><li><a href="#_sub98" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a></li><li><a href="#_sub99" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a></li><li><a href="#_sub100" class="code">function dialogOK(hObject,eventdata,h_OK)</a></li><li><a href="#_sub101" class="code">function dialogCancel(hObject,eventdata,handles)</a></li><li><a href="#_sub102" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a></li><li><a href="#_sub103" class="code">function [beam_angle,magnetic_variation,wse,output_auxiliary_data] = exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,hf)</a></li><li><a href="#_sub104" class="code">function dialogExportSettings(hObject,eventdata,handles)</a></li><li><a href="#_sub105" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a></li><li><a href="#_sub106" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a></li><li><a href="#_sub107" class="code">function icons = getIcons</a></li><li><a href="#_sub108" class="code">function guiparams = createGUIparams</a></li><li><a href="#_sub109" class="code">function ShiptracksZoom_Callback(obj,evd,handles)</a></li><li><a href="#_sub110" class="code">function ShiptracksPan_Callback(obj,evd,handles)</a></li><li><a href="#_sub111" class="code">function figure1_WindowKeyPressFcn(hObject, eventdata, handles)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function varargout = VMT(varargin)</a>
0002 <span class="comment">% --- THE VELOCITY MAPPING TOOLBOX ---</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% VMT is a Matlab-based software for processing and visualizing ADCP data</span>
0005 <span class="comment">% collected along transects in rivers or other bodies of water. VMT allows</span>
0006 <span class="comment">% rapid processing, visualization, and analysis of a range of ADCP datasets</span>
0007 <span class="comment">% and includes utilities to export ADCP data to files compatible with</span>
0008 <span class="comment">% ArcGIS, Tecplot, and Google Earth. The software can be used to explore</span>
0009 <span class="comment">% patterns of three-dimensional fluid motion through several methods for</span>
0010 <span class="comment">% calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et</span>
0011 <span class="comment">% al., 2000). The software also includes capabilities for analyzing the</span>
0012 <span class="comment">% acoustic backscatter and bathymetric data from the ADCP. A user-friendly</span>
0013 <span class="comment">% graphical user interface (GUI) enhances program functionality and</span>
0014 <span class="comment">% provides ready access to two- and three- dimensional plotting functions,</span>
0015 <span class="comment">% allowing rapid display and interrogation of velocity, backscatter, and</span>
0016 <span class="comment">% bathymetry data.</span>
0017 <span class="comment">%</span>
0018 <span class="comment">% CITATION:</span>
0019 <span class="comment">% Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.</span>
0020 <span class="comment">% L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,</span>
0021 <span class="comment">% J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and</span>
0022 <span class="comment">% visualization suite for moving-vessel ADCP measurements. Earth Surf.</span>
0023 <span class="comment">% Process. Landforms. doi: 10.1002/esp.3367</span>
0024 <span class="comment">%</span>
0025 <span class="comment">%__________________________________________________________________________</span>
0026 <span class="comment">% P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center</span>
0027 <span class="comment">% (pjackson@usgs.gov)</span>
0028 <span class="comment">%</span>
0029 <span class="comment">% Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.</span>
0030 <span class="comment">%__________________________________________________________________________</span>
0031 
0032 <span class="comment">% Begin initialization code - DO NOT EDIT</span>
0033 gui_Singleton = 1;
0034 gui_State = struct(<span class="string">'gui_Name'</span>,       mfilename, <span class="keyword">...</span>
0035     <span class="string">'gui_Singleton'</span>,  gui_Singleton, <span class="keyword">...</span>
0036     <span class="string">'gui_OpeningFcn'</span>, @<a href="#_sub1" class="code" title="subfunction VMT_OpeningFcn(hObject, eventdata, handles, varargin)">VMT_OpeningFcn</a>, <span class="keyword">...</span>
0037     <span class="string">'gui_OutputFcn'</span>,  @<a href="#_sub2" class="code" title="subfunction varargout = VMT_OutputFcn(hObject, eventdata, handles)">VMT_OutputFcn</a>, <span class="keyword">...</span>
0038     <span class="string">'gui_LayoutFcn'</span>,  [] , <span class="keyword">...</span>
0039     <span class="string">'gui_Callback'</span>,   []);
0040 <span class="keyword">if</span> nargin &amp;&amp; ischar(varargin{1})
0041     gui_State.gui_Callback = str2func(varargin{1});
0042 <span class="keyword">end</span>
0043 
0044 <span class="comment">% If ERROR, write a txt file with the error dump info</span>
0045 <span class="keyword">try</span>
0046 <span class="keyword">if</span> nargout
0047     [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
0048 <span class="keyword">else</span>
0049     gui_mainfcn(gui_State, varargin{:});
0050 <span class="keyword">end</span>
0051 
0052 <span class="keyword">catch</span> err
0053     <span class="keyword">if</span> isdeployed
0054         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
0055             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
0056         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
0057             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
0058             errLogFileName},<span class="keyword">...</span>
0059             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0060             <span class="string">'error'</span>);
0061         fid = fopen(errLogFileName,<span class="string">'W'</span>);
0062         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
0063         fclose(fid);
0064         rethrow(err)
0065     <span class="keyword">else</span>
0066         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
0067             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0068             <span class="string">'error'</span>);
0069         rethrow(err);
0070     <span class="keyword">end</span>
0071 <span class="keyword">end</span>
0072 <span class="comment">% End initialization code - DO NOT EDIT</span>
0073 
0074 <span class="comment">%#ok&lt;*DEFNU,*INUSL,*INUSD&gt;</span>
0075 
0076 <span class="comment">% --- Executes just before VMT is made visible.</span>
0077 <a name="_sub1" href="#_subfunctions" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a>
0078 <span class="comment">% This function has no output args, see OutputFcn.</span>
0079 <span class="comment">% hObject    handle to figure</span>
0080 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0081 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0082 <span class="comment">% varargin   command line arguments to VMT (see VARARGIN)</span>
0083 
0084 <span class="comment">% Choose default command line output for VMT</span>
0085 handles.output = hObject;
0086 
0087 <span class="comment">% Build the GUI toolbar:</span>
0088 <span class="comment">% ----------------------</span>
0089 handles = <a href="#_sub91" class="code" title="subfunction handles = buildToolbar(handles)">buildToolbar</a>(handles);
0090 
0091 <span class="comment">% Ensure path to utils &amp; docs is available</span>
0092 <span class="comment">% ----------------------------------------</span>
0093 <span class="keyword">if</span> ~isdeployed
0094     filesep = <span class="string">'\'</span>; <span class="comment">% windows</span>
0095     utilspath = [pwd filesep <span class="string">'utils'</span>];
0096     docspath  = [pwd filesep <span class="string">'doc'</span>];
0097     toolspath = [pwd filesep <span class="string">'tools'</span>];
0098     addpath(utilspath,docspath,toolspath)
0099 <span class="keyword">end</span>
0100 
0101 <span class="comment">% Update handles structure</span>
0102 <span class="comment">% ------------------------</span>
0103 guidata(hObject, handles);
0104 
0105 <span class="comment">% Load the GUI preferences:</span>
0106 <span class="comment">% -------------------------</span>
0107 <a href="#_sub92" class="code" title="subfunction load_prefs(hfigure)">load_prefs</a>(handles.figure1)
0108 
0109 <span class="comment">% Initialize the GUI parameters:</span>
0110 <span class="comment">% ------------------------------</span>
0111 guiparams = <a href="#_sub108" class="code" title="subfunction guiparams = createGUIparams">createGUIparams</a>;
0112 guiparams.vmt_version = <span class="string">'v4.06'</span>;
0113 
0114 <span class="comment">% Draw the VMT Background</span>
0115 <span class="comment">% -----------------</span>
0116 pos = get(handles.figure1,<span class="string">'position'</span>);
0117 axes(handles.VMTBackground);
0118 <span class="comment">% if ~isdeployed %isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0119     X = imread(<span class="string">'VMT_Background.png'</span>);
0120     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0121 <span class="comment">% else</span>
0122 <span class="comment">%     X = imread('VMT_Background.png');</span>
0123 <span class="comment">%     X = imresize(X, [pos(4) pos(3)]);</span>
0124 <span class="comment">%     X = uint8(X);</span>
0125 <span class="comment">%     imshow(X,'Border','tight')</span>
0126 <span class="comment">% end</span>
0127 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0128 
0129 <span class="comment">% Store the application data:</span>
0130 <span class="comment">% ---------------------------</span>
0131 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0132 
0133 <span class="comment">% Initialize the GUI:</span>
0134 <span class="comment">% -------------------</span>
0135 <a href="#_sub94" class="code" title="subfunction initGUI(handles)">initGUI</a>(handles)
0136 <a href="#_sub95" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'init'</span>)
0137 <span class="comment">% set(handles.GraphicsExportPanel,'Visible','off')</span>
0138 <span class="comment">% set(handles.ProcessingPanel,'Visible','off')</span>
0139 pos = get(handles.figure1,<span class="string">'Position'</span>);
0140 <span class="comment">% pos(3) = 545;</span>
0141 <span class="comment">% set(handles.figure1,'Position',pos)</span>
0142 movegui(handles.figure1,<span class="string">'center'</span>)
0143 set(handles.figure1,<span class="string">'Resize'</span>,<span class="string">'on'</span>)
0144 
0145 <span class="comment">% Allow access to the VMT Main GUI info by other sub-GUIs by pushing it to</span>
0146 <span class="comment">% the root</span>
0147 setappdata(0  , <span class="string">'hVMTgui'</span>    , gcf);
0148 
0149 <span class="comment">% UIWAIT makes VMT wait for user response (see UIRESUME)</span>
0150 <span class="comment">% uiwait(handles.figure1);</span>
0151 <span class="comment">% [EOF] VMT_OpeningFcn</span>
0152 
0153 
0154 <span class="comment">% --- Outputs from this function are returned to the command line.</span>
0155 <a name="_sub2" href="#_subfunctions" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a>
0156 <span class="comment">% varargout  cell array for returning output args (see VARARGOUT);</span>
0157 <span class="comment">% hObject    handle to figure</span>
0158 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0159 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0160 
0161 <span class="comment">% Get default command line output from handles structure</span>
0162 varargout{1} = handles.output;
0163 <span class="comment">% [EOF] VMT_OutputFcn</span>
0164 
0165 <span class="comment">% --- Executes when figure1 is resized.</span>
0166 <a name="_sub3" href="#_subfunctions" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a>
0167 
0168 <span class="comment">% Draw the VMT Background</span>
0169 <span class="comment">% -----------------</span>
0170 pos = get(handles.figure1,<span class="string">'position'</span>);
0171 axes(handles.VMTBackground);
0172 <span class="comment">% if ~isdeployed %isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0173     X = imread(<span class="string">'VMT_Background.png'</span>);
0174     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0175 <span class="comment">% else</span>
0176 <span class="comment">%     X = imread('VMT_Background.png');</span>
0177 <span class="comment">%     X = imresize(X, [pos(4) pos(3)]);</span>
0178 <span class="comment">%     X = uint8(X);</span>
0179 <span class="comment">%     imshow(X,'Border','tight')</span>
0180 <span class="comment">% end</span>
0181 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0182 
0183 <span class="comment">% --- Executes when user attempts to close figure1.</span>
0184 <a name="_sub4" href="#_subfunctions" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a>
0185 <span class="comment">% hObject    handle to figure1 (see GCBO)</span>
0186 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0187 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0188 
0189 <span class="comment">% Hint: delete(hObject) closes the figure</span>
0190 close_button = questdlg(<span class="keyword">...</span>
0191     <span class="string">'You are about to exit VMT. Any unsaved work will be lost. Are you sure?'</span>,<span class="keyword">...</span>
0192     <span class="string">'Exit VMT?'</span>,<span class="string">'No'</span>);
0193 <span class="keyword">switch</span> close_button
0194     <span class="keyword">case</span> <span class="string">'Yes'</span>
0195         delete(hObject)
0196         close all hidden
0197     <span class="keyword">otherwise</span>
0198         <span class="keyword">return</span>
0199 <span class="keyword">end</span>
0200 <span class="comment">% [EOF] figure1_CloseRequestFcn</span>
0201 
0202 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0203 <span class="comment">% MENU BAR CALLBACKS %</span>
0204 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0205 
0206 <span class="comment">% --------------------------------------------------------------------</span>
0207 <a name="_sub5" href="#_subfunctions" class="code">function menuFile_Callback(hObject, eventdata, handles)</a>
0208 <span class="comment">% Empty</span>
0209 
0210 <span class="comment">% --------------------------------------------------------------------</span>
0211 <a name="_sub6" href="#_subfunctions" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a>
0212 <span class="comment">% Empty</span>
0213 
0214 <span class="comment">% --------------------------------------------------------------------</span>
0215 <a name="_sub7" href="#_subfunctions" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a>
0216 <a href="#_sub50" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>(hObject, eventdata, handles)
0217 <span class="comment">% [EOF] menuOpenASCII_Callback</span>
0218 
0219 <span class="comment">% --------------------------------------------------------------------</span>
0220 <a name="_sub8" href="#_subfunctions" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a>
0221 
0222 <span class="comment">% Get the Application data:</span>
0223 <span class="comment">% -------------------------</span>
0224 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0225 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0226 
0227 <span class="comment">% Ask the user to select files:</span>
0228 <span class="comment">% -----------------------------</span>
0229 <span class="comment">% current_file = fullfile(guiparams.data_folder,guiparams.data_files{1});</span>
0230 <span class="comment">% current_file = fullfile(guiprefs.mat_path,guiprefs.mat_file);</span>
0231 <span class="keyword">if</span> iscell(guiprefs.mat_file)
0232     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file{1});
0233 <span class="keyword">else</span>
0234     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file);
0235 <span class="keyword">end</span>
0236 [filename,pathname] = <span class="keyword">...</span>
0237     uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-files (*.mat)'</span>}, <span class="keyword">...</span>
0238     <span class="string">'Select MAT File'</span>, <span class="keyword">...</span>
0239     uifile, <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
0240 
0241 <span class="keyword">if</span> ischar(filename) <span class="comment">% Single MAT file loaded</span>
0242     <span class="comment">% Load the data:</span>
0243     <span class="comment">% --------------</span>
0244     vars = load(fullfile(pathname,filename));
0245     
0246     <span class="comment">% Make sure the selected file is a valid file:</span>
0247     <span class="comment">% --------------------------------------------</span>
0248     varnames = fieldnames(vars);
0249     <span class="keyword">if</span> isequal(sort(varnames),{<span class="string">'A'</span> <span class="string">'Map'</span> <span class="string">'V'</span> <span class="string">'z'</span>}')
0250         guiparams.mat_path = pathname;
0251         guiparams.mat_file = filename;
0252         guiparams.z = vars.z;
0253         guiparams.A = vars.A;
0254         guiparams.V = vars.V;
0255         
0256         <span class="comment">% Update the preferences:</span>
0257         <span class="comment">% -----------------------</span>
0258         guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0259         guiprefs.mat_path = pathname;
0260         guiprefs.mat_file = filename;
0261         setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0262         <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0263                      
0264         <span class="comment">% Re-store the Application Data:</span>
0265         <span class="comment">% ------------------------------</span>
0266         setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0267         
0268         <span class="comment">% Update the GUI:</span>
0269         <span class="comment">% ---------------</span>
0270         set(handles.HorizontalGridNodeSpacing,<span class="string">'String'</span>,vars.A(1).hgns)
0271         <a href="#_sub95" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
0272     <span class="keyword">else</span> <span class="comment">% Not a valid file</span>
0273         errordlg(<span class="string">'The selected file is not a valid ADCP data MAT file.'</span>, <span class="keyword">...</span>
0274             <span class="string">'Invalid File...'</span>)
0275     <span class="keyword">end</span>
0276     
0277     <span class="comment">% Set the vertical grid node spacing</span>
0278     <span class="comment">% ----------------------------------</span>
0279     <span class="comment">% For RioGrande probes, use the bin size, else just use the default</span>
0280     <span class="comment">% Backwards compatible</span>
0281     <span class="keyword">if</span> vars.A(1).Sup.wm ~= 3 <span class="comment">% RG</span>
0282         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,double(vars.A(1).Sup.binSize_cm(1))/100)
0283     <span class="keyword">else</span> <span class="comment">% Older file, must be RG</span>
0284         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,0.4)
0285     <span class="keyword">end</span>
0286     
0287 <span class="keyword">elseif</span> iscell(filename) <span class="comment">% Multiple MAT files loaded</span>
0288     <span class="comment">% Set the filenames</span>
0289     <span class="comment">% -----------------</span>
0290     guiparams.mat_path = pathname;
0291     guiparams.mat_file = filename;
0292     
0293     <span class="comment">% Push status to log window</span>
0294     <span class="comment">% -------------------------</span>
0295     log_text = {<span class="keyword">...</span>
0296         <span class="string">'Loading previously processed MAT files.'</span>;<span class="keyword">...</span>
0297         <span class="string">'Directory:'</span>};
0298     log_text = vertcat(log_text, pathname, {<span class="string">'Files:'</span>}, filename');
0299     statusLogging(handles.LogWindow,log_text)
0300     
0301     <span class="comment">% Update the Application Data:</span>
0302     <span class="comment">% ------------------------------</span>
0303     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0304     
0305     <span class="comment">% Update the persistent preferences:</span>
0306     <span class="comment">% ----------------------------------</span>
0307     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0308     guiprefs.mat_path = pathname;
0309     guiprefs.mat_file = filename;
0310     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0311     <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0312         
0313     <span class="comment">% Update the GUI:</span>
0314     <span class="comment">% ---------------</span>
0315     <a href="#_sub95" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'multiplematfiles'</span>)
0316 <span class="keyword">end</span>
0317 
0318 <span class="comment">% [EOF] menuOpenMAT_Callback</span>
0319 
0320 <span class="comment">% --------------------------------------------------------------------</span>
0321 <a name="_sub9" href="#_subfunctions" class="code">function menuSave_Callback(hObject, eventdata, handles)</a>
0322 <span class="comment">% Empty</span>
0323 
0324 <span class="comment">% --------------------------------------------------------------------</span>
0325 <a name="_sub10" href="#_subfunctions" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a>
0326 <a href="#_sub51" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>(hObject, eventdata, handles)
0327 <span class="comment">% [EOF] menuSaveMAT_Callback</span>
0328 
0329 <span class="comment">% --------------------------------------------------------------------</span>
0330 <a name="_sub11" href="#_subfunctions" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a>
0331 <a href="#_sub59" class="code" title="subfunction SaveTecplotFile_Callback(hObject, eventdata, handles)">SaveTecplotFile_Callback</a>(handles,eventdata,handles)
0332 <span class="comment">% [EOF] menuSaveTecplot_Callback</span>
0333 
0334 <span class="comment">% --------------------------------------------------------------------</span>
0335 <a name="_sub12" href="#_subfunctions" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a>
0336 <a href="#_sub60" class="code" title="subfunction SaveGoogleEarthFile_Callback(hObject, eventdata, handles)">SaveGoogleEarthFile_Callback</a>(handles,eventdata,handles)
0337 <span class="comment">% [EOF] menuSaveKMZFile_Callback</span>
0338 
0339 <span class="comment">% --------------------------------------------------------------------</span>
0340 <a name="_sub13" href="#_subfunctions" class="code">function menuExport_Callback(hObject, eventdata, handles)</a>
0341 <span class="comment">% Empty</span>
0342 
0343 <span class="comment">% --------------------------------------------------------------------</span>
0344 <a name="_sub14" href="#_subfunctions" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a>
0345 <span class="comment">% Empty</span>
0346 
0347 <span class="comment">% --------------------------------------------------------------------</span>
0348 <a name="_sub15" href="#_subfunctions" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a>
0349 
0350 <span class="comment">% Get the Application Data:</span>
0351 <span class="comment">% -------------------------</span>
0352 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0353 
0354 <span class="comment">% Update the Application Data:</span>
0355 <span class="comment">% ----------------------------</span>
0356 guiparams.print        = true;
0357 guiparams.presentation = false;
0358 
0359 <span class="comment">% Re-store the Application data:</span>
0360 <span class="comment">% ------------------------------</span>
0361 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0362 
0363 <span class="comment">% Update the GUI:</span>
0364 <span class="comment">% ---------------</span>
0365 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0366 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
0367 
0368 <span class="comment">% [EOF] menuPrintFormat_Callback</span>
0369 
0370 
0371 <span class="comment">% --------------------------------------------------------------------</span>
0372 <a name="_sub16" href="#_subfunctions" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a>
0373 
0374 <span class="comment">% Get the Application Data:</span>
0375 <span class="comment">% -------------------------</span>
0376 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0377 
0378 <span class="comment">% Update the Application Data:</span>
0379 <span class="comment">% ----------------------------</span>
0380 guiparams.print        = false;
0381 guiparams.presentation = true;
0382 
0383 <span class="comment">% Re-store the Application data:</span>
0384 <span class="comment">% ------------------------------</span>
0385 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0386 
0387 <span class="comment">% Update the GUI:</span>
0388 <span class="comment">% ---------------</span>
0389 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0390 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
0391 
0392 <span class="comment">% [EOF] menuPresentationFormat_Callback</span>
0393 
0394 <span class="comment">% --------------------------------------------------------------------</span>
0395 <a name="_sub17" href="#_subfunctions" class="code">function menuGraphicsRenderer_Callback(hObject, eventdata, handles)</a>
0396 <span class="comment">%  --- Empty ---</span>
0397 
0398 <span class="comment">% --------------------------------------------------------------------</span>
0399 <a name="_sub18" href="#_subfunctions" class="code">function menuOpenGL_Callback(hObject, eventdata, handles)</a>
0400 <span class="comment">% Get the Application Data:</span>
0401 <span class="comment">% -------------------------</span>
0402 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0403 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0404 
0405 <span class="comment">% Update the Application Data:</span>
0406 <span class="comment">% ----------------------------</span>
0407 guiparams.renderer  = <span class="string">'OpenGL'</span>;
0408 guiprefs.renderer   = <span class="string">'OpenGL'</span>;
0409 
0410 <span class="comment">% Re-store the Application data:</span>
0411 <span class="comment">% ------------------------------</span>
0412 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0413 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0414 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0415 
0416 <span class="comment">% Update the GUI:</span>
0417 <span class="comment">% ---------------</span>
0418 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0419 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0420 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0421 
0422 <span class="comment">% Modify the existing figures</span>
0423 <span class="comment">% ---------------------------</span>
0424 <span class="comment">% Find what plots exist already</span>
0425 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0426 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0427 
0428 <span class="comment">% Loop through valid figures and adjust</span>
0429 <span class="comment">% -------------------------------------</span>
0430 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0431     <span class="keyword">for</span> i = 1:length(valid_names)
0432         <span class="comment">% Focus the figure</span>
0433         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0434         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0435             figure(hff)
0436             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0437         <span class="keyword">end</span>
0438         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0439         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0440             figure(hff)
0441             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0442         <span class="keyword">end</span>
0443     <span class="keyword">end</span>
0444 <span class="keyword">end</span>
0445 <span class="comment">% [EOF] menuOpenGL_Callback</span>
0446 
0447 
0448 <span class="comment">% --------------------------------------------------------------------</span>
0449 <a name="_sub19" href="#_subfunctions" class="code">function menuPainters_Callback(hObject, eventdata, handles)</a>
0450 <span class="comment">% Get the Application Data:</span>
0451 <span class="comment">% -------------------------</span>
0452 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0453 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0454 
0455 <span class="comment">% Update the Application Data:</span>
0456 <span class="comment">% ----------------------------</span>
0457 guiparams.renderer  = <span class="string">'painters'</span>;
0458 guiprefs.renderer   = <span class="string">'painters'</span>;
0459 
0460 <span class="comment">% Re-store the Application data:</span>
0461 <span class="comment">% ------------------------------</span>
0462 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0463 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0464 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0465 
0466 <span class="comment">% Update the GUI:</span>
0467 <span class="comment">% ---------------</span>
0468 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0469 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0470 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0471 
0472 <span class="comment">% Modify the existing figures</span>
0473 <span class="comment">% ---------------------------</span>
0474 <span class="comment">% Find what plots exist already</span>
0475 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0476 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0477 
0478 <span class="comment">% Loop through valid figures and adjust</span>
0479 <span class="comment">% -------------------------------------</span>
0480 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0481     <span class="keyword">for</span> i = 1:length(valid_names)
0482         <span class="comment">% Focus the figure</span>
0483         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0484         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0485             figure(hff)
0486             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0487         <span class="keyword">end</span>
0488         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0489         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0490             figure(hff)
0491             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0492         <span class="keyword">end</span>
0493     <span class="keyword">end</span>
0494 <span class="keyword">end</span>
0495 <span class="comment">% [EOF] menuPainters_Callback</span>
0496 
0497 <span class="comment">% --------------------------------------------------------------------</span>
0498 <a name="_sub20" href="#_subfunctions" class="code">function menuZbuffer_Callback(hObject, eventdata, handles)</a>
0499 <span class="comment">% Get the Application Data:</span>
0500 <span class="comment">% -------------------------</span>
0501 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0502 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0503 
0504 <span class="comment">% Update the Application Data:</span>
0505 <span class="comment">% ----------------------------</span>
0506 guiparams.renderer  = <span class="string">'zbuffer'</span>;
0507 guiprefs.renderer   = <span class="string">'zbuffer'</span>;
0508 
0509 <span class="comment">% Re-store the Application data:</span>
0510 <span class="comment">% ------------------------------</span>
0511 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0512 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0513 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0514 
0515 <span class="comment">% Update the GUI:</span>
0516 <span class="comment">% ---------------</span>
0517 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0518 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0519 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0520 
0521 <span class="comment">% Modify the existing figures</span>
0522 <span class="comment">% ---------------------------</span>
0523 <span class="comment">% Find what plots exist already</span>
0524 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0525 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0526 
0527 <span class="comment">% Loop through valid figures and adjust</span>
0528 <span class="comment">% -------------------------------------</span>
0529 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0530     <span class="keyword">for</span> i = 1:length(valid_names)
0531         <span class="comment">% Focus the figure</span>
0532         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0533         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0534             figure(hff)
0535             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0536         <span class="keyword">end</span>
0537         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0538         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0539             figure(hff)
0540             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0541         <span class="keyword">end</span>
0542     <span class="keyword">end</span>
0543 <span class="keyword">end</span>
0544 <span class="comment">% [EOF] menuZbuffer_Callback</span>
0545 
0546 <span class="comment">% --------------------------------------------------------------------</span>
0547 <a name="_sub21" href="#_subfunctions" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a>
0548 <span class="comment">% Get the Application data:</span>
0549 <span class="comment">% -------------------------</span>
0550 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0551 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0552 
0553 <span class="comment">% Find what plots exist already</span>
0554 fig_handles = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0555 fig_names   = get(fig_handles,<span class="string">'name'</span>);
0556 
0557 <span class="comment">% Remove the VMT GUI as a valid figure in the list</span>
0558 [~, idx] = ismember({get(handles.figure1,<span class="string">'Name'</span>),<span class="string">'VMT_GraphicsControl'</span>}, fig_names);
0559 <span class="keyword">if</span> ~isempty(idx)
0560     fig_names(idx) = [];
0561 <span class="keyword">end</span>
0562 
0563 <span class="keyword">if</span> guiparams.presentation
0564     figure_style = <span class="string">'presentation'</span>;
0565 <span class="keyword">else</span>
0566     figure_style = <span class="string">'print'</span>;
0567 <span class="keyword">end</span>
0568 
0569 [selected_figures] = <a href="#_sub105" class="code" title="subfunction [selected_figures] = openFiguresDialog(figure_names,hf)">openFiguresDialog</a>(fig_names,handles.figure1);
0570 
0571 <span class="keyword">if</span> isempty(selected_figures) <span class="comment">% User pressed cancel</span>
0572     <span class="keyword">return</span>
0573 <span class="keyword">else</span>
0574     <span class="keyword">for</span> i = 1:length(selected_figures)
0575         <a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>(guiprefs.mat_path,selected_figures(i),figure_style)
0576     <span class="keyword">end</span>
0577 <span class="keyword">end</span>
0578 
0579 
0580 <span class="comment">% [EOF] menuExportFigures_Callback</span>
0581 
0582 <span class="comment">% --------------------------------------------------------------------</span>
0583 <a name="_sub22" href="#_subfunctions" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a>
0584 <span class="comment">% Get the Application data:</span>
0585 <span class="comment">% -------------------------</span>
0586 guiparams              = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0587 beam_angle             = guiparams.beam_angle; 
0588 magnetic_variation     = guiparams.magnetic_variation; 
0589 wse                    = guiparams.wse;
0590 output_auxiliary_data  = guiparams.output_auxiliary_data; 
0591 
0592 <span class="comment">% Open dialog and allow user to select settings</span>
0593 <span class="comment">% ---------------------------------------------</span>
0594 [beam_angle,<span class="keyword">...</span>
0595     magnetic_variation,<span class="keyword">...</span>
0596     wse,<span class="keyword">...</span>
0597     output_auxiliary_data] = <span class="keyword">...</span>
0598     <a href="#_sub103" class="code" title="subfunction [beam_angle,magnetic_variation,wse,output_auxiliary_data] = exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,hf)">exportSettingsDialog</a>(beam_angle,magnetic_variation,wse,output_auxiliary_data,handles.figure1);
0599 
0600 <span class="comment">% Re-store the Application data:</span>
0601 <span class="comment">% ------------------------------</span>
0602 guiparams.beam_angle            = beam_angle;
0603 guiparams.magnetic_variation    = magnetic_variation; 
0604 guiparams.wse                   = wse;
0605 guiparams.output_auxiliary_data = output_auxiliary_data;
0606 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0607 
0608 <span class="comment">% [EOF] menuExportSettings_Callback</span>
0609 
0610 <span class="comment">% --------------------------------------------------------------------</span>
0611 <a name="_sub23" href="#_subfunctions" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
0612 <a href="#_sub61" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>(hObject, eventdata, handles);
0613 <span class="comment">% [EOF] menuExportMultibeamBathymetry_Callback</span>
0614 
0615 
0616 <span class="comment">% --------------------------------------------------------------------</span>
0617 <a name="_sub24" href="#_subfunctions" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a>
0618 
0619 <span class="comment">% Get the Application Data:</span>
0620 <span class="comment">% -------------------------</span>
0621 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0622 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0623 PVdata    = guiparams.iric_anv_planview_data;
0624 iric_path = guiprefs.iric_path;
0625 iric_file = guiprefs.iric_file;
0626 
0627 <span class="comment">% Is there any planview data?</span>
0628 <span class="keyword">if</span> isempty(PVdata)
0629     <span class="comment">% Nothing to do, warn user</span>
0630     log_text = {<span class="string">'No planview plot data to export. User must Plot Plan View first.'</span>};
0631     warndlg(log_text{:},<span class="string">'Nothing to export'</span>)
0632 <span class="keyword">else</span>
0633     <span class="comment">% Save the planview data as output and to an *.anv file with spacing</span>
0634     <span class="comment">% and smoothing (for iRiC)</span>
0635     log_text = {<span class="string">'Exporting iRic formated ANV vector file...'</span>};
0636     [iric_file,iric_path] = uiputfile(<span class="string">'*.anv'</span>,<span class="string">'Save *.anv file'</span>,<span class="keyword">...</span>
0637         fullfile(iric_path,iric_file));
0638     
0639     <span class="keyword">if</span> ischar(iric_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0640         outfile = fullfile(iric_path,iric_file);
0641         log_text = vertcat(log_text,{outfile});
0642         ofid   = fopen(outfile, <span class="string">'wt'</span>);
0643         outcount = fprintf(ofid,<span class="keyword">...</span>
0644             <span class="string">'%8.2f  %8.2f  %5.2f  %3.3f  %3.3f\n'</span>,PVdata.outmat);
0645         fclose(ofid);
0646     <span class="keyword">else</span>
0647         <span class="comment">% Return default iric_path and iric_file</span>
0648         iric_path = guiprefs.iric_path;
0649         iric_file = guiprefs.iric_file;
0650     <span class="keyword">end</span>
0651 <span class="keyword">end</span>
0652 
0653 <span class="comment">% Push messages to Log Window:</span>
0654 <span class="comment">% ----------------------------</span>
0655 statusLogging(handles.LogWindow, log_text)
0656 
0657 <span class="comment">% Store the persistent preferences:</span>
0658 <span class="comment">% ---------------------------------</span>
0659 guiprefs.iric_file = iric_file;
0660 guiprefs.iric_path = iric_path;
0661 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0662 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'iric'</span>)
0663 
0664 <span class="comment">% [EOF] menuSaveANVFile_Callback</span>
0665 
0666 <span class="comment">% --------------------------------------------------------------------</span>
0667 <a name="_sub25" href="#_subfunctions" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a>
0668 <span class="comment">% Get the Application Data:</span>
0669 <span class="comment">% -------------------------</span>
0670 guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0671 guiprefs    = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0672 excel_path  = guiprefs.excel_path;
0673 excel_file  = guiprefs.excel_file;
0674 
0675 <span class="comment">% Push messages to Log Window:</span>
0676 <span class="comment">% ----------------------------</span>
0677 log_text = {<span class="string">'Exporting Excel File (reprocessing dataset; this will create new plots)'</span>};
0678 statusLogging(handles.LogWindow, log_text)
0679 
0680 <span class="comment">% If there are multiple MAT files loaded, go ahead and export just the DAV</span>
0681 <span class="comment">% data.</span>
0682 <span class="keyword">if</span> iscell(guiparams.mat_file)
0683     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0684     <a href="#_sub56" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0685     <span class="comment">% Refresh the Application Data:</span>
0686     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0687     z           = guiparams.z;
0688     A           = guiparams.A;
0689     V           = guiparams.V;
0690     Map         = guiparams.Map;
0691     wse         = guiparams.wse;
0692     PVdata      = guiparams.iric_anv_planview_data;
0693     log_text = {<span class="string">'Writing data to Excel file...'</span>;<span class="keyword">...</span>
0694         <span class="string">'Multiple transected loaded. Will export Planview Data Only!'</span>};
0695     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
0696         fullfile(excel_path,excel_file));
0697     
0698     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0699         outfile = fullfile(excel_path,excel_file);
0700         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0701         
0702     <span class="keyword">else</span>
0703         <span class="comment">% Return default excel_path and excel_file</span>
0704         excel_path = guiprefs.excel_path;
0705         excel_file = guiprefs.excel_file;
0706         outfile = fullfile(excel_path,excel_file);
0707         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0708     <span class="keyword">end</span>
0709     
0710     <span class="comment">% Delete the old file if it exists</span>
0711     <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
0712         log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
0713             [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
0714             <span class="string">'already exists. Overwriting file...'</span>});
0715         delete(outfile)
0716     <span class="keyword">end</span>
0717     
0718     <span class="comment">% Save DAV data to an Excel File</span>
0719     hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
0720     vmin = num2str(guiparams.depth_range_min);
0721     vmax = num2str(guiparams.depth_range_max);
0722     pvheaders = {<span class="keyword">...</span>
0723         <span class="string">'UTM_East'</span> <span class="string">'UTM_North'</span> <span class="string">'Dist_m'</span> <span class="string">'Bed_Elev_m'</span><span class="keyword">...</span>
0724         [<span class="string">'EastDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0725         [<span class="string">'NorthDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0726         <span class="string">'Vel_mag_cm/s'</span> <span class="string">'Vel_dir_deg'</span>};
0727     
0728 
0729     <span class="comment">% Initialize Variables</span>
0730     pvdata = []; Dist = [];
0731     X = []; Y = []; E = [];
0732     Ve = []; Vn =[]; Vm = []; Vd = [];
0733     
0734     <span class="comment">% Concatenate data from all MAT files into arrays</span>
0735     <span class="keyword">for</span> i = 1:length(guiparams.mat_file)
0736         <span class="comment">% Load current MAT-file</span>
0737         load(fullfile(guiparams.mat_path, guiparams.mat_file{i}))
0738         
0739         <span class="comment">% Location and Bathy</span>
0740         X = [X V.mcsX(1,:)];
0741         Y = [Y V.mcsY(1,:)];
0742         Dist = [Dist sort(V.mcsDist(1,:),<span class="string">'descend'</span>)];
0743         E = [E V.mcsBedElev];
0744         
0745         <span class="comment">% Build layer-averaged velocities</span>
0746         indx = find(V.mcsDepth(:,1) &lt; str2num(vmin) | V.mcsDepth(:,1) &gt; str2num(vmax));
0747         V.mcsX(indx,:) = nan;
0748         V.mcsY(indx,:) = nan;
0749         V.mcsEast(indx,:) = nan;
0750         V.mcsNorth(indx,:) = nan;
0751         Ve = [Ve <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast)];
0752         Vn = [Vn <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth)];
0753         Vm = [Vm sqrt(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast).^2 + <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth).^2)];
0754         Vd = [Vd ari2geodeg(atan2(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth),<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast))*180/pi)];
0755         
0756         waitbar(i/(length(guiparams.mat_file)+1),hwait)
0757     <span class="keyword">end</span>
0758     
0759     <span class="comment">% Put output into 1 matrix</span>
0760     pvdata = [<span class="keyword">...</span>
0761         X; Y; Dist; E;<span class="keyword">...</span><span class="comment"> % Bathy and locations</span>
0762         Ve; Vn; Vm; Vd<span class="keyword">...</span><span class="comment"> % Velocity</span>
0763         ];
0764     pvdata(isnan(pvdata)) = -9999;
0765     
0766     <span class="comment">% Create table and write to Excel</span>
0767     pvout = num2cell(pvdata');
0768     pvout = vertcat(pvheaders,pvout);
0769     xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
0770     
0771     <span class="comment">% Close out waitbar</span>
0772     waitbar(1,hwait)
0773     delete(hwait)
0774     
0775     <span class="comment">% Push messages to Log Window:</span>
0776     <span class="comment">% ----------------------------</span>
0777     statusLogging(handles.LogWindow, log_text)
0778 <span class="keyword">else</span>
0779     
0780     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0781     <a href="#_sub56" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0782     <a href="#_sub57" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
0783     <span class="comment">% Refresh the Application Data:</span>
0784     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0785     z           = guiparams.z;
0786     A           = guiparams.A;
0787     V           = guiparams.V;
0788     Map         = guiparams.Map;
0789     wse         = guiparams.wse;
0790     PVdata      = guiparams.iric_anv_planview_data;
0791     
0792     
0793     log_text = {<span class="string">'Writing data to Excel file...'</span>};
0794     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
0795         fullfile(excel_path,excel_file));
0796     
0797     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0798         outfile = fullfile(excel_path,excel_file);
0799         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0800         
0801         <span class="comment">% Delete the old file if it exists</span>
0802         <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
0803             log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
0804                 [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
0805                 <span class="string">'already exists. Overwriting file...'</span>});
0806             delete(outfile)
0807         <span class="keyword">end</span>
0808         
0809         <span class="comment">% Push messages to Log Window:</span>
0810         <span class="comment">% ----------------------------</span>
0811         statusLogging(handles.LogWindow, log_text)
0812         
0813         <span class="comment">% Save MCS Summary to an Excel File</span>
0814         hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
0815         xlswrite(outfile,{<span class="string">'Files:'</span>},<span class="string">'VMTSummary'</span>,<span class="string">'H4'</span>); waitbar(1/5,hwait)
0816         sout = guiparams.data_files';
0817         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'I4'</span>); waitbar(2/5,hwait)
0818         sout = {<span class="keyword">...</span>
0819             <span class="string">'VMT: Summary of Mean Cross Section'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0820             <span class="string">'VMT '</span> guiparams.vmt_version <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0821             <span class="string">'Date Processed: '</span> datestr(now) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0822             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0823             <span class="string">'Mean Cross Section (MCS) Properties'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0824             <span class="string">'Horz. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.horizontal_grid_node_spacing;<span class="keyword">...</span>
0825             <span class="string">'Vert. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> single(guiparams.A(1).Sup.binSize_cm)/100;<span class="keyword">...</span>
0826             <span class="string">'Endpoints:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">'UTM_East'</span>    <span class="string">'UTM_North'</span>;<span class="keyword">...</span>
0827             <span class="string">'Left Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xLeftBank V.yLeftBank;<span class="keyword">...</span>
0828             <span class="string">'Right Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xRightBank V.yRightBank;<span class="keyword">...</span>
0829             <span class="string">'Total Length in meters'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.dl;<span class="keyword">...</span>
0830             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0831             <span class="string">'Mean Flow Direction (deg)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.mfd;<span class="keyword">...</span>
0832             <span class="string">'in geographic coordinates'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0833             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0834             <span class="string">'Slope'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.m;<span class="keyword">...</span>
0835             <span class="string">'Intercept'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.b;<span class="keyword">...</span>
0836             <span class="string">'Theta (deg)'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.theta};
0837         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'A1'</span>); waitbar(3/5,hwait)
0838         
0839         <span class="comment">% Save DAV data to an Excel File</span>
0840         vmin = num2str(guiparams.depth_range_min);
0841         vmax = num2str(guiparams.depth_range_max);
0842         pvheaders = {<span class="keyword">...</span>
0843             <span class="string">'UTM_East_WGS84'</span> <span class="string">'UTM_North_WGS84'</span> <span class="string">'Dist_m'</span> <span class="string">'Bed_Elev_m'</span><span class="keyword">...</span>
0844             [<span class="string">'EastDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
0845             [<span class="string">'NorthDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
0846             <span class="string">'Vel_mag_cms'</span> <span class="string">'Vel_dir_deg'</span>};
0847         
0848         <span class="comment">% Create block style matrix of all processed data</span>
0849         pvdata = [];
0850         
0851         <span class="comment">% Sort the Distances such that when plotting in 2D (Dist. vs. Depth),</span>
0852         <span class="comment">% you are looking upstream into the transect</span>
0853         Dist = sort(V.mcsDist,2,<span class="string">'descend'</span>);
0854         
0855         <span class="comment">% Build bathy data matrix</span>
0856         pvdata = [V.mcsX(1,:); V.mcsY(1,:); Dist(1,:); V.mcsBedElev];
0857         
0858         <span class="comment">% Build layer-averaged velocities</span>
0859         indx = find(V.mcsDepth(:,1) &lt; str2num(vmin) | V.mcsDepth(:,1) &gt; str2num(vmax));
0860         V.mcsX(indx,:) = nan;
0861         V.mcsY(indx,:) = nan;
0862         V.mcsEast(indx,:) = nan;
0863         V.mcsNorth(indx,:) = nan;
0864         pvdata = [<span class="keyword">...</span>
0865             pvdata;<span class="keyword">...</span>
0866             <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast);<span class="keyword">...</span>
0867             <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth);<span class="keyword">...</span>
0868             sqrt(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast).^2 + <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth).^2);<span class="keyword">...</span>
0869             ari2geodeg(atan2(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth), <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast))*180/pi)];
0870         pvdata(isnan(pvdata)) = -9999;
0871         pvout = num2cell(pvdata');
0872         pvout = vertcat(pvheaders,pvout);
0873         xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
0874         waitbar(4/5,hwait)
0875         
0876         <span class="comment">% Save MCS data to an Excel File</span>
0877         mcsheaders = {<span class="keyword">...</span>
0878             <span class="string">'UTM_East'</span> <span class="keyword">...</span>
0879             <span class="string">'UTM_North'</span><span class="keyword">...</span>
0880             <span class="string">'Distance from Left Bank, in meters'</span><span class="keyword">...</span>
0881             <span class="string">'Elevation, in meters'</span><span class="keyword">...</span>
0882             <span class="keyword">...</span><span class="comment">'Bed Elevation, in meters'...</span>
0883             <span class="string">'East Velocity, in cm/s'</span><span class="keyword">...</span>
0884             <span class="string">'North Velocity, in cm/s'</span><span class="keyword">...</span>
0885             <span class="string">'Vertical Velocity, in cm/s'</span><span class="keyword">...</span>
0886             <span class="string">'Velocity Magnitude, in cm/s'</span><span class="keyword">...</span>
0887             <span class="string">'Velocity Direction, in degrees (geographic coordinates)'</span><span class="keyword">...</span>
0888             <span class="string">'Streamwise Velocity, in cm/s'</span><span class="keyword">...</span>
0889             <span class="string">'Transverse Velocity, in cm/s'</span><span class="keyword">...</span>
0890             <span class="string">'Primary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
0891             <span class="string">'Secondary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
0892             <span class="string">'Primary Velocity (roz), in cm/s'</span><span class="keyword">...</span>
0893             <span class="string">'Secondary Velocity (roz), in cm/s'</span>};
0894         
0895         mcsdata = [<span class="keyword">...</span>
0896             V.mcsX(:)<span class="keyword">...</span>
0897             V.mcsY(:)<span class="keyword">...</span>
0898             V.mcsDist(:)<span class="keyword">...</span>
0899             (wse - V.mcsDepth(:))<span class="keyword">...</span>
0900             <span class="keyword">...</span><span class="comment">repmat((wse - V.mcsBed(:)),size(V.mcsX,1),1)...</span>
0901             V.mcsEast(:)<span class="keyword">...</span>
0902             V.mcsNorth(:)<span class="keyword">...</span>
0903             V.mcsVert(:)<span class="keyword">...</span>
0904             V.mcsMag(:)<span class="keyword">...</span>
0905             V.mcsDir(:)<span class="keyword">...</span>
0906             V.u(:)<span class="keyword">...</span>
0907             V.v(:)<span class="keyword">...</span>
0908             V.vp(:)<span class="keyword">...</span>
0909             V.vs(:)<span class="keyword">...</span>
0910             V.Roz.up(:)<span class="keyword">...</span>
0911             V.Roz.us(:)];
0912         mcsdata(isnan(mcsdata)) = -9999;
0913         
0914         mcsout = vertcat(mcsheaders,num2cell(mcsdata));
0915         xlswrite(outfile,mcsout,<span class="string">'MeanCrossSection'</span>);
0916         waitbar(1,hwait)
0917         delete(hwait)
0918         
0919     <span class="keyword">else</span>
0920         <span class="comment">% Return default excel_path and excel_file</span>
0921         excel_path = guiprefs.excel_path;
0922         excel_file = guiprefs.excel_file;
0923         outfile = fullfile(excel_path,excel_file);
0924         log_text = {<span class="string">'User aborted Excel export...'</span>};
0925     <span class="keyword">end</span>
0926     
0927     
0928     
0929 <span class="keyword">end</span>
0930 
0931 <span class="comment">% Push messages to Log Window:</span>
0932 <span class="comment">% ----------------------------</span>
0933 statusLogging(handles.LogWindow, log_text)
0934 
0935 <span class="comment">% Store the persistent preferences:</span>
0936 <span class="comment">% ---------------------------------</span>
0937 guiprefs.excel_file = excel_file;
0938 guiprefs.excel_path = excel_path;
0939 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0940 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'excel'</span>)
0941 
0942 <span class="comment">% [EOF] menuSaveExcel_Callback</span>
0943 
0944 <span class="comment">% --------------------------------------------------------------------</span>
0945 <a name="_sub26" href="#_subfunctions" class="code">function menuParameters_Callback(hObject, eventdata, handles)</a>
0946 <span class="comment">% Empty</span>
0947 
0948 <span class="comment">% --------------------------------------------------------------------</span>
0949 <a name="_sub27" href="#_subfunctions" class="code">function menuProcessingParameters_Callback(hObject, eventdata, handles)</a>
0950 <span class="comment">% Empty</span>
0951 
0952 <span class="comment">% --------------------------------------------------------------------</span>
0953 <a name="_sub28" href="#_subfunctions" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a>
0954 <span class="comment">% Turn ON or OFF Unit Discharge Correction</span>
0955 
0956 <span class="comment">% Get the Application Data:</span>
0957 <span class="comment">% -------------------------</span>
0958 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0959 
0960 <span class="comment">% Update the GUI &amp; Application Data:</span>
0961 <span class="comment">% ----------------------------------</span>
0962 status = get(handles.menuUnitDischargeCorrection,<span class="string">'Checked'</span>);
0963 <span class="keyword">switch</span> status
0964     <span class="keyword">case</span> <span class="string">'on'</span> <span class="comment">% Turn it off</span>
0965         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0966         guiparams.unit_discharge_correction = false;
0967     <span class="keyword">case</span> <span class="string">'off'</span> <span class="comment">% Turn it on</span>
0968         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0969         guiparams.unit_discharge_correction = true;
0970 <span class="keyword">end</span>
0971 
0972 <span class="comment">% Re-store the Application data:</span>
0973 <span class="comment">% ------------------------------</span>
0974 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0975 
0976 
0977 <span class="comment">%  [EOF] menuUnitDischargeCorrection_Callback</span>
0978 
0979 <span class="comment">% --------------------------------------------------------------------</span>
0980 <a name="_sub29" href="#_subfunctions" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a>
0981 <span class="comment">% Empty</span>
0982 
0983 <span class="comment">% --------------------------------------------------------------------</span>
0984 <a name="_sub30" href="#_subfunctions" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a>
0985 <span class="comment">% Empty</span>
0986 
0987 <span class="comment">% --------------------------------------------------------------------</span>
0988 <a name="_sub31" href="#_subfunctions" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a>
0989 <span class="comment">% Set the Plotting Parameter Units to &quot;metric&quot;</span>
0990 
0991 <span class="comment">% Get the Application Data:</span>
0992 <span class="comment">% -------------------------</span>
0993 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0994 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0995 
0996 <span class="comment">% Update the Application Data:</span>
0997 <span class="comment">% ----------------------------</span>
0998 guiparams.english_units = false;
0999 guiprefs.units = <span class="string">'metric'</span>;
1000 
1001 <span class="comment">% Re-store the Application data:</span>
1002 <span class="comment">% ------------------------------</span>
1003 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1004 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1005 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'units'</span>)
1006 
1007 <span class="comment">% Update the GUI:</span>
1008 <span class="comment">% ---------------</span>
1009 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1010 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1011 
1012 <span class="comment">% [EOF] menuMetric_Callback</span>
1013 
1014 
1015 <span class="comment">% --------------------------------------------------------------------</span>
1016 <a name="_sub32" href="#_subfunctions" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a>
1017 <span class="comment">% Set the Plotting Parameter Units to &quot;english&quot;</span>
1018 
1019 <span class="comment">% Get the Application Data:</span>
1020 <span class="comment">% -------------------------</span>
1021 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1022 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1023 
1024 <span class="comment">% Update the Application Data:</span>
1025 <span class="comment">% ----------------------------</span>
1026 guiparams.english_units = true;
1027 guiprefs.units = <span class="string">'english'</span>;
1028 
1029 <span class="comment">% Re-store the Application data:</span>
1030 <span class="comment">% ------------------------------</span>
1031 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1032 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1033 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'units'</span>)
1034 
1035 <span class="comment">% Update the GUI:</span>
1036 <span class="comment">% ---------------</span>
1037 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1038 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1039 
1040 <span class="comment">% [EOF] menuEnglish_Callback</span>
1041 
1042 
1043 <span class="comment">% --------------------------------------------------------------------</span>
1044 <a name="_sub33" href="#_subfunctions" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
1045 <span class="comment">% Empty</span>
1046 
1047 <span class="comment">% --------------------------------------------------------------------</span>
1048 <a name="_sub34" href="#_subfunctions" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a>
1049 <span class="comment">% Set cross-section endpoints automatically</span>
1050 
1051 <span class="comment">% Get the Application Data:</span>
1052 <span class="comment">% -------------------------</span>
1053 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1054 
1055 <span class="comment">% Update the Application Data:</span>
1056 <span class="comment">% ----------------------------</span>
1057 guiparams.set_cross_section_endpoints = false;
1058 
1059 <span class="comment">% Re-store the Application data:</span>
1060 <span class="comment">% ------------------------------</span>
1061 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1062 
1063 <span class="comment">% Update the GUI:</span>
1064 <span class="comment">% ---------------</span>
1065 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1066 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1067 
1068 <span class="comment">% [EOF] menuCrossSectionEndpointAutomatic_Callback</span>
1069 
1070 
1071 <span class="comment">% --------------------------------------------------------------------</span>
1072 <a name="_sub35" href="#_subfunctions" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a>
1073 <span class="comment">% Set cross-section endpoints manually</span>
1074 
1075 <span class="comment">% Get the Application Data:</span>
1076 <span class="comment">% -------------------------</span>
1077 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1078 
1079 <span class="comment">% Update the Application Data:</span>
1080 <span class="comment">% ----------------------------</span>
1081 guiparams.set_cross_section_endpoints = true;
1082 
1083 <span class="comment">% Re-store the Application data:</span>
1084 <span class="comment">% ------------------------------</span>
1085 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1086 
1087 <span class="comment">% Update the GUI:</span>
1088 <span class="comment">% ---------------</span>
1089 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1090 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1091 
1092 <span class="comment">% [EOF] menuCrossSectionEndpointManual_Callback</span>
1093 
1094 
1095 
1096 
1097 <span class="comment">% --------------------------------------------------------------------</span>
1098 <a name="_sub36" href="#_subfunctions" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a>
1099 <span class="comment">% Empty</span>
1100 
1101 <span class="comment">% --------------------------------------------------------------------</span>
1102 <a name="_sub37" href="#_subfunctions" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a>
1103 
1104 <span class="comment">% Get the Application Data:</span>
1105 <span class="comment">% -------------------------</span>
1106 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1107 
1108 <span class="comment">% Update the Application Data:</span>
1109 <span class="comment">% ----------------------------</span>
1110 guiparams.print        = true;
1111 guiparams.presentation = false;
1112 
1113 <span class="comment">% Re-store the Application data:</span>
1114 <span class="comment">% ------------------------------</span>
1115 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1116 
1117 <span class="comment">% Update the GUI:</span>
1118 <span class="comment">% ---------------</span>
1119 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1120 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1121 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1122 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1123 
1124 <span class="comment">% Modify the existing figures</span>
1125 <span class="comment">% ---------------------------</span>
1126 <span class="comment">% Find what plots exist already</span>
1127 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
1128 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
1129 
1130 <span class="comment">% Defaults for Print Stlye Figure</span>
1131 BkgdColor   = <span class="string">'white'</span>;
1132 AxColor     = <span class="string">'black'</span>;
1133 FigColor    = <span class="string">'white'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
1134 FntSize     = 14;
1135 
1136 <span class="comment">% Loop through valid figures and adjust</span>
1137 <span class="comment">% -------------------------------------</span>
1138 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
1139     
1140     <span class="keyword">for</span> i = 1:length(valid_names)
1141         <span class="keyword">switch</span> valid_names{i}
1142             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
1143                 <span class="comment">% Focus the figure</span>
1144                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
1145                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1146                     figure(hff)
1147                     
1148                     <span class="comment">% Make the changes to figure</span>
1149                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1150                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1151                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1152                     set(gca,<span class="string">'Color'</span>,FigColor)
1153                     set(gca,<span class="string">'XColor'</span>,AxColor)
1154                     set(gca,<span class="string">'YColor'</span>,AxColor)
1155                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1156                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1157                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1158                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1159                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1160                 <span class="keyword">end</span>
1161             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
1162                 <span class="comment">% Focus the figure</span>
1163                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
1164                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1165                     figure(hff)
1166                     
1167                     <span class="comment">% Make the changes to figure</span>
1168                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1169                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1170                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1171                     set(gca,<span class="string">'Color'</span>,FigColor)
1172                     set(gca,<span class="string">'XColor'</span>,AxColor)
1173                     set(gca,<span class="string">'YColor'</span>,AxColor)
1174                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1175                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1176                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1177                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1178                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1179                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
1180                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
1181                 <span class="keyword">end</span>
1182             <span class="keyword">otherwise</span>
1183         <span class="keyword">end</span>
1184     <span class="keyword">end</span>
1185     
1186     
1187 <span class="keyword">end</span>
1188 
1189 
1190 <span class="comment">%[EOF] menuStylePrint_Callback</span>
1191 
1192 
1193 <span class="comment">% --------------------------------------------------------------------</span>
1194 <a name="_sub38" href="#_subfunctions" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a>
1195 <span class="comment">% Get the Application Data:</span>
1196 <span class="comment">% -------------------------</span>
1197 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1198 
1199 <span class="comment">% Update the Application Data:</span>
1200 <span class="comment">% ----------------------------</span>
1201 guiparams.print        = false;
1202 guiparams.presentation = true;
1203 
1204 <span class="comment">% Re-store the Application data:</span>
1205 <span class="comment">% ------------------------------</span>
1206 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1207 
1208 <span class="comment">% Update the GUI:</span>
1209 <span class="comment">% ---------------</span>
1210 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1211 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1212 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1213 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1214 
1215 <span class="comment">% Modify the existing figures</span>
1216 <span class="comment">% ---------------------------</span>
1217 <span class="comment">% Find what plots exist already</span>
1218 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
1219 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
1220 
1221 <span class="comment">% Defaults for Presentation Stlye Figure</span>
1222 <span class="comment">% --------------------------------------</span>
1223 BkgdColor   = <span class="string">'black'</span>;
1224 AxColor     = <span class="string">'white'</span>;
1225 FigColor    = <span class="string">'black'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
1226 FntSize     = 14;
1227 
1228 <span class="comment">% Loop through valid figures and adjust</span>
1229 <span class="comment">% -------------------------------------</span>
1230 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
1231     
1232     <span class="keyword">for</span> i = 1:length(valid_names)
1233         <span class="keyword">switch</span> valid_names{i}
1234             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
1235                 <span class="comment">% Focus the figure</span>
1236                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
1237                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1238                     figure(hff)
1239                     
1240                     <span class="comment">% Make the changes to figure</span>
1241                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1242                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1243                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1244                     set(gca,<span class="string">'Color'</span>,FigColor)
1245                     set(gca,<span class="string">'XColor'</span>,AxColor)
1246                     set(gca,<span class="string">'YColor'</span>,AxColor)
1247                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1248                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1249                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1250                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1251                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1252                 <span class="keyword">end</span>
1253             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
1254                 <span class="comment">% Focus the figure</span>
1255                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
1256                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1257                     figure(hff)
1258                     
1259                     <span class="comment">% Make the changes to figure</span>
1260                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1261                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1262                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1263                     set(gca,<span class="string">'Color'</span>,[0.3 0.3 0.3]) <span class="comment">%FigColor)</span>
1264                     set(gca,<span class="string">'XColor'</span>,AxColor)
1265                     set(gca,<span class="string">'YColor'</span>,AxColor)
1266                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1267                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1268                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1269                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1270                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1271                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
1272                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
1273                 <span class="keyword">end</span>
1274             <span class="keyword">otherwise</span>
1275         <span class="keyword">end</span>
1276     <span class="keyword">end</span>
1277     
1278     
1279 <span class="keyword">end</span>
1280 
1281 <span class="comment">% [EOF] menuStylePresentation_Callback</span>
1282 
1283 <span class="comment">% --------------------------------------------------------------------</span>
1284 <a name="_sub39" href="#_subfunctions" class="code">function menuKMZVerticalOffset_Callback(hObject, eventdata, handles)</a>
1285 
1286 <span class="comment">% Get the Application data:</span>
1287 <span class="comment">% -------------------------</span>
1288 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1289 
1290 <span class="comment">% Initialize the answer:</span>
1291 <span class="comment">% ----------------------</span>
1292 numstr = {num2str(guiparams.vertical_offset)};
1293 answer = NaN;
1294 <span class="keyword">while</span> isnan(answer)
1295     answer = inputdlg(<span class="string">'Vertical Offset (m)'</span>,<span class="string">'KMZ Export'</span>,1,numstr);
1296     
1297     <span class="keyword">if</span> isempty(answer) <span class="comment">% User hits &quot;Cancel&quot;</span>
1298         <span class="keyword">return</span>
1299     <span class="keyword">end</span>
1300     
1301     answer = str2double(answer); <span class="comment">% A non-numeric char will be NaN</span>
1302     <span class="comment">% A numeric char will be a double</span>
1303 <span class="keyword">end</span>
1304 
1305 <span class="comment">% Re-store the Application data:</span>
1306 <span class="comment">% ------------------------------</span>
1307 guiparams.vertical_offset = answer;
1308 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1309 
1310 <span class="comment">% [EOF] menuKMZExport_Callback</span>
1311 
1312 <span class="comment">% --------------------------------------------------------------------</span>
1313 <a name="_sub40" href="#_subfunctions" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a>
1314 <span class="comment">% Not implemented</span>
1315 
1316 <span class="comment">% --------------------------------------------------------------------</span>
1317 <a name="_sub41" href="#_subfunctions" class="code">function menuTools_Callback(hObject, eventdata, handles)</a>
1318 <span class="comment">% Empty</span>
1319 
1320 <span class="comment">% --------------------------------------------------------------------</span>
1321 <a name="_sub42" href="#_subfunctions" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a>
1322 ASCII2GIS_GUI
1323 <span class="comment">% [EOF] menuASCII2GIS_Callback</span>
1324 
1325 <span class="comment">% --------------------------------------------------------------------</span>
1326 <a name="_sub43" href="#_subfunctions" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a>
1327 
1328 <span class="comment">% Get the Application preferences:</span>
1329 <span class="comment">% --------------------------------</span>
1330 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1331 
1332 inpath = guiprefs.kmz_path;
1333 <span class="keyword">if</span> iscell(guiprefs.kmz_file)
1334     infile = guiprefs.kmz_file{1};
1335 <span class="keyword">else</span>
1336     infile = guiprefs.kmz_file;
1337 <span class="keyword">end</span>
1338 [log_text,outpath,outfile] = ASCII2KML(inpath,infile);
1339 
1340 guiprefs.kmz_path = outpath;
1341 guiprefs.kmz_file = outfile;
1342 
1343 <span class="comment">% Update persistent preferences</span>
1344 <span class="comment">% -----------------------------</span>
1345 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1346 
1347 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1348 
1349 <span class="comment">% --------------------------------------------------------------------</span>
1350 <a name="_sub44" href="#_subfunctions" class="code">function menuOpenBatchMode_Callback(hObject, eventdata, handles)</a>
1351 <span class="comment">% Get the Application preferences:</span>
1352 <span class="comment">% --------------------------------</span>
1353 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1354 
1355 VMT_BatchMode;
1356 <span class="comment">% [EOF] menuOpenBatchMode_Callback</span>
1357 
1358 <span class="comment">% --------------------------------------------------------------------</span>
1359 <a name="_sub45" href="#_subfunctions" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a>
1360 <span class="comment">% Empty</span>
1361 
1362 <span class="comment">% --------------------------------------------------------------------</span>
1363 <a name="_sub46" href="#_subfunctions" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a>
1364 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1365 <span class="keyword">try</span> <span class="comment">% to open the User Guide PDF</span>
1366     open([<span class="string">'VMT User Guide '</span> guiparams.vmt_version <span class="string">'.pdf'</span>]);
1367     
1368 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
1369     
1370     <span class="keyword">if</span> isdeployed
1371         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1372             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1373         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1374             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1375             errLogFileName},<span class="keyword">...</span>
1376             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1377             <span class="string">'error'</span>);
1378         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1379         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1380         fclose(fid);
1381         rethrow(err)
1382     <span class="keyword">else</span>
1383         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1384             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1385             <span class="string">'error'</span>);
1386         rethrow(err);
1387     <span class="keyword">end</span>
1388 <span class="keyword">end</span>
1389 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1390 
1391 <span class="comment">% --------------------------------------------------------------------</span>
1392 <a name="_sub47" href="#_subfunctions" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a>
1393 <span class="comment">% Get the Application data:</span>
1394 <span class="comment">% -------------------------</span>
1395 <span class="comment">% guiparams = getappdata(handles.figure1,'guiparams'); %#ok&lt;NASGU&gt;</span>
1396 
1397 <span class="keyword">try</span>
1398     <span class="comment">% Construct a URL to a local file which can be interpreted by any</span>
1399     <span class="comment">% web-browser</span>
1400     rootpath = strrep(pwd,filesep,<span class="string">'/'</span>);
1401     webaddress = [<span class="string">'file:///'</span> rootpath <span class="string">'/doc/index.html'</span>];
1402     system([<span class="string">'start '</span> webaddress]);
1403 <span class="comment">%     [stat,h,url] = web(webaddress) % Produced with m2html (FEX)</span>
1404 <span class="keyword">catch</span> err 
1405     <span class="keyword">if</span> isdeployed
1406         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1407             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1408         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1409             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1410             errLogFileName},<span class="keyword">...</span>
1411             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1412             <span class="string">'error'</span>);
1413         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1414         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1415         fclose(fid);
1416         rethrow(err)
1417     <span class="keyword">else</span>
1418         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1419             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1420             <span class="string">'error'</span>);
1421         rethrow(err);
1422     <span class="keyword">end</span>
1423 <span class="keyword">end</span>
1424 
1425 <span class="comment">% [EOF] menuFunctionLibrary_Callback</span>
1426 
1427 <span class="comment">% --------------------------------------------------------------------</span>
1428 <a name="_sub48" href="#_subfunctions" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a>
1429 
1430 <span class="comment">% Get the Application data:</span>
1431 <span class="comment">% -------------------------</span>
1432 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1433 
1434 <span class="comment">% Check version tag against the web, and display a message</span>
1435 <span class="keyword">try</span>
1436     current_vmt_version = urlread(<span class="string">'http://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt'</span>);
1437     <span class="comment">%     current_vmt_version = urlread('http://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt');</span>
1438 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
1439     <span class="keyword">if</span> isdeployed
1440         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1441             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1442         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1443             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1444             errLogFileName},<span class="keyword">...</span>
1445             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1446             <span class="string">'error'</span>);
1447         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1448         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1449         fclose(fid);
1450         rethrow(err)
1451     <span class="keyword">else</span>
1452         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1453             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1454             <span class="string">'error'</span>);
1455         rethrow(err);
1456     <span class="keyword">end</span>
1457 <span class="keyword">end</span>
1458 
1459 <span class="keyword">if</span> strcmpi(guiparams.vmt_version,current_vmt_version)
1460     h = msgbox(<span class="string">'VMT is currently up to date, no updates available.'</span>,<span class="string">'Check for updates'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1461 <span class="keyword">else</span>
1462     h = msgbox(<span class="string">'VMT is out of date. Please visit the VMT homepage.'</span>,<span class="string">'Check for updates'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1463 <span class="keyword">end</span>
1464 <span class="comment">% [EOF] menuCheckForUpdates_Callback</span>
1465 
1466 <span class="comment">% --------------------------------------------------------------------</span>
1467 <a name="_sub49" href="#_subfunctions" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a>
1468 
1469 <span class="comment">% Get the Application data:</span>
1470 <span class="comment">% -------------------------</span>
1471 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1472 messagestr = <span class="keyword">...</span>
1473     {<span class="string">'The Velocity Mapping Toolbox'</span>;<span class="keyword">...</span>
1474     [<span class="string">'   Version: '</span> guiparams.vmt_version];<span class="keyword">...</span>
1475     <span class="string">''</span>;<span class="keyword">...</span>
1476     <span class="string">''</span>;<span class="keyword">...</span>
1477     <span class="string">'With collaborations from:'</span>;<span class="keyword">...</span>
1478     <span class="string">'   U.S. Geological Survey'</span>;<span class="keyword">...</span>
1479     <span class="string">'   University of Illinois'</span>;<span class="keyword">...</span>
1480     <span class="string">'   University of Hull'</span>;<span class="keyword">...</span>
1481     <span class="string">''</span>;<span class="keyword">...</span>
1482     <span class="string">''</span>;<span class="keyword">...</span>
1483     <span class="string">'Citation: '</span>;<span class="keyword">...</span>
1484     <span class="string">'   Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L.,'</span>;<span class="keyword">...</span>
1485     <span class="string">'   Rhoads, B. L., Oberg, K. A., Best, J. L., Mueller, D. S.,'</span>;<span class="keyword">...</span>
1486     <span class="string">'   Johnson, K. K. and Riley, J. D. (2013), Velocity Mapping'</span>;<span class="keyword">...</span>
1487     <span class="string">'   Toolbox (VMT): a processing and visualization suite for'</span>;<span class="keyword">...</span>
1488     <span class="string">'   moving-vessel ADCP measurements. Earth Surf. Process.'</span>;<span class="keyword">...</span>
1489     <span class="string">'   Landforms.doi: 10.1002/esp.3367'</span>};
1490 h = msgbox(messagestr,<span class="string">'About VMT'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1491 <span class="comment">% [EOF] menuAbout_Callback</span>
1492 
1493 
1494 
1495 
1496 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
1497 <span class="comment">% TOOLBAR CALLBACKS %</span>
1498 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
1499 
1500 <span class="comment">% --------------------------------------------------------------------</span>
1501 <a name="_sub50" href="#_subfunctions" class="code">function loadDataCallback(hObject, eventdata, handles)</a>
1502 <span class="comment">% Read Files into Data Structure using tfile.</span>
1503 
1504 <span class="comment">% Get the Application data:</span>
1505 <span class="comment">% -------------------------</span>
1506 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1507 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1508 
1509 <span class="comment">% Ask the user to select files:</span>
1510 <span class="comment">% -----------------------------</span>
1511 current_file = fullfile(guiprefs.ascii_path,guiprefs.ascii_file{1});
1512 [filename,pathname] = uigetfile({<span class="string">'*_ASC.TXT'</span>,<span class="string">'ASCII (*_ASC.TXT)'</span>}, <span class="keyword">...</span>
1513     <span class="string">'Select the ASCII Output Files'</span>, <span class="keyword">...</span>
1514     current_file, <span class="keyword">...</span>
1515     <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
1516 
1517 <span class="keyword">if</span> ischar(pathname) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
1518     guiparams.data_folder = pathname;
1519     <span class="keyword">if</span> ischar(filename)
1520         filename = {filename};
1521     <span class="keyword">end</span>
1522     guiparams.data_files = filename;
1523     guiparams.mat_file = <span class="string">''</span>;
1524     
1525     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1526     
1527    
1528     
1529     <span class="comment">% Update the preferences:</span>
1530     <span class="comment">% -----------------------</span>
1531     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1532     guiprefs.ascii_path = pathname;
1533     guiprefs.ascii_file = filename;
1534     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1535     <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'ascii'</span>)
1536     
1537     <span class="comment">% Push messages to Log Window:</span>
1538     <span class="comment">% ----------------------------</span>
1539     log_text = {<span class="keyword">...</span>
1540         <span class="string">''</span>;<span class="keyword">...</span>
1541         [<span class="string">'%--- '</span> datestr(now) <span class="string">' ---%'</span>];<span class="keyword">...</span>
1542         <span class="string">'Current Project Directory:'</span>;<span class="keyword">...</span>
1543         guiparams.data_folder;
1544         <span class="string">'Loading the following files into memory:'</span>;<span class="keyword">...</span>
1545         char(filename)};
1546     statusLogging(handles.LogWindow, log_text)
1547     
1548     <span class="comment">% Read the file(s)</span>
1549     <span class="comment">% ----------------</span>
1550     [~,~,savefile,A,z] = <span class="keyword">...</span>
1551         <a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>(guiparams.data_folder,guiparams.data_files);
1552     guiparams.savefile = savefile;
1553     guiparams.A        = A;
1554     guiparams.z        = z;
1555     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1556     
1557     <span class="comment">% Set the vertical grid node spacing</span>
1558     <span class="comment">% ----------------------------------</span>
1559     <span class="comment">% For RioGrande probes, use the bin size, else just use the default</span>
1560     <span class="comment">% Backwards compatible</span>
1561     <span class="keyword">if</span> A(1).Sup.wm ~= 3 <span class="comment">% RG</span>
1562         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,double(A(1).Sup.binSize_cm(1))/100)
1563     <span class="keyword">else</span> <span class="comment">% Older file, must be RG</span>
1564         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,0.4)
1565     <span class="keyword">end</span>
1566        
1567 <span class="comment">%</span>
1568 <span class="comment">%     % Preprocess the data:</span>
1569 <span class="comment">%     % --------------------</span>
1570 <span class="comment">%     A = VMT_PreProcess(z,A);</span>
1571 <span class="comment">%</span>
1572 <span class="comment">%     % Push messages to Log Window:</span>
1573 <span class="comment">%     % ----------------------------</span>
1574 <span class="comment">%     log_text = {...</span>
1575 <span class="comment">%         '   Preprocessing complete.';...</span>
1576 <span class="comment">%         '   Begin Data Processing...'};</span>
1577 <span class="comment">%     statusLogging(handles.LogWindow, log_text)</span>
1578 <span class="comment">%</span>
1579 <span class="comment">%     A(1).hgns = guiparams.horizontal_grid_node_spacing;</span>
1580 <span class="comment">%     A(1).wse  = guiparams.wse;  %Set the WSE to entered value</span>
1581 <span class="comment">%     [A,V,processing_log_text] = VMT_ProcessTransects(z,A,...</span>
1582 <span class="comment">%         guiparams.set_cross_section_endpoints,...</span>
1583 <span class="comment">%         guiparams.unit_discharge_correction);</span>
1584 <span class="comment">%</span>
1585 <span class="comment">%     % Push messages to Log Window:</span>
1586 <span class="comment">%     % ----------------------------</span>
1587 <span class="comment">%     statusLogging(handles.LogWindow, processing_log_text)</span>
1588 <span class="comment">%</span>
1589 <span class="comment">%     % Store the data:</span>
1590 <span class="comment">%     % ---------------</span>
1591 <span class="comment">%     guiparams.z = z;</span>
1592 <span class="comment">%     guiparams.A = A;</span>
1593 <span class="comment">%     guiparams.V = V;</span>
1594 <span class="comment">%     setappdata(handles.figure1,'guiparams',guiparams)</span>
1595     
1596           
1597     <span class="comment">% Update the GUI:</span>
1598     <span class="comment">% ---------------</span>
1599     <a href="#_sub95" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
1600     
1601     <span class="comment">% If data are RG or SP, set vertical grid node spacing to bin size</span>
1602     
1603 <span class="keyword">end</span>
1604 <span class="comment">% [EOF] loadDataCallback</span>
1605 
1606 
1607 
1608 <span class="comment">% --------------------------------------------------------------------</span>
1609 <a name="_sub51" href="#_subfunctions" class="code">function saveDataCallback(hObject, eventdata, handles)</a>
1610 <span class="comment">% SaveMATFile_Callback(handles.SaveMATFile,eventdata,handles)</span>
1611 
1612 <span class="comment">% Get the Application data:</span>
1613 <span class="comment">% -------------------------</span>
1614 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1615 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1616 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1617 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1618 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
1619 
1620 [the_file,the_path] = <span class="keyword">...</span>
1621     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
1622     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
1623     fullfile(guiparams.mat_path,guiparams.savefile));
1624 
1625 <span class="comment">% Save the processed data to a MAT file:</span>
1626 <span class="comment">% --------------------------------------</span>
1627 <span class="keyword">if</span> ischar(the_file)
1628     guiparams.mat_path = the_path;
1629     guiparams.mat_file = the_file;
1630     guiparams.savefile = the_file;
1631     
1632     <span class="comment">% Re-store the Application data:</span>
1633     <span class="comment">% ------------------------------</span>
1634     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1635     
1636     <span class="comment">% Update the preferences:</span>
1637     <span class="comment">% -----------------------</span>
1638     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1639     guiprefs.mat_path = the_path;
1640     guiprefs.mat_file = the_file;
1641     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1642     <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
1643     
1644     [pathstr,filename,extension] = fileparts([guiparams.mat_path guiparams.savefile]);
1645     savefile = fullfile(pathstr,[filename extension]);
1646     <span class="comment">%h = msgbox(['Saving processed data in MAT File ''' filename extension ''''], ...</span>
1647     <span class="comment">%    'Saving Processed Data File...'); %#ok&lt;NASGU&gt;</span>
1648     log_text = {<span class="keyword">...</span>
1649         <span class="string">'Saving Processed Data File...'</span>;<span class="keyword">...</span>
1650         savefile};
1651     statusLogging(handles.LogWindow,log_text)
1652     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
1653 <span class="keyword">end</span>
1654 
1655 <span class="comment">% [EOF] saveDataCallback</span>
1656 
1657 
1658 <span class="comment">% --------------------------------------------------------------------</span>
1659 <a name="_sub52" href="#_subfunctions" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a>
1660 
1661 <span class="comment">% Get the Application data:</span>
1662 <span class="comment">% -------------------------</span>
1663 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1664 z   = guiparams.z;
1665 A   = guiparams.A;
1666 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
1667 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
1668 
1669 <span class="comment">% Compute multibeam bathymetry:</span>
1670 <span class="comment">% -----------------------------</span>
1671 msgbox(<span class="string">'Processing Bathymetry...Please Be Patient'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
1672 <span class="comment">%A = VMT_MBBathy(z,A,savefile,handles.beam_angle,handles.MagneticVariation,handles.WSE);</span>
1673 <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>(z,A,savefile, <span class="keyword">...</span>
1674     guiparams.beam_angle, <span class="keyword">...</span>
1675     guiparams.magnetic_variation, <span class="keyword">...</span>
1676     guiparams.wse, <span class="keyword">...</span>
1677     guiparams.output_auxiliary_data);
1678 
1679 msgbox(<span class="string">'Bathymetry Output Complete'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
1680 
1681 <span class="comment">% [EOF] saveBathymetryCallback</span>
1682 
1683 <span class="comment">% --------------------------------------------------------------------</span>
1684 <a name="_sub53" href="#_subfunctions" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a>
1685 
1686 <span class="comment">% Get the Application data:</span>
1687 <span class="comment">% -------------------------</span>
1688 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1689 
1690 [guiparams.english_units,guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
1691     guiparams.presentation,guiparams.print] = <span class="keyword">...</span>
1692     plotParametersDialog(guiparams.english_units, <span class="keyword">...</span>
1693     guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
1694     guiparams.presentation,guiparams.print,<span class="keyword">...</span>
1695     handles.figure1);
1696 
1697 <span class="comment">% Update the GUI:</span>
1698 <span class="comment">% ---------------</span>
1699 <span class="keyword">if</span> guiparams.english_units
1700     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1701     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1702 <span class="keyword">else</span>
1703     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1704     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1705 <span class="keyword">end</span>
1706 
1707 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
1708     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1709     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1710 <span class="keyword">else</span>
1711     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1712     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1713 <span class="keyword">end</span>
1714 
1715 <span class="keyword">if</span> guiparams.presentation
1716     <a href="#_sub38" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
1717 <span class="comment">%     set(handles.menuStylePrint,           'Checked','off')</span>
1718 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','on')</span>
1719 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','off')</span>
1720 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','on')</span>
1721 <span class="keyword">else</span>
1722     <a href="#_sub37" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
1723 <span class="comment">%     set(handles.menuStylePrint,           'Checked','on')</span>
1724 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','off')</span>
1725 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','on')</span>
1726 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','off')</span>
1727 <span class="keyword">end</span>
1728 
1729 <span class="comment">% Re-store the Application data:</span>
1730 <span class="comment">% ------------------------------</span>
1731 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1732 
1733 <span class="comment">% [EOF] plottingParametersCallback</span>
1734 
1735 
1736 <span class="comment">% --------------------------------------------------------------------</span>
1737 <a name="_sub54" href="#_subfunctions" class="code">function processingParametersCallback(hObject, eventdata, handles)</a>
1738 
1739 <span class="comment">% Get the Application data:</span>
1740 <span class="comment">% -------------------------</span>
1741 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1742 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1743 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1744 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1745 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
1746 
1747 <span class="comment">% [EOF] processingParametersCallback</span>
1748 
1749 
1750 <span class="comment">% --------------------------------------------------------------------</span>
1751 <a name="_sub55" href="#_subfunctions" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a>
1752 <span class="comment">% Plot 1</span>
1753 
1754 <span class="comment">% Get the Application data:</span>
1755 <span class="comment">% -------------------------</span>
1756 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1757 z = guiparams.z;
1758 A = guiparams.A;
1759 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
1760 <span class="comment">% Map = guiparams.Map;</span>
1761 setends = guiparams.set_cross_section_endpoints;
1762 
1763 <span class="comment">% Preprocess the data:</span>
1764 <span class="comment">% --------------------</span>
1765 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
1766 
1767 <span class="comment">% Push messages to Log Window:</span>
1768 <span class="comment">% ----------------------------</span>
1769 log_text = {<span class="keyword">...</span>
1770     <span class="string">'   Preprocessing complete.'</span>;<span class="keyword">...</span>
1771     <span class="string">'   Begin Data Processing...'</span>};
1772 statusLogging(handles.LogWindow, log_text)
1773 
1774 <span class="comment">% Process the transects:</span>
1775 <span class="comment">% ----------------------</span>
1776 A(1).hgns = guiparams.horizontal_grid_node_spacing;
1777 A(1).vgns = guiparams.vertical_grid_node_spacing;
1778 A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
1779 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
1780     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction);
1781 
1782 <span class="comment">% Compute the smoothed variables</span>
1783 <span class="comment">% ------------------------------</span>
1784 <span class="comment">% This is required so that the V struc is complete at any point during</span>
1785 <span class="comment">% runtime.</span>
1786 V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
1787     <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
1788     guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
1789     guiparams.vertical_smoothing_window);
1790 
1791 <span class="comment">% Push messages to Log Window:</span>
1792 <span class="comment">% ----------------------------</span>
1793 statusLogging(handles.LogWindow, processing_log_text)
1794 
1795 <span class="comment">% Store the data:</span>
1796 <span class="comment">% ---------------</span>
1797 guiparams.z = z;
1798 guiparams.A = A;
1799 guiparams.V = V;
1800 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1801 
1802 <span class="comment">% Push messages to Log Window:</span>
1803 <span class="comment">% ----------------------------</span>
1804 log_text = {<span class="string">'Plotting Shiptracks (reprocessing)'</span>};
1805 statusLogging(handles.LogWindow, log_text)
1806 
1807 <span class="comment">% Create or replot the Shiptracks</span>
1808 <span class="comment">% -------------------------------</span>
1809 <span class="comment">% Grab the axes to the plot</span>
1810 <span class="comment">% axes(handles.Plot1Shiptracks);</span>
1811 <a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>(A,V,z,setends,handles.Plot1Shiptracks); <span class="comment">% PLOT 1</span>
1812 
1813 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
1814 <span class="comment">% New plot display window</span>
1815 <span class="comment">% h = VMT_CreatePlotDisplay('shiptracks');</span>
1816 <span class="comment">% h = figure(1); clf</span>
1817 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
1818 
1819 <span class="comment">% [EOF] shiptracksPlotCallback</span>
1820 
1821 
1822 <span class="comment">% --------------------------------------------------------------------</span>
1823 <a name="_sub56" href="#_subfunctions" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a>
1824 <span class="comment">% Plot 2</span>
1825 
1826 <span class="comment">% Get the Application data:</span>
1827 <span class="comment">% -------------------------</span>
1828 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1829 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1830 
1831 <span class="keyword">if</span> iscell(guiparams.mat_file) <span class="comment">% Multiple MAT files loaded</span>
1832     <span class="comment">% Push messages to Log Window:</span>
1833     <span class="comment">% ----------------------------</span>
1834     log_text = {<span class="string">'Plotting Multiple Transects (Planview)'</span>};
1835     statusLogging(handles.LogWindow, log_text)
1836     
1837        
1838     <span class="comment">% Push plotting parameters to log window:</span>
1839     <span class="comment">% ---------------------------------------</span>
1840     log_text = {<span class="keyword">...</span>
1841         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
1842         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
1843         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
1844         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
1845         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
1846         };
1847     statusLogging(handles.LogWindow, log_text)
1848     
1849     <span class="comment">% Plot the data:</span>
1850     <span class="comment">% --------------</span>
1851     z = [];
1852     A = [];
1853     V = [];
1854     Map = [];
1855     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
1856     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
1857         depth_range, <span class="keyword">...</span>
1858         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
1859         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
1860         guiparams.smoothing_window_size, <span class="keyword">...</span>
1861         guiparams.display_shoreline, <span class="keyword">...</span>
1862         guiparams.english_units, <span class="keyword">...</span>
1863         guiparams.mat_file, <span class="keyword">...</span>
1864         guiparams.mat_path); <span class="comment">% PLOT2</span>
1865     statusLogging(handles.LogWindow, log_text)
1866     
1867     <span class="comment">% Plot a Shoreline Map:</span>
1868     <span class="comment">% ---------------------</span>
1869     <span class="keyword">if</span> guiparams.display_shoreline
1870         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
1871             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
1872             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
1873             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
1874         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
1875             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
1876             Map.UTMe   = mapdata(:,1);
1877             Map.UTMn   = mapdata(:,2);
1878             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
1879             <span class="comment">%Map.UTMzone = zone;</span>
1880         <span class="keyword">else</span>
1881             Map = [];
1882         <span class="keyword">end</span>
1883         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
1884         log_text = {<span class="keyword">...</span>
1885             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
1886             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
1887             };
1888         statusLogging(handles.LogWindow, log_text)
1889     <span class="keyword">else</span>
1890         Map = [];
1891     <span class="keyword">end</span>
1892     
1893 <span class="keyword">else</span>
1894     z = guiparams.z;
1895     A = guiparams.A;
1896     <span class="comment">% V = guiparams.V;</span>
1897     Map = guiparams.Map;
1898     
1899     <span class="comment">% Push messages to Log Window:</span>
1900     <span class="comment">% ----------------------------</span>
1901     log_text = {<span class="string">'Plotting Depth Averaged Vectors (reprocessing)'</span>};
1902     statusLogging(handles.LogWindow, log_text)
1903     
1904         
1905     <span class="comment">% Preprocess the data:</span>
1906     <span class="comment">% --------------------</span>
1907     A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
1908     
1909     <span class="comment">% Process the transects:</span>
1910     <span class="comment">% ----------------------</span>
1911     A(1).hgns = guiparams.horizontal_grid_node_spacing;
1912     A(1).vgns = guiparams.vertical_grid_node_spacing;
1913     A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
1914     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
1915         guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction);
1916     
1917     <span class="comment">% Compute the smoothed variables</span>
1918     <span class="comment">% ------------------------------</span>
1919     <span class="comment">% This is required so that the V struc is complete at any point during</span>
1920     <span class="comment">% runtime.</span>
1921     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
1922         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
1923         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
1924         guiparams.vertical_smoothing_window);
1925     
1926     <span class="comment">% Push messages to Log Window:</span>
1927     <span class="comment">% ----------------------------</span>
1928     statusLogging(handles.LogWindow, processing_log_text)
1929     
1930     <span class="comment">% Plot the cross section:</span>
1931     <span class="comment">% -----------------------</span>
1932     log_text = {<span class="keyword">...</span>
1933         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
1934         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
1935         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
1936         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
1937         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
1938         };
1939     statusLogging(handles.LogWindow, log_text)
1940     
1941     <span class="comment">% Plot the data:</span>
1942     <span class="comment">% --------------</span>
1943     <span class="comment">%msgbox('Plotting Plan View','VMT Status','help','replace');</span>
1944     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
1945     
1946     
1947     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
1948         depth_range, <span class="keyword">...</span>
1949         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
1950         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
1951         guiparams.smoothing_window_size, <span class="keyword">...</span>
1952         guiparams.display_shoreline, <span class="keyword">...</span>
1953         guiparams.english_units, <span class="keyword">...</span>
1954         guiparams.mat_file, <span class="keyword">...</span>
1955         guiparams.mat_path); <span class="comment">% PLOT2</span>
1956     statusLogging(handles.LogWindow, log_text)
1957     
1958     <span class="comment">% Plot a Shoreline Map:</span>
1959     <span class="comment">% ---------------------</span>
1960     <span class="keyword">if</span> guiparams.display_shoreline
1961         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
1962             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
1963             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
1964             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
1965         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
1966             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
1967             Map.UTMe   = mapdata(:,1);
1968             Map.UTMn   = mapdata(:,2);
1969             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
1970             <span class="comment">%Map.UTMzone = zone;</span>
1971         <span class="keyword">else</span>
1972             Map = [];
1973         <span class="keyword">end</span>
1974         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
1975         log_text = {<span class="keyword">...</span>
1976             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
1977             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
1978             };
1979         statusLogging(handles.LogWindow, log_text)
1980     <span class="keyword">else</span>
1981         Map = [];
1982     <span class="keyword">end</span>
1983     
1984 <span class="keyword">end</span>
1985 
1986 <span class="keyword">if</span> guiparams.add_background
1987     [guiprefs,log_text] = <a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>(guiprefs);
1988     statusLogging(handles.LogWindow, log_text)
1989 <span class="keyword">end</span>
1990 
1991 <span class="comment">% Update guiparams</span>
1992 <span class="comment">% ----------------</span>
1993 guiparams.z   = z;
1994 guiparams.A   = A;
1995 guiparams.V   = V;
1996 guiparams.Map = Map;
1997 guiparams.iric_anv_planview_data = PVdata;
1998 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams);
1999 
2000 <span class="comment">% Update preferences</span>
2001 <span class="comment">% ------------------</span>
2002 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2003 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'shoreline'</span>)
2004 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'aerial'</span>)
2005 
2006 <span class="comment">% Force plot to be formated properly</span>
2007 <span class="comment">% ----------------------------------</span>
2008 <span class="keyword">if</span> guiparams.presentation
2009     <a href="#_sub38" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2010 <span class="keyword">else</span>
2011     <a href="#_sub37" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2012 <span class="keyword">end</span>
2013 <span class="keyword">switch</span> guiparams.renderer
2014     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
2015         <a href="#_sub18" class="code" title="subfunction menuOpenGL_Callback(hObject, eventdata, handles)">menuOpenGL_Callback</a>(hObject, eventdata, handles)
2016     <span class="keyword">case</span> <span class="string">'painters'</span>
2017         <a href="#_sub19" class="code" title="subfunction menuPainters_Callback(hObject, eventdata, handles)">menuPainters_Callback</a>(hObject, eventdata, handles)
2018     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
2019         <a href="#_sub20" class="code" title="subfunction menuZbuffer_Callback(hObject, eventdata, handles)">menuZbuffer_Callback</a>(hObject, eventdata, handles)
2020 <span class="keyword">end</span>
2021 
2022 <span class="comment">% Focus the figure</span>
2023 <span class="comment">% ----------------</span>
2024 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
2025 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
2026     figure(hff)
2027 <span class="keyword">end</span>
2028 
2029 <span class="comment">% Start the Graphics Control Gui</span>
2030 <span class="comment">% ------------------------------</span>
2031 VMT_GraphicsControl
2032 
2033 <span class="comment">% [EOF] planviewPlotCallback</span>
2034 
2035 
2036 <span class="comment">% --------------------------------------------------------------------</span>
2037 <a name="_sub57" href="#_subfunctions" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a>
2038 <span class="comment">% Plot 3</span>
2039 
2040 <span class="comment">% Get the Application data:</span>
2041 <span class="comment">% -------------------------</span>
2042 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2043 z = guiparams.z;
2044 A = guiparams.A;
2045 <span class="comment">% V = guiparams.V;</span>
2046 <span class="comment">% Map = guiparams.Map;</span>
2047 
2048 <span class="comment">% Preprocess the data:</span>
2049 <span class="comment">% --------------------</span>
2050 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2051 
2052 <span class="comment">% Push messages to Log Window:</span>
2053 <span class="comment">% ----------------------------</span>
2054 log_text = {<span class="string">'Plotting Cross Section (reprocessing)'</span>};
2055 statusLogging(handles.LogWindow, log_text)
2056 
2057 <span class="comment">% Process the transects:</span>
2058 <span class="comment">% ----------------------</span>
2059 A(1).hgns = guiparams.horizontal_grid_node_spacing;
2060 A(1).vgns = guiparams.vertical_grid_node_spacing;
2061 A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2062 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2063     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction);
2064 
2065 <span class="comment">% Push messages to Log Window:</span>
2066 <span class="comment">% ----------------------------</span>
2067 statusLogging(handles.LogWindow, processing_log_text)
2068 
2069 <span class="comment">% Plot the cross section:</span>
2070 <span class="comment">% -----------------------</span>
2071 log_text = {<span class="keyword">...</span>
2072     <span class="string">'Cross Section Plotting Parameters'</span>;<span class="keyword">...</span>
2073     sprintf(<span class="string">'   Contour variable: %s'</span>          ,guiparams.contours(guiparams.idx_contour).string);<span class="keyword">...</span>
2074     sprintf(<span class="string">'   Vertical exaggeration: %d'</span>     ,guiparams.vertical_exaggeration);<span class="keyword">...</span>
2075     sprintf(<span class="string">'   Vector scale: %3.1f'</span>           ,guiparams.vector_scale_cross_section);<span class="keyword">...</span>
2076     sprintf(<span class="string">'   Horizontal vector spacing: %d'</span> ,guiparams.horizontal_vector_spacing);<span class="keyword">...</span>
2077     sprintf(<span class="string">'   Vertical vector spacing: %d'</span>   ,guiparams.vertical_vector_spacing);<span class="keyword">...</span>
2078     sprintf(<span class="string">'   Horizontal smooting window: %d'</span>,guiparams.horizontal_smoothing_window);<span class="keyword">...</span>
2079     sprintf(<span class="string">'   Vertical smoothing window: %d'</span> ,guiparams.vertical_smoothing_window);<span class="keyword">...</span>
2080     };
2081 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
2082     log_text = vertcat(log_text, {<span class="keyword">...</span>
2083         sprintf(<span class="string">'   Vector variable: %s'</span>,guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).string);<span class="keyword">...</span>
2084         sprintf(<span class="string">'   Inc. vertical component?: %d'</span>,guiparams.include_vertical_velocity)<span class="keyword">...</span>
2085         });
2086 <span class="keyword">end</span>
2087 <span class="comment">% Push messages to Log Window:</span>
2088 <span class="comment">% ----------------------------</span>
2089 statusLogging(handles.LogWindow, log_text)
2090 
2091 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
2092     <span class="comment">%msgbox('Plotting Cross Section','VMT Status','help','replace')</span>
2093 <span class="comment">%     V = VMT_SmoothVar(V, ...</span>
2094 <span class="comment">%         ...guiparams.contour, ...</span>
2095 <span class="comment">%         guiparams.horizontal_smoothing_window, ...</span>
2096 <span class="comment">%         guiparams.vertical_smoothing_window);</span>
2097     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2098         <span class="keyword">...</span><span class="comment">guiparams.secondary_flow_vector_variable, ...</span>
2099         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2100         guiparams.vertical_smoothing_window);
2101     [~,A,V,plot_cont_log_text] = <a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,varargin)">VMT_PlotXSContQuiver</a>(z,A,V, <span class="keyword">...</span>
2102         guiparams.contour, <span class="keyword">...</span>
2103         guiparams.vector_scale_cross_section, <span class="keyword">...</span>
2104         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2105         guiparams.horizontal_vector_spacing, <span class="keyword">...</span>
2106         guiparams.vertical_vector_spacing, <span class="keyword">...</span>
2107         guiparams.secondary_flow_vector_variable, <span class="keyword">...</span>
2108         guiparams.include_vertical_velocity, <span class="keyword">...</span>
2109         guiparams.english_units); <span class="comment">%#ok&lt;ASGLU&gt; % PLOT3</span>
2110     
2111 <span class="keyword">elseif</span> ~guiparams.plot_secondary_flow_vectors
2112     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2113         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2114         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2115         guiparams.vertical_smoothing_window);
2116     
2117     [~,A,V,zmin,zmax,plot_cont_log_text] = <a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english)">VMT_PlotXSCont</a>(z,A,V, <span class="keyword">...</span>
2118         guiparams.contour, <span class="keyword">...</span>
2119         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2120         guiparams.english_units);  <span class="comment">%#ok&lt;ASGLU&gt;</span>
2121     
2122     guiparams.zmin = zmin;
2123     guiparams.zmax = zmax;
2124     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2125 <span class="keyword">end</span>
2126 
2127 <span class="comment">% Force plot to be formated properly</span>
2128 <span class="comment">% ----------------------------------</span>
2129 <span class="keyword">if</span> guiparams.presentation
2130     <a href="#_sub38" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2131 <span class="keyword">else</span>
2132     <a href="#_sub37" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2133 <span class="keyword">end</span>
2134 <span class="keyword">switch</span> guiparams.renderer
2135     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
2136         <a href="#_sub18" class="code" title="subfunction menuOpenGL_Callback(hObject, eventdata, handles)">menuOpenGL_Callback</a>(hObject, eventdata, handles)
2137     <span class="keyword">case</span> <span class="string">'painters'</span>
2138         <a href="#_sub19" class="code" title="subfunction menuPainters_Callback(hObject, eventdata, handles)">menuPainters_Callback</a>(hObject, eventdata, handles)
2139     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
2140         <a href="#_sub20" class="code" title="subfunction menuZbuffer_Callback(hObject, eventdata, handles)">menuZbuffer_Callback</a>(hObject, eventdata, handles)
2141 <span class="keyword">end</span>
2142 
2143 <span class="comment">% Focus the figure</span>
2144 <span class="comment">% ----------------</span>
2145 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
2146 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
2147     figure(hff)
2148 <span class="keyword">end</span>
2149 
2150 <span class="comment">% Re-store the Application data:</span>
2151 <span class="comment">% ------------------------------</span>
2152 guiparams.V = V;
2153 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2154 
2155 <span class="comment">% Start the Graphics Control Gui</span>
2156 <span class="comment">% ------------------------------</span>
2157 VMT_GraphicsControl
2158 
2159 <span class="comment">% Push messages to Log Window:</span>
2160 <span class="comment">% ----------------------------</span>
2161 statusLogging(handles.LogWindow, plot_cont_log_text)
2162 <span class="comment">% msgbox('Plotting Complete','VMT Status','help','replace')</span>
2163 
2164 <span class="comment">% [EOF] crosssectionPlotCallback</span>
2165 
2166 
2167 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2168 <span class="comment">% DATA EXPORT CALLBACKS %</span>
2169 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2170 
2171 <span class="comment">% --------------------------------------------------------------------</span>
2172 <a name="_sub58" href="#_subfunctions" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a>
2173 <span class="comment">% saveDataCallback(hObject, eventdata, handles)</span>
2174 
2175 <span class="comment">% Get the Application data:</span>
2176 <span class="comment">% -------------------------</span>
2177 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2178 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2179 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2180 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2181 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2182 
2183 [the_file,the_path] = <span class="keyword">...</span>
2184     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
2185     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
2186     fullfile(guiparams.mat_path,guiparams.savefile));
2187 
2188 <span class="comment">% Save the processed data to a MAT file:</span>
2189 <span class="comment">% --------------------------------------</span>
2190 <span class="keyword">if</span> ischar(the_file)
2191     guiparams.mat_path = the_path;
2192     guiparams.mat_file = the_file;
2193     guiparams.savefile = the_file;
2194     
2195     <span class="comment">% Re-store the Application data:</span>
2196     <span class="comment">% ------------------------------</span>
2197     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2198     
2199     <span class="comment">% Update the preferences:</span>
2200     <span class="comment">% -----------------------</span>
2201     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2202     guiprefs.mat_path = the_path;
2203     guiprefs.mat_file = the_file;
2204     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2205     <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
2206     
2207     [~,filename,extension] = fileparts(guiparams.savefile);
2208     savefile = [filename extension];
2209     h = msgbox([<span class="string">'Saving processed data in MAT File '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
2210         <span class="string">'Saving Processed Data File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2211     disp(<span class="string">'Saving Processed Data File...'</span>)
2212     disp(savefile)
2213     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
2214 <span class="keyword">end</span>
2215 
2216 <span class="comment">% [EOF] SaveMATFile_Callback</span>
2217 
2218 
2219 <span class="comment">% --------------------------------------------------------------------</span>
2220 <a name="_sub59" href="#_subfunctions" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a>
2221 
2222 <span class="comment">% Get the Application data:</span>
2223 <span class="comment">% -------------------------</span>
2224 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2225 <span class="comment">% z   = guiparams.z;</span>
2226 <span class="comment">% A   = guiparams.A;</span>
2227 V   = guiparams.V;
2228 <span class="comment">% Map = guiparams.Map;</span>
2229 
2230 [the_file,the_path] = <span class="keyword">...</span>
2231     uiputfile({<span class="string">'*.dat'</span>,<span class="string">'Tecplot Files (*.dat)'</span>}, <span class="keyword">...</span>
2232     <span class="string">'Save Tecplot File'</span>, <span class="keyword">...</span>
2233     fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2234 
2235 <span class="comment">% Output the data (no smoothing) to Tecplot:</span>
2236 <span class="comment">% ------------------------------------------</span>
2237 <span class="keyword">if</span> ischar(the_file)
2238     guiparams.tecplot_path = the_path;
2239     guiparams.tecplot_file = the_file;
2240     
2241     <span class="comment">% Re-store the Application data:</span>
2242     <span class="comment">% ------------------------------</span>
2243     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2244     
2245     <span class="comment">% Update the preferences:</span>
2246     <span class="comment">% -----------------------</span>
2247     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2248     guiprefs.tecplot_path = the_path;
2249     guiprefs.tecplot_file = the_file;
2250     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2251     <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'tecplot'</span>)
2252     
2253     <span class="comment">% Push to log window</span>
2254     <span class="comment">% ------------------</span>
2255     log_text = {<span class="keyword">...</span>
2256         <span class="string">'Exporting Data to Tecplot (*.dat) File...'</span>;<span class="keyword">...</span>
2257         <span class="string">'Directory:'</span>;<span class="keyword">...</span>
2258         the_path;<span class="keyword">...</span>
2259         [<span class="string">'Filename: '</span> the_file]};
2260     statusLogging(handles.LogWindow,log_text)
2261         
2262     <span class="keyword">if</span> isempty(V)
2263         A = guiparams.A;
2264         A(1).hgns = guiparams.horizontal_grid_node_spacing;
2265         A(1).vgns = guiparams.vertical_grid_node_spacing;
2266         A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2267         [~,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2268             guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2269             guiparams.unit_discharge_correction);
2270     <span class="keyword">end</span>
2271     <a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2272     
2273     <span class="comment">% Push to log window</span>
2274     <span class="comment">% ------------------</span>
2275     log_text = {<span class="string">'Exporting XS Bathy Data to Tecplot (*.dat) File...'</span>};
2276     statusLogging(handles.LogWindow,log_text)
2277     
2278     <a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2279     
2280     <span class="comment">% Push to log window</span>
2281     <span class="comment">% ------------------</span>
2282     log_text = {<span class="string">'Tecplot Export Complete'</span>};
2283     statusLogging(handles.LogWindow,log_text)
2284    
2285 <span class="keyword">end</span>
2286 
2287 <span class="comment">% [EOF] SaveTechplotFile_Callback</span>
2288 
2289 
2290 <span class="comment">% --------------------------------------------------------------------</span>
2291 <a name="_sub60" href="#_subfunctions" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a>
2292 
2293 <span class="comment">% Get the Application data:</span>
2294 <span class="comment">% -------------------------</span>
2295 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2296 <span class="comment">% z   = guiparams.z;</span>
2297 A   = guiparams.A;
2298 V   = guiparams.V;
2299 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2300 
2301 [the_file,the_path] = <span class="keyword">...</span>
2302     uiputfile({<span class="string">'*.kmz'</span>,<span class="string">'Google Earth Files (*.kmz)'</span>}, <span class="keyword">...</span>
2303     <span class="string">'Save Google Earth File'</span>, <span class="keyword">...</span>
2304     fullfile(guiparams.kmz_path,guiparams.kmz_file));
2305 
2306 <span class="comment">% Save the processed data to a Google Earth (KMZ) file:</span>
2307 <span class="comment">% -----------------------------------------------------</span>
2308 <span class="keyword">if</span> ischar(the_file)
2309     guiparams.kmz_path = the_path;
2310     guiparams.kmz_file = the_file;
2311     
2312     <span class="comment">% Re-store the Application data:</span>
2313     <span class="comment">% ------------------------------</span>
2314     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2315     
2316     <span class="comment">% Update the preferences:</span>
2317     <span class="comment">% -----------------------</span>
2318     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2319     guiprefs.kmz_path = the_path;
2320     guiprefs.kmz_file = the_file;
2321     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2322     <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'kmz'</span>)
2323     
2324     <span class="comment">%     if guiparams.display_shoreline</span>
2325     <span class="comment">%         VMT_Shoreline2GE_3D(A,Map, ...</span>
2326     <span class="comment">%                             guiparams.vertical_exaggeration, ...</span>
2327     <span class="comment">%                             guiparams.vertical_offset);</span>
2328     <span class="comment">%     end</span>
2329     <span class="keyword">if</span> isempty(V)
2330         A = guiparams.A;
2331         A(1).hgns = guiparams.horizontal_grid_node_spacing;
2332         A(1).vgns = guiparams.vertical_grid_node_spacing;
2333         A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2334         [~,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2335             guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2336             guiparams.unit_discharge_correction);
2337     <span class="keyword">end</span>
2338     <a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>(A,V,[], <span class="keyword">...</span>
2339         fullfile(guiparams.kmz_path,guiparams.kmz_file), <span class="keyword">...</span>
2340         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2341         guiparams.vertical_offset);
2342 <span class="keyword">end</span>
2343 
2344 <span class="comment">% [EOF] SaveGoogleEarthFile_Callback</span>
2345 
2346 
2347 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2348 <span class="comment">% DATA EXPORT/BATHYMETRY CALLBACKS %</span>
2349 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2350 
2351 <span class="comment">% --------------------------------------------------------------------</span>
2352 <a name="_sub61" href="#_subfunctions" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
2353 
2354 <span class="comment">% Get the Application data:</span>
2355 <span class="comment">% -------------------------</span>
2356 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2357 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2358 z = guiparams.z;
2359 A = guiparams.A;
2360 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
2361 <span class="comment">% Map = guiparams.Map;</span>
2362 setends = guiparams.set_cross_section_endpoints;
2363 
2364 [the_file,the_path] = <span class="keyword">...</span>
2365     uiputfile({<span class="string">'*.csv'</span>,<span class="string">'Multibeam Bathymetry Files (*.csv)'</span>}, <span class="keyword">...</span>
2366     <span class="string">'Export Multibeam Bathymetry'</span>, <span class="keyword">...</span>
2367     fullfile(guiprefs.multibeambathymetry_path, <span class="keyword">...</span>
2368     guiprefs.multibeambathymetry_file));
2369 
2370 <span class="keyword">if</span> ischar(the_file)
2371     guiparams.multibeambathymetry_path = the_path;
2372     guiparams.multibeambathymetry_file = the_file;
2373     
2374     <span class="comment">% Re-store the Application data:</span>
2375     <span class="comment">% ------------------------------</span>
2376     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2377     
2378     <span class="comment">% Update the preferences:</span>
2379     <span class="comment">% -----------------------</span>
2380     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2381     guiprefs.multibeambathymetry_path = the_path;
2382     guiprefs.multibeambathymetry_file = the_file;
2383     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2384     <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'multibeambathymetry'</span>)
2385     
2386     <span class="keyword">if</span> guiparams.output_auxiliary_data
2387     <span class="keyword">end</span>
2388     
2389     <span class="comment">%msgbox('Processing Bathymetry...Please Be Patient','VMT Status','help','replace')</span>
2390     
2391     savefile = fullfile(guiparams.multibeambathymetry_path, <span class="keyword">...</span>
2392         guiparams.multibeambathymetry_file);
2393     
2394     log_text = {<span class="string">'Multibeam bathymetry file saved to:'</span>;<span class="keyword">...</span>
2395         [<span class="string">'   '</span> savefile]};
2396     statusLogging(handles.LogWindow,log_text)
2397     
2398     <span class="comment">% Process the transects:</span>
2399     <span class="comment">% ----------------------</span>
2400     A(1).hgns = guiparams.horizontal_grid_node_spacing;
2401     A(1).vgns = guiparams.vertical_grid_node_spacing;
2402     A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2403     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2404         guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction);
2405     
2406     <span class="comment">% Compute the smoothed variables</span>
2407     <span class="comment">% ------------------------------</span>
2408     <span class="comment">% This is required so that the V struc is complete at any point during</span>
2409     <span class="comment">% runtime.</span>
2410     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2411         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2412         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2413         guiparams.vertical_smoothing_window);
2414     
2415     <span class="comment">% Push messages to Log Window:</span>
2416     <span class="comment">% ----------------------------</span>
2417     statusLogging(handles.LogWindow, processing_log_text)
2418 
2419     
2420     <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>(guiparams.z, <span class="keyword">...</span>
2421         guiparams.A, <span class="keyword">...</span>
2422         savefile, <span class="keyword">...</span>
2423         guiparams.beam_angle, <span class="keyword">...</span>
2424         guiparams.magnetic_variation, <span class="keyword">...</span>
2425         guiparams.wse, <span class="keyword">...</span>
2426         guiparams.output_auxiliary_data);
2427     
2428     <span class="comment">%msgbox('Bathymetry Output Complete','VMT Status','help','replace')</span>
2429     
2430 <span class="keyword">end</span>
2431 
2432 <span class="comment">% [EOF] ExportMultibeamBathymetry_Callback</span>
2433 
2434 
2435 <span class="comment">% --------------------------------------------------------------------</span>
2436 <a name="_sub62" href="#_subfunctions" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a>
2437 <span class="comment">% Get the beam angle</span>
2438 
2439 <span class="comment">% Get the Application data:</span>
2440 <span class="comment">% -------------------------</span>
2441 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2442 
2443 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2444 <span class="comment">% ----------------------------------------------------------------</span>
2445 new_beam_angle = str2double(get(hObject,<span class="string">'String'</span>));
2446 is_a_number = ~isnan(new_beam_angle);
2447 is_positive = new_beam_angle&gt;=0;
2448 
2449 <span class="comment">% Modify the Application data:</span>
2450 <span class="comment">% ----------------------------</span>
2451 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2452     guiparams.beam_angle = new_beam_angle;
2453     
2454     <span class="comment">% Re-store the Application data:</span>
2455     <span class="comment">% ------------------------------</span>
2456     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2457     
2458 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2459     set(hObject,<span class="string">'String'</span>,guiparams.beam_angle)
2460 <span class="keyword">end</span>
2461 
2462 <span class="comment">% [EOF] BeamAngle_Callback</span>
2463 
2464 
2465 <span class="comment">% --------------------------------------------------------------------</span>
2466 <a name="_sub63" href="#_subfunctions" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a>
2467 <span class="comment">% Get the Magnetic Variation</span>
2468 
2469 <span class="comment">% Get the Application data:</span>
2470 <span class="comment">% -------------------------</span>
2471 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2472 
2473 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2474 <span class="comment">% ----------------------------------------------------------------</span>
2475 new_magnetic_variation = str2double(get(hObject,<span class="string">'String'</span>));
2476 is_a_number = ~isnan(new_magnetic_variation);
2477 is_positive = new_magnetic_variation&gt;=0;
2478 
2479 <span class="comment">% Modify the Application data:</span>
2480 <span class="comment">% ----------------------------</span>
2481 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2482     guiparams.magnetic_variation = new_magnetic_variation;
2483     
2484     <span class="comment">% Re-store the Application data:</span>
2485     <span class="comment">% ------------------------------</span>
2486     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2487     
2488 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2489     set(hObject,<span class="string">'String'</span>,guiparams.magnetic_variation)
2490 <span class="keyword">end</span>
2491 
2492 <span class="comment">% [EOF] MagneticVariation_Callback</span>
2493 
2494 
2495 <span class="comment">% --------------------------------------------------------------------</span>
2496 <a name="_sub64" href="#_subfunctions" class="code">function WSE_Callback(hObject, eventdata, handles)</a>
2497 
2498 <span class="comment">% Get the Application data:</span>
2499 <span class="comment">% -------------------------</span>
2500 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2501 
2502 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2503 <span class="comment">% ----------------------------------------------------------------</span>
2504 new_wse = str2double(get(hObject,<span class="string">'String'</span>));
2505 is_a_number = ~isnan(new_wse);
2506 is_positive = new_wse&gt;=0;
2507 
2508 <span class="comment">% Modify the Application data:</span>
2509 <span class="comment">% ----------------------------</span>
2510 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2511     guiparams.wse = new_wse;
2512     
2513     <span class="comment">% Re-store the Application data:</span>
2514     <span class="comment">% ------------------------------</span>
2515     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2516     
2517 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2518     set(hObject,<span class="string">'String'</span>,guiparams.wse)
2519 <span class="keyword">end</span>
2520 
2521 <span class="comment">% [EOF] WSE_Callback</span>
2522 
2523 
2524 <span class="comment">% --------------------------------------------------------------------</span>
2525 <a name="_sub65" href="#_subfunctions" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a>
2526 <span class="comment">% Bathymetry Auxiliary Data</span>
2527 
2528 <span class="comment">% Get the Application data:</span>
2529 <span class="comment">% -------------------------</span>
2530 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2531 
2532 <span class="comment">% Modify the Application data:</span>
2533 <span class="comment">% ----------------------------</span>
2534 guiparams.output_auxiliary_data = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2535 
2536 <span class="comment">% Re-store the Application data:</span>
2537 <span class="comment">% ------------------------------</span>
2538 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2539 
2540 <span class="comment">% [EOF] OutputAuxiliaryData_Callback</span>
2541 
2542 
2543 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2544 <span class="comment">% PLOTTING/PLAN VIEW PLOT CALLBACKS %</span>
2545 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2546 
2547 <span class="comment">% --------------------------------------------------------------------</span>
2548 <a name="_sub66" href="#_subfunctions" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a>
2549 
2550 <span class="comment">% Get the Application data:</span>
2551 <span class="comment">% -------------------------</span>
2552 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2553 
2554 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2555 <span class="comment">% ----------------------------------------------------------------</span>
2556 new_depth_range_min = str2double(get(hObject,<span class="string">'String'</span>));
2557 is_a_number = ~isnan(new_depth_range_min);
2558 is_positive = new_depth_range_min&gt;=0;
2559 
2560 <span class="comment">% Modify the Application data:</span>
2561 <span class="comment">% ----------------------------</span>
2562 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2563     guiparams.depth_range_min = new_depth_range_min;
2564     
2565     <span class="comment">% Re-store the Application data:</span>
2566     <span class="comment">% ------------------------------</span>
2567     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2568     
2569 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2570     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_min)
2571 <span class="keyword">end</span>
2572 
2573 <span class="comment">% [EOF] DepthRangeMin_Callback</span>
2574 
2575 
2576 <span class="comment">% --------------------------------------------------------------------</span>
2577 <a name="_sub67" href="#_subfunctions" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a>
2578 
2579 <span class="comment">% Get the Application data:</span>
2580 <span class="comment">% -------------------------</span>
2581 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2582 
2583 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2584 <span class="comment">% ----------------------------------------------------------------</span>
2585 new_depth_range_max = str2double(get(hObject,<span class="string">'String'</span>));
2586 is_a_number = ~isnan(new_depth_range_max);
2587 is_positive = new_depth_range_max&gt;=0;
2588 
2589 <span class="comment">% Modify the Application data:</span>
2590 <span class="comment">% ----------------------------</span>
2591 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2592     guiparams.depth_range_max = new_depth_range_max;
2593     
2594     <span class="comment">% Re-store the Application data:</span>
2595     <span class="comment">% ------------------------------</span>
2596     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2597     
2598 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2599     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_max)
2600 <span class="keyword">end</span>
2601 
2602 <span class="comment">% [EOF] DepthMax_Callback</span>
2603 
2604 
2605 <span class="comment">% --------------------------------------------------------------------</span>
2606 <a name="_sub68" href="#_subfunctions" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a>
2607 <span class="comment">% Set quiver scale (contour)</span>
2608 
2609 <span class="comment">% Get the Application data:</span>
2610 <span class="comment">% -------------------------</span>
2611 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2612 
2613 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2614 <span class="comment">% ----------------------------------------------------------------</span>
2615 new_vector_scale_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
2616 is_a_number = ~isnan(new_vector_scale_plan_view);
2617 is_positive = new_vector_scale_plan_view&gt;=0;
2618 
2619 <span class="comment">% Modify the Application data:</span>
2620 <span class="comment">% ----------------------------</span>
2621 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2622     guiparams.vector_scale_plan_view = round(new_vector_scale_plan_view);
2623     
2624     <span class="comment">% Re-store the Application data:</span>
2625     <span class="comment">% ------------------------------</span>
2626     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2627     
2628 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2629     set(hObject,<span class="string">'String'</span>,guiparams.vector_scale_plan_view)
2630 <span class="keyword">end</span>
2631 
2632 <span class="comment">% [EOF] VectorScalePlanView_Callback</span>
2633 
2634 
2635 <span class="comment">% --------------------------------------------------------------------</span>
2636 <a name="_sub69" href="#_subfunctions" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a>
2637 <span class="comment">% Set quiver spacing (contour, horizontal)</span>
2638 
2639 <span class="comment">% Get the Application data:</span>
2640 <span class="comment">% -------------------------</span>
2641 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2642 
2643 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2644 <span class="comment">% ----------------------------------------------------------------</span>
2645 new_vector_spacing_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
2646 is_a_number = ~isnan(new_vector_spacing_plan_view);
2647 is_positive = new_vector_spacing_plan_view&gt;=0;
2648 
2649 <span class="comment">% Modify the Application data:</span>
2650 <span class="comment">% ----------------------------</span>
2651 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2652     guiparams.vector_spacing_plan_view = round(new_vector_spacing_plan_view);
2653     
2654     <span class="comment">% Re-store the Application data:</span>
2655     <span class="comment">% ------------------------------</span>
2656     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2657     
2658 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2659     set(hObject,<span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
2660 <span class="keyword">end</span>
2661 
2662 <span class="comment">% [EOF] VectorSpacingPlanview_Callback</span>
2663 
2664 
2665 <span class="comment">% --------------------------------------------------------------------</span>
2666 <a name="_sub70" href="#_subfunctions" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a>
2667 <span class="comment">% Plan View smoothing window size</span>
2668 
2669 <span class="comment">% Get the Application data:</span>
2670 <span class="comment">% -------------------------</span>
2671 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2672 
2673 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2674 <span class="comment">% ----------------------------------------------------------------</span>
2675 new_smoothing_window_size = str2double(get(hObject,<span class="string">'String'</span>));
2676 is_a_number = ~isnan(new_smoothing_window_size);
2677 is_positive = new_smoothing_window_size&gt;=0;
2678 
2679 <span class="comment">% Modify the Application data:</span>
2680 <span class="comment">% ----------------------------</span>
2681 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2682     guiparams.smoothing_window_size = round(new_smoothing_window_size);
2683     
2684     <span class="comment">% Re-store the Application data:</span>
2685     <span class="comment">% ------------------------------</span>
2686     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2687     
2688 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2689     set(hObject,<span class="string">'String'</span>,guiparams.smoothing_window_size)
2690 <span class="keyword">end</span>
2691 
2692 <span class="comment">% [EOF] SmoothingWindowSize_Callback</span>
2693 
2694 
2695 <span class="comment">% --------------------------------------------------------------------</span>
2696 <a name="_sub71" href="#_subfunctions" class="code">function DisplayShoreline_Callback(hObject, eventdata, handles)</a>
2697 
2698 <span class="comment">% Get the Application data:</span>
2699 <span class="comment">% -------------------------</span>
2700 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2701 
2702 <span class="comment">% Modify the Application data:</span>
2703 <span class="comment">% ----------------------------</span>
2704 guiparams.display_shoreline = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2705 
2706 <span class="comment">% Re-store the Application data:</span>
2707 <span class="comment">% ------------------------------</span>
2708 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2709 
2710 <span class="comment">% [EOF] DisplayShoreline_Callback</span>
2711 
2712 
2713 <span class="comment">% --------------------------------------------------------------------</span>
2714 <a name="_sub72" href="#_subfunctions" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a>
2715 
2716 <span class="comment">% Get the Application data:</span>
2717 <span class="comment">% -------------------------</span>
2718 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2719 
2720 <span class="comment">% Modify the Application data:</span>
2721 <span class="comment">% ----------------------------</span>
2722 guiparams.add_background = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2723 
2724 <span class="comment">% Re-store the Application data:</span>
2725 <span class="comment">% ------------------------------</span>
2726 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2727 
2728 <span class="comment">% [EOF] AddBackground_Callback</span>
2729 
2730 
2731 <span class="comment">% --------------------------------------------------------------------</span>
2732 <a name="_sub73" href="#_subfunctions" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a>
2733 <a href="#_sub56" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
2734 <span class="comment">% [EOF] PlotPlanView_Callback</span>
2735 
2736 
2737 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2738 <span class="comment">% PLOTTING/SHIP TRACKS PLOT CALLBACKS %</span>
2739 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2740 
2741 <span class="comment">% --------------------------------------------------------------------</span>
2742 <a name="_sub74" href="#_subfunctions" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a>
2743 <span class="comment">% Set the horizontal grid node spacing</span>
2744 
2745 <span class="comment">% Get the Application data:</span>
2746 <span class="comment">% -------------------------</span>
2747 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2748 
2749 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2750 <span class="comment">% ----------------------------------------------------------------</span>
2751 new_horizontal_grid_node_spacing = str2double(get(hObject,<span class="string">'String'</span>));
2752 is_a_number = ~isnan(new_horizontal_grid_node_spacing);
2753 is_positive = new_horizontal_grid_node_spacing&gt;=0;
2754 
2755 <span class="comment">% Modify the Application data:</span>
2756 <span class="comment">% ----------------------------</span>
2757 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2758     guiparams.horizontal_grid_node_spacing = new_horizontal_grid_node_spacing;
2759     
2760     <span class="comment">% Re-store the Application data:</span>
2761     <span class="comment">% ------------------------------</span>
2762     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2763     
2764 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2765     set(hObject,<span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
2766 <span class="keyword">end</span>
2767 
2768 <span class="comment">% [EOF] HorizontalGridNodeSpacing_Callback</span>
2769 
2770 <span class="comment">% --------------------------------------------------------------------</span>
2771 <a name="_sub75" href="#_subfunctions" class="code">function VerticalGridNodeSpacing_Callback(hObject, eventdata, handles)</a>
2772 <span class="comment">% Set the horizontal grid node spacing</span>
2773 
2774 <span class="comment">% Get the Application data:</span>
2775 <span class="comment">% -------------------------</span>
2776 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2777 
2778 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2779 <span class="comment">% ----------------------------------------------------------------</span>
2780 new_vertical_grid_node_spacing = str2double(get(hObject,<span class="string">'String'</span>));
2781 is_a_number = ~isnan(new_vertical_grid_node_spacing);
2782 is_positive = new_vertical_grid_node_spacing&gt;=0;
2783 
2784 <span class="comment">% Modify the Application data:</span>
2785 <span class="comment">% ----------------------------</span>
2786 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2787     guiparams.vertical_grid_node_spacing = new_vertical_grid_node_spacing;
2788     
2789     <span class="comment">% Re-store the Application data:</span>
2790     <span class="comment">% ------------------------------</span>
2791     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2792     
2793 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2794     set(hObject,<span class="string">'String'</span>,guiparams.vertical_grid_node_spacing)
2795 <span class="keyword">end</span>
2796 
2797 <span class="comment">% [EOF] VerticalGridNodeSpacing_Callback</span>
2798 
2799 <span class="comment">% --------------------------------------------------------------------</span>
2800 <a name="_sub76" href="#_subfunctions" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
2801 <span class="comment">% Set the cross section endpoints manually</span>
2802 
2803 <span class="comment">% Get the Application data:</span>
2804 <span class="comment">% -------------------------</span>
2805 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2806 
2807 <span class="comment">% Modify the Application data:</span>
2808 <span class="comment">% ----------------------------</span>
2809 guiparams.set_cross_section_endpoints = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2810 
2811 <span class="comment">% Re-store the Application data:</span>
2812 <span class="comment">% ------------------------------</span>
2813 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2814 
2815 <span class="comment">% [EOF] SetCrossSectionEndpoints_Callback</span>
2816 
2817 
2818 <span class="comment">% --------------------------------------------------------------------</span>
2819 <a name="_sub77" href="#_subfunctions" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a>
2820 <a href="#_sub55" class="code" title="subfunction shiptracksPlotCallback(hObject, eventdata, handles)">shiptracksPlotCallback</a>(hObject, eventdata, handles)
2821 <span class="comment">% [EOF] PlotShiptracks_Callback</span>
2822 
2823 
2824 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2825 <span class="comment">% PLOTTING/CROSS SECTION PLOT CALLBACKS %</span>
2826 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2827 
2828 <span class="comment">% --------------------------------------------------------------------</span>
2829 <a name="_sub78" href="#_subfunctions" class="code">function Contour_Callback(hObject, eventdata, handles)</a>
2830 
2831 <span class="comment">% Get the Application data:</span>
2832 <span class="comment">% -------------------------</span>
2833 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2834 
2835 <span class="comment">% Modify the Application data:</span>
2836 <span class="comment">% ----------------------------</span>
2837 idx_variable = get(hObject,<span class="string">'Value'</span>);
2838 guiparams.idx_contour = idx_variable;
2839 guiparams.contour = guiparams.contours(idx_variable).variable;
2840 
2841 <span class="comment">% Re-store the Application data:</span>
2842 <span class="comment">% ------------------------------</span>
2843 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2844 
2845 <span class="comment">% [EOF] Contour_Callback</span>
2846 
2847 
2848 <span class="comment">% --------------------------------------------------------------------</span>
2849 <a name="_sub79" href="#_subfunctions" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a>
2850 <span class="comment">% Set vertical exaggeration</span>
2851 
2852 <span class="comment">% Get the Application data:</span>
2853 <span class="comment">% -------------------------</span>
2854 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2855 
2856 <span class="comment">% Modify the Application data:</span>
2857 <span class="comment">% ----------------------------</span>
2858 guiparams.vertical_exaggeration = str2double(get(hObject,<span class="string">'String'</span>));
2859 
2860 <span class="comment">% Re-store the Application data:</span>
2861 <span class="comment">% ------------------------------</span>
2862 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2863 
2864 <span class="comment">% Update the GUI:</span>
2865 <span class="comment">% ---------------</span>
2866 <span class="comment">% updateGUI(handles,guiparams)</span>
2867 
2868 <span class="comment">% [EOF] VerticalExaggeration_Callback</span>
2869 
2870 
2871 <span class="comment">% --------------------------------------------------------------------</span>
2872 <a name="_sub80" href="#_subfunctions" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a>
2873 
2874 <span class="comment">% Get the Application data:</span>
2875 <span class="comment">% -------------------------</span>
2876 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2877 
2878 <span class="comment">% Modify the Application data:</span>
2879 <span class="comment">% ----------------------------</span>
2880 guiparams.vector_scale_cross_section = str2double(get(hObject,<span class="string">'String'</span>));
2881 
2882 <span class="comment">% Re-store the Application data:</span>
2883 <span class="comment">% ------------------------------</span>
2884 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2885 
2886 <span class="comment">% Update the GUI:</span>
2887 <span class="comment">% ---------------</span>
2888 <span class="comment">% updateGUI(handles,guiparams)</span>
2889 
2890 <span class="comment">% [EOF] VectorScaleCrossSection_Callback</span>
2891 
2892 
2893 <span class="comment">% --------------------------------------------------------------------</span>
2894 <a name="_sub81" href="#_subfunctions" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a>
2895 
2896 <span class="comment">% Get the Application data:</span>
2897 <span class="comment">% -------------------------</span>
2898 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2899 
2900 <span class="comment">% Modify the Application data:</span>
2901 <span class="comment">% ----------------------------</span>
2902 guiparams.horizontal_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
2903 
2904 <span class="comment">% Re-store the Application data:</span>
2905 <span class="comment">% ------------------------------</span>
2906 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2907 
2908 <span class="comment">% Update the GUI:</span>
2909 <span class="comment">% ---------------</span>
2910 <span class="comment">% updateGUI(handles,guiparams)</span>
2911 
2912 <span class="comment">% [EOF] HorizontalVectorSpacing_Callback</span>
2913 
2914 
2915 <span class="comment">% --------------------------------------------------------------------</span>
2916 <a name="_sub82" href="#_subfunctions" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a>
2917 <span class="comment">% Get the vertical quiver spacing for contour plots</span>
2918 
2919 <span class="comment">% Get the Application data:</span>
2920 <span class="comment">% -------------------------</span>
2921 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2922 
2923 <span class="comment">% Modify the Application data:</span>
2924 <span class="comment">% ----------------------------</span>
2925 guiparams.vertical_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
2926 
2927 <span class="comment">% Re-store the Application data:</span>
2928 <span class="comment">% ------------------------------</span>
2929 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2930 
2931 <span class="comment">% Update the GUI:</span>
2932 <span class="comment">% ---------------</span>
2933 <span class="comment">% updateGUI(handles,guiparams)</span>
2934 
2935 <span class="comment">% [EOF] VerticalVectorSpacing_Callback</span>
2936 
2937 
2938 <span class="comment">% --------------------------------------------------------------------</span>
2939 <a name="_sub83" href="#_subfunctions" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
2940 <span class="comment">% Horizontal Smoothing</span>
2941 
2942 <span class="comment">% Get the Application data:</span>
2943 <span class="comment">% -------------------------</span>
2944 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2945 
2946 <span class="comment">% Modify the Application data:</span>
2947 <span class="comment">% ----------------------------</span>
2948 guiparams.horizontal_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
2949 
2950 <span class="comment">% Re-store the Application data:</span>
2951 <span class="comment">% ------------------------------</span>
2952 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2953 
2954 <span class="comment">% Update the GUI:</span>
2955 <span class="comment">% ---------------</span>
2956 <span class="comment">% updateGUI(handles,guiparams)</span>
2957 
2958 <span class="comment">% [EOF] HorizontalSmoothingWindow_Callback</span>
2959 
2960 
2961 <span class="comment">% --------------------------------------------------------------------</span>
2962 <a name="_sub84" href="#_subfunctions" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
2963 <span class="comment">% Vertical Smoothing</span>
2964 
2965 <span class="comment">% Get the Application data:</span>
2966 <span class="comment">% -------------------------</span>
2967 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2968 
2969 <span class="comment">% Modify the Application data:</span>
2970 <span class="comment">% ----------------------------</span>
2971 guiparams.vertical_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
2972 
2973 <span class="comment">% Re-store the Application data:</span>
2974 <span class="comment">% ------------------------------</span>
2975 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2976 
2977 <span class="comment">% Update the GUI:</span>
2978 <span class="comment">% ---------------</span>
2979 <span class="comment">% updateGUI(handles,guiparams)</span>
2980 
2981 <span class="comment">% [EOF] VerticalSmoothingWindow_Callback</span>
2982 
2983 
2984 <span class="comment">% --------------------------------------------------------------------</span>
2985 <a name="_sub85" href="#_subfunctions" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a>
2986 
2987 <span class="comment">% Get the Application data:</span>
2988 <span class="comment">% -------------------------</span>
2989 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2990 
2991 <span class="comment">% Modify the Application data:</span>
2992 <span class="comment">% ----------------------------</span>
2993 guiparams.plot_secondary_flow_vectors = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2994 
2995 <span class="comment">% Re-store the Application data:</span>
2996 <span class="comment">% ------------------------------</span>
2997 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2998 
2999 <span class="comment">% [EOF] PlotSecondaryFlowVectors_Callback</span>
3000 
3001 
3002 <span class="comment">% --------------------------------------------------------------------</span>
3003 <a name="_sub86" href="#_subfunctions" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a>
3004 
3005 <span class="comment">% Get the Application data:</span>
3006 <span class="comment">% -------------------------</span>
3007 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3008 
3009 <span class="comment">% Modify the Application data:</span>
3010 <span class="comment">% ----------------------------</span>
3011 idx_variable = get(hObject,<span class="string">'Value'</span>);
3012 guiparams.idx_secondary_flow_vector_variable = idx_variable;
3013 guiparams.secondary_flow_vector_variable = guiparams.secondary_flows(idx_variable).variable;
3014 
3015 <span class="comment">% Re-store the Application data:</span>
3016 <span class="comment">% ------------------------------</span>
3017 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3018 
3019 <span class="comment">% [EOF] SecondaryFlowVectorVariable_Callback</span>
3020 
3021 
3022 <span class="comment">% --------------------------------------------------------------------</span>
3023 <a name="_sub87" href="#_subfunctions" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a>
3024 
3025 <span class="comment">% Get the Application data:</span>
3026 <span class="comment">% -------------------------</span>
3027 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3028 
3029 <span class="comment">% Modify the Application data:</span>
3030 <span class="comment">% ----------------------------</span>
3031 guiparams.include_vertical_velocity = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3032 
3033 <span class="comment">% Re-store the Application data:</span>
3034 <span class="comment">% ------------------------------</span>
3035 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3036 
3037 <span class="comment">% [EOF] IncludeVerticalVelocity_Callback</span>
3038 
3039 
3040 <span class="comment">% --------------------------------------------------------------------</span>
3041 <a name="_sub88" href="#_subfunctions" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a>
3042 <a href="#_sub57" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
3043 <span class="comment">% [EOF] PlotCrossSection_Callback</span>
3044 
3045 
3046 <span class="comment">% --------------------------------------------------------------------</span>
3047 <a name="_sub89" href="#_subfunctions" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a>
3048 set(handles.LogWindow,<span class="string">'string'</span>,<span class="string">''</span>)
3049 <span class="comment">% [EOF] ClearLog_Callback</span>
3050 
3051 <span class="comment">% --------------------------------------------------------------------</span>
3052 <a name="_sub90" href="#_subfunctions" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a>
3053 
3054 <span class="comment">% Get the Application data:</span>
3055 <span class="comment">% -------------------------</span>
3056 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3057 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
3058 <span class="comment">% z   = guiparams.z;   %#ok&lt;NASGU&gt;</span>
3059 <span class="comment">% A   = guiparams.A;   %#ok&lt;NASGU&gt;</span>
3060 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
3061 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
3062 
3063 [the_file,the_path] = <span class="keyword">...</span>
3064     uiputfile({<span class="string">'*.txt'</span>,<span class="string">'TXT-Files (*.txt)'</span>}, <span class="keyword">...</span>
3065     <span class="string">'Choose where to save the log file'</span>, <span class="keyword">...</span>
3066     fullfile(guiprefs.log_path,guiprefs.log_file));
3067 
3068 <span class="comment">% Save the log to a TXT file:</span>
3069 <span class="comment">% ---------------------------</span>
3070 <span class="keyword">if</span> ischar(the_file)
3071     guiparams.log_path = the_path;
3072     guiparams.log_file = the_file;
3073     <span class="comment">%guiparams.savefile = the_file;</span>
3074     
3075     <span class="comment">% Re-store the Application data:</span>
3076     <span class="comment">% ------------------------------</span>
3077     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3078     
3079     <span class="comment">% Update the preferences:</span>
3080     <span class="comment">% -----------------------</span>
3081     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
3082     guiprefs.log_path = the_path;
3083     guiprefs.log_file = the_file;
3084     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
3085     <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'log'</span>)
3086     
3087     [~,filename,extension] = fileparts(the_file);
3088     savefile = [the_path filename extension];
3089     h = msgbox([<span class="string">'Saving log to: '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
3090         <span class="string">'Saving Log File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
3091     
3092     logfile = get(handles.LogWindow,<span class="string">'string'</span>);
3093     [nrows,~]= size(logfile);
3094     fid = fopen(savefile, <span class="string">'w'</span>);
3095     <span class="keyword">for</span> row=1:nrows
3096         fprintf(fid, <span class="string">'%s \n'</span>, logfile{row,:});
3097     <span class="keyword">end</span>
3098     fclose(fid);
3099 <span class="keyword">end</span>
3100 <span class="comment">% [EOF] SaveLog_Callback</span>
3101 
3102 <span class="comment">%%%%%%%%%%%%%%%%</span>
3103 <span class="comment">% SUBFUNCTIONS %</span>
3104 <span class="comment">%%%%%%%%%%%%%%%%</span>
3105 
3106 <span class="comment">% --------------------------------------------------------------------</span>
3107 <a name="_sub91" href="#_subfunctions" class="code">function handles = buildToolbar(handles)</a>
3108 
3109 icons = <a href="#_sub107" class="code" title="subfunction icons = getIcons">getIcons</a>;
3110 ht = uitoolbar(<span class="string">'Parent'</span>,handles.figure1);
3111 
3112 <span class="comment">% Load data</span>
3113 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_open.png');</span>
3114 <span class="comment">% icon = double(icon)/(2^16-1);</span>
3115 <span class="comment">% icon(icon==0) = NaN;</span>
3116 handles.toolbarLoadData = <span class="keyword">...</span>
3117     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3118     <span class="string">'CData'</span>,        icons(1).data, <span class="keyword">...</span>
3119     <span class="string">'TooltipString'</span>,<span class="string">'Open ASCII File'</span>);
3120 
3121 <span class="comment">% Save data</span>
3122 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_save.png');</span>
3123 <span class="comment">% icon = double(icon)/(2^16-1);</span>
3124 <span class="comment">% icon(icon==0) = NaN;</span>
3125 handles.toolbarSaveMatFile = <span class="keyword">...</span>
3126     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3127     <span class="string">'CData'</span>,        icons(2).data, <span class="keyword">...</span>
3128     <span class="string">'TooltipString'</span>,<span class="string">'Save MAT File'</span>, <span class="keyword">...</span>
3129     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
3130 
3131 
3132 <span class="comment">% Save bathymetry</span>
3133 <span class="comment">%icon = ones(16,16,3);</span>
3134 handles.toolbarSaveBathymetry = <span class="keyword">...</span>
3135     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3136     <span class="string">'CData'</span>,        icons(5).data, <span class="keyword">...</span>
3137     <span class="string">'TooltipString'</span>,<span class="string">'Export Bathymetry'</span>);
3138 
3139 <span class="comment">% Save figures</span>
3140 <span class="comment">% icon = ones(16,16,3);</span>
3141 handles.toolbarSaveFigures = <span class="keyword">...</span>
3142     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3143     <span class="string">'CData'</span>,        icons(6).data, <span class="keyword">...</span>
3144     <span class="string">'TooltipString'</span>,<span class="string">'Export Figures'</span>);
3145 
3146 <span class="comment">% Save Excel File</span>
3147 <span class="comment">% icon = ones(16,16,3);</span>
3148 handles.toolbarSaveExcel = <span class="keyword">...</span>
3149     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3150     <span class="string">'CData'</span>,        icons(7).data, <span class="keyword">...</span>
3151     <span class="string">'TooltipString'</span>,<span class="string">'Export Excel File'</span>);
3152 
3153 
3154 <span class="comment">% Plotting parameters</span>
3155 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\PlotGeneralElement.gif');</span>
3156 <span class="comment">% icon = ind2rgb(icon,map);</span>
3157 handles.toolbarPlottingParameters = <span class="keyword">...</span>
3158     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3159     <span class="string">'CData'</span>,        icons(3).data, <span class="keyword">...</span>
3160     <span class="string">'TooltipString'</span>,<span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
3161     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
3162 
3163 <span class="comment">% Processing parameters</span>
3164 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3165 <span class="comment">% icon = ind2rgb(icon,map);</span>
3166 handles.toolbarProcessingParameters = <span class="keyword">...</span>
3167     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3168     <span class="string">'CData'</span>,        icons(4).data, <span class="keyword">...</span>
3169     <span class="string">'TooltipString'</span>,<span class="string">'Processing Parameters'</span>);
3170 
3171 <span class="comment">% Zoom In</span>
3172 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3173 <span class="comment">% icon = ind2rgb(icon,map);</span>
3174 <span class="comment">% handles.toolbarZoomIn = ...</span>
3175 <span class="comment">%     uitoggletool('Parent',       ht, ...</span>
3176 <span class="comment">%     'CData',        icons(8).data, ...</span>
3177 <span class="comment">%     'TooltipString','Zoom In (Shiptracks)', ...</span>
3178 <span class="comment">%     'Separator',     'on');</span>
3179 
3180 <span class="comment">% Zoom Out</span>
3181 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3182 <span class="comment">% icon = ind2rgb(icon,map);</span>
3183 <span class="comment">% handles.toolbarZoomOut = ...</span>
3184 <span class="comment">%     uitoggletool('Parent',       ht, ...</span>
3185 <span class="comment">%     'CData',        icons(9).data, ...</span>
3186 <span class="comment">%     'TooltipString','Zoom Out (Shiptracks)');</span>
3187 
3188 <span class="comment">% Pan</span>
3189 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3190 <span class="comment">% icon = ind2rgb(icon,map);</span>
3191 <span class="comment">% handles.toolbarPan = ...</span>
3192 <span class="comment">%     uipushtool('Parent',       ht, ...</span>
3193 <span class="comment">%     'CData',        icons(10).data, ...</span>
3194 <span class="comment">%     'TooltipString','Pan (Shiptracks)');</span>
3195 
3196 
3197 
3198 set(handles.toolbarLoadData,            <span class="string">'ClickedCallback'</span>,{@<a href="#_sub50" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>,handles})
3199 set(handles.toolbarSaveMatFile,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub51" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>,handles})
3200 set(handles.toolbarSaveBathymetry,      <span class="string">'ClickedCallback'</span>,{@<a href="#_sub61" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>,handles})
3201 set(handles.toolbarSaveFigures,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub21" class="code" title="subfunction menuExportFigures_Callback(hObject, eventdata, handles)">menuExportFigures_Callback</a>,handles})
3202 set(handles.toolbarSaveExcel,           <span class="string">'ClickedCallback'</span>,{@<a href="#_sub25" class="code" title="subfunction menuSaveExcel_Callback(hObject, eventdata, handles)">menuSaveExcel_Callback</a>,handles})
3203 set(handles.toolbarPlottingParameters,  <span class="string">'ClickedCallback'</span>,{@<a href="#_sub53" class="code" title="subfunction plottingParametersCallback(hObject, eventdata, handles)">plottingParametersCallback</a>,handles})
3204 set(handles.toolbarProcessingParameters,<span class="string">'ClickedCallback'</span>,{@<a href="#_sub54" class="code" title="subfunction processingParametersCallback(hObject, eventdata, handles)">processingParametersCallback</a>,handles})
3205 <span class="comment">% set(handles.toolbarZoomIn,              'ClickedCallback',{@ShiptracksZoom_Callback,handles})</span>
3206 <span class="comment">% set(handles.toolbarZoomOut,              'ClickedCallback',{@ShiptracksZoom_Callback,handles})</span>
3207 <span class="comment">% set(handles.toolbarPan,              'ClickedCallback',{@ShiptracksPan_Callback,handles})</span>
3208 <span class="comment">% set(handles.planviewPlot,        'ClickedCallback',{@planviewPlotCallback,handles})</span>
3209 <span class="comment">% set(handles.crosssectionPlot,    'ClickedCallback',{@crosssectionPlotCallback,handles})</span>
3210 
3211 <span class="comment">% [EOF] buildtoolbar</span>
3212 
3213 
3214 <span class="comment">% --------------------------------------------------------------------</span>
3215 <a name="_sub92" href="#_subfunctions" class="code">function load_prefs(hfigure)</a>
3216 <span class="comment">% Load the GUI preferences.  Also, initialize preferences if they don't</span>
3217 <span class="comment">% already exist.</span>
3218 
3219 <span class="comment">% Preferences:</span>
3220 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
3221 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
3222 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
3223 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
3224 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
3225 <span class="comment">% 'log'                  Path and filename of last Log file</span>
3226 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
3227 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
3228 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
3229 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
3230 <span class="comment">% 'renderer'             Default graphics renderer</span>
3231 <span class="comment">% 'units'                Default plotting units</span>
3232 
3233 <span class="comment">% Originals</span>
3234 <span class="comment">% prefs = {'ascii2gispath' 'ascii2kmlpath' 'asciipath'   'doqqpath' ...</span>
3235 <span class="comment">%          'endspath'      'logpath'       'matpath'     'savedpath' ...</span>
3236 <span class="comment">%          'shorepath'     'stapath'       'ysidatapath' 'ysidatapath'};</span>
3237 
3238 <span class="comment">% ASCII</span>
3239 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>)
3240     ascii = getpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>);
3241     <span class="keyword">if</span> exist(ascii.path,<span class="string">'dir'</span>)
3242         guiprefs.ascii_path = ascii.path;
3243     <span class="keyword">else</span>
3244         guiprefs.ascii_path = pwd;
3245     <span class="keyword">end</span>
3246     does_exist = false(1,length(ascii.file));
3247     <span class="keyword">for</span> k = 1:length(ascii.file) <span class="comment">% Check each file one-by-one</span>
3248         does_exist(k) = exist(fullfile(ascii.path,ascii.file{k}),<span class="string">'file'</span>);
3249     <span class="keyword">end</span>
3250     <span class="keyword">if</span> any(does_exist)
3251         guiprefs.ascii_file = ascii.file(does_exist);
3252     <span class="keyword">else</span>
3253         guiprefs.ascii_file = {<span class="string">''</span>};
3254     <span class="keyword">end</span>
3255 <span class="keyword">else</span> <span class="comment">% Initialize ASCII</span>
3256     guiprefs.ascii_path = pwd;
3257     guiprefs.ascii_file = {<span class="string">''</span>};
3258     
3259     ascii.path = pwd;
3260     ascii.file = {<span class="string">''</span>};
3261     setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
3262 <span class="keyword">end</span>
3263 
3264 <span class="comment">% MAT</span>
3265 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>)
3266     mat = getpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>);
3267     <span class="keyword">if</span> exist(mat.path,<span class="string">'dir'</span>)
3268         guiprefs.mat_path = mat.path;
3269     <span class="keyword">else</span>
3270         guiprefs.mat_path = pwd;
3271     <span class="keyword">end</span>
3272     
3273     <span class="keyword">if</span> iscell(mat.file)
3274         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file{1}),<span class="string">'file'</span>)
3275             guiprefs.mat_file = mat.file;
3276         <span class="keyword">else</span>
3277             guiprefs.mat_file = <span class="string">''</span>;
3278         <span class="keyword">end</span>
3279     <span class="keyword">else</span>
3280         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file),<span class="string">'file'</span>)
3281             guiprefs.mat_file = mat.file;
3282         <span class="keyword">else</span>
3283             guiprefs.mat_file = <span class="string">''</span>;
3284         <span class="keyword">end</span>
3285     <span class="keyword">end</span>
3286 <span class="keyword">else</span> <span class="comment">% Initialize MAT</span>
3287     guiprefs.mat_path = pwd;
3288     guiprefs.mat_file = <span class="string">''</span>;
3289     
3290     mat.path = pwd;
3291     mat.file = <span class="string">''</span>;
3292     setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
3293 <span class="keyword">end</span>
3294 
3295 <span class="comment">% TECPLOT</span>
3296 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>)
3297     tecplot = getpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>);
3298     <span class="keyword">if</span> exist(tecplot.path,<span class="string">'dir'</span>)
3299         guiprefs.tecplot_path = tecplot.path;
3300     <span class="keyword">else</span>
3301         guiprefs.tecplot_path = pwd;
3302     <span class="keyword">end</span>
3303     <span class="keyword">if</span> exist(fullfile(tecplot.path,tecplot.file),<span class="string">'file'</span>)
3304         guiprefs.tecplot_file = tecplot.file;
3305     <span class="keyword">else</span>
3306         guiprefs.tecplot_file = <span class="string">''</span>;
3307     <span class="keyword">end</span>
3308 <span class="keyword">else</span> <span class="comment">% Initialize TECPLOT</span>
3309     guiprefs.tecplot_path = pwd;
3310     guiprefs.tecplot_file = <span class="string">''</span>;
3311     
3312     tecplot.path = pwd;
3313     tecplot.file = <span class="string">''</span>;
3314     setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
3315 <span class="keyword">end</span>
3316 
3317 <span class="comment">% KMZ</span>
3318 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>)
3319     kmz = getpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>);
3320     <span class="keyword">if</span> exist(kmz.path,<span class="string">'dir'</span>)
3321         guiprefs.kmz_path = kmz.path;
3322     <span class="keyword">else</span>
3323         guiprefs.kmz_path = pwd;
3324     <span class="keyword">end</span>
3325     <span class="keyword">if</span> exist(fullfile(kmz.path,kmz.file),<span class="string">'file'</span>)
3326         guiprefs.kmz_file = kmz.file;
3327     <span class="keyword">else</span>
3328         guiprefs.kmz_file = <span class="string">''</span>;
3329     <span class="keyword">end</span>
3330 <span class="keyword">else</span> <span class="comment">% Initialize KMZ</span>
3331     guiprefs.kmz_path = pwd;
3332     guiprefs.kmz_file = <span class="string">''</span>;
3333     
3334     kmz.path = pwd;
3335     kmz.file = <span class="string">''</span>;
3336     setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
3337 <span class="keyword">end</span>
3338 
3339 <span class="comment">% MULTIBEAM BATHYMETRY</span>
3340 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>)
3341     multibeambathymetry = getpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>);
3342     <span class="keyword">if</span> exist(multibeambathymetry.path,<span class="string">'dir'</span>)
3343         guiprefs.multibeambathymetry_path = multibeambathymetry.path;
3344     <span class="keyword">else</span>
3345         guiprefs.multibeambathymetry_path = pwd;
3346     <span class="keyword">end</span>
3347     <span class="keyword">if</span> exist(fullfile(multibeambathymetry.path,multibeambathymetry.file),<span class="string">'file'</span>)
3348         guiprefs.multibeambathymetry_file = multibeambathymetry.file;
3349     <span class="keyword">else</span>
3350         guiprefs.multibeambathymetry_file = <span class="string">''</span>;
3351     <span class="keyword">end</span>
3352 <span class="keyword">else</span> <span class="comment">% Initialize MULTIBEAM BATHYMETRY</span>
3353     guiprefs.multibeambathymetry_path = pwd;
3354     guiprefs.multibeambathymetry_file = <span class="string">''</span>;
3355     
3356     multibeambathymetry.path = pwd;
3357     multibeambathymetry.file = <span class="string">''</span>;
3358     setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
3359 <span class="keyword">end</span>
3360 
3361 <span class="comment">% Log</span>
3362 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'log'</span>)
3363     log = getpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>);
3364     <span class="keyword">if</span> exist(log.path,<span class="string">'dir'</span>)
3365         guiprefs.log_path = log.path;
3366     <span class="keyword">else</span>
3367         guiprefs.log_path = pwd;
3368     <span class="keyword">end</span>
3369     <span class="keyword">if</span> exist(fullfile(log.path,log.file),<span class="string">'file'</span>)
3370         guiprefs.log_file = log.file;
3371     <span class="keyword">else</span>
3372         guiprefs.log_file = <span class="string">''</span>;
3373     <span class="keyword">end</span>
3374 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
3375     guiprefs.log_path = pwd;
3376     guiprefs.log_file = <span class="string">''</span>;
3377     
3378     log.path = pwd;
3379     log.file = <span class="string">''</span>;
3380     setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
3381 <span class="keyword">end</span>
3382 
3383 <span class="comment">% iRic</span>
3384 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>)
3385     iric = getpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>);
3386     <span class="keyword">if</span> exist(iric.path,<span class="string">'dir'</span>)
3387         guiprefs.iric_path = iric.path;
3388     <span class="keyword">else</span>
3389         guiprefs.iric_path = pwd;
3390     <span class="keyword">end</span>
3391     <span class="keyword">if</span> exist(fullfile(iric.path,iric.file),<span class="string">'file'</span>)
3392         guiprefs.iric_file = iric.file;
3393     <span class="keyword">else</span>
3394         guiprefs.iric_file = <span class="string">''</span>;
3395     <span class="keyword">end</span>
3396 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
3397     guiprefs.iric_path = pwd;
3398     guiprefs.iric_file = <span class="string">''</span>;
3399     
3400     iric.path = pwd;
3401     iric.file = <span class="string">''</span>;
3402     setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
3403 <span class="keyword">end</span>
3404 
3405 <span class="comment">% excel</span>
3406 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>)
3407     excel = getpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>);
3408     <span class="keyword">if</span> exist(excel.path,<span class="string">'dir'</span>)
3409         guiprefs.excel_path = excel.path;
3410     <span class="keyword">else</span>
3411         guiprefs.excel_path = pwd;
3412     <span class="keyword">end</span>
3413     <span class="keyword">if</span> exist(fullfile(excel.path,excel.file),<span class="string">'file'</span>)
3414         guiprefs.excel_file = excel.file;
3415     <span class="keyword">else</span>
3416         guiprefs.excel_file = <span class="string">''</span>;
3417     <span class="keyword">end</span>
3418 <span class="keyword">else</span> <span class="comment">% Initialize pref</span>
3419     guiprefs.excel_path = pwd;
3420     guiprefs.excel_file = <span class="string">''</span>;
3421     
3422     excel.path = pwd;
3423     excel.file = <span class="string">''</span>;
3424     setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
3425 <span class="keyword">end</span>
3426 
3427 <span class="comment">% aerial</span>
3428 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>)
3429     aerial = getpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>);
3430     <span class="keyword">if</span> exist(aerial.path,<span class="string">'dir'</span>)
3431         guiprefs.aerial_path = aerial.path;
3432     <span class="keyword">else</span>
3433         guiprefs.aerial_path = pwd;
3434     <span class="keyword">end</span>
3435     does_exist = false(1,length(aerial.file));
3436     <span class="keyword">if</span> iscell(aerial.file)
3437     <span class="keyword">for</span> k = 1:numel(aerial.file) <span class="comment">% Check each file one-by-one</span>
3438         does_exist(k) = exist(fullfile(aerial.path,aerial.file{k}),<span class="string">'file'</span>);
3439     <span class="keyword">end</span>
3440     <span class="keyword">else</span>
3441         does_exist = exist(fullfile(aerial.path,aerial.file),<span class="string">'file'</span>);
3442     <span class="keyword">end</span>
3443     <span class="keyword">if</span> any(does_exist)
3444         guiprefs.aerial_file = aerial.file;
3445     <span class="keyword">else</span>
3446         guiprefs.aerial_file = {<span class="string">''</span>};
3447     <span class="keyword">end</span>
3448 <span class="keyword">else</span> <span class="comment">% Initialize aerial</span>
3449     guiprefs.aerial_path = pwd;
3450     guiprefs.aerial_file = {<span class="string">''</span>};
3451     
3452     aerial.path = pwd;
3453     aerial.file = {<span class="string">''</span>};
3454     setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
3455 <span class="keyword">end</span>
3456 
3457 <span class="comment">% shoreline</span>
3458 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>)
3459     shoreline = getpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>);
3460     <span class="keyword">if</span> exist(shoreline.path,<span class="string">'dir'</span>)
3461         guiprefs.shoreline_path = shoreline.path;
3462     <span class="keyword">else</span>
3463         guiprefs.shoreline_path = pwd;
3464     <span class="keyword">end</span>
3465     
3466     <span class="keyword">if</span> iscell(shoreline.file)
3467         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file{1}),<span class="string">'file'</span>)
3468             guiprefs.shoreline_file = shoreline.file;
3469         <span class="keyword">else</span>
3470             guiprefs.shoreline_file = <span class="string">''</span>;
3471         <span class="keyword">end</span>
3472     <span class="keyword">else</span>
3473         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file),<span class="string">'file'</span>)
3474             guiprefs.shoreline_file = shoreline.file;
3475         <span class="keyword">else</span>
3476             guiprefs.shoreline_file = <span class="string">''</span>;
3477         <span class="keyword">end</span>
3478     <span class="keyword">end</span>
3479 <span class="keyword">else</span> <span class="comment">% Initialize shoreline</span>
3480     guiprefs.shoreline_path = pwd;
3481     guiprefs.shoreline_file = <span class="string">''</span>;
3482     
3483     shoreline.path = pwd;
3484     shoreline.file = <span class="string">''</span>;
3485     setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
3486 <span class="keyword">end</span>
3487 <span class="comment">% guiprefs.presentation = true;</span>
3488 <span class="comment">% guiprefs.print        = false;</span>
3489 
3490 <span class="comment">% for k = 1:length(prefs)</span>
3491 <span class="comment">%     newpref = '';</span>
3492 <span class="comment">%     if ispref('VMT',prefs{k})</span>
3493 <span class="comment">%         stored_newpref = getpref('VMT',prefs{k});</span>
3494 <span class="comment">%         if exist(stored_newpref,'dir')</span>
3495 <span class="comment">%             newpref = stored_newpref;</span>
3496 <span class="comment">%         else</span>
3497 <span class="comment">%             setpref('VMT',prefs{k},newpref)</span>
3498 <span class="comment">%         end</span>
3499 <span class="comment">%     end</span>
3500 <span class="comment">%     guiprefs.(prefs{k}) = newpref;</span>
3501 <span class="comment">% end</span>
3502 
3503 <span class="comment">% RENDERER</span>
3504 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>)
3505     renderer = getpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>);
3506     guiprefs.renderer = renderer;
3507 <span class="keyword">else</span> <span class="comment">% Initialize RENDERER</span>
3508     renderer           = <span class="string">'OpenGL'</span>;
3509     guiprefs.renderer  = renderer;
3510     setpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>,renderer)
3511 <span class="keyword">end</span>
3512 
3513 <span class="comment">% UNITS</span>
3514 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'units'</span>)
3515     units = getpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>);
3516     guiprefs.units = units;
3517 <span class="keyword">else</span> <span class="comment">% Initialize RENDERER</span>
3518     units           = <span class="string">'metric'</span>;
3519     guiprefs.units  = renderer;
3520     setpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>,units)
3521 <span class="keyword">end</span>
3522 
3523 setappdata(hfigure,<span class="string">'guiprefs'</span>,guiprefs)
3524 
3525 <span class="comment">% [EOF] load_prefs</span>
3526 
3527 
3528 <span class="comment">% --------------------------------------------------------------------</span>
3529 <a name="_sub93" href="#_subfunctions" class="code">function store_prefs(hfigure,pref)</a>
3530 <span class="comment">% Store preferences in the Application data and in the persistent</span>
3531 <span class="comment">% preferences data.</span>
3532 
3533 <span class="comment">% Preferences:</span>
3534 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
3535 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
3536 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
3537 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
3538 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
3539 <span class="comment">% 'log'                  Path and filename of last Log file</span>
3540 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
3541 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
3542 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
3543 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
3544 <span class="comment">% 'renderer'             Default graphics renderer</span>
3545 <span class="comment">% 'units'                Default plotting units</span>
3546 
3547 guiprefs = getappdata(hfigure,<span class="string">'guiprefs'</span>);
3548 
3549 <span class="keyword">switch</span> pref
3550     <span class="keyword">case</span> <span class="string">'ascii'</span>
3551         ascii.path = guiprefs.ascii_path;
3552         ascii.file = guiprefs.ascii_file;
3553         setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
3554     <span class="keyword">case</span> <span class="string">'mat'</span>
3555         mat.path = guiprefs.mat_path;
3556         mat.file = guiprefs.mat_file;
3557         setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
3558     <span class="keyword">case</span> <span class="string">'tecplot'</span>
3559         tecplot.path = guiprefs.tecplot_path;
3560         tecplot.file = guiprefs.tecplot_file;
3561         setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
3562     <span class="keyword">case</span> <span class="string">'kmz'</span>
3563         kmz.path = guiprefs.kmz_path;
3564         kmz.file = guiprefs.kmz_file;
3565         setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
3566     <span class="keyword">case</span> <span class="string">'multibeambathymetry'</span>
3567         multibeambathymetry.path = guiprefs.multibeambathymetry_path;
3568         multibeambathymetry.file = guiprefs.multibeambathymetry_file;
3569         setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
3570     <span class="keyword">case</span> <span class="string">'log'</span>
3571         log.path = guiprefs.log_path;
3572         log.file = guiprefs.log_file;
3573         setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
3574     <span class="keyword">case</span> <span class="string">'iric'</span>
3575         iric.path = guiprefs.iric_path;
3576         iric.file = guiprefs.iric_file;
3577         setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
3578     <span class="keyword">case</span> <span class="string">'excel'</span>
3579         excel.path = guiprefs.excel_path;
3580         excel.file = guiprefs.excel_file;
3581         setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
3582     <span class="keyword">case</span> <span class="string">'aerial'</span>
3583         aerial.path = guiprefs.aerial_path;
3584         aerial.file = guiprefs.aerial_file;
3585         setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
3586     <span class="keyword">case</span> <span class="string">'shoreline'</span>
3587         shoreline.path = guiprefs.shoreline_path;
3588         shoreline.file = guiprefs.shoreline_file;
3589         setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
3590     <span class="keyword">case</span> <span class="string">'renderer'</span>
3591         renderer = guiprefs.renderer;
3592         setpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>,renderer)
3593     <span class="keyword">case</span> <span class="string">'units'</span>
3594         units = guiprefs.units;
3595         setpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>,units)
3596     <span class="keyword">otherwise</span>
3597 <span class="keyword">end</span>
3598 
3599 <span class="comment">% if ismember(pref,prefs)</span>
3600 <span class="comment">%     setpref('VMT',pref,value)</span>
3601 <span class="comment">%</span>
3602 <span class="comment">%     guiprefs = getappdata(hfigure,'guiprefs');</span>
3603 <span class="comment">%     guiprefs.(pref) = value;</span>
3604 <span class="comment">%     setappdata(hfigure,'guiprefs',guiprefs)</span>
3605 <span class="comment">% end</span>
3606 
3607 <span class="comment">% [EOF] store_prefs</span>
3608 
3609 
3610 <span class="comment">% --------------------------------------------------------------------</span>
3611 <a name="_sub94" href="#_subfunctions" class="code">function initGUI(handles)</a>
3612 <span class="comment">% Initialize the UI controls in the GUI.</span>
3613 
3614 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3615 
3616 <span class="comment">% Set the name and version</span>
3617 set(handles.figure1,<span class="string">'Name'</span>,[<span class="string">'Velocity Mapping Toolbox (VMT) '</span> guiparams.vmt_version], <span class="keyword">...</span>
3618     <span class="string">'DockControls'</span>,<span class="string">'off'</span>)
3619 <span class="comment">%set(handles.VMTversion,             'String',guiparams.vmt_version)</span>
3620 
3621 <span class="comment">% Set the PLOT 1 axis labels</span>
3622 axes(handles.Plot1Shiptracks);
3623 set(handles.Plot1Shiptracks,<span class="string">'DataAspectRatio'</span>,[1 1 1],<span class="string">'PlotBoxAspectRatio'</span>,[1 1 1])
3624 xlabel(<span class="string">'UTM Easting (m)'</span>)
3625 ylabel(<span class="string">'UTM Northing (m)'</span>)
3626 box on
3627 grid on
3628 <span class="comment">% ticks_format('%6.0f','%8.0f'); %formats the ticks for UTM</span>
3629 
3630 <span class="comment">%%%%%%%%%%%%</span>
3631 <span class="comment">% MENU BAR %</span>
3632 <span class="comment">%%%%%%%%%%%%</span>
3633 <span class="keyword">if</span> guiparams.english_units
3634     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3635     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
3636 <span class="keyword">else</span>
3637     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3638     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
3639 <span class="keyword">end</span>
3640 
3641 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
3642     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
3643     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3644 <span class="keyword">else</span>
3645     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
3646     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3647 <span class="keyword">end</span>
3648 
3649 
3650 <span class="keyword">if</span> guiparams.print
3651     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3652     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
3653     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3654     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3655 <span class="keyword">elseif</span> guiparams.presentation
3656     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3657     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
3658     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3659     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3660 <span class="keyword">else</span>
3661 <span class="keyword">end</span>
3662 
3663 <span class="keyword">switch</span> guiparams.renderer
3664     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
3665         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3666         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3667         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3668     <span class="keyword">case</span> <span class="string">'painters'</span>
3669         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3670         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3671         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3672     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
3673         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3674         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3675         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3676 <span class="keyword">end</span>
3677 
3678 
3679 <span class="comment">%%%%%%%%%%%%%%%</span>
3680 <span class="comment">% DATA EXPORT %</span>
3681 <span class="comment">%%%%%%%%%%%%%%%</span>
3682 <span class="comment">% BathymetryPanel</span>
3683 <span class="comment">% set(handles.BeamAngle,                  'String',guiparams.beam_angle)</span>
3684 <span class="comment">% set(handles.MagneticVariation,          'String',guiparams.magnetic_variation)</span>
3685 <span class="comment">% set(handles.WSE,                        'String',guiparams.wse)</span>
3686 <span class="comment">% set(handles.OutputAuxiliaryData,        'Value', guiparams.output_auxiliary_data)</span>
3687 
3688 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
3689 <span class="comment">% PLOTTING/PLAN VIEW %</span>
3690 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
3691 <span class="comment">% PlanViewPanel</span>
3692 set(handles.DepthRangeMin,              <span class="string">'String'</span>,guiparams.depth_range_min)
3693 set(handles.DepthRangeMax,              <span class="string">'String'</span>,guiparams.depth_range_max)
3694 set(handles.VectorScalePlanView,        <span class="string">'String'</span>,guiparams.vector_scale_plan_view)
3695 set(handles.VectorSpacingPlanview,      <span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
3696 set(handles.SmoothingWindowSize,        <span class="string">'String'</span>,guiparams.smoothing_window_size)
3697 set(handles.DisplayShoreline,           <span class="string">'Value'</span>, guiparams.display_shoreline)
3698 set(handles.AddBackground,              <span class="string">'Value'</span>, guiparams.add_background)
3699 
3700 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
3701 <span class="comment">% PLOTTING/SHIP TRACKS %</span>
3702 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
3703 <span class="comment">% ShiptracksPanel</span>
3704 set(handles.HorizontalGridNodeSpacing,  <span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
3705 set(handles.VerticalGridNodeSpacing,    <span class="string">'String'</span>,guiparams.vertical_grid_node_spacing)
3706 <span class="comment">%set(handles.SetCrossSectionEndpoints,   'Value', guiparams.set_cross_section_endpoints)</span>
3707 
3708 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3709 <span class="comment">% PLOTTING/CROSS SECTIONS %</span>
3710 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3711 <span class="comment">% CrossSectionsPanel</span>
3712 set(handles.Contour,                    <span class="string">'String'</span>,{guiparams.contours.string}, <span class="keyword">...</span>
3713     <span class="string">'Value'</span>, guiparams.idx_contour)
3714 set(handles.VerticalExaggeration,       <span class="string">'String'</span>,guiparams.vertical_exaggeration)
3715 set(handles.VectorScaleCrossSection,    <span class="string">'String'</span>,guiparams.vector_scale_cross_section)
3716 set(handles.HorizontalVectorSpacing,    <span class="string">'String'</span>,guiparams.horizontal_vector_spacing)
3717 set(handles.VerticalVectorSpacing,      <span class="string">'String'</span>,guiparams.vertical_vector_spacing)
3718 set(handles.HorizontalSmoothingWindow,  <span class="string">'String'</span>,guiparams.horizontal_smoothing_window)
3719 set(handles.VerticalSmoothingWindow,    <span class="string">'String'</span>,guiparams.vertical_smoothing_window)
3720 set(handles.PlotSecondaryFlowVectors,   <span class="string">'Value'</span>, guiparams.plot_secondary_flow_vectors)
3721 set(handles.SecondaryFlowVectorVariable,<span class="string">'String'</span>,{guiparams.secondary_flows.string}, <span class="keyword">...</span>
3722     <span class="string">'Value'</span>, guiparams.idx_secondary_flow_vector_variable)
3723 set(handles.IncludeVerticalVelocity,    <span class="string">'Value'</span>, guiparams.include_vertical_velocity)
3724 
3725 <span class="comment">% set(handles.EnglishUnits,               'Value',guiparams.english_units)</span>
3726 
3727 <span class="comment">% [EOF] initGUI</span>
3728 
3729 
3730 <span class="comment">% --------------------------------------------------------------------</span>
3731 <a name="_sub95" href="#_subfunctions" class="code">function set_enable(handles,enable_state)</a>
3732 
3733 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3734 
3735 <span class="keyword">switch</span> enable_state
3736     <span class="keyword">case</span> <span class="string">'init'</span>
3737         guiparams.gui_state = <span class="string">'init'</span>;
3738         set([handles.menuFile
3739             handles.menuOpen
3740             handles.menuOpenASCII
3741             handles.menuOpenMAT
3742             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3743         
3744         set([handles.toolbarLoadData
3745             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3746         set([handles.toolbarSaveMatFile
3747             handles.toolbarSaveBathymetry
3748             handles.toolbarSaveFigures
3749             handles.toolbarSaveExcel
3750             handles.toolbarPlottingParameters
3751             handles.toolbarProcessingParameters
3752             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3753         
3754         set([handles.DepthRangeMin
3755             handles.DepthRangeMax
3756             handles.VectorScalePlanView
3757             handles.VectorSpacingPlanview
3758             handles.SmoothingWindowSize
3759             handles.DisplayShoreline
3760             handles.AddBackground
3761             handles.PlotPlanView
3762             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3763         
3764         set([handles.HorizontalGridNodeSpacing
3765             handles.VerticalGridNodeSpacing
3766             handles.PlotShiptracks
3767             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3768         
3769         set([handles.Contour
3770             handles.VerticalExaggeration
3771             handles.VectorScaleCrossSection
3772             handles.HorizontalVectorSpacing
3773             handles.VerticalVectorSpacing
3774             handles.HorizontalSmoothingWindow
3775             handles.VerticalSmoothingWindow
3776             handles.PlotSecondaryFlowVectors
3777             handles.SecondaryFlowVectorVariable
3778             handles.IncludeVerticalVelocity
3779             handles.PlotCrossSection
3780             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3781         
3782     <span class="keyword">case</span> <span class="string">'fileloaded'</span>
3783         guiparams.gui_state = <span class="string">'fileloaded'</span>;
3784         set([handles.menuFile
3785             handles.menuOpen
3786             handles.menuOpenASCII
3787             handles.menuOpenMAT
3788             handles.menuSaveMAT
3789             handles.menuSaveTecplot
3790             handles.menuSaveKMZFile
3791             handles.menuParameters
3792             handles.menuPlottingParameters
3793             handles.menuMetric
3794             handles.menuEnglish
3795             handles.menuBathymetryExportSettings
3796             handles.menuExportMultibeamBathymetry
3797             handles.menuKMZVerticalOffset
3798             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3799         
3800         set([handles.toolbarLoadData
3801             handles.toolbarSaveMatFile
3802             handles.toolbarSaveBathymetry
3803             handles.toolbarSaveExcel
3804             handles.toolbarSaveFigures
3805             handles.toolbarPlottingParameters
3806             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3807         set([handles.toolbarProcessingParameters
3808             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3809         
3810            
3811         set([handles.DepthRangeMin
3812             handles.DepthRangeMax
3813             handles.VectorScalePlanView
3814             handles.VectorSpacingPlanview
3815             handles.SmoothingWindowSize
3816             handles.DisplayShoreline
3817             handles.PlotPlanView
3818             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3819         <span class="keyword">if</span> guiparams.has_mapping_toolbox
3820             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3821         <span class="keyword">else</span>
3822             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3823         <span class="keyword">end</span>
3824         
3825         set([handles.HorizontalGridNodeSpacing
3826             handles.VerticalGridNodeSpacing
3827             handles.PlotShiptracks
3828             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3829         
3830         set([handles.Contour
3831             handles.VerticalExaggeration
3832             handles.VectorScaleCrossSection
3833             handles.HorizontalVectorSpacing
3834             handles.VerticalVectorSpacing
3835             handles.HorizontalSmoothingWindow
3836             handles.VerticalSmoothingWindow
3837             handles.PlotSecondaryFlowVectors
3838             handles.SecondaryFlowVectorVariable
3839             handles.IncludeVerticalVelocity
3840             handles.PlotCrossSection
3841             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3842     <span class="keyword">case</span> <span class="string">'multiplematfiles'</span>
3843         guiparams.gui_state = <span class="string">'multiplematfiles'</span>;
3844         set([handles.menuFile
3845             handles.menuOpen
3846             handles.menuOpenASCII
3847             handles.menuOpenMAT
3848             handles.menuParameters
3849             handles.menuPlottingParameters
3850             handles.menuMetric
3851             handles.menuEnglish
3852             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3853         set([handles.menuSaveMAT
3854             handles.menuBathymetryExportSettings
3855             handles.menuExportMultibeamBathymetry
3856             handles.menuKMZVerticalOffset
3857             handles.menuSaveKMZFile
3858             handles.menuSaveTecplot
3859             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3860         
3861         set([handles.toolbarLoadData
3862             handles.toolbarSaveFigures
3863             handles.toolbarPlottingParameters
3864             handles.toolbarSaveExcel
3865             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3866         set([handles.toolbarProcessingParameters
3867             handles.toolbarSaveMatFile
3868             handles.toolbarSaveBathymetry
3869             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3870         
3871         set([handles.DepthRangeMin
3872             handles.DepthRangeMax
3873             handles.VectorScalePlanView
3874             handles.VectorSpacingPlanview
3875             handles.SmoothingWindowSize
3876             handles.DisplayShoreline
3877             handles.PlotPlanView
3878             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3879         <span class="keyword">if</span> guiparams.has_mapping_toolbox
3880             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3881         <span class="keyword">else</span>
3882             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3883         <span class="keyword">end</span>
3884         
3885         set([handles.HorizontalGridNodeSpacing
3886             handles.VerticalGridNodeSpacing
3887             handles.PlotShiptracks
3888             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3889         
3890         set([handles.Contour
3891             handles.VerticalExaggeration
3892             handles.VectorScaleCrossSection
3893             handles.HorizontalVectorSpacing
3894             handles.VerticalVectorSpacing
3895             handles.HorizontalSmoothingWindow
3896             handles.VerticalSmoothingWindow
3897             handles.PlotSecondaryFlowVectors
3898             handles.SecondaryFlowVectorVariable
3899             handles.IncludeVerticalVelocity
3900             handles.PlotCrossSection
3901             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3902     <span class="keyword">otherwise</span>
3903 <span class="keyword">end</span>
3904 
3905 <span class="comment">% Save Application Data</span>
3906 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3907 
3908 <span class="comment">% [EOF] set_enable</span>
3909 
3910 <span class="comment">%% Compute the longitudinal dispersion coefficient</span>
3911 
3912 <span class="comment">%% --- Executes on button press in zerosecq_chkbox.</span>
3913 <span class="comment">%function zerosecq_chkbox_Callback(hObject, eventdata, handles)</span>
3914 <span class="comment">% hObject    handle to zerosecq_chkbox (see GCBO)</span>
3915 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
3916 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
3917 
3918 <span class="comment">% Hint: get(hObject,'Value') returns toggle state of zerosecq_chkbox</span>
3919 
3920 
3921 <span class="comment">% --------------------------------------------------------------------</span>
3922 <a name="_sub96" href="#_subfunctions" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] = </a><span class="keyword">...</span>
3923     plotParametersDialog(english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style,hf)
3924 
3925 w = 500;
3926 h = 110;
3927 dx = 10;
3928 dy = 35;
3929 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
3930 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
3931     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
3932     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
3933     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
3934     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
3935     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
3936     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
3937     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3938     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
3939     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
3940     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
3941 dialog_params.english_units               = english_units;
3942 dialog_params.set_cross_section_endpoints = set_cross_section_endpoints;
3943 dialog_params.presentation                = plot_presentation_style; <span class="comment">%presentation;</span>
3944 dialog_params.print                       = plot_print_style; <span class="comment">%print;</span>
3945 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
3946 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
3947 
3948 <span class="comment">% Build the graphics:</span>
3949 <span class="comment">% -------------------</span>
3950 handles.UnitsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
3951     <span class="string">'Title'</span>, <span class="string">'Units'</span>, <span class="keyword">...</span>
3952     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3953     <span class="string">'Position'</span>,[dx dy (w-3*dx)/3 h-dx-dy+10]);
3954 handles.UnitsMetric = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3955     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
3956     <span class="string">'String'</span>,<span class="string">'Metric'</span>, <span class="keyword">...</span>
3957     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3958     <span class="string">'Position'</span>,[15 35 100 22]);
3959 handles.UnitsEnglish = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3960     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
3961     <span class="string">'String'</span>,<span class="string">'English'</span>, <span class="keyword">...</span>
3962     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3963     <span class="string">'Position'</span>,[15 10 100 22]);
3964 
3965 handles.EndpointsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
3966     <span class="string">'Title'</span>, <span class="string">'Cross-Section Endpoints'</span>, <span class="keyword">...</span>
3967     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3968     <span class="string">'Position'</span>,[(w+dx)/3 dy (w-3*dx)/3 h-dx-dy+10]);
3969 handles.EndpointsAutomatic = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3970     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
3971     <span class="string">'String'</span>,<span class="string">'Automatic'</span>, <span class="keyword">...</span>
3972     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3973     <span class="string">'Position'</span>,[15 35 100 22]);
3974 handles.EndpointsManual = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3975     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
3976     <span class="string">'String'</span>,<span class="string">'Set Manually'</span>, <span class="keyword">...</span>
3977     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3978     <span class="string">'Position'</span>,[15 10 100 22]);
3979 
3980 handles.StylePanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
3981     <span class="string">'Title'</span>, <span class="string">'Plot Style'</span>, <span class="keyword">...</span>
3982     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3983     <span class="string">'Position'</span>,[w-w/3 dy (w-3*dx)/3 h-dx-dy+10]);
3984 handles.StylePresentation = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3985     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
3986     <span class="string">'String'</span>,<span class="string">'Presentation'</span>, <span class="keyword">...</span>
3987     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3988     <span class="string">'Position'</span>,[15 35 100 22]);
3989 handles.StylePrint = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
3990     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
3991     <span class="string">'String'</span>,<span class="string">'Print'</span>, <span class="keyword">...</span>
3992     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
3993     <span class="string">'Position'</span>,[15 10 100 22]);
3994 
3995 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
3996     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
3997     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
3998     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
3999     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4000 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4001     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4002     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4003     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4004     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4005 
4006 <span class="comment">% Update the UI controls:</span>
4007 <span class="comment">% -----------------------</span>
4008 <span class="keyword">if</span> dialog_params.english_units
4009     set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
4010     set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
4011 <span class="keyword">else</span>
4012     set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
4013     set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
4014 <span class="keyword">end</span>
4015 <span class="keyword">if</span> dialog_params.set_cross_section_endpoints
4016     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
4017     set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
4018 <span class="keyword">else</span>
4019     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
4020     set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
4021 <span class="keyword">end</span>
4022 <span class="keyword">if</span> dialog_params.presentation
4023     set(handles.StylePresentation, <span class="string">'Value'</span>,1)
4024     set(handles.StylePrint,        <span class="string">'Value'</span>,0)
4025 <span class="keyword">else</span>
4026     set(handles.StylePresentation, <span class="string">'Value'</span>,0)
4027     set(handles.StylePrint,        <span class="string">'Value'</span>,1)
4028 <span class="keyword">end</span>
4029 
4030 <span class="comment">% Set the callbacks:</span>
4031 <span class="comment">% ------------------</span>
4032 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub102" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>, handles.OK})
4033 set(handles.UnitsMetric,       <span class="string">'Callback'</span>,       {@<a href="#_sub97" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'metric'</span>})
4034 set(handles.UnitsEnglish,      <span class="string">'Callback'</span>,       {@<a href="#_sub97" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'english'</span>})
4035 set(handles.EndpointsAutomatic,<span class="string">'Callback'</span>,       {@<a href="#_sub98" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'auto'</span>})
4036 set(handles.EndpointsManual,   <span class="string">'Callback'</span>,       {@<a href="#_sub98" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'manual'</span>})
4037 set(handles.StylePresentation, <span class="string">'Callback'</span>,       {@<a href="#_sub99" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'presentation'</span>})
4038 set(handles.StylePrint,        <span class="string">'Callback'</span>,       {@<a href="#_sub99" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'print'</span>})
4039 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub100" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
4040 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub101" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
4041 
4042 <span class="comment">% Position the dialog and make it visible:</span>
4043 <span class="comment">% ----------------------------------------</span>
4044 fpos = get(hf,<span class="string">'Position'</span>);
4045 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
4046 movegui(handles.Figure,dpos)
4047 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
4048 
4049 <span class="comment">% Hold the dialog open:</span>
4050 <span class="comment">% ---------------------</span>
4051 waitfor(handles.OK)
4052 
4053 <span class="comment">% Return the outputs and close the dialog:</span>
4054 <span class="comment">% ----------------------------------------</span>
4055 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4056 english_units = dialog_params.english_units;
4057 set_cross_section_endpoints = dialog_params.set_cross_section_endpoints;
4058 plot_presentation_style =  dialog_params.presentation;
4059 plot_print_style =  dialog_params.print;
4060 
4061 delete(handles.Figure)
4062 
4063 <span class="comment">% [EOF] plotParametersDialog</span>
4064 
4065 
4066 <span class="comment">% --------------------------------------------------------------------</span>
4067 <a name="_sub97" href="#_subfunctions" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a>
4068 
4069 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4070 <span class="keyword">switch</span> the_units
4071     <span class="keyword">case</span> <span class="string">'metric'</span>
4072         dialog_params.english_units = false;
4073         
4074         set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
4075         set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
4076     <span class="keyword">case</span> <span class="string">'english'</span>
4077         dialog_params.english_units = true;
4078         
4079         set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
4080         set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
4081     <span class="keyword">otherwise</span>
4082 <span class="keyword">end</span>
4083 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4084 
4085 <span class="comment">% [EOF] dialogUnits</span>
4086 
4087 <span class="comment">% --------------------------------------------------------------------</span>
4088 <a name="_sub98" href="#_subfunctions" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a>
4089 
4090 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4091 <span class="keyword">switch</span> the_endpoints
4092     <span class="keyword">case</span> <span class="string">'auto'</span>
4093         dialog_params.set_cross_section_endpoints = false;
4094         
4095         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
4096         set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
4097     <span class="keyword">case</span> <span class="string">'manual'</span>
4098         dialog_params.set_cross_section_endpoints = true;
4099         
4100         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
4101         set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
4102     <span class="keyword">otherwise</span>
4103 <span class="keyword">end</span>
4104 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4105 
4106 <span class="comment">% [EOF] dialogEnpoints</span>
4107 
4108 <a name="_sub99" href="#_subfunctions" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a>
4109 
4110 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4111 <span class="keyword">switch</span> the_style
4112     <span class="keyword">case</span> <span class="string">'presentation'</span>
4113         dialog_params.presentation  = true;
4114         dialog_params.print         = false;
4115         
4116         set(handles.StylePresentation,<span class="string">'Value'</span>,1)
4117         set(handles.StylePrint,       <span class="string">'Value'</span>,0)
4118     <span class="keyword">case</span> <span class="string">'print'</span>
4119         dialog_params.presentation  = false;
4120         dialog_params.print         = true;
4121         
4122         set(handles.StylePresentation,<span class="string">'Value'</span>,0)
4123         set(handles.StylePrint,       <span class="string">'Value'</span>,1)
4124     <span class="keyword">otherwise</span>
4125 <span class="keyword">end</span>
4126 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4127 
4128 <span class="comment">% [EOF] dialogEnpoints</span>
4129 
4130 <span class="comment">% --------------------------------------------------------------------</span>
4131 <a name="_sub100" href="#_subfunctions" class="code">function dialogOK(hObject,eventdata,h_OK)</a>
4132 
4133 delete(h_OK)
4134 
4135 <span class="comment">% [EOF] dialogOK</span>
4136 
4137 <span class="comment">% --------------------------------------------------------------------</span>
4138 <a name="_sub101" href="#_subfunctions" class="code">function dialogCancel(hObject,eventdata,handles)</a>
4139 <span class="comment">% Return the original inputs</span>
4140 dialog_params = getappdata(handles.Figure,<span class="string">'original_dialog_params'</span>);
4141 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4142 delete(handles.OK)
4143 
4144 <span class="comment">% [EOF] dialogCancel</span>
4145 
4146 <span class="comment">% --------------------------------------------------------------------</span>
4147 <a name="_sub102" href="#_subfunctions" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a>
4148 
4149 delete(h_OK)
4150 
4151 <span class="comment">% [EOF] dialogCloseReq</span>
4152 
4153 <a name="_sub103" href="#_subfunctions" class="code">function [beam_angle,magnetic_variation,wse,output_auxiliary_data] = exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,hf)</a>
4154 w = 230;
4155 h = 200;
4156 dx = 10;
4157 dy = 35;
4158 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4159 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Export Settings'</span>, <span class="keyword">...</span>
4160     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4161     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4162     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4163     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4164     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4165     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4166     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4167     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4168     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4169     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4170 dialog_params.beam_angle             = beam_angle;
4171 dialog_params.magnetic_variation     = magnetic_variation;
4172 dialog_params.wse                    = wse;
4173 dialog_params.output_auxiliary_data = output_auxiliary_data;
4174 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4175 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4176 
4177 <span class="comment">% Build the graphics:</span>
4178 <span class="comment">% -------------------</span>
4179 ph = 150;
4180 handles.BathymetryPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4181     <span class="string">'Title'</span>, <span class="string">'Bathymetry'</span>, <span class="keyword">...</span>
4182     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4183     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
4184 handles.BeamAngleText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4185     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4186     <span class="string">'String'</span>,<span class="string">'Beam Angle (deg)'</span>, <span class="keyword">...</span>
4187     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4188     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4189     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4190     <span class="string">'Position'</span>,[dx+5 h-ph+60-4 100 22]);
4191 handles.BeamAngle = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4192     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4193     <span class="keyword">...</span><span class="comment">'String','Beam Angle (deg)', ...</span>
4194     <span class="string">'String'</span>,beam_angle,<span class="keyword">...</span>
4195     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4196     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4197     <span class="string">'Position'</span>,[w-dx-80 h-ph+60 50 22]);
4198 handles.MagneticVariationText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4199     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4200     <span class="string">'String'</span>,<span class="string">'Magnetic Variation'</span>, <span class="keyword">...</span>
4201     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4202     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4203     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4204     <span class="string">'Position'</span>,[dx+5 h-ph+30-4 100 22]);
4205 handles.MagneticVariation = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4206     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4207     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
4208     <span class="string">'String'</span>,magnetic_variation,<span class="keyword">...</span>
4209     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4210     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4211     <span class="string">'Position'</span>,[w-dx-80 h-ph+30 50 22]);
4212 handles.WSEText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4213     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4214     <span class="string">'String'</span>,<span class="string">'WSE (m)'</span>, <span class="keyword">...</span>
4215     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4216     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4217     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4218     <span class="string">'Position'</span>,[dx+5 h-ph-4 100 22]);
4219 handles.WSE = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4220     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4221     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
4222     <span class="string">'String'</span>,num2str(wse),<span class="keyword">...</span>
4223     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4224     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4225     <span class="string">'Position'</span>,[w-dx-80 h-ph 50 22]);
4226 handles.OutputauxiliaryData = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4227     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4228     <span class="string">'String'</span>,<span class="string">'Output auxiliary Data'</span>, <span class="keyword">...</span>
4229     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4230     <span class="string">'Position'</span>,[dx+5 20 w-2*dx-30 22]);
4231 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4232     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4233     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
4234     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4235     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4236 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4237     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4238     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4239     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4240     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4241 
4242 <span class="comment">% Update the UI controls:</span>
4243 <span class="comment">% -----------------------</span>
4244 set(handles.BeamAngle,                <span class="string">'String'</span>,dialog_params.beam_angle)
4245 set(handles.MagneticVariation,        <span class="string">'String'</span>,dialog_params.magnetic_variation)
4246 set(handles.WSE,                      <span class="string">'String'</span>,dialog_params.wse)
4247 set(handles.OutputauxiliaryData,     <span class="string">'Value'</span>, double(dialog_params.output_auxiliary_data))
4248 
4249 <span class="comment">% Set the callbacks:</span>
4250 <span class="comment">% ------------------</span>
4251 set(handles.Figure,                      <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub102" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
4252 set(handles.BeamAngle,                   <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4253 set(handles.MagneticVariation,           <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4254 set(handles.WSE,                         <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4255 set(handles.OutputauxiliaryData,         <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4256 set(handles.OK,                          <span class="string">'Callback'</span>,       {@<a href="#_sub100" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,      handles.OK})
4257 set(handles.Cancel,                      <span class="string">'Callback'</span>,       {@<a href="#_sub101" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,  handles})
4258 
4259 <span class="comment">% Position the dialog and make it visible:</span>
4260 <span class="comment">% ----------------------------------------</span>
4261 fpos = get(hf,<span class="string">'Position'</span>);
4262 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
4263 movegui(handles.Figure,dpos)
4264 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
4265 
4266 <span class="comment">% Hold the dialog open:</span>
4267 <span class="comment">% ---------------------</span>
4268 waitfor(handles.OK)
4269 
4270 <span class="comment">% Return the outputs and close the dialog:</span>
4271 <span class="comment">% ----------------------------------------</span>
4272 dialog_params           = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4273 beam_angle              = dialog_params.beam_angle;
4274 magnetic_variation      = dialog_params.magnetic_variation;
4275 wse                     = str2double(dialog_params.wse);
4276 output_auxiliary_data  = logical(dialog_params.output_auxiliary_data);
4277 
4278 delete(handles.Figure)
4279 
4280 <span class="comment">% [EOF] exportSettingsDialog</span>
4281 
4282 <span class="comment">% --------------------------------------------------------------------</span>
4283 <a name="_sub104" href="#_subfunctions" class="code">function dialogExportSettings(hObject,eventdata,handles)</a>
4284 
4285 <span class="comment">% Grab the current data</span>
4286 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4287 
4288 <span class="comment">% Set it according to the dialog box values</span>
4289 dialog_params.beam_angle                = get(handles.BeamAngle,<span class="string">'String'</span>);
4290 dialog_params.magnetic_variation        = get(handles.MagneticVariation,<span class="string">'String'</span>);
4291 dialog_params.wse                       = get(handles.WSE,<span class="string">'String'</span>);
4292 dialog_params.output_auxiliary_data    = get(handles.OutputauxiliaryData,<span class="string">'Value'</span>);
4293 
4294 <span class="comment">% Re-store the application data</span>
4295 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4296 
4297 <span class="comment">% [EOF] dialogExportSettings</span>
4298 
4299 <a name="_sub105" href="#_subfunctions" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a>
4300 
4301 w = 230;
4302 h = 200;
4303 dx = 10;
4304 dy = 35;
4305 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4306 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Select open figures to export'</span>, <span class="keyword">...</span>
4307     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4308     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4309     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4310     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4311     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4312     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4313     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4314     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4315     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4316     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4317 dialog_params.figure_names               = figure_names;
4318 dialog_params.selected_figures           = <span class="string">''</span>;
4319 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4320 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4321 
4322 <span class="comment">% Build the graphics:</span>
4323 <span class="comment">% -------------------</span>
4324 handles.ListboxPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4325     <span class="string">'Title'</span>, <span class="string">'Figures'</span>, <span class="keyword">...</span>
4326     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4327     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
4328 handles.Figures = uicontrol(<span class="string">'Style'</span>,<span class="string">'listbox'</span>, <span class="keyword">...</span>
4329     <span class="string">'Parent'</span>,handles.ListboxPanel, <span class="keyword">...</span>
4330     <span class="string">'BackGroundColor'</span>,<span class="string">'white'</span>,<span class="keyword">...</span>
4331     <span class="string">'String'</span>,figure_names, <span class="keyword">...</span>
4332     <span class="string">'Min'</span>, 0,<span class="keyword">...</span>
4333     <span class="string">'Max'</span>, 2,<span class="keyword">...</span>
4334     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4335     <span class="string">'Position'</span>,[15 35 (w-5*dx) 100]);
4336 
4337 
4338 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4339     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4340     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
4341     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4342     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4343 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4344     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4345     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4346     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4347     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4348 
4349 <span class="comment">% Update the UI controls:</span>
4350 <span class="comment">% -----------------------</span>
4351 
4352 
4353 <span class="comment">% Set the callbacks:</span>
4354 <span class="comment">% ------------------</span>
4355 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub102" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
4356 set(handles.Figures,           <span class="string">'Callback'</span>,       {@<a href="#_sub106" class="code" title="subfunction dialogSelectFigures(hObject,eventdata,handles)">dialogSelectFigures</a>    handles})
4357 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub100" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
4358 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub101" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
4359 
4360 <span class="comment">% Position the dialog and make it visible:</span>
4361 <span class="comment">% ----------------------------------------</span>
4362 fpos = get(hf,<span class="string">'Position'</span>);
4363 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
4364 movegui(handles.Figure,dpos)
4365 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
4366 
4367 <span class="comment">% Hold the dialog open:</span>
4368 <span class="comment">% ---------------------</span>
4369 waitfor(handles.OK)
4370 
4371 <span class="comment">% Return the outputs and close the dialog:</span>
4372 <span class="comment">% ----------------------------------------</span>
4373 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4374 selected_figures = dialog_params.selected_figures;
4375 
4376 delete(handles.Figure)
4377 
4378 <span class="comment">% [EOF] openFiguresDialog</span>
4379 
4380 <span class="comment">% --------------------------------------------------------------------</span>
4381 <a name="_sub106" href="#_subfunctions" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a>
4382 
4383 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4384 
4385 idx_selected = get(handles.Figures,<span class="string">'Value'</span>);
4386 fig_names    = get(handles.Figures,<span class="string">'String'</span>);
4387 selected     = fig_names(idx_selected);
4388 dialog_params.selected_figures = selected;
4389 
4390 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4391 
4392 
4393 
4394 <span class="comment">% --------------------------------------------------------------------</span>
4395 <a name="_sub107" href="#_subfunctions" class="code">function icons = getIcons</a>
4396 
4397 <span class="comment">% Load data</span>
4398 idx = 1;
4399 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4400     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
4401     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   129   120   135   188   NaN   NaN   NaN
4402     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN    96   189   NaN   NaN   130   NaN    95   NaN
4403     NaN   NaN   206   206   206   206   NaN   NaN   NaN   NaN   NaN   NaN   NaN    84    79   NaN
4404     NaN   206   255   255   255   255   198   197   NaN   NaN   NaN   NaN    83    79    76   NaN
4405     198   255   255   255   255   255   255   198   198   198   198   198   198   212   212   NaN
4406     198   255   255   255   255   255   255   255   255   255   255   255   198   157   197   NaN
4407     198   255   226   198   198   198   198   198   198   198   198   198   198   198   177   NaN
4408     198   255   198   218   255   255   255   255   255   255   255   255   255   255   161   NaN
4409     198   253   198   247   255   255   255   255   255   255   255   255   255   251   155   NaN
4410     198   226   201   255   255   255   255   255   255   255   255   255   231   206   165   NaN
4411     198   207   215   255   255   255   255   255   255   255   255   255   239   198   159   NaN
4412     198   198   240   255   255   255   255   255   255   255   255   255   222   157   159   NaN
4413     198   199   255   255   255   255   255   255   255   255   255   255   191   165   159   NaN
4414     NaN   165   165   165   165   165   165   165   165   165   165   165   165   159   159   NaN
4415     NaN   NaN   159   159   159   159   159   159   159   159   159   159   159   159   NaN   NaN]/255;
4416 
4417 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4418     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
4419     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   145   137   149   195   NaN   NaN   NaN
4420     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   116   196   NaN   NaN   145   NaN   116   NaN
4421     NaN   NaN   162   162   162   162   NaN   NaN   NaN   NaN   NaN   NaN   NaN   107   105   NaN
4422     NaN   162   255   255   255   255   154   197   NaN   NaN   NaN   NaN   106   104   103   NaN
4423     154   255   255   255   255   255   255   154   154   154   154   154   154   208   208   NaN
4424     154   243   243   243   243   243   243   255   255   255   255   255   154   123   197   NaN
4425     154   235   193   154   154   154   154   154   154   154   154   154   154   154   137   NaN
4426     154   215   154   191   255   255   251   255   255   255   255   255   231   255   126   NaN
4427     154   213   154   240   255   255   255   255   255   255   255   255   199   249   123   NaN
4428     154   179   160   255   247   247   247   247   247   247   247   247   190   188   115   NaN
4429     154   162   184   255   235   235   235   235   235   235   235   231   186   154   169   NaN
4430     154   154   228   255   227   227   227   227   227   227   227   223   178   123   169   NaN
4431     154   156   255   215   215   215   215   215   215   215   215   215   153   115   169   NaN
4432     NaN   115   115   115   115   115   115   115   115   115   115   115   115   169   169   NaN
4433     NaN   NaN   169   169   169   169   169   169   169   169   169   169   169   169   NaN   NaN]/255;
4434 
4435 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4436     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
4437     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   166   161   170   202   NaN   NaN   NaN
4438     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   149   205   NaN   NaN   166   NaN   148   NaN
4439     NaN   NaN    34    34    34    34   NaN   NaN   NaN   NaN   NaN   NaN   NaN   141   144   NaN
4440     NaN    34   255   255   255   255    25   197   NaN   NaN   NaN   NaN   142   145   147   NaN
4441     25   255   156   156   156   156   255    25    25    25    25    25    25   200   200   NaN
4442     25   156   140   140   140   140   140   255   255   255   255   255    25    26   197   NaN
4443     25   132    80    25    25    25    25    25    25    25    25    25    25    25    25   NaN
4444     25   132    25   108   255   255   247   255   255   255   255   255   132   255    25   NaN
4445     25   112    25   137   156   156   156   156   156   156   156   156    91   150    25   NaN
4446     25    67    33   165   148   148   148   148   148   148   148   148    83    92    13   NaN
4447     25    38    64   156   132   132   132   132   132   132   132   132    67    25   176   NaN
4448     25    26   122   156   124   124   124   124   124   124   124   124    67    26   176   NaN
4449     25    28   156   108   108   108   108   108   108   108   108   108    41    13   176   NaN
4450     NaN    13    13    13    13    13    13    13    13    13    13    13    13   176   176   NaN
4451     NaN   NaN   176   176   176   176   176   176   176   176   176   176   176   176   NaN   NaN]/255;
4452 
4453 <span class="comment">% Save data</span>
4454 idx = idx+1;
4455 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4456     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
4457     NaN    0.6902    0.6902    0.6902    0.6902    0.6902    0.6274    0.6274    0.5647    0.5647    0.5647    0.5019    0.5019    0.4392    0.2510       NaN
4458     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.3137    0.3765    0.2510    0.4670
4459     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.2510    0.1882    0.2510    0.4670
4460     NaN    0.6274    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.1882    0.5019    0.2510    0.4670
4461     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.1882    0.4392    0.2510    0.4670
4462     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.1255    0.3765    0.2510    0.4670
4463     NaN    0.5647    0.7529    0.3765    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.7529    0.0627    0.3765    0.2510    0.4670
4464     NaN    0.5647    0.7529    0.6902    0.3765    0.3137    0.3137    0.2510    0.1882    0.1882    0.1255    0.0627    0.3765    0.3137    0.2510    0.4670
4465     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5019    0.5019    0.5019    0.4392    0.4392    0.3765    0.3137    0.3137    0.2510    0.4670
4466     NaN    0.5019    0.6902    0.6274    0.5647    0.3137    0.3137    0.3137    0.3137    0.3137    0.3765    0.3137    0.3137    0.2510    0.2510    0.4670
4467     NaN    0.4392    0.6274    0.5647    0.5019    0.3137       NaN    0.1882    0.8157    0.8157    0.3765    0.2510    0.2510    0.2510    0.2510    0.4670
4468     NaN    0.4392    0.6274    0.5019    0.5019    0.3137    0.1882    0.4392    0.8784    0.8784    0.4392    0.1882    0.2510    0.1882    0.2510    0.4670
4469     NaN    0.4392    0.5647    0.5019    0.1255    0.1255    0.6902    0.6902    0.7529    0.7529    0.3137    0.1882    0.1882    0.1882    0.2510    0.4670
4470     NaN    0.7333    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.4670
4471     NaN       NaN    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670];
4472 
4473 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4474     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
4475     NaN    0.7216    0.7216    0.6902    0.6902    0.6588    0.6274    0.5961    0.5647    0.5647    0.5333    0.5019    0.4706    0.4706    0.2196       NaN
4476     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.3451    0.3451    0.2196    0.5378
4477     NaN    0.6902    0.7529    0.5333    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.3137    0.1882    0.2196    0.5378
4478     NaN    0.6588    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.3137    0.4706    0.2196    0.5378
4479     NaN    0.6274    0.7529    0.4706    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.2824    0.4392    0.2196    0.5378
4480     NaN    0.5961    0.7529    0.4392    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.2510    0.4078    0.2196    0.5378
4481     NaN    0.5647    0.7529    0.4078    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.7843    0.2196    0.3765    0.2196    0.5378
4482     NaN    0.5333    0.7216    0.7216    0.3765    0.3765    0.3451    0.3137    0.3137    0.2824    0.2510    0.2196    0.3765    0.3451    0.2196    0.5378
4483     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5333    0.5019    0.4706    0.4392    0.4078    0.3765    0.3451    0.3137    0.2196    0.5378
4484     NaN    0.4706    0.6588    0.6274    0.5647    0.3451    0.3451    0.3451    0.3451    0.3765    0.4078    0.3451    0.3137    0.2824    0.2196    0.5378
4485     NaN    0.4706    0.6274    0.5647    0.5333    0.3451       NaN    0.2510    0.8470    0.8784    0.4706    0.2824    0.2824    0.2510    0.2196    0.5378
4486     NaN    0.4392    0.5961    0.5333    0.5019    0.3451    0.2510    0.4706    0.8784    0.9098    0.5019    0.2510    0.2510    0.2510    0.2196    0.5378
4487     NaN    0.4078    0.5647    0.5019    0.2824    0.1882    0.7216    0.7216    0.7529    0.7843    0.3137    0.2510    0.2510    0.2196    0.2196    0.5378
4488     NaN    0.7176    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.5378
4489     NaN       NaN    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378];
4490 
4491 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4492     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
4493     NaN    0.9412    0.9412    0.9412    0.9412    0.9412    0.9412    0.8784    0.8784    0.8784    0.8784    0.8784    0.8157    0.8157    0.4392       NaN
4494     NaN    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.7529    0.6902    0.4392    0.5997
4495     NaN    0.9412    1.0000    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.7529    0.3765    0.4392    0.5997
4496     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.6902    0.8784    0.4392    0.5997
4497     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.6902    0.8157    0.4392    0.5997
4498     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.6274    0.8157    0.4392    0.5997
4499     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.8784    0.6274    0.7529    0.4392    0.5997
4500     NaN    0.8784    1.0000    1.0000    0.8157    0.7529    0.7529    0.7529    0.6902    0.6902    0.6274    0.6274    0.7529    0.7529    0.4392    0.5997
4501     NaN    0.8784    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8784    0.8157    0.8157    0.7529    0.7529    0.6902    0.4392    0.5997
4502     NaN    0.8157    1.0000    1.0000    0.9412    0.4392    0.4392    0.4392    0.4392    0.4392    0.5019    0.7529    0.6902    0.6902    0.4392    0.5997
4503     NaN    0.8157    1.0000    0.9412    0.9412    0.4392       NaN    0.2510    0.9412    0.9412    0.5019    0.6902    0.6902    0.6274    0.4392    0.5997
4504     NaN    0.8157    1.0000    0.9412    0.8784    0.4392    0.2510    0.5647    0.9412    0.9412    0.5647    0.6274    0.6274    0.6274    0.4392    0.5997
4505     NaN    0.8157    0.9412    0.8784    0.6902    0.2510    0.7529    0.7529    0.8157    0.8157    0.3137    0.6274    0.6274    0.6274    0.4392    0.5997
4506     NaN    0.8275    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.5997
4507     NaN       NaN    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997];
4508 
4509 <span class="comment">% Plotting parameters</span>
4510 idx = idx+1;
4511 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4512     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
4513     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4514     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4515     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
4516     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
4517     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
4518     0   101   239   255   224   109   255   255   255   247    79   254   254   123    36   165
4519     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
4520     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
4521     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
4522     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
4523     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
4524     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
4525     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4526     0     0     0     1     0     0     0     0     0     0     0     0     0     0     0   165
4527     255   165   165   165   172   165   165   165   165   165   165   165   165   165   165   165]/255;
4528 
4529 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4530     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
4531     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0     0
4532     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4533     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
4534     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
4535     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
4536     0   101   239   255   224   109   255   255   255   247    79   254   254   123     0   165
4537     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
4538     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
4539     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
4540     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
4541     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
4542     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
4543     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4544     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   165
4545     0   165   165   165   153   165   165   165   165   165   165   165   165   165   165   165]/255;
4546 
4547 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4548     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
4549     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4550     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4551     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4552     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4553     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4554     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4555     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4556     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4557     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4558     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4559     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4560     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4561     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4562     0    24    39     0     0     0     0     0     0     0     0     0     0     0     0   145
4563     255   145   145   145   134   145   145   145   145   145   145   145   145   145   145   145]/255;
4564 
4565 <span class="comment">% Processing parameters</span>
4566 idx = idx+1;
4567 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4568     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
4569     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
4570     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4571     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4572     255     0   255   255   107   255   255   107   255   255   107   255   107   255     0   255
4573     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4574     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4575     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4576     255     0   255   255   107   255   107   255   107   255   255   107   255   255     0   255
4577     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4578     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4579     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4580     255     0   255   107   255   107   255   107   255   255   107   255   107   255     0   255
4581     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4582     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4583     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
4584 
4585 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4586     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
4587     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
4588     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4589     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4590     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
4591     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4592     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4593     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4594     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
4595     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4596     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4597     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4598     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
4599     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4600     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4601     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
4602 
4603 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4604     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
4605     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
4606     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4607     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4608     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
4609     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4610     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4611     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4612     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
4613     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4614     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4615     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4616     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
4617     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4618     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4619     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
4620 
4621 <span class="comment">% Export bathymetry dialog</span>
4622 idx = idx+1;
4623 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4624     [226    226    226    226    226    226    226    197    220    226    226    226    226    226    226    226
4625     226    226    226    226    226    227    241    144    158    241    228    228    229    228    229    226
4626     226    243    243    243    237    237    246    164    119    242    232    225    226    218    243    206
4627     179    152    153    166    148    148    177    179    63    185    141    146    154    151    179    189
4628     167    4    134    175    151    164    161    198    122    255    212    233    215    199    140    185
4629     134    50    209    241    255    255    133    118    15    20    28    94    4    0    0    89
4630     136    0    0    0    0    0    0    0    0    0    0    0    0    21    56    140
4631     208    255    226    233    255    242    215    232    251    237    226    233    207    222    156    139
4632     172    159    152    153    166    145    178    147    169    164    161    163    154    153    128    135
4633     160    164    148    139    171    150    165    154    165    185    166    173    190    190    148    162
4634     214    233    211    203    217    212    217    238    202    236    213    222    230    224    184    184
4635     219    206    174    190    219    204    201    218    183    224    219    222    217    202    176    182
4636     210    182    183    214    225    220    203    229    175    217    220    220    222    212    184    185
4637     197    175    207    224    223    220    205    231    170    221    220    220    222    217    191    187
4638     186    193    223    224    220    201    203    228    171    224    218    220    222    215    190    187
4639     189    211    220    216    204    201    214    213    187    213    216    220    220    212    193    189
4640     ]/255;
4641 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4642     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
4643     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
4644     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
4645     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
4646     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
4647     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
4648     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
4649     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
4650     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
4651     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
4652     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
4653     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
4654     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
4655     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
4656     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
4657     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
4658     ]/255;
4659 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4660     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
4661     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
4662     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
4663     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
4664     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
4665     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
4666     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
4667     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
4668     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
4669     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
4670     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
4671     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
4672     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
4673     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
4674     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
4675     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
4676     ]/255;
4677 
4678 <span class="comment">% Export Figures Dialog</span>
4679 idx = idx + 1;
4680 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4681     [NaN    NaN    10    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
4682     NaN    NaN    67    255    255    255    255    255    255    255    201    141    NaN    NaN    NaN    NaN
4683     NaN    NaN    43    255    241    240    241    246    252    255    186    220    151    NaN    NaN    NaN
4684     NaN    NaN    42    255    238    237    237    236    238    254    210    178    214    38    NaN    NaN
4685     NaN    NaN    43    255    241    241    241    241    240    244    252    255    255    79    NaN    NaN
4686     NaN    NaN    47    255    232    232    225    224    224    223    220    238    255    69    NaN    NaN
4687     NaN    NaN    55    233    114    225    230    223    221    221    215    237    255    67    NaN    NaN
4688     4    NaN    37    181    168    126    193    214    205    200    203    242    255    67    NaN    NaN
4689     41    164    134    153    144    139    131    209    238    223    242    240    255    67    NaN    NaN
4690     41    118    91    91    122    125    120    106    170    241    245    241    255    67    NaN    NaN
4691     41    113    91    89    97    108    99    89    117    205    190    230    255    67    NaN    NaN
4692     41    124    94    88    78    74    81    179    255    252    244    241    255    67    NaN    NaN
4693     13    34    76    187    88    92    222    255    255    250    250    250    255    73    NaN    NaN
4694     NaN    NaN    69    236    121    227    255    243    238    238    238    238    255    82    NaN    NaN
4695     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
4696 
4697 
4698 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4699     [NaN    NaN    10    24    24    24    24    24    24    24    22    4    NaN    NaN    NaN    NaN
4700     NaN    NaN    69    255    255    255    255    255    255    255    204    144    NaN    NaN    NaN    NaN
4701     NaN    NaN    45    255    241    240    241    246    252    255    189    222    155    NaN    NaN    NaN
4702     NaN    NaN    43    255    238    237    237    236    238    254    210    179    215    39    NaN    NaN
4703     NaN    NaN    44    255    241    241    241    241    240    244    252    255    255    80    NaN    NaN
4704     NaN    NaN    49    255    231    230    225    224    224    223    220    238    255    70    NaN    NaN
4705     NaN    NaN    56    227    136    214    227    223    221    221    215    237    255    68    NaN    NaN
4706     4    NaN    19    157    243    154    181    210    204    200    203    242    255    67    NaN    NaN
4707     51    255    231    225    219    217    172    197    232    222    242    240    255    67    NaN    NaN
4708     52    227    184    183    195    201    204    172    169    239    245    241    255    67    NaN    NaN
4709     51    218    177    177    180    187    187    177    130    202    190    230    255    67    NaN    NaN
4710     51    237    195    183    172    170    152    175    255    251    244    241    255    67    NaN    NaN
4711     15    38    72    173    183    149    211    255    255    250    250    250    255    73    NaN    NaN
4712     NaN    NaN    65    226    174    214    252    242    238    238    238    238    255    84    NaN    NaN
4713     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
4714 
4715 
4716 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4717     [NaN    NaN    9    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
4718     NaN    NaN    66    255    255    255    255    255    255    255    196    139    NaN    NaN    NaN    NaN
4719     NaN    NaN    42    255    239    238    238    244    252    255    186    216    148    NaN    NaN    NaN
4720     NaN    NaN    41    255    236    235    235    234    237    251    210    176    212    36    NaN    NaN
4721     NaN    NaN    42    255    239    239    239    239    238    241    252    255    255    78    NaN    NaN
4722     NaN    NaN    46    255    233    232    224    223    223    223    219    235    255    67    NaN    NaN
4723     NaN    NaN    53    240    101    232    230    221    219    218    213    235    255    65    NaN    NaN
4724     5    NaN    60    212    94    107    205    215    203    198    201    240    255    66    NaN    NaN
4725     34    56    40    80    70    62    94    222    241    221    240    238    255    66    NaN    NaN
4726     35    10    2    0    51    55    36    46    176    240    243    239    255    66    NaN    NaN
4727     35    11    9    7    16    34    12    6    110    204    188    228    255    66    NaN    NaN
4728     35    14    0    0    0    0    14    187    255    251    242    239    255    66    NaN    NaN
4729     12    37    84    206    0    41    234    255    255    248    248    248    255    72    NaN    NaN
4730     NaN    NaN    69    249    79    239    255    240    236    236    236    236    255    80    NaN    NaN
4731     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
4732 
4733 <span class="comment">% Export Excel File</span>
4734 idx = idx + 1;
4735 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4736     [NaN    NaN    NaN    NaN    NaN    NaN  106  252  255  255  255  255  255  255  255  255
4737    38  136  109  101   96   77   95  134  106   99   93   87   90   66  255  255
4738    52  197  232  217  210  202  191  178  170  164  160  159  155   15  255  255
4739    51  181  255  255  255  255  255  255  255  255  255  255  253    9  255  255
4740    49  174  245  153  156  175  255  255  181  153  149  205  245    0  255  255
4741    47  168  199  122  149  100  155  183   99   99   15  117  245    0  255  241
4742    45  158  255  146  146  141   87   68  120   34   86  255  238    0  252  232
4743    42  144  255  255  158  158  143   74   68  117  255  255  230    0  255  255
4744    40  134  255  255  169   15  150  111   68   81  105  167  236    0  230  217
4745    37  131  255  158   99  106   10  143  117   50   51  165  252    0  255  254
4746    35  122  208    0   22   32    8   17  110   20    0   13  212    0  255  245
4747    33  115  255  255  255  255  255  250  146  113  119  106  217    0  236  217
4748    31  109  255  254  252  251  250  255  255  255  255  255  241    0  255  251
4749    29  116  190  168  164  157  145  133  126  121  117  118  112    0  215  205
4750    20   63   47   38   36   20   38   83   64   51   52   55   64   20  255  241
4751     NaN    NaN    NaN    NaN    NaN    NaN   96  249  252  228  237  251  249  203  241  246]/255;
4752 
4753 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4754     [NaN    NaN    NaN    NaN    NaN    NaN  114  252  255  255  255  255  255  255  255  255
4755    49  180  152  145  140  118  140  173  150  139  132  126  126  106  255  255
4756    67  249  252  242  237  231  221  207  201  196  194  193  193   75  255  255
4757    66  232  255  255  255  255  255  255  255  255  255  255  255   68  255  255
4758    64  226  251  197  191  200  255  255  194  170  168  214  253   61  255  255
4759    62  220  224  183  207  173  189  202  167  175  116  172  253   58  255  246
4760    60  211  255  190  196  203  166  131  187  134  148  255  249   54  254  240
4761    57  199  255  255  198  203  202  158  132  168  255  255  245   47  255  255
4762    54  190  255  255  200  110  199  185  155  147  160  203  251   44  240  230
4763    52  187  255  204  187  194  121  204  189  139   99  179  255   39  255  254
4764    49  180  230   42   49   53   36   64  182   98   65   70  228   36  255  248
4765    47  171  255  255  255  255  255  255  186  115  124  114  235   34  243  229
4766    45  166  255  255  254  254  255  255  255  255  255  255  255   33  255  252
4767    43  176  222  206  204  200  190  180  174  171  169  169  169   32  229  220
4768    30  101   81   74   69   54   72  116   96   84   84   84   94   55  255  245
4769     NaN    NaN    NaN    NaN    NaN    NaN  105  251  253  237  242  252  251  218  246  249]/255;
4770 
4771 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4772     [ NaN    NaN    NaN    NaN    NaN    NaN  125  253  255  255  255  255  255  255  255  255
4773    34  118   92   84   79   56   83  111   88   79   73   69   74   45  255  255
4774    46  180  228  207  203  195  182  169  159  155  149  149  145    0  255  255
4775    45  163  255  255  255  255  255  255  255  255  255  255  254    0  255  255
4776    42  156  248  152  155  176  255  255  181  154  147  206  245    0  255  255
4777    40  150  202  117  136   87  154  181   90   84    8  120  243    0  255  252
4778    38  138  255  145  137  131   81   65  106   27   86  255  238    0  255  250
4779    35  122  255  255  159  152  137   75   62  121  255  255  229    0  255  255
4780    33  113  255  255  171   13  145  111   67   76   84  159  234    0  255  247
4781    30  109  255  160   89   97   10  136  111   36   33  159  251    0  255  255
4782    28   99  211    0   12   23    2   11  101    0    0   13  209    0  255  253
4783    26   92  255  255  255  255  255  250  146  111  117  104  213    0  255  245
4784    23   89  255  255  255  255  255  255  255  255  255  255  241    0  255  254
4785    22   93  180  156  151  141  129  114  105   98   93   93   83    0  255  239
4786    15   43   26   17   15    0   25   63   45   39   38   39   44    9  255  252
4787     NaN    NaN    NaN    NaN    NaN    NaN  117  253  255  249  251  255  254  239  252  254]/255;
4788 
4789 <span class="comment">% Zoom In</span>
4790 idx = idx + 1;
4791 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4792     [NaN,NaN,0.745082780193790,0.603906309605554,0.603906309605554,0.603906309605554,0.603906309605554,0.568627450980392,0.764705882352941,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,0.698023956664378,0.568627450980392,0.780392156862745,0.823514152742809,0.854886701762417,0.925474937056535,0.827450980392157,0.596063172350652,0.749019607843137,NaN,NaN,NaN,NaN,NaN,NaN;0.752925917448692,0.501945525291829,0.737239642938888,0.643121995880064,0.584313725490196,0.690180819409476,0.760769054703594,1,0.894102388036927,0.596063172350652,NaN,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.639215686274510,0.650965133134966,0.600000000000000,0.596063172350652,0.196078431372549,0.596063172350652,0.764705882352941,0.941161211566339,0.721553368429084,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.686274509803922,0.678431372549020,0.682337682154574,0.662745098039216,0.196078431372549,0.650965133134966,0.639215686274510,0.788235294117647,0.811764705882353,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.764705882352941,0.815671015487907,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.682337682154574,0.815671015487907,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.866666666666667,0.952941176470588,0.803921568627451,0.803921568627451,0.196078431372549,0.619592584115358,0.607843137254902,0.737239642938888,0.741176470588235,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.721553368429084,1,1,0.968627450980392,0.196078431372549,0.709803921568628,0.670588235294118,0.807827878233005,0.564690623331045,0.772549019607843,NaN,NaN,NaN,NaN,NaN;NaN,0.592156862745098,0.839200427252613,1,1,0.901945525291829,0.788235294117647,0.792141603723201,0.549004348821241,0.654901960784314,NaN,1,NaN,NaN,NaN,NaN;NaN,NaN,0.639215686274510,0.698023956664378,0.827450980392157,0.784298466468299,0.650965133134966,0.498054474708171,0.623529411764706,0.627435721370260,0.890196078431373,0.937254901960784,0.996063172350652,NaN,NaN,NaN;NaN,NaN,NaN,0.772549019607843,0.698023956664378,0.678431372549020,0.690180819409476,0.784298466468299,0.666651407644770,0.615686274509804,0.745082780193790,1,0.933318074311437,0.996063172350652,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.517631799801633,0.745082780193790,1,0.929411764705882,1,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.513725490196078,0.741176470588235,1,0.925474937056535,0.749019607843137;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.513725490196078,0.741176470588235,0.988220035095750,0.745082780193790;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.533318074311437,0.549004348821241,0.654901960784314;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.694117647058824,0.635278858625162,NaN;];
4793 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4794     [1,1,0.745082780193790,0.670588235294118,0.670588235294118,0.670588235294118,0.670588235294118,0.576470588235294,0.760769054703594,1,1,1,1,1,1,1;1,0.701960784313725,0.650965133134966,0.917631799801633,0.968627450980392,0.992156862745098,1,0.898039215686275,0.603906309605554,0.741176470588235,1,1,1,1,1,1;0.756862745098039,0.588220035095750,0.929411764705882,0.858823529411765,0.807827878233005,0.854886701762417,0.894102388036927,1,0.976470588235294,0.596063172350652,1,1,1,1,1,1;0.721553368429084,0.823514152742809,0.878416113527123,0.835294117647059,0.831357289997711,0.274509803921569,0.815671015487907,0.894102388036927,1,0.807827878233005,0.670588235294118,1,1,1,1,1;0.670588235294118,0.901945525291829,0.890196078431373,0.890196078431373,0.878416113527123,0.274509803921569,0.854886701762417,0.831357289997711,0.937254901960784,0.933318074311437,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.937254901960784,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.878416113527123,0.937254901960784,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.988220035095750,0.862729839017319,0.862729839017319,0.274509803921569,0.815671015487907,0.803921568627451,0.921568627450980,0.854886701762417,0.670588235294118,1,1,1,1,1;0.721553368429084,0.737239642938888,1,1,0.988220035095750,0.274509803921569,0.898039215686275,0.882352941176471,0.980376897840848,0.627435721370260,0.768612191958496,1,1,1,1,1;1,0.603906309605554,0.847043564507515,1,1,0.984313725490196,0.960784313725490,0.976470588235294,0.662745098039216,0.658808270389868,1,0.615686274509804,1,1,1,1;1,1,0.650965133134966,0.701960784313725,0.854886701762417,0.874509803921569,0.780392156862745,0.564690623331045,0.615686274509804,0.627435721370260,0.733333333333333,0.713710231174182,0.600000000000000,1,1,1;1,1,1,0.772549019607843,0.705867093919280,0.686274509803922,0.694117647058824,0.784298466468299,0.674494544899672,0.572533760585946,0.498054474708171,0.741176470588235,0.709803921568628,0.600000000000000,1,1;1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.509788662546731,0.741176470588235,0.709803921568628,0.600000000000000,1;1,1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.505882352941176,0.741176470588235,0.721553368429084,0.501945525291829;1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.443152513923857,0.505882352941176,0.733333333333333,0.670588235294118;1,1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.454901960784314,0.435309376668956,0.658808270389868;1,1,1,1,1,1,1,1,1,1,1,1,1,0.694117647058824,0.647058823529412,1;];
4795 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4796     [1,1,0.796078431372549,0.854886701762417,0.854886701762417,0.854886701762417,0.854886701762417,0.713710231174182,0.792141603723201,1,1,1,1,1,1,1;1,0.768612191958496,0.827450980392157,0.956847486076143,0.976470588235294,0.992156862745098,1,0.945098039215686,0.803921568627451,0.796078431372549,1,1,1,1,1,1;0.776455329213397,0.749019607843137,0.952941176470588,0.901945525291829,0.882352941176471,0.909788662546731,0.937254901960784,1,0.988220035095750,0.819607843137255,1,1,1,1,1,1;0.858823529411765,0.882352941176471,0.909788662546731,0.882352941176471,0.886259250782025,0.470588235294118,0.882352941176471,0.933318074311437,1,0.921568627450980,0.854886701762417,1,1,1,1,1;0.854886701762417,0.925474937056535,0.909788662546731,0.913725490196078,0.905882352941177,0.470588235294118,0.901945525291829,0.894102388036927,0.960784313725490,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.945098039215686,0.949004348821241,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.921568627450980,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.952941176470588,0.992156862745098,0.917631799801633,0.917631799801633,0.470588235294118,0.945098039215686,0.949004348821241,0.941161211566339,0.937254901960784,0.854886701762417,1,1,1,1,1;0.858823529411765,0.827450980392157,1,1,0.992156862745098,0.470588235294118,0.921568627450980,0.909788662546731,0.980376897840848,0.823514152742809,0.792141603723201,1,1,1,1,1;1,0.717647058823529,0.925474937056535,1,1,0.980376897840848,0.960784313725490,0.976470588235294,0.815671015487907,0.776455329213397,1,0.180392156862745,1,1,1,1;1,1,0.776455329213397,0.870572976272221,0.941161211566339,0.937254901960784,0.866666666666667,0.717647058823529,0.682337682154574,0.607843137254902,0.490211337453269,0.435309376668956,0.203921568627451,1,1,1;1,1,1,0.799984740978103,0.796078431372549,0.792141603723201,0.764705882352941,0.792141603723201,0.780392156862745,0.545098039215686,0.125490196078431,0.325505455100328,0.450995651178759,0.203921568627451,1,1;1,1,1,1,1,1,1,1,1,0.784298466468299,0.384313725490196,0.149019607843137,0.325505455100328,0.458838788433661,0.180392156862745,1;1,1,1,1,1,1,1,1,1,1,0.796078431372549,0.396093690394446,0.149019607843137,0.329411764705882,0.458838788433661,0.254917219806210;1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.407843137254902,0.149019607843137,0.298039215686275,0.580376897840848;1,1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.403936827649348,0.258823529411765,0.674494544899672;1,1,1,1,1,1,1,1,1,1,1,1,1,0.749019607843137,0.654901960784314,1;];
4797 
4798 <span class="comment">% Zoom Out</span>
4799 idx = idx + 1;
4800 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4801     [NaN,NaN,0.745082780193790,0.603906309605554,0.603906309605554,0.603906309605554,0.603906309605554,0.568627450980392,0.764705882352941,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,0.698023956664378,0.568627450980392,0.780392156862745,0.823514152742809,0.854886701762417,0.925474937056535,0.827450980392157,0.596063172350652,0.749019607843137,NaN,NaN,NaN,NaN,NaN,NaN;0.752925917448692,0.501945525291829,0.737239642938888,0.643121995880064,0.584313725490196,0.690180819409476,0.760769054703594,1,0.894102388036927,0.596063172350652,NaN,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.639215686274510,0.650965133134966,0.600000000000000,0.596063172350652,0.643121995880064,0.596063172350652,0.764705882352941,0.941161211566339,0.721553368429084,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.686274509803922,0.678431372549020,0.682337682154574,0.662745098039216,0.650965133134966,0.650965133134966,0.639215686274510,0.788235294117647,0.811764705882353,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.764705882352941,0.815671015487907,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.682337682154574,0.815671015487907,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.866666666666667,0.952941176470588,0.760769054703594,0.760769054703594,0.760769054703594,0.760769054703594,0.760769054703594,0.737239642938888,0.741176470588235,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.721553368429084,1,1,0.968627450980392,0.870572976272221,0.709803921568628,0.670588235294118,0.807827878233005,0.564690623331045,0.772549019607843,NaN,NaN,NaN,NaN,NaN;NaN,0.592156862745098,0.839200427252613,1,1,0.901945525291829,0.788235294117647,0.792141603723201,0.549004348821241,0.654901960784314,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,0.639215686274510,0.698023956664378,0.827450980392157,0.784298466468299,0.650965133134966,0.498054474708171,0.623529411764706,0.627435721370260,0.890196078431373,0.937254901960784,0.996063172350652,NaN,NaN,NaN;NaN,NaN,NaN,0.772549019607843,0.698023956664378,0.678431372549020,0.690180819409476,0.784298466468299,NaN,0.615686274509804,0.745082780193790,1,0.933318074311437,0.996063172350652,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.517631799801633,0.745082780193790,1,0.929411764705882,1,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.513725490196078,0.741176470588235,1,0.925474937056535,0.749019607843137;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.513725490196078,0.741176470588235,0.988220035095750,0.745082780193790;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.533318074311437,0.549004348821241,0.654901960784314;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.694117647058824,0.635278858625162,NaN;];
4802 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4803     [1,1,0.745082780193790,0.670588235294118,0.670588235294118,0.670588235294118,0.670588235294118,0.576470588235294,0.760769054703594,1,1,1,1,1,1,1;1,0.701960784313725,0.650965133134966,0.917631799801633,0.968627450980392,0.992156862745098,1,0.898039215686275,0.603906309605554,0.741176470588235,1,1,1,1,1,1;0.756862745098039,0.588220035095750,0.929411764705882,0.858823529411765,0.807827878233005,0.854886701762417,0.894102388036927,1,0.976470588235294,0.596063172350652,1,1,1,1,1,1;0.721553368429084,0.823514152742809,0.878416113527123,0.835294117647059,0.831357289997711,0.843137254901961,0.815671015487907,0.894102388036927,1,0.807827878233005,0.670588235294118,1,1,1,1,1;0.670588235294118,0.901945525291829,0.890196078431373,0.890196078431373,0.878416113527123,0.870572976272221,0.854886701762417,0.831357289997711,0.937254901960784,0.933318074311437,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.937254901960784,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.878416113527123,0.937254901960784,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.988220035095750,0.819607843137255,0.819607843137255,0.819607843137255,0.819607843137255,0.819607843137255,0.921568627450980,0.854886701762417,0.670588235294118,1,1,1,1,1;0.721553368429084,0.737239642938888,1,1,0.988220035095750,0.952941176470588,0.898039215686275,0.882352941176471,0.980376897840848,0.627435721370260,0.768612191958496,1,1,1,1,1;1,0.603906309605554,0.847043564507515,1,1,0.984313725490196,0.960784313725490,0.976470588235294,0.662745098039216,0.658808270389868,1,1,1,1,1,1;1,1,0.650965133134966,0.701960784313725,0.854886701762417,0.874509803921569,0.780392156862745,0.564690623331045,0.615686274509804,0.627435721370260,0.733333333333333,0.713710231174182,0.600000000000000,1,1,1;1,1,1,0.772549019607843,0.705867093919280,0.686274509803922,0.694117647058824,0.784298466468299,1,0.572533760585946,0.498054474708171,0.741176470588235,0.709803921568628,0.600000000000000,1,1;1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.509788662546731,0.741176470588235,0.709803921568628,0.600000000000000,1;1,1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.505882352941176,0.741176470588235,0.721553368429084,0.501945525291829;1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.443152513923857,0.505882352941176,0.733333333333333,0.670588235294118;1,1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.454901960784314,0.435309376668956,0.658808270389868;1,1,1,1,1,1,1,1,1,1,1,1,1,0.694117647058824,0.647058823529412,1;];
4804 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4805     [1,1,0.796078431372549,0.854886701762417,0.854886701762417,0.854886701762417,0.854886701762417,0.713710231174182,0.792141603723201,1,1,1,1,1,1,1;1,0.768612191958496,0.827450980392157,0.956847486076143,0.976470588235294,0.992156862745098,1,0.945098039215686,0.803921568627451,0.796078431372549,1,1,1,1,1,1;0.776455329213397,0.749019607843137,0.952941176470588,0.901945525291829,0.882352941176471,0.909788662546731,0.937254901960784,1,0.988220035095750,0.819607843137255,1,1,1,1,1,1;0.858823529411765,0.882352941176471,0.909788662546731,0.882352941176471,0.886259250782025,0.894102388036927,0.882352941176471,0.933318074311437,1,0.921568627450980,0.854886701762417,1,1,1,1,1;0.854886701762417,0.925474937056535,0.909788662546731,0.913725490196078,0.905882352941177,0.901945525291829,0.901945525291829,0.894102388036927,0.960784313725490,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.945098039215686,0.949004348821241,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.921568627450980,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.952941176470588,0.992156862745098,0.890196078431373,0.890196078431373,0.890196078431373,0.890196078431373,0.890196078431373,0.941161211566339,0.937254901960784,0.854886701762417,1,1,1,1,1;0.858823529411765,0.827450980392157,1,1,0.992156862745098,0.964690623331045,0.921568627450980,0.909788662546731,0.980376897840848,0.823514152742809,0.792141603723201,1,1,1,1,1;1,0.717647058823529,0.925474937056535,1,1,0.980376897840848,0.960784313725490,0.976470588235294,0.815671015487907,0.776455329213397,1,1,1,1,1,1;1,1,0.776455329213397,0.870572976272221,0.941161211566339,0.937254901960784,0.866666666666667,0.717647058823529,0.682337682154574,0.607843137254902,0.490211337453269,0.435309376668956,0.203921568627451,1,1,1;1,1,1,0.799984740978103,0.796078431372549,0.792141603723201,0.764705882352941,0.792141603723201,1,0.545098039215686,0.125490196078431,0.325505455100328,0.450995651178759,0.203921568627451,1,1;1,1,1,1,1,1,1,1,1,0.784298466468299,0.384313725490196,0.149019607843137,0.325505455100328,0.458838788433661,0.180392156862745,1;1,1,1,1,1,1,1,1,1,1,0.796078431372549,0.396093690394446,0.149019607843137,0.329411764705882,0.458838788433661,0.254917219806210;1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.407843137254902,0.149019607843137,0.298039215686275,0.580376897840848;1,1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.403936827649348,0.258823529411765,0.674494544899672;1,1,1,1,1,1,1,1,1,1,1,1,1,0.749019607843137,0.654901960784314,1;];
4806 
4807 <span class="comment">% Pan</span>
4808 idx = idx + 1;
4809 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4810     [NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.290196078431373,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,NaN,0.290196078431373,0.290196078431373,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,0.290196078431373,NaN,NaN,NaN,NaN;NaN,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,NaN,NaN,NaN;NaN,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,NaN,0.290196078431373,NaN;NaN,NaN,NaN,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,0.290196078431373;NaN,NaN,NaN,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373;NaN,0.290196078431373,0.290196078431373,0.290196078431373,0.290196078431373,1,1,1,1,1,1,1,0.290196078431373,1,0.991546501869230,0.290196078431373;0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,1,1,1,1,1,0.996032654306859,0.986602578774701,0.975188830395972,0.290196078431373;0.290196078431373,1,1,1,0.290196078431373,1,1,1,1,1,1,0.991546501869230,0.981109330891890,0.968841077286946,0.290196078431373,NaN;NaN,0.290196078431373,1,1,1,1,1,1,1,0.996032654306859,0.986602578774701,0.975188830395972,0.962127107652400,0.947631036850538,0.290196078431373,NaN;NaN,NaN,0.290196078431373,1,1,1,1,1,0.991546501869230,0.981109330891890,0.968871595330739,0.955046921492332,0.939909971770810,0.923643854428931,0.290196078431373,NaN;NaN,NaN,0.290196078431373,1,1,1,0.996063172350652,0.986572060730907,0.975188830395972,0.962127107652400,0.947631036850538,0.931914244296941,0.915190356298161,0.290196078431373,NaN,NaN;NaN,NaN,NaN,0.290196078431373,1,0.991546501869230,0.981109330891890,0.968841077286946,0.955016403448539,0.939909971770810,0.923643854428931,0.906553749904631,0.888761730373083,0.290196078431373,NaN,NaN;NaN,NaN,NaN,NaN,0.290196078431373,0.975188830395972,0.962127107652400,0.947631036850538,0.931914244296941,0.915220874341955,0.897734035248341,0.879728389410239,0.290196078431373,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.939909971770810,0.923643854428931,0.906553749904631,0.888761730373083,0.870634012359808,0.852231631952392,0.290196078431373,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.915190356298161,0.897734035248341,0.879758907454032,0.861478599221790,0.843076218814374,0.824887464713512,0.290196078431373,NaN,NaN,NaN;];
4811 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4812     [0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894071869993134,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894071869993134,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.882536049439231,0.407843137254902;0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860105287251087,0.407843137254902;0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.882566567483024,0.868223086900130,0.851468680857557,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860105287251087,0.842221713588159,0.822354467078660,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.882566567483024,0.868223086900130,0.851468680857557,0.832516975661860,0.811795223926146,0.789547570000763,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860135805294881,0.842221713588159,0.822354467078660,0.800839246204318,0.777950713359274,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.882536049439231,0.868223086900130,0.851438162813764,0.832516975661860,0.811764705882353,0.789547570000763,0.766079194323644,0.741756313420310,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.860135805294881,0.842252231631952,0.822384985122454,0.800808728160525,0.777920195315480,0.754024567025254,0.729396505683986,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.811764705882353,0.789547570000763,0.766079194323644,0.741786831464103,0.716914625772488,0.691676203555352,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.777920195315480,0.754024567025254,0.729396505683986,0.704371709773404,0.679133287556268,0.654261081864653,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;];
4813 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4814     [0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799954222934310,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799954222934310,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799954222934310,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.785091935606928,0.709803921568628;0.709803921568628,0.799954222934310,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776272220950637,0.756130312046998,0.709803921568628;0.709803921568628,0.799984740978103,0.799954222934310,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.785091935606928,0.766628519111925,0.744960708018616,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799954222934310,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776272220950637,0.756160830090791,0.733089188982986,0.707423514152743,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.785091935606928,0.766598001068132,0.744960708018616,0.720546272983902,0.693781948577096,0.665094987411307,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776241702906844,0.756160830090791,0.733089188982986,0.707423514152743,0.679682612344549,0.650141145952545,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.785061417563134,0.766598001068132,0.744960708018616,0.720546272983902,0.693812466620890,0.665094987411307,0.634882124055848,0.603479056992447,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.756160830090791,0.733089188982986,0.707423514152743,0.679652094300755,0.650141145952545,0.619287403677424,0.587518120088502,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.693781948577096,0.665094987411307,0.634882124055848,0.603509575036240,0.571404592965591,0.538872358281834,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.650141145952545,0.619256885633631,0.587518120088502,0.555230029755093,0.522697795071336,0.490638590066377,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;];
4815 <span class="comment">% [EOF] getIcons</span>
4816 
4817 <a name="_sub108" href="#_subfunctions" class="code">function guiparams = createGUIparams</a>
4818 <span class="comment">% Creates the guiparams structure with specified defaults.</span>
4819 
4820 <span class="comment">% Check for any stored prefs</span>
4821 <span class="comment">% --------------------------</span>
4822 <span class="comment">% Currently, units and the graphics renderer are stored as persistent prefs</span>
4823 guiprefs = getpref(<span class="string">'VMT'</span>);
4824 
4825 <span class="comment">% Organized by GUI panels</span>
4826 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
4827 <span class="comment">% SHIPTRACKS PLOT %</span>
4828 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
4829 guiparams.horizontal_grid_node_spacing       = 1.0;
4830 guiparams.vertical_grid_node_spacing         = 0.4;
4831 
4832 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
4833 <span class="comment">% CROSS SECTION PLOT %</span>
4834 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
4835 guiparams.contours                           = <span class="string">''</span>; <span class="comment">% Set below</span>
4836 guiparams.contour                            = <span class="string">''</span>; <span class="comment">% Set below</span>
4837 guiparams.idx_contour                        = 1;
4838 guiparams.vertical_exaggeration              = 10;
4839 guiparams.vector_scale_cross_section         = 0.2;
4840 guiparams.horizontal_vector_spacing          = 1;
4841 guiparams.vertical_vector_spacing            = 1;
4842 guiparams.horizontal_smoothing_window        = 1;
4843 guiparams.vertical_smoothing_window          = 1;
4844 guiparams.plot_secondary_flow_vectors        = true;
4845 guiparams.secondary_flows                    = <span class="string">''</span>; <span class="comment">% Set below</span>
4846 guiparams.secondary_flow_vector_variable     = <span class="string">''</span>; <span class="comment">% Set below</span>
4847 guiparams.idx_secondary_flow_vector_variable = 1;
4848 guiparams.include_vertical_velocity          = true;
4849 
4850 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
4851 <span class="comment">% PLAN VIEW PLOT %</span>
4852 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
4853 guiparams.depth_range_min                    = 0;
4854 guiparams.depth_range_max                    = inf;
4855 guiparams.vector_scale_plan_view             = 1;
4856 guiparams.vector_spacing_plan_view           = 1;
4857 guiparams.smoothing_window_size              = 1;
4858 guiparams.display_shoreline                  = false;
4859 guiparams.add_background                     = false;
4860 
4861 <span class="comment">%%%%%%%%%%%%%%%</span>
4862 <span class="comment">% DATA EXPORT %</span>
4863 <span class="comment">%%%%%%%%%%%%%%%</span>
4864 guiparams.beam_angle                         = 20.0;
4865 guiparams.magnetic_variation                 = 0.0;
4866 guiparams.wse                                = 0.0;
4867 guiparams.output_auxiliary_data              = false;
4868 
4869 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
4870 <span class="comment">% Contour variables %</span>
4871 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
4872 idx = 1;
4873 guiparams.contours(idx).string   = <span class="string">'Streamwise Velocity (u)'</span>;
4874 guiparams.contours(idx).variable = <span class="string">'streamwise'</span>;
4875 idx = idx + 1;
4876 guiparams.contours(idx).string   = <span class="string">'Transverse Velocity (v)'</span>;
4877 guiparams.contours(idx).variable = <span class="string">'transverse'</span>;
4878 idx = idx + 1;
4879 guiparams.contours(idx).string   = <span class="string">'Vertical Velocity (w)'</span>;
4880 guiparams.contours(idx).variable = <span class="string">'vertical'</span>;
4881 idx = idx + 1;
4882 guiparams.contours(idx).string   = <span class="string">'Velocity Magnitude'</span>;
4883 guiparams.contours(idx).variable = <span class="string">'mag'</span>;
4884 idx = idx + 1;
4885 guiparams.contours(idx).string   = <span class="string">'East Velocity (E)'</span>;
4886 guiparams.contours(idx).variable = <span class="string">'east'</span>;
4887 idx = idx + 1;
4888 guiparams.contours(idx).string   = <span class="string">'North Velocity (N)'</span>;
4889 guiparams.contours(idx).variable = <span class="string">'north'</span>;
4890 idx = idx + 1;
4891 guiparams.contours(idx).string   = <span class="string">'Error Velocity'</span>;
4892 guiparams.contours(idx).variable = <span class="string">'error'</span>;
4893 idx = idx + 1;
4894 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (zsd)'</span>;
4895 guiparams.contours(idx).variable = <span class="string">'primary_zsd'</span>;
4896 idx = idx + 1;
4897 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (zsd)'</span>;
4898 guiparams.contours(idx).variable = <span class="string">'secondary_zsd'</span>;
4899 idx = idx + 1;
4900 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (Roz)'</span>;
4901 guiparams.contours(idx).variable = <span class="string">'primary_roz'</span>;
4902 idx = idx + 1;
4903 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (Roz)'</span>;
4904 guiparams.contours(idx).variable = <span class="string">'secondary_roz'</span>;
4905 idx = idx + 1;
4906 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Downstream Comp.)'</span>;
4907 guiparams.contours(idx).variable = <span class="string">'primary_roz_x'</span>;
4908 idx = idx + 1;
4909 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Cross-Stream Comp.)'</span>;
4910 guiparams.contours(idx).variable = <span class="string">'primary_roz_y'</span>;
4911 idx = idx + 1;
4912 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Downstream Comp.)'</span>;
4913 guiparams.contours(idx).variable = <span class="string">'secondary_roz_x'</span>;
4914 idx = idx + 1;
4915 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Cross-Stream Comp.)'</span>;
4916 guiparams.contours(idx).variable = <span class="string">'secondary_roz_y'</span>;
4917 idx = idx + 1;
4918 guiparams.contours(idx).string   = <span class="string">'Backscatter'</span>;
4919 guiparams.contours(idx).variable = <span class="string">'backscatter'</span>;
4920 idx = idx + 1;
4921 guiparams.contours(idx).string   = <span class="string">'Flow Direction (deg.)'</span>;
4922 guiparams.contours(idx).variable = <span class="string">'flowangle'</span>;
4923 
4924 guiparams.contour = guiparams.contours(guiparams.idx_contour).variable;
4925 
4926 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4927 <span class="comment">% Secondary Flow Vector Variables %</span>
4928 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4929 idx = 1;
4930 guiparams.secondary_flows(idx).string   = <span class="string">'Transverse'</span>;
4931 guiparams.secondary_flows(idx).variable = <span class="string">'transverse'</span>;
4932 idx = idx + 1;
4933 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (zsd)'</span>;
4934 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_zsd'</span>;
4935 idx = idx + 1;
4936 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz)'</span>;
4937 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz'</span>;
4938 idx = idx + 1;
4939 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz, Cross-Stream Comp)'</span>;
4940 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz_y'</span>;
4941 idx = idx + 1;
4942 guiparams.secondary_flows(idx).string   = <span class="string">'Primary (Roz, Cross-Stream Comp)'</span>;
4943 guiparams.secondary_flows(idx).variable  = <span class="string">'primary_roz_y'</span>;
4944 
4945 guiparams.secondary_flow_vector_variable = <span class="keyword">...</span>
4946     guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).variable;
4947 
4948 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4949 <span class="comment">% INTERNAL SETTINGS &amp; DEFAULTS %</span>
4950 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4951 <span class="comment">% Menu bar options</span>
4952 guiparams.presentation                       = true;
4953 guiparams.print                              = false;
4954 guiparams.set_cross_section_endpoints        = false;
4955 guiparams.unit_discharge_correction          = false;
4956 
4957 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'units'</span>)
4958     <span class="keyword">switch</span> guiprefs.units
4959         <span class="keyword">case</span> <span class="string">'metric'</span>
4960             guiparams.english_units          = false;
4961         <span class="keyword">case</span> <span class="string">'english'</span>
4962             guiparams.english_units          = true;
4963     <span class="keyword">end</span>
4964 <span class="keyword">else</span>
4965     guiparams.english_units                  = false;
4966 <span class="keyword">end</span>
4967 guiparams.vertical_offset                    = 0;
4968 
4969 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>)
4970     guiparams.renderer                       = guiprefs.renderer;
4971 <span class="keyword">else</span>
4972     guiparams.renderer                       = <span class="string">'OpenGL'</span>;
4973 <span class="keyword">end</span>
4974 <span class="comment">% guiparams.plot_ship_tracks                   = false;</span>
4975 <span class="comment">% guiparams.plot_planview                      = false;</span>
4976 <span class="comment">% guiparams.plot_cross_section                 = false;</span>
4977 
4978 <span class="comment">% File location defaults</span>
4979 guiparams.ascii_path                        = pwd;
4980 guiparams.ascii_file                        = <span class="string">''</span>;
4981 guiparams.mat_path                          = pwd;
4982 guiparams.mat_file                          = <span class="string">''</span>;
4983 guiparams.tecplot_path                      = pwd;
4984 guiparams.tecplot_file                      = <span class="string">''</span>;
4985 guiparams.kmz_path                          = pwd;
4986 guiparams.kmz_file                          = <span class="string">''</span>;
4987 guiparams.multibeambathymetry_path          = pwd;
4988 guiparams.multibeambathymetry_file          = <span class="string">''</span>;
4989 guiparams.log_path                          = pwd;
4990 guiparams.log_file                          = <span class="string">''</span>;
4991 <span class="comment">% Avoids problems of not finding the MCR root when running as a standalone</span>
4992 <span class="comment">% application</span>
4993 <span class="keyword">if</span> isdeployed 
4994     guiparams.has_mapping_toolbox           = true;
4995 <span class="keyword">else</span>
4996     guiparams.has_mapping_toolbox               = <span class="keyword">...</span>
4997         ~isempty(dir(fullfile(matlabroot,<span class="string">'toolbox'</span>,<span class="string">'map'</span>)));
4998 <span class="keyword">end</span>
4999 
5000 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5001 <span class="comment">% IN MEMORY DATA STORAGE %</span>
5002 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5003 guiparams.z                      = [];
5004 guiparams.A                      = [];
5005 guiparams.V                      = [];
5006 guiparams.Map                    = [];
5007 guiparams.savefile               = [];
5008 guiparams.iric_anv_planview_data = [];
5009 <span class="comment">% guiparams.zmin = []; % Don't need to store these?</span>
5010 <span class="comment">% guiparams.zmax = [];</span>
5011 <span class="comment">% guiprefs = getappdata(handles.figure1,'guiprefs');</span>
5012 guiparams.data_folder = <span class="string">''</span>;
5013 guiparams.data_files  = {<span class="string">''</span>};
5014 guiparams.gui_state   = <span class="string">'init'</span>;
5015 
5016 <span class="comment">% [EOF] createGUIparams</span>
5017 
5018 <a name="_sub109" href="#_subfunctions" class="code">function ShiptracksZoom_Callback(obj,evd,handles)</a>
5019 ticks_format(<span class="string">'%6.0f'</span>,<span class="string">'%8.0f'</span>); <span class="comment">%formats the ticks for UTM (when zooming)</span>
5020 
5021 <a name="_sub110" href="#_subfunctions" class="code">function ShiptracksPan_Callback(obj,evd,handles)</a>
5022 ticks_format(<span class="string">'%6.0f'</span>,<span class="string">'%8.0f'</span>); <span class="comment">%formats the ticks for UTM (when panning)</span>
5023 
5024 <span class="comment">% [EOF] VMT</span>
5025 
5026 
5027 
5028 
5029 
5030 <span class="comment">% --- Hidden keyboard commands</span>
5031 <a name="_sub111" href="#_subfunctions" class="code">function figure1_WindowKeyPressFcn(hObject, eventdata, handles)</a>
5032 <span class="comment">% Used to pass specific hidden keyboard commands to VMT. Currently, the</span>
5033 <span class="comment">% only use for this function is to open Beta support for SonTek M9 data.</span>
5034 <span class="comment">%</span>
5035 <span class="comment">% hObject    handle to figure1 (see GCBO)</span>
5036 <span class="comment">% eventdata  structure with the following fields (see FIGURE)</span>
5037 <span class="comment">%    Key: name of the key that was pressed, in lower case</span>
5038 <span class="comment">%    Character: character interpretation of the key(s) that was pressed</span>
5039 <span class="comment">%    Modifier: name(s) of the modifier key(s) (i.e., control, shift) pressed</span>
5040 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
5041 
5042 in1 = eventdata.Modifier; 
5043 in2 = eventdata.Key;
5044 
5045 <span class="keyword">if</span> ~isempty(in1) <span class="comment">% User pressed at least one modifier key</span>
5046     input = [in1{:} in2];
5047 <span class="keyword">else</span>
5048     input = in2;
5049 <span class="keyword">end</span>
5050 
5051 <span class="keyword">switch</span> input
5052     <span class="comment">% Hidden SonTek M9 support</span>
5053     <span class="keyword">case</span> <span class="string">'shiftcontrols'</span>
5054         msgtxt = {<span class="keyword">...</span>
5055             <span class="string">'VMT offers limited support for SonTek M9/S5 data.'</span>;<span class="keyword">...</span>
5056             <span class="string">'SonTek RiverSurveyorLive required data format:'</span>;<span class="keyword">...</span>
5057             <span class="string">'      -ENU coordinates'</span>;<span class="keyword">...</span>
5058             <span class="string">'      -Desired GPS reference (BT/GGA/VTG)'</span>
5059             <span class="string">''</span>;<span class="keyword">...</span>
5060             <span class="string">'Abosolutely NO GUARANTEE is made or implied that this'</span>;<span class="keyword">...</span>
5061             <span class="string">'functionality will work for all cases. Results are'</span>;<span class="keyword">...</span>
5062             <span class="string">'PROVISIONAL at best.'</span>};
5063         msgbox(msgtxt, <span class="string">'Hidden Functionality: Process SonTek M9'</span>, <span class="string">'warn'</span>,<span class="string">'replace'</span>)
5064         
5065         <span class="comment">% Get the Application data:</span>
5066         <span class="comment">% -------------------------</span>
5067         guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
5068         guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
5069         
5070         <span class="comment">% Ask the user to select files:</span>
5071         <span class="comment">% -----------------------------</span>
5072         <span class="comment">% current_file = fullfile(guiparams.data_folder,guiparams.data_files{1});</span>
5073         <span class="comment">% current_file = fullfile(guiprefs.mat_path,guiprefs.mat_file);</span>
5074         <span class="keyword">if</span> iscell(guiprefs.mat_file)
5075             uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file{1});
5076         <span class="keyword">else</span>
5077             uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file);
5078         <span class="keyword">end</span>
5079         [filename,pathname] = <span class="keyword">...</span>
5080             uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-files (*.mat)'</span>}, <span class="keyword">...</span>
5081             <span class="string">'Select SonTek RiverSurveyor Live v3.60 MAT File'</span>, <span class="keyword">...</span>
5082             uifile, <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
5083         
5084         <span class="keyword">if</span> ischar(pathname) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
5085             guiparams.data_folder = pathname;
5086             <span class="keyword">if</span> ischar(filename)
5087                 filename = {filename};
5088             <span class="keyword">end</span>
5089             guiparams.data_files = filename;
5090             guiparams.mat_file = <span class="string">''</span>;
5091             
5092             setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
5093             
5094             
5095             
5096             <span class="comment">% Update the preferences:</span>
5097             <span class="comment">% -----------------------</span>
5098             guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
5099             guiprefs.ascii_path = pathname;
5100             guiprefs.ascii_file = filename;
5101             setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
5102             <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'ascii'</span>)
5103             
5104             <span class="comment">% Push messages to Log Window:</span>
5105             <span class="comment">% ----------------------------</span>
5106             log_text = {<span class="keyword">...</span>
5107                 <span class="string">''</span>;<span class="keyword">...</span>
5108                 [<span class="string">'%--- '</span> datestr(now) <span class="string">' ---%'</span>];<span class="keyword">...</span>
5109                 <span class="string">'Current Project Directory:'</span>;<span class="keyword">...</span>
5110                 guiparams.data_folder;
5111                 <span class="string">'Loading the following files into memory:'</span>;<span class="keyword">...</span>
5112                 char(filename)};
5113             statusLogging(handles.LogWindow, log_text)
5114             
5115             <span class="comment">% Read the file(s)</span>
5116             <span class="comment">% ----------------</span>
5117             <span class="comment">%A = parseSonTekVMT(fullfile(pathname,filename));</span>
5118             
5119             [~,~,savefile,A,z] = <span class="keyword">...</span>
5120                 <a href="VMT_ReadFiles_SonTek.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles_SonTek(zPathName,zFileName)">VMT_ReadFiles_SonTek</a>(guiparams.data_folder,guiparams.data_files);
5121             guiparams.savefile = savefile;
5122             guiparams.A        = A;
5123             guiparams.z        = z;
5124             setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
5125             
5126             
5127             <span class="comment">% Update the GUI:</span>
5128             <span class="comment">% ---------------</span>
5129             <a href="#_sub95" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
5130         <span class="keyword">end</span>  
5131     <span class="keyword">case</span> <span class="string">'f1'</span> <span class="comment">% Call the VMT UsersGuide</span>
5132         <a href="#_sub46" class="code" title="subfunction menuUsersGuide_Callback(hObject, eventdata, handles)">menuUsersGuide_Callback</a>(hObject, eventdata, handles)
5133         
5134     <span class="keyword">case</span> <span class="string">'controlalte'</span>
5135         VMT_BuildCustomFlatFile;
5136     <span class="keyword">otherwise</span>
5137         <span class="comment">%disp(input)</span>
5138 <span class="keyword">end</span>
5139 
5140 
5141 
5142</pre></div>
<hr><address>Generated on Tue 29-Apr-2014 14:30:48 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>